function KW(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const a=Object.getOwnPropertyDescriptor(s,r);a&&Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();function RC(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function DC(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var U2={exports:{}},Sd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w3;function YW(){if(w3)return Sd;w3=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(s,r,a){var i=null;if(a!==void 0&&(i=""+a),r.key!==void 0&&(i=""+r.key),"key"in r){a={};for(var o in r)o!=="key"&&(a[o]=r[o])}else a=r;return r=a.ref,{$$typeof:t,type:s,key:i,ref:r!==void 0?r:null,props:a}}return Sd.Fragment=e,Sd.jsx=n,Sd.jsxs=n,Sd}var S3;function ZW(){return S3||(S3=1,U2.exports=YW()),U2.exports}var L=ZW(),j2={exports:{}},et={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T3;function QW(){if(T3)return et;T3=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),i=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator;function p(V){return V===null||typeof V!="object"?null:(V=d&&V[d]||V["@@iterator"],typeof V=="function"?V:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,v={};function x(V,ee,ce){this.props=V,this.context=ee,this.refs=v,this.updater=ce||g}x.prototype.isReactComponent={},x.prototype.setState=function(V,ee){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,ee,"setState")},x.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function w(){}w.prototype=x.prototype;function T(V,ee,ce){this.props=V,this.context=ee,this.refs=v,this.updater=ce||g}var N=T.prototype=new w;N.constructor=T,y(N,x.prototype),N.isPureReactComponent=!0;var C=Array.isArray,E={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function $(V,ee,ce,ue,he,be){return ce=be.ref,{$$typeof:t,type:V,key:ee,ref:ce!==void 0?ce:null,props:be}}function O(V,ee){return $(V.type,ee,void 0,void 0,void 0,V.props)}function A(V){return typeof V=="object"&&V!==null&&V.$$typeof===t}function _(V){var ee={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(ce){return ee[ce]})}var D=/\/+/g;function B(V,ee){return typeof V=="object"&&V!==null&&V.key!=null?_(""+V.key):ee.toString(36)}function j(){}function W(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(j,j):(V.status="pending",V.then(function(ee){V.status==="pending"&&(V.status="fulfilled",V.value=ee)},function(ee){V.status==="pending"&&(V.status="rejected",V.reason=ee)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function X(V,ee,ce,ue,he){var be=typeof V;(be==="undefined"||be==="boolean")&&(V=null);var we=!1;if(V===null)we=!0;else switch(be){case"bigint":case"string":case"number":we=!0;break;case"object":switch(V.$$typeof){case t:case e:we=!0;break;case f:return we=V._init,X(we(V._payload),ee,ce,ue,he)}}if(we)return he=he(V),we=ue===""?"."+B(V,0):ue,C(he)?(ce="",we!=null&&(ce=we.replace(D,"$&/")+"/"),X(he,ee,ce,"",function(Ae){return Ae})):he!=null&&(A(he)&&(he=O(he,ce+(he.key==null||V&&V.key===he.key?"":(""+he.key).replace(D,"$&/")+"/")+we)),ee.push(he)),1;we=0;var Ie=ue===""?".":ue+":";if(C(V))for(var ke=0;ke<V.length;ke++)ue=V[ke],be=Ie+B(ue,ke),we+=X(ue,ee,ce,be,he);else if(ke=p(V),typeof ke=="function")for(V=ke.call(V),ke=0;!(ue=V.next()).done;)ue=ue.value,be=Ie+B(ue,ke++),we+=X(ue,ee,ce,be,he);else if(be==="object"){if(typeof V.then=="function")return X(W(V),ee,ce,ue,he);throw ee=String(V),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return we}function U(V,ee,ce){if(V==null)return V;var ue=[],he=0;return X(V,ue,"","",function(be){return ee.call(ce,be,he++)}),ue}function Y(V){if(V._status===-1){var ee=V._result;ee=ee(),ee.then(function(ce){(V._status===0||V._status===-1)&&(V._status=1,V._result=ce)},function(ce){(V._status===0||V._status===-1)&&(V._status=2,V._result=ce)}),V._status===-1&&(V._status=0,V._result=ee)}if(V._status===1)return V._result.default;throw V._result}var Q=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)};function ie(){}return et.Children={map:U,forEach:function(V,ee,ce){U(V,function(){ee.apply(this,arguments)},ce)},count:function(V){var ee=0;return U(V,function(){ee++}),ee},toArray:function(V){return U(V,function(ee){return ee})||[]},only:function(V){if(!A(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},et.Component=x,et.Fragment=n,et.Profiler=r,et.PureComponent=T,et.StrictMode=s,et.Suspense=l,et.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,et.act=function(){throw Error("act(...) is not supported in production builds of React.")},et.cache=function(V){return function(){return V.apply(null,arguments)}},et.cloneElement=function(V,ee,ce){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var ue=y({},V.props),he=V.key,be=void 0;if(ee!=null)for(we in ee.ref!==void 0&&(be=void 0),ee.key!==void 0&&(he=""+ee.key),ee)!R.call(ee,we)||we==="key"||we==="__self"||we==="__source"||we==="ref"&&ee.ref===void 0||(ue[we]=ee[we]);var we=arguments.length-2;if(we===1)ue.children=ce;else if(1<we){for(var Ie=Array(we),ke=0;ke<we;ke++)Ie[ke]=arguments[ke+2];ue.children=Ie}return $(V.type,he,void 0,void 0,be,ue)},et.createContext=function(V){return V={$$typeof:i,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:a,_context:V},V},et.createElement=function(V,ee,ce){var ue,he={},be=null;if(ee!=null)for(ue in ee.key!==void 0&&(be=""+ee.key),ee)R.call(ee,ue)&&ue!=="key"&&ue!=="__self"&&ue!=="__source"&&(he[ue]=ee[ue]);var we=arguments.length-2;if(we===1)he.children=ce;else if(1<we){for(var Ie=Array(we),ke=0;ke<we;ke++)Ie[ke]=arguments[ke+2];he.children=Ie}if(V&&V.defaultProps)for(ue in we=V.defaultProps,we)he[ue]===void 0&&(he[ue]=we[ue]);return $(V,be,void 0,void 0,null,he)},et.createRef=function(){return{current:null}},et.forwardRef=function(V){return{$$typeof:o,render:V}},et.isValidElement=A,et.lazy=function(V){return{$$typeof:f,_payload:{_status:-1,_result:V},_init:Y}},et.memo=function(V,ee){return{$$typeof:c,type:V,compare:ee===void 0?null:ee}},et.startTransition=function(V){var ee=E.T,ce={};E.T=ce;try{var ue=V(),he=E.S;he!==null&&he(ce,ue),typeof ue=="object"&&ue!==null&&typeof ue.then=="function"&&ue.then(ie,Q)}catch(be){Q(be)}finally{E.T=ee}},et.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},et.use=function(V){return E.H.use(V)},et.useActionState=function(V,ee,ce){return E.H.useActionState(V,ee,ce)},et.useCallback=function(V,ee){return E.H.useCallback(V,ee)},et.useContext=function(V){return E.H.useContext(V)},et.useDebugValue=function(){},et.useDeferredValue=function(V,ee){return E.H.useDeferredValue(V,ee)},et.useEffect=function(V,ee){return E.H.useEffect(V,ee)},et.useId=function(){return E.H.useId()},et.useImperativeHandle=function(V,ee,ce){return E.H.useImperativeHandle(V,ee,ce)},et.useInsertionEffect=function(V,ee){return E.H.useInsertionEffect(V,ee)},et.useLayoutEffect=function(V,ee){return E.H.useLayoutEffect(V,ee)},et.useMemo=function(V,ee){return E.H.useMemo(V,ee)},et.useOptimistic=function(V,ee){return E.H.useOptimistic(V,ee)},et.useReducer=function(V,ee,ce){return E.H.useReducer(V,ee,ce)},et.useRef=function(V){return E.H.useRef(V)},et.useState=function(V){return E.H.useState(V)},et.useSyncExternalStore=function(V,ee,ce){return E.H.useSyncExternalStore(V,ee,ce)},et.useTransition=function(){return E.H.useTransition()},et.version="19.0.0",et}var C3;function OC(){return C3||(C3=1,j2.exports=QW()),j2.exports}var K=OC();const wi=RC(K);var W2={exports:{}},Td={},G2={exports:{}},H2={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N3;function JW(){return N3||(N3=1,function(t){function e(U,Y){var Q=U.length;U.push(Y);e:for(;0<Q;){var ie=Q-1>>>1,V=U[ie];if(0<r(V,Y))U[ie]=Y,U[Q]=V,Q=ie;else break e}}function n(U){return U.length===0?null:U[0]}function s(U){if(U.length===0)return null;var Y=U[0],Q=U.pop();if(Q!==Y){U[0]=Q;e:for(var ie=0,V=U.length,ee=V>>>1;ie<ee;){var ce=2*(ie+1)-1,ue=U[ce],he=ce+1,be=U[he];if(0>r(ue,Q))he<V&&0>r(be,ue)?(U[ie]=be,U[he]=Q,ie=he):(U[ie]=ue,U[ce]=Q,ie=ce);else if(he<V&&0>r(be,Q))U[ie]=be,U[he]=Q,ie=he;else break e}}return Y}function r(U,Y){var Q=U.sortIndex-Y.sortIndex;return Q!==0?Q:U.id-Y.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var l=[],c=[],f=1,d=null,p=3,g=!1,y=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function N(U){for(var Y=n(c);Y!==null;){if(Y.callback===null)s(c);else if(Y.startTime<=U)s(c),Y.sortIndex=Y.expirationTime,e(l,Y);else break;Y=n(c)}}function C(U){if(v=!1,N(U),!y)if(n(l)!==null)y=!0,W();else{var Y=n(c);Y!==null&&X(C,Y.startTime-U)}}var E=!1,R=-1,$=5,O=-1;function A(){return!(t.unstable_now()-O<$)}function _(){if(E){var U=t.unstable_now();O=U;var Y=!0;try{e:{y=!1,v&&(v=!1,w(R),R=-1),g=!0;var Q=p;try{t:{for(N(U),d=n(l);d!==null&&!(d.expirationTime>U&&A());){var ie=d.callback;if(typeof ie=="function"){d.callback=null,p=d.priorityLevel;var V=ie(d.expirationTime<=U);if(U=t.unstable_now(),typeof V=="function"){d.callback=V,N(U),Y=!0;break t}d===n(l)&&s(l),N(U)}else s(l);d=n(l)}if(d!==null)Y=!0;else{var ee=n(c);ee!==null&&X(C,ee.startTime-U),Y=!1}}break e}finally{d=null,p=Q,g=!1}Y=void 0}}finally{Y?D():E=!1}}}var D;if(typeof T=="function")D=function(){T(_)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,j=B.port2;B.port1.onmessage=_,D=function(){j.postMessage(null)}}else D=function(){x(_,0)};function W(){E||(E=!0,D())}function X(U,Y){R=x(function(){U(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_continueExecution=function(){y||g||(y=!0,W())},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(U){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var Q=p;p=Y;try{return U()}finally{p=Q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(U,Y){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var Q=p;p=U;try{return Y()}finally{p=Q}},t.unstable_scheduleCallback=function(U,Y,Q){var ie=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ie+Q:ie):Q=ie,U){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=Q+V,U={id:f++,callback:Y,priorityLevel:U,startTime:Q,expirationTime:V,sortIndex:-1},Q>ie?(U.sortIndex=Q,e(c,U),n(l)===null&&U===n(c)&&(v?(w(R),R=-1):v=!0,X(C,Q-ie))):(U.sortIndex=V,e(l,U),y||g||(y=!0,W())),U},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(U){var Y=p;return function(){var Q=p;p=Y;try{return U.apply(this,arguments)}finally{p=Q}}}}(H2)),H2}var k3;function eG(){return k3||(k3=1,G2.exports=JW()),G2.exports}var q2={exports:{}},ls={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E3;function tG(){if(E3)return ls;E3=1;var t=OC();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var s={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(l,c,f){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:d==null?null:""+d,children:l,containerInfo:c,implementation:f}}var i=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return ls.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,ls.createPortal=function(l,c){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return a(l,c,null,f)},ls.flushSync=function(l){var c=i.T,f=s.p;try{if(i.T=null,s.p=2,l)return l()}finally{i.T=c,s.p=f,s.d.f()}},ls.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,s.d.C(l,c))},ls.prefetchDNS=function(l){typeof l=="string"&&s.d.D(l)},ls.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var f=c.as,d=o(f,c.crossOrigin),p=typeof c.integrity=="string"?c.integrity:void 0,g=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;f==="style"?s.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:p,fetchPriority:g}):f==="script"&&s.d.X(l,{crossOrigin:d,integrity:p,fetchPriority:g,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},ls.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var f=o(c.as,c.crossOrigin);s.d.M(l,{crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&s.d.M(l)},ls.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var f=c.as,d=o(f,c.crossOrigin);s.d.L(l,f,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},ls.preloadModule=function(l,c){if(typeof l=="string")if(c){var f=o(c.as,c.crossOrigin);s.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else s.d.m(l)},ls.requestFormReset=function(l){s.d.r(l)},ls.unstable_batchedUpdates=function(l,c){return l(c)},ls.useFormState=function(l,c,f){return i.H.useFormState(l,c,f)},ls.useFormStatus=function(){return i.H.useHostTransitionStatus()},ls.version="19.0.0",ls}var $3;function nG(){if($3)return q2.exports;$3=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),q2.exports=tG(),q2.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I3;function sG(){if(I3)return Td;I3=1;var t=eG(),e=OC(),n=nG();function s(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}var a=Symbol.for("react.element"),i=Symbol.for("react.transitional.element"),o=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),p=Symbol.for("react.consumer"),g=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),N=Symbol.for("react.offscreen"),C=Symbol.for("react.memo_cache_sentinel"),E=Symbol.iterator;function R(u){return u===null||typeof u!="object"?null:(u=E&&u[E]||u["@@iterator"],typeof u=="function"?u:null)}var $=Symbol.for("react.client.reference");function O(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===$?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case l:return"Fragment";case o:return"Portal";case f:return"Profiler";case c:return"StrictMode";case v:return"Suspense";case x:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case g:return(u.displayName||"Context")+".Provider";case p:return(u._context.displayName||"Context")+".Consumer";case y:var h=u.render;return u=u.displayName,u||(u=h.displayName||h.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case w:return h=u.displayName||null,h!==null?h:O(u.type)||"Memo";case T:h=u._payload,u=u._init;try{return O(u(h))}catch{}}return null}var A=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_=Object.assign,D,B;function j(u){if(D===void 0)try{throw Error()}catch(m){var h=m.stack.trim().match(/\n( *(at )?)/);D=h&&h[1]||"",B=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+D+u+B}var W=!1;function X(u,h){if(!u||W)return"";W=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(h){var Te=function(){throw Error()};if(Object.defineProperty(Te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Te,[])}catch(ge){var fe=ge}Reflect.construct(u,[],Te)}else{try{Te.call()}catch(ge){fe=ge}u.call(Te.prototype)}}else{try{throw Error()}catch(ge){fe=ge}(Te=u())&&typeof Te.catch=="function"&&Te.catch(function(){})}}catch(ge){if(ge&&fe&&typeof ge.stack=="string")return[ge.stack,fe.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=b.DetermineComponentFrameRoot(),F=k[0],P=k[1];if(F&&P){var G=F.split(`
`),se=P.split(`
`);for(S=b=0;b<G.length&&!G[b].includes("DetermineComponentFrameRoot");)b++;for(;S<se.length&&!se[S].includes("DetermineComponentFrameRoot");)S++;if(b===G.length||S===se.length)for(b=G.length-1,S=se.length-1;1<=b&&0<=S&&G[b]!==se[S];)S--;for(;1<=b&&0<=S;b--,S--)if(G[b]!==se[S]){if(b!==1||S!==1)do if(b--,S--,0>S||G[b]!==se[S]){var ye=`
`+G[b].replace(" at new "," at ");return u.displayName&&ye.includes("<anonymous>")&&(ye=ye.replace("<anonymous>",u.displayName)),ye}while(1<=b&&0<=S);break}}}finally{W=!1,Error.prepareStackTrace=m}return(m=u?u.displayName||u.name:"")?j(m):""}function U(u){switch(u.tag){case 26:case 27:case 5:return j(u.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 15:return u=X(u.type,!1),u;case 11:return u=X(u.type.render,!1),u;case 1:return u=X(u.type,!0),u;default:return""}}function Y(u){try{var h="";do h+=U(u),u=u.return;while(u);return h}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}function Q(u){var h=u,m=u;if(u.alternate)for(;h.return;)h=h.return;else{u=h;do h=u,(h.flags&4098)!==0&&(m=h.return),u=h.return;while(u)}return h.tag===3?m:null}function ie(u){if(u.tag===13){var h=u.memoizedState;if(h===null&&(u=u.alternate,u!==null&&(h=u.memoizedState)),h!==null)return h.dehydrated}return null}function V(u){if(Q(u)!==u)throw Error(s(188))}function ee(u){var h=u.alternate;if(!h){if(h=Q(u),h===null)throw Error(s(188));return h!==u?null:u}for(var m=u,b=h;;){var S=m.return;if(S===null)break;var k=S.alternate;if(k===null){if(b=S.return,b!==null){m=b;continue}break}if(S.child===k.child){for(k=S.child;k;){if(k===m)return V(S),u;if(k===b)return V(S),h;k=k.sibling}throw Error(s(188))}if(m.return!==b.return)m=S,b=k;else{for(var F=!1,P=S.child;P;){if(P===m){F=!0,m=S,b=k;break}if(P===b){F=!0,b=S,m=k;break}P=P.sibling}if(!F){for(P=k.child;P;){if(P===m){F=!0,m=k,b=S;break}if(P===b){F=!0,b=k,m=S;break}P=P.sibling}if(!F)throw Error(s(189))}}if(m.alternate!==b)throw Error(s(190))}if(m.tag!==3)throw Error(s(188));return m.stateNode.current===m?u:h}function ce(u){var h=u.tag;if(h===5||h===26||h===27||h===6)return u;for(u=u.child;u!==null;){if(h=ce(u),h!==null)return h;u=u.sibling}return null}var ue=Array.isArray,he=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,be={pending:!1,data:null,method:null,action:null},we=[],Ie=-1;function ke(u){return{current:u}}function Ae(u){0>Ie||(u.current=we[Ie],we[Ie]=null,Ie--)}function De(u,h){Ie++,we[Ie]=u.current,u.current=h}var We=ke(null),ft=ke(null),dt=ke(null),$t=ke(null);function vt(u,h){switch(De(dt,h),De(ft,u),De(We,null),u=h.nodeType,u){case 9:case 11:h=(h=h.documentElement)&&(h=h.namespaceURI)?YD(h):0;break;default:if(u=u===8?h.parentNode:h,h=u.tagName,u=u.namespaceURI)u=YD(u),h=ZD(u,h);else switch(h){case"svg":h=1;break;case"math":h=2;break;default:h=0}}Ae(We),De(We,h)}function pt(){Ae(We),Ae(ft),Ae(dt)}function It(u){u.memoizedState!==null&&De($t,u);var h=We.current,m=ZD(h,u.type);h!==m&&(De(ft,u),De(We,m))}function Tt(u){ft.current===u&&(Ae(We),Ae(ft)),$t.current===u&&(Ae($t),yd._currentValue=be)}var Zs=Object.prototype.hasOwnProperty,Jt=t.unstable_scheduleCallback,wr=t.unstable_cancelCallback,Ss=t.unstable_shouldYield,Ya=t.unstable_requestPaint,en=t.unstable_now,Gr=t.unstable_getCurrentPriorityLevel,Hr=t.unstable_ImmediatePriority,qr=t.unstable_UserBlockingPriority,Qs=t.unstable_NormalPriority,al=t.unstable_LowPriority,zu=t.unstable_IdlePriority,kf=t.log,Fv=t.unstable_setDisableYieldValue,xa=null,Ts=null;function Lv(u){if(Ts&&typeof Ts.onCommitFiberRoot=="function")try{Ts.onCommitFiberRoot(xa,u,void 0,(u.current.flags&128)===128)}catch{}}function Ki(u){if(typeof kf=="function"&&Fv(u),Ts&&typeof Ts.setStrictMode=="function")try{Ts.setStrictMode(xa,u)}catch{}}var Js=Math.clz32?Math.clz32:Lj,_j=Math.log,Fj=Math.LN2;function Lj(u){return u>>>=0,u===0?32:31-(_j(u)/Fj|0)|0}var Rg=128,Dg=4194304;function il(u){var h=u&42;if(h!==0)return h;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function Og(u,h){var m=u.pendingLanes;if(m===0)return 0;var b=0,S=u.suspendedLanes,k=u.pingedLanes,F=u.warmLanes;u=u.finishedLanes!==0;var P=m&134217727;return P!==0?(m=P&~S,m!==0?b=il(m):(k&=P,k!==0?b=il(k):u||(F=P&~F,F!==0&&(b=il(F))))):(P=m&~S,P!==0?b=il(P):k!==0?b=il(k):u||(F=m&~F,F!==0&&(b=il(F)))),b===0?0:h!==0&&h!==b&&(h&S)===0&&(S=b&-b,F=h&-h,S>=F||S===32&&(F&4194176)!==0)?h:b}function Ef(u,h){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&h)===0}function Mj(u,h){switch(u){case 1:case 2:case 4:case 8:return h+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function UI(){var u=Rg;return Rg<<=1,(Rg&4194176)===0&&(Rg=128),u}function jI(){var u=Dg;return Dg<<=1,(Dg&62914560)===0&&(Dg=4194304),u}function Mv(u){for(var h=[],m=0;31>m;m++)h.push(u);return h}function $f(u,h){u.pendingLanes|=h,h!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function zj(u,h,m,b,S,k){var F=u.pendingLanes;u.pendingLanes=m,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=m,u.entangledLanes&=m,u.errorRecoveryDisabledLanes&=m,u.shellSuspendCounter=0;var P=u.entanglements,G=u.expirationTimes,se=u.hiddenUpdates;for(m=F&~m;0<m;){var ye=31-Js(m),Te=1<<ye;P[ye]=0,G[ye]=-1;var fe=se[ye];if(fe!==null)for(se[ye]=null,ye=0;ye<fe.length;ye++){var ge=fe[ye];ge!==null&&(ge.lane&=-536870913)}m&=~Te}b!==0&&WI(u,b,0),k!==0&&S===0&&u.tag!==0&&(u.suspendedLanes|=k&~(F&~h))}function WI(u,h,m){u.pendingLanes|=h,u.suspendedLanes&=~h;var b=31-Js(h);u.entangledLanes|=h,u.entanglements[b]=u.entanglements[b]|1073741824|m&4194218}function GI(u,h){var m=u.entangledLanes|=h;for(u=u.entanglements;m;){var b=31-Js(m),S=1<<b;S&h|u[b]&h&&(u[b]|=h),m&=~S}}function HI(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function qI(){var u=he.p;return u!==0?u:(u=window.event,u===void 0?32:m3(u.type))}function Pj(u,h){var m=he.p;try{return he.p=u,h()}finally{he.p=m}}var Yi=Math.random().toString(36).slice(2),is="__reactFiber$"+Yi,Ls="__reactProps$"+Yi,Pu="__reactContainer$"+Yi,zv="__reactEvents$"+Yi,Bj="__reactListeners$"+Yi,Vj="__reactHandles$"+Yi,XI="__reactResources$"+Yi,If="__reactMarker$"+Yi;function Pv(u){delete u[is],delete u[Ls],delete u[zv],delete u[Bj],delete u[Vj]}function ol(u){var h=u[is];if(h)return h;for(var m=u.parentNode;m;){if(h=m[Pu]||m[is]){if(m=h.alternate,h.child!==null||m!==null&&m.child!==null)for(u=e3(u);u!==null;){if(m=u[is])return m;u=e3(u)}return h}u=m,m=u.parentNode}return null}function Bu(u){if(u=u[is]||u[Pu]){var h=u.tag;if(h===5||h===6||h===13||h===26||h===27||h===3)return u}return null}function Af(u){var h=u.tag;if(h===5||h===26||h===27||h===6)return u.stateNode;throw Error(s(33))}function Vu(u){var h=u[XI];return h||(h=u[XI]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function zn(u){u[If]=!0}var KI=new Set,YI={};function ll(u,h){Uu(u,h),Uu(u+"Capture",h)}function Uu(u,h){for(YI[u]=h,u=0;u<h.length;u++)KI.add(h[u])}var Za=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Uj=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ZI={},QI={};function jj(u){return Zs.call(QI,u)?!0:Zs.call(ZI,u)?!1:Uj.test(u)?QI[u]=!0:(ZI[u]=!0,!1)}function _g(u,h,m){if(jj(h))if(m===null)u.removeAttribute(h);else{switch(typeof m){case"undefined":case"function":case"symbol":u.removeAttribute(h);return;case"boolean":var b=h.toLowerCase().slice(0,5);if(b!=="data-"&&b!=="aria-"){u.removeAttribute(h);return}}u.setAttribute(h,""+m)}}function Fg(u,h,m){if(m===null)u.removeAttribute(h);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(h);return}u.setAttribute(h,""+m)}}function Qa(u,h,m,b){if(b===null)u.removeAttribute(m);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(m);return}u.setAttributeNS(h,m,""+b)}}function Sr(u){switch(typeof u){case"bigint":case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function JI(u){var h=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function Wj(u){var h=JI(u)?"checked":"value",m=Object.getOwnPropertyDescriptor(u.constructor.prototype,h),b=""+u[h];if(!u.hasOwnProperty(h)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var S=m.get,k=m.set;return Object.defineProperty(u,h,{configurable:!0,get:function(){return S.call(this)},set:function(F){b=""+F,k.call(this,F)}}),Object.defineProperty(u,h,{enumerable:m.enumerable}),{getValue:function(){return b},setValue:function(F){b=""+F},stopTracking:function(){u._valueTracker=null,delete u[h]}}}}function Lg(u){u._valueTracker||(u._valueTracker=Wj(u))}function eA(u){if(!u)return!1;var h=u._valueTracker;if(!h)return!0;var m=h.getValue(),b="";return u&&(b=JI(u)?u.checked?"true":"false":u.value),u=b,u!==m?(h.setValue(u),!0):!1}function Mg(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}var Gj=/[\n"\\]/g;function Tr(u){return u.replace(Gj,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function Bv(u,h,m,b,S,k,F,P){u.name="",F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?u.type=F:u.removeAttribute("type"),h!=null?F==="number"?(h===0&&u.value===""||u.value!=h)&&(u.value=""+Sr(h)):u.value!==""+Sr(h)&&(u.value=""+Sr(h)):F!=="submit"&&F!=="reset"||u.removeAttribute("value"),h!=null?Vv(u,F,Sr(h)):m!=null?Vv(u,F,Sr(m)):b!=null&&u.removeAttribute("value"),S==null&&k!=null&&(u.defaultChecked=!!k),S!=null&&(u.checked=S&&typeof S!="function"&&typeof S!="symbol"),P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"?u.name=""+Sr(P):u.removeAttribute("name")}function tA(u,h,m,b,S,k,F,P){if(k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(u.type=k),h!=null||m!=null){if(!(k!=="submit"&&k!=="reset"||h!=null))return;m=m!=null?""+Sr(m):"",h=h!=null?""+Sr(h):m,P||h===u.value||(u.value=h),u.defaultValue=h}b=b??S,b=typeof b!="function"&&typeof b!="symbol"&&!!b,u.checked=P?u.checked:!!b,u.defaultChecked=!!b,F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"&&(u.name=F)}function Vv(u,h,m){h==="number"&&Mg(u.ownerDocument)===u||u.defaultValue===""+m||(u.defaultValue=""+m)}function ju(u,h,m,b){if(u=u.options,h){h={};for(var S=0;S<m.length;S++)h["$"+m[S]]=!0;for(m=0;m<u.length;m++)S=h.hasOwnProperty("$"+u[m].value),u[m].selected!==S&&(u[m].selected=S),S&&b&&(u[m].defaultSelected=!0)}else{for(m=""+Sr(m),h=null,S=0;S<u.length;S++){if(u[S].value===m){u[S].selected=!0,b&&(u[S].defaultSelected=!0);return}h!==null||u[S].disabled||(h=u[S])}h!==null&&(h.selected=!0)}}function nA(u,h,m){if(h!=null&&(h=""+Sr(h),h!==u.value&&(u.value=h),m==null)){u.defaultValue!==h&&(u.defaultValue=h);return}u.defaultValue=m!=null?""+Sr(m):""}function sA(u,h,m,b){if(h==null){if(b!=null){if(m!=null)throw Error(s(92));if(ue(b)){if(1<b.length)throw Error(s(93));b=b[0]}m=b}m==null&&(m=""),h=m}m=Sr(h),u.defaultValue=m,b=u.textContent,b===m&&b!==""&&b!==null&&(u.value=b)}function Wu(u,h){if(h){var m=u.firstChild;if(m&&m===u.lastChild&&m.nodeType===3){m.nodeValue=h;return}}u.textContent=h}var Hj=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rA(u,h,m){var b=h.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?b?u.setProperty(h,""):h==="float"?u.cssFloat="":u[h]="":b?u.setProperty(h,m):typeof m!="number"||m===0||Hj.has(h)?h==="float"?u.cssFloat=m:u[h]=(""+m).trim():u[h]=m+"px"}function aA(u,h,m){if(h!=null&&typeof h!="object")throw Error(s(62));if(u=u.style,m!=null){for(var b in m)!m.hasOwnProperty(b)||h!=null&&h.hasOwnProperty(b)||(b.indexOf("--")===0?u.setProperty(b,""):b==="float"?u.cssFloat="":u[b]="");for(var S in h)b=h[S],h.hasOwnProperty(S)&&m[S]!==b&&rA(u,S,b)}else for(var k in h)h.hasOwnProperty(k)&&rA(u,k,h[k])}function Uv(u){if(u.indexOf("-")===-1)return!1;switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qj=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Xj=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function zg(u){return Xj.test(""+u)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":u}var jv=null;function Wv(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Gu=null,Hu=null;function iA(u){var h=Bu(u);if(h&&(u=h.stateNode)){var m=u[Ls]||null;e:switch(u=h.stateNode,h.type){case"input":if(Bv(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),h=m.name,m.type==="radio"&&h!=null){for(m=u;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+Tr(""+h)+'"][type="radio"]'),h=0;h<m.length;h++){var b=m[h];if(b!==u&&b.form===u.form){var S=b[Ls]||null;if(!S)throw Error(s(90));Bv(b,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(h=0;h<m.length;h++)b=m[h],b.form===u.form&&eA(b)}break e;case"textarea":nA(u,m.value,m.defaultValue);break e;case"select":h=m.value,h!=null&&ju(u,!!m.multiple,h,!1)}}}var Gv=!1;function oA(u,h,m){if(Gv)return u(h,m);Gv=!0;try{var b=u(h);return b}finally{if(Gv=!1,(Gu!==null||Hu!==null)&&(w0(),Gu&&(h=Gu,u=Hu,Hu=Gu=null,iA(h),u)))for(h=0;h<u.length;h++)iA(u[h])}}function Rf(u,h){var m=u.stateNode;if(m===null)return null;var b=m[Ls]||null;if(b===null)return null;m=b[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(u=u.type,b=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!b;break e;default:u=!1}if(u)return null;if(m&&typeof m!="function")throw Error(s(231,h,typeof m));return m}var Hv=!1;if(Za)try{var Df={};Object.defineProperty(Df,"passive",{get:function(){Hv=!0}}),window.addEventListener("test",Df,Df),window.removeEventListener("test",Df,Df)}catch{Hv=!1}var Zi=null,qv=null,Pg=null;function lA(){if(Pg)return Pg;var u,h=qv,m=h.length,b,S="value"in Zi?Zi.value:Zi.textContent,k=S.length;for(u=0;u<m&&h[u]===S[u];u++);var F=m-u;for(b=1;b<=F&&h[m-b]===S[k-b];b++);return Pg=S.slice(u,1<b?1-b:void 0)}function Bg(u){var h=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&h===13&&(u=13)):u=h,u===10&&(u=13),32<=u||u===13?u:0}function Vg(){return!0}function uA(){return!1}function Ms(u){function h(m,b,S,k,F){this._reactName=m,this._targetInst=S,this.type=b,this.nativeEvent=k,this.target=F,this.currentTarget=null;for(var P in u)u.hasOwnProperty(P)&&(m=u[P],this[P]=m?m(k):k[P]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?Vg:uA,this.isPropagationStopped=uA,this}return _(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Vg)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Vg)},persist:function(){},isPersistent:Vg}),h}var ul={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ug=Ms(ul),Of=_({},ul,{view:0,detail:0}),Kj=Ms(Of),Xv,Kv,_f,jg=_({},Of,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zv,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==_f&&(_f&&u.type==="mousemove"?(Xv=u.screenX-_f.screenX,Kv=u.screenY-_f.screenY):Kv=Xv=0,_f=u),Xv)},movementY:function(u){return"movementY"in u?u.movementY:Kv}}),cA=Ms(jg),Yj=_({},jg,{dataTransfer:0}),Zj=Ms(Yj),Qj=_({},Of,{relatedTarget:0}),Yv=Ms(Qj),Jj=_({},ul,{animationName:0,elapsedTime:0,pseudoElement:0}),e7=Ms(Jj),t7=_({},ul,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),n7=Ms(t7),s7=_({},ul,{data:0}),hA=Ms(s7),r7={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},a7={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},i7={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function o7(u){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(u):(u=i7[u])?!!h[u]:!1}function Zv(){return o7}var l7=_({},Of,{key:function(u){if(u.key){var h=r7[u.key]||u.key;if(h!=="Unidentified")return h}return u.type==="keypress"?(u=Bg(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?a7[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zv,charCode:function(u){return u.type==="keypress"?Bg(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Bg(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),u7=Ms(l7),c7=_({},jg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fA=Ms(c7),h7=_({},Of,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zv}),f7=Ms(h7),d7=_({},ul,{propertyName:0,elapsedTime:0,pseudoElement:0}),p7=Ms(d7),m7=_({},jg,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),g7=Ms(m7),y7=_({},ul,{newState:0,oldState:0}),b7=Ms(y7),x7=[9,13,27,32],Qv=Za&&"CompositionEvent"in window,Ff=null;Za&&"documentMode"in document&&(Ff=document.documentMode);var v7=Za&&"TextEvent"in window&&!Ff,dA=Za&&(!Qv||Ff&&8<Ff&&11>=Ff),pA=" ",mA=!1;function gA(u,h){switch(u){case"keyup":return x7.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yA(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var qu=!1;function w7(u,h){switch(u){case"compositionend":return yA(h);case"keypress":return h.which!==32?null:(mA=!0,pA);case"textInput":return u=h.data,u===pA&&mA?null:u;default:return null}}function S7(u,h){if(qu)return u==="compositionend"||!Qv&&gA(u,h)?(u=lA(),Pg=qv=Zi=null,qu=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return dA&&h.locale!=="ko"?null:h.data;default:return null}}var T7={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bA(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h==="input"?!!T7[u.type]:h==="textarea"}function xA(u,h,m,b){Gu?Hu?Hu.push(b):Hu=[b]:Gu=b,h=k0(h,"onChange"),0<h.length&&(m=new Ug("onChange","change",null,m,b),u.push({event:m,listeners:h}))}var Lf=null,Mf=null;function C7(u){GD(u,0)}function Wg(u){var h=Af(u);if(eA(h))return u}function vA(u,h){if(u==="change")return h}var wA=!1;if(Za){var Jv;if(Za){var ew="oninput"in document;if(!ew){var SA=document.createElement("div");SA.setAttribute("oninput","return;"),ew=typeof SA.oninput=="function"}Jv=ew}else Jv=!1;wA=Jv&&(!document.documentMode||9<document.documentMode)}function TA(){Lf&&(Lf.detachEvent("onpropertychange",CA),Mf=Lf=null)}function CA(u){if(u.propertyName==="value"&&Wg(Mf)){var h=[];xA(h,Mf,u,Wv(u)),oA(C7,h)}}function N7(u,h,m){u==="focusin"?(TA(),Lf=h,Mf=m,Lf.attachEvent("onpropertychange",CA)):u==="focusout"&&TA()}function k7(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return Wg(Mf)}function E7(u,h){if(u==="click")return Wg(h)}function $7(u,h){if(u==="input"||u==="change")return Wg(h)}function I7(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var er=typeof Object.is=="function"?Object.is:I7;function zf(u,h){if(er(u,h))return!0;if(typeof u!="object"||u===null||typeof h!="object"||h===null)return!1;var m=Object.keys(u),b=Object.keys(h);if(m.length!==b.length)return!1;for(b=0;b<m.length;b++){var S=m[b];if(!Zs.call(h,S)||!er(u[S],h[S]))return!1}return!0}function NA(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function kA(u,h){var m=NA(u);u=0;for(var b;m;){if(m.nodeType===3){if(b=u+m.textContent.length,u<=h&&b>=h)return{node:m,offset:h-u};u=b}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=NA(m)}}function EA(u,h){return u&&h?u===h?!0:u&&u.nodeType===3?!1:h&&h.nodeType===3?EA(u,h.parentNode):"contains"in u?u.contains(h):u.compareDocumentPosition?!!(u.compareDocumentPosition(h)&16):!1:!1}function $A(u){u=u!=null&&u.ownerDocument!=null&&u.ownerDocument.defaultView!=null?u.ownerDocument.defaultView:window;for(var h=Mg(u.document);h instanceof u.HTMLIFrameElement;){try{var m=typeof h.contentWindow.location.href=="string"}catch{m=!1}if(m)u=h.contentWindow;else break;h=Mg(u.document)}return h}function tw(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h&&(h==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||h==="textarea"||u.contentEditable==="true")}function A7(u,h){var m=$A(h);h=u.focusedElem;var b=u.selectionRange;if(m!==h&&h&&h.ownerDocument&&EA(h.ownerDocument.documentElement,h)){if(b!==null&&tw(h)){if(u=b.start,m=b.end,m===void 0&&(m=u),"selectionStart"in h)h.selectionStart=u,h.selectionEnd=Math.min(m,h.value.length);else if(m=(u=h.ownerDocument||document)&&u.defaultView||window,m.getSelection){m=m.getSelection();var S=h.textContent.length,k=Math.min(b.start,S);b=b.end===void 0?k:Math.min(b.end,S),!m.extend&&k>b&&(S=b,b=k,k=S),S=kA(h,k);var F=kA(h,b);S&&F&&(m.rangeCount!==1||m.anchorNode!==S.node||m.anchorOffset!==S.offset||m.focusNode!==F.node||m.focusOffset!==F.offset)&&(u=u.createRange(),u.setStart(S.node,S.offset),m.removeAllRanges(),k>b?(m.addRange(u),m.extend(F.node,F.offset)):(u.setEnd(F.node,F.offset),m.addRange(u)))}}for(u=[],m=h;m=m.parentNode;)m.nodeType===1&&u.push({element:m,left:m.scrollLeft,top:m.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<u.length;h++)m=u[h],m.element.scrollLeft=m.left,m.element.scrollTop=m.top}}var R7=Za&&"documentMode"in document&&11>=document.documentMode,Xu=null,nw=null,Pf=null,sw=!1;function IA(u,h,m){var b=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;sw||Xu==null||Xu!==Mg(b)||(b=Xu,"selectionStart"in b&&tw(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),Pf&&zf(Pf,b)||(Pf=b,b=k0(nw,"onSelect"),0<b.length&&(h=new Ug("onSelect","select",null,h,m),u.push({event:h,listeners:b}),h.target=Xu)))}function cl(u,h){var m={};return m[u.toLowerCase()]=h.toLowerCase(),m["Webkit"+u]="webkit"+h,m["Moz"+u]="moz"+h,m}var Ku={animationend:cl("Animation","AnimationEnd"),animationiteration:cl("Animation","AnimationIteration"),animationstart:cl("Animation","AnimationStart"),transitionrun:cl("Transition","TransitionRun"),transitionstart:cl("Transition","TransitionStart"),transitioncancel:cl("Transition","TransitionCancel"),transitionend:cl("Transition","TransitionEnd")},rw={},AA={};Za&&(AA=document.createElement("div").style,"AnimationEvent"in window||(delete Ku.animationend.animation,delete Ku.animationiteration.animation,delete Ku.animationstart.animation),"TransitionEvent"in window||delete Ku.transitionend.transition);function hl(u){if(rw[u])return rw[u];if(!Ku[u])return u;var h=Ku[u],m;for(m in h)if(h.hasOwnProperty(m)&&m in AA)return rw[u]=h[m];return u}var RA=hl("animationend"),DA=hl("animationiteration"),OA=hl("animationstart"),D7=hl("transitionrun"),O7=hl("transitionstart"),_7=hl("transitioncancel"),_A=hl("transitionend"),FA=new Map,LA="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Xr(u,h){FA.set(u,h),ll(h,[u])}var Cr=[],Yu=0,aw=0;function Gg(){for(var u=Yu,h=aw=Yu=0;h<u;){var m=Cr[h];Cr[h++]=null;var b=Cr[h];Cr[h++]=null;var S=Cr[h];Cr[h++]=null;var k=Cr[h];if(Cr[h++]=null,b!==null&&S!==null){var F=b.pending;F===null?S.next=S:(S.next=F.next,F.next=S),b.pending=S}k!==0&&MA(m,S,k)}}function Hg(u,h,m,b){Cr[Yu++]=u,Cr[Yu++]=h,Cr[Yu++]=m,Cr[Yu++]=b,aw|=b,u.lanes|=b,u=u.alternate,u!==null&&(u.lanes|=b)}function iw(u,h,m,b){return Hg(u,h,m,b),qg(u)}function Qi(u,h){return Hg(u,null,null,h),qg(u)}function MA(u,h,m){u.lanes|=m;var b=u.alternate;b!==null&&(b.lanes|=m);for(var S=!1,k=u.return;k!==null;)k.childLanes|=m,b=k.alternate,b!==null&&(b.childLanes|=m),k.tag===22&&(u=k.stateNode,u===null||u._visibility&1||(S=!0)),u=k,k=k.return;S&&h!==null&&u.tag===3&&(k=u.stateNode,S=31-Js(m),k=k.hiddenUpdates,u=k[S],u===null?k[S]=[h]:u.push(h),h.lane=m|536870912)}function qg(u){if(50<cd)throw cd=0,f2=null,Error(s(185));for(var h=u.return;h!==null;)u=h,h=u.return;return u.tag===3?u.stateNode:null}var Zu={},zA=new WeakMap;function Nr(u,h){if(typeof u=="object"&&u!==null){var m=zA.get(u);return m!==void 0?m:(h={value:u,source:h,stack:Y(h)},zA.set(u,h),h)}return{value:u,source:h,stack:Y(h)}}var Qu=[],Ju=0,Xg=null,Kg=0,kr=[],Er=0,fl=null,Ja=1,ei="";function dl(u,h){Qu[Ju++]=Kg,Qu[Ju++]=Xg,Xg=u,Kg=h}function PA(u,h,m){kr[Er++]=Ja,kr[Er++]=ei,kr[Er++]=fl,fl=u;var b=Ja;u=ei;var S=32-Js(b)-1;b&=~(1<<S),m+=1;var k=32-Js(h)+S;if(30<k){var F=S-S%5;k=(b&(1<<F)-1).toString(32),b>>=F,S-=F,Ja=1<<32-Js(h)+S|m<<S|b,ei=k+u}else Ja=1<<k|m<<S|b,ei=u}function ow(u){u.return!==null&&(dl(u,1),PA(u,1,0))}function lw(u){for(;u===Xg;)Xg=Qu[--Ju],Qu[Ju]=null,Kg=Qu[--Ju],Qu[Ju]=null;for(;u===fl;)fl=kr[--Er],kr[Er]=null,ei=kr[--Er],kr[Er]=null,Ja=kr[--Er],kr[Er]=null}var Cs=null,Jn=null,wt=!1,Kr=null,va=!1,uw=Error(s(519));function pl(u){var h=Error(s(418,""));throw Uf(Nr(h,u)),uw}function BA(u){var h=u.stateNode,m=u.type,b=u.memoizedProps;switch(h[is]=u,h[Ls]=b,m){case"dialog":mt("cancel",h),mt("close",h);break;case"iframe":case"object":case"embed":mt("load",h);break;case"video":case"audio":for(m=0;m<fd.length;m++)mt(fd[m],h);break;case"source":mt("error",h);break;case"img":case"image":case"link":mt("error",h),mt("load",h);break;case"details":mt("toggle",h);break;case"input":mt("invalid",h),tA(h,b.value,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name,!0),Lg(h);break;case"select":mt("invalid",h);break;case"textarea":mt("invalid",h),sA(h,b.value,b.defaultValue,b.children),Lg(h)}m=b.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||h.textContent===""+m||b.suppressHydrationWarning===!0||KD(h.textContent,m)?(b.popover!=null&&(mt("beforetoggle",h),mt("toggle",h)),b.onScroll!=null&&mt("scroll",h),b.onScrollEnd!=null&&mt("scrollend",h),b.onClick!=null&&(h.onclick=E0),h=!0):h=!1,h||pl(u)}function VA(u){for(Cs=u.return;Cs;)switch(Cs.tag){case 3:case 27:va=!0;return;case 5:case 13:va=!1;return;default:Cs=Cs.return}}function Bf(u){if(u!==Cs)return!1;if(!wt)return VA(u),wt=!0,!1;var h=!1,m;if((m=u.tag!==3&&u.tag!==27)&&((m=u.tag===5)&&(m=u.type,m=!(m!=="form"&&m!=="button")||I2(u.type,u.memoizedProps)),m=!m),m&&(h=!0),h&&Jn&&pl(u),VA(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(s(317));e:{for(u=u.nextSibling,h=0;u;){if(u.nodeType===8)if(m=u.data,m==="/$"){if(h===0){Jn=Zr(u.nextSibling);break e}h--}else m!=="$"&&m!=="$!"&&m!=="$?"||h++;u=u.nextSibling}Jn=null}}else Jn=Cs?Zr(u.stateNode.nextSibling):null;return!0}function Vf(){Jn=Cs=null,wt=!1}function Uf(u){Kr===null?Kr=[u]:Kr.push(u)}var jf=Error(s(460)),UA=Error(s(474)),cw={then:function(){}};function jA(u){return u=u.status,u==="fulfilled"||u==="rejected"}function Yg(){}function WA(u,h,m){switch(m=u[m],m===void 0?u.push(h):m!==h&&(h.then(Yg,Yg),h=m),h.status){case"fulfilled":return h.value;case"rejected":throw u=h.reason,u===jf?Error(s(483)):u;default:if(typeof h.status=="string")h.then(Yg,Yg);else{if(u=Mt,u!==null&&100<u.shellSuspendCounter)throw Error(s(482));u=h,u.status="pending",u.then(function(b){if(h.status==="pending"){var S=h;S.status="fulfilled",S.value=b}},function(b){if(h.status==="pending"){var S=h;S.status="rejected",S.reason=b}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw u=h.reason,u===jf?Error(s(483)):u}throw Wf=h,jf}}var Wf=null;function GA(){if(Wf===null)throw Error(s(459));var u=Wf;return Wf=null,u}var ec=null,Gf=0;function Zg(u){var h=Gf;return Gf+=1,ec===null&&(ec=[]),WA(ec,u,h)}function Hf(u,h){h=h.props.ref,u.ref=h!==void 0?h:null}function Qg(u,h){throw h.$$typeof===a?Error(s(525)):(u=Object.prototype.toString.call(h),Error(s(31,u==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":u)))}function HA(u){var h=u._init;return h(u._payload)}function qA(u){function h(oe,ne){if(u){var le=oe.deletions;le===null?(oe.deletions=[ne],oe.flags|=16):le.push(ne)}}function m(oe,ne){if(!u)return null;for(;ne!==null;)h(oe,ne),ne=ne.sibling;return null}function b(oe){for(var ne=new Map;oe!==null;)oe.key!==null?ne.set(oe.key,oe):ne.set(oe.index,oe),oe=oe.sibling;return ne}function S(oe,ne){return oe=co(oe,ne),oe.index=0,oe.sibling=null,oe}function k(oe,ne,le){return oe.index=le,u?(le=oe.alternate,le!==null?(le=le.index,le<ne?(oe.flags|=33554434,ne):le):(oe.flags|=33554434,ne)):(oe.flags|=1048576,ne)}function F(oe){return u&&oe.alternate===null&&(oe.flags|=33554434),oe}function P(oe,ne,le,xe){return ne===null||ne.tag!==6?(ne=r2(le,oe.mode,xe),ne.return=oe,ne):(ne=S(ne,le),ne.return=oe,ne)}function G(oe,ne,le,xe){var Fe=le.type;return Fe===l?ye(oe,ne,le.props.children,xe,le.key):ne!==null&&(ne.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===T&&HA(Fe)===ne.type)?(ne=S(ne,le.props),Hf(ne,le),ne.return=oe,ne):(ne=g0(le.type,le.key,le.props,null,oe.mode,xe),Hf(ne,le),ne.return=oe,ne)}function se(oe,ne,le,xe){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==le.containerInfo||ne.stateNode.implementation!==le.implementation?(ne=a2(le,oe.mode,xe),ne.return=oe,ne):(ne=S(ne,le.children||[]),ne.return=oe,ne)}function ye(oe,ne,le,xe,Fe){return ne===null||ne.tag!==7?(ne=Cl(le,oe.mode,xe,Fe),ne.return=oe,ne):(ne=S(ne,le),ne.return=oe,ne)}function Te(oe,ne,le){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return ne=r2(""+ne,oe.mode,le),ne.return=oe,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case i:return le=g0(ne.type,ne.key,ne.props,null,oe.mode,le),Hf(le,ne),le.return=oe,le;case o:return ne=a2(ne,oe.mode,le),ne.return=oe,ne;case T:var xe=ne._init;return ne=xe(ne._payload),Te(oe,ne,le)}if(ue(ne)||R(ne))return ne=Cl(ne,oe.mode,le,null),ne.return=oe,ne;if(typeof ne.then=="function")return Te(oe,Zg(ne),le);if(ne.$$typeof===g)return Te(oe,d0(oe,ne),le);Qg(oe,ne)}return null}function fe(oe,ne,le,xe){var Fe=ne!==null?ne.key:null;if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return Fe!==null?null:P(oe,ne,""+le,xe);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case i:return le.key===Fe?G(oe,ne,le,xe):null;case o:return le.key===Fe?se(oe,ne,le,xe):null;case T:return Fe=le._init,le=Fe(le._payload),fe(oe,ne,le,xe)}if(ue(le)||R(le))return Fe!==null?null:ye(oe,ne,le,xe,null);if(typeof le.then=="function")return fe(oe,ne,Zg(le),xe);if(le.$$typeof===g)return fe(oe,ne,d0(oe,le),xe);Qg(oe,le)}return null}function ge(oe,ne,le,xe,Fe){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return oe=oe.get(le)||null,P(ne,oe,""+xe,Fe);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case i:return oe=oe.get(xe.key===null?le:xe.key)||null,G(ne,oe,xe,Fe);case o:return oe=oe.get(xe.key===null?le:xe.key)||null,se(ne,oe,xe,Fe);case T:var it=xe._init;return xe=it(xe._payload),ge(oe,ne,le,xe,Fe)}if(ue(xe)||R(xe))return oe=oe.get(le)||null,ye(ne,oe,xe,Fe,null);if(typeof xe.then=="function")return ge(oe,ne,le,Zg(xe),Fe);if(xe.$$typeof===g)return ge(oe,ne,le,d0(ne,xe),Fe);Qg(ne,xe)}return null}function ze(oe,ne,le,xe){for(var Fe=null,it=null,Ue=ne,Ge=ne=0,Vn=null;Ue!==null&&Ge<le.length;Ge++){Ue.index>Ge?(Vn=Ue,Ue=null):Vn=Ue.sibling;var St=fe(oe,Ue,le[Ge],xe);if(St===null){Ue===null&&(Ue=Vn);break}u&&Ue&&St.alternate===null&&h(oe,Ue),ne=k(St,ne,Ge),it===null?Fe=St:it.sibling=St,it=St,Ue=Vn}if(Ge===le.length)return m(oe,Ue),wt&&dl(oe,Ge),Fe;if(Ue===null){for(;Ge<le.length;Ge++)Ue=Te(oe,le[Ge],xe),Ue!==null&&(ne=k(Ue,ne,Ge),it===null?Fe=Ue:it.sibling=Ue,it=Ue);return wt&&dl(oe,Ge),Fe}for(Ue=b(Ue);Ge<le.length;Ge++)Vn=ge(Ue,oe,Ge,le[Ge],xe),Vn!==null&&(u&&Vn.alternate!==null&&Ue.delete(Vn.key===null?Ge:Vn.key),ne=k(Vn,ne,Ge),it===null?Fe=Vn:it.sibling=Vn,it=Vn);return u&&Ue.forEach(function(bo){return h(oe,bo)}),wt&&dl(oe,Ge),Fe}function Ye(oe,ne,le,xe){if(le==null)throw Error(s(151));for(var Fe=null,it=null,Ue=ne,Ge=ne=0,Vn=null,St=le.next();Ue!==null&&!St.done;Ge++,St=le.next()){Ue.index>Ge?(Vn=Ue,Ue=null):Vn=Ue.sibling;var bo=fe(oe,Ue,St.value,xe);if(bo===null){Ue===null&&(Ue=Vn);break}u&&Ue&&bo.alternate===null&&h(oe,Ue),ne=k(bo,ne,Ge),it===null?Fe=bo:it.sibling=bo,it=bo,Ue=Vn}if(St.done)return m(oe,Ue),wt&&dl(oe,Ge),Fe;if(Ue===null){for(;!St.done;Ge++,St=le.next())St=Te(oe,St.value,xe),St!==null&&(ne=k(St,ne,Ge),it===null?Fe=St:it.sibling=St,it=St);return wt&&dl(oe,Ge),Fe}for(Ue=b(Ue);!St.done;Ge++,St=le.next())St=ge(Ue,oe,Ge,St.value,xe),St!==null&&(u&&St.alternate!==null&&Ue.delete(St.key===null?Ge:St.key),ne=k(St,ne,Ge),it===null?Fe=St:it.sibling=St,it=St);return u&&Ue.forEach(function(XW){return h(oe,XW)}),wt&&dl(oe,Ge),Fe}function sn(oe,ne,le,xe){if(typeof le=="object"&&le!==null&&le.type===l&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case i:e:{for(var Fe=le.key;ne!==null;){if(ne.key===Fe){if(Fe=le.type,Fe===l){if(ne.tag===7){m(oe,ne.sibling),xe=S(ne,le.props.children),xe.return=oe,oe=xe;break e}}else if(ne.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===T&&HA(Fe)===ne.type){m(oe,ne.sibling),xe=S(ne,le.props),Hf(xe,le),xe.return=oe,oe=xe;break e}m(oe,ne);break}else h(oe,ne);ne=ne.sibling}le.type===l?(xe=Cl(le.props.children,oe.mode,xe,le.key),xe.return=oe,oe=xe):(xe=g0(le.type,le.key,le.props,null,oe.mode,xe),Hf(xe,le),xe.return=oe,oe=xe)}return F(oe);case o:e:{for(Fe=le.key;ne!==null;){if(ne.key===Fe)if(ne.tag===4&&ne.stateNode.containerInfo===le.containerInfo&&ne.stateNode.implementation===le.implementation){m(oe,ne.sibling),xe=S(ne,le.children||[]),xe.return=oe,oe=xe;break e}else{m(oe,ne);break}else h(oe,ne);ne=ne.sibling}xe=a2(le,oe.mode,xe),xe.return=oe,oe=xe}return F(oe);case T:return Fe=le._init,le=Fe(le._payload),sn(oe,ne,le,xe)}if(ue(le))return ze(oe,ne,le,xe);if(R(le)){if(Fe=R(le),typeof Fe!="function")throw Error(s(150));return le=Fe.call(le),Ye(oe,ne,le,xe)}if(typeof le.then=="function")return sn(oe,ne,Zg(le),xe);if(le.$$typeof===g)return sn(oe,ne,d0(oe,le),xe);Qg(oe,le)}return typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint"?(le=""+le,ne!==null&&ne.tag===6?(m(oe,ne.sibling),xe=S(ne,le),xe.return=oe,oe=xe):(m(oe,ne),xe=r2(le,oe.mode,xe),xe.return=oe,oe=xe),F(oe)):m(oe,ne)}return function(oe,ne,le,xe){try{Gf=0;var Fe=sn(oe,ne,le,xe);return ec=null,Fe}catch(Ue){if(Ue===jf)throw Ue;var it=Rr(29,Ue,null,oe.mode);return it.lanes=xe,it.return=oe,it}finally{}}}var ml=qA(!0),XA=qA(!1),tc=ke(null),Jg=ke(0);function KA(u,h){u=hi,De(Jg,u),De(tc,h),hi=u|h.baseLanes}function hw(){De(Jg,hi),De(tc,tc.current)}function fw(){hi=Jg.current,Ae(tc),Ae(Jg)}var $r=ke(null),wa=null;function Ji(u){var h=u.alternate;De($n,$n.current&1),De($r,u),wa===null&&(h===null||tc.current!==null||h.memoizedState!==null)&&(wa=u)}function YA(u){if(u.tag===22){if(De($n,$n.current),De($r,u),wa===null){var h=u.alternate;h!==null&&h.memoizedState!==null&&(wa=u)}}else eo()}function eo(){De($n,$n.current),De($r,$r.current)}function ti(u){Ae($r),wa===u&&(wa=null),Ae($n)}var $n=ke(0);function e0(u){for(var h=u;h!==null;){if(h.tag===13){var m=h.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var F7=typeof AbortController<"u"?AbortController:function(){var u=[],h=this.signal={aborted:!1,addEventListener:function(m,b){u.push(b)}};this.abort=function(){h.aborted=!0,u.forEach(function(m){return m()})}},L7=t.unstable_scheduleCallback,M7=t.unstable_NormalPriority,In={$$typeof:g,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function dw(){return{controller:new F7,data:new Map,refCount:0}}function qf(u){u.refCount--,u.refCount===0&&L7(M7,function(){u.controller.abort()})}var Xf=null,pw=0,nc=0,sc=null;function z7(u,h){if(Xf===null){var m=Xf=[];pw=0,nc=v2(),sc={status:"pending",value:void 0,then:function(b){m.push(b)}}}return pw++,h.then(ZA,ZA),h}function ZA(){if(--pw===0&&Xf!==null){sc!==null&&(sc.status="fulfilled");var u=Xf;Xf=null,nc=0,sc=null;for(var h=0;h<u.length;h++)(0,u[h])()}}function P7(u,h){var m=[],b={status:"pending",value:null,reason:null,then:function(S){m.push(S)}};return u.then(function(){b.status="fulfilled",b.value=h;for(var S=0;S<m.length;S++)(0,m[S])(h)},function(S){for(b.status="rejected",b.reason=S,S=0;S<m.length;S++)(0,m[S])(void 0)}),b}var QA=A.S;A.S=function(u,h){typeof h=="object"&&h!==null&&typeof h.then=="function"&&z7(u,h),QA!==null&&QA(u,h)};var gl=ke(null);function mw(){var u=gl.current;return u!==null?u:Mt.pooledCache}function t0(u,h){h===null?De(gl,gl.current):De(gl,h.pool)}function JA(){var u=mw();return u===null?null:{parent:In._currentValue,pool:u}}var to=0,rt=null,At=null,xn=null,n0=!1,rc=!1,yl=!1,s0=0,Kf=0,ac=null,B7=0;function fn(){throw Error(s(321))}function gw(u,h){if(h===null)return!1;for(var m=0;m<h.length&&m<u.length;m++)if(!er(u[m],h[m]))return!1;return!0}function yw(u,h,m,b,S,k){return to=k,rt=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,A.H=u===null||u.memoizedState===null?bl:no,yl=!1,k=m(b,S),yl=!1,rc&&(k=tR(h,m,b,S)),eR(u),k}function eR(u){A.H=Sa;var h=At!==null&&At.next!==null;if(to=0,xn=At=rt=null,n0=!1,Kf=0,ac=null,h)throw Error(s(300));u===null||Pn||(u=u.dependencies,u!==null&&f0(u)&&(Pn=!0))}function tR(u,h,m,b){rt=u;var S=0;do{if(rc&&(ac=null),Kf=0,rc=!1,25<=S)throw Error(s(301));if(S+=1,xn=At=null,u.updateQueue!=null){var k=u.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}A.H=xl,k=h(m,b)}while(rc);return k}function V7(){var u=A.H,h=u.useState()[0];return h=typeof h.then=="function"?Yf(h):h,u=u.useState()[0],(At!==null?At.memoizedState:null)!==u&&(rt.flags|=1024),h}function bw(){var u=s0!==0;return s0=0,u}function xw(u,h,m){h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~m}function vw(u){if(n0){for(u=u.memoizedState;u!==null;){var h=u.queue;h!==null&&(h.pending=null),u=u.next}n0=!1}to=0,xn=At=rt=null,rc=!1,Kf=s0=0,ac=null}function zs(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xn===null?rt.memoizedState=xn=u:xn=xn.next=u,xn}function vn(){if(At===null){var u=rt.alternate;u=u!==null?u.memoizedState:null}else u=At.next;var h=xn===null?rt.memoizedState:xn.next;if(h!==null)xn=h,At=u;else{if(u===null)throw rt.alternate===null?Error(s(467)):Error(s(310));At=u,u={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},xn===null?rt.memoizedState=xn=u:xn=xn.next=u}return xn}var r0;r0=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Yf(u){var h=Kf;return Kf+=1,ac===null&&(ac=[]),u=WA(ac,u,h),h=rt,(xn===null?h.memoizedState:xn.next)===null&&(h=h.alternate,A.H=h===null||h.memoizedState===null?bl:no),u}function a0(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return Yf(u);if(u.$$typeof===g)return os(u)}throw Error(s(438,String(u)))}function ww(u){var h=null,m=rt.updateQueue;if(m!==null&&(h=m.memoCache),h==null){var b=rt.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(h={data:b.data.map(function(S){return S.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),m===null&&(m=r0(),rt.updateQueue=m),m.memoCache=h,m=h.data[h.index],m===void 0)for(m=h.data[h.index]=Array(u),b=0;b<u;b++)m[b]=C;return h.index++,m}function ni(u,h){return typeof h=="function"?h(u):h}function i0(u){var h=vn();return Sw(h,At,u)}function Sw(u,h,m){var b=u.queue;if(b===null)throw Error(s(311));b.lastRenderedReducer=m;var S=u.baseQueue,k=b.pending;if(k!==null){if(S!==null){var F=S.next;S.next=k.next,k.next=F}h.baseQueue=S=k,b.pending=null}if(k=u.baseState,S===null)u.memoizedState=k;else{h=S.next;var P=F=null,G=null,se=h,ye=!1;do{var Te=se.lane&-536870913;if(Te!==se.lane?(bt&Te)===Te:(to&Te)===Te){var fe=se.revertLane;if(fe===0)G!==null&&(G=G.next={lane:0,revertLane:0,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),Te===nc&&(ye=!0);else if((to&fe)===fe){se=se.next,fe===nc&&(ye=!0);continue}else Te={lane:0,revertLane:se.revertLane,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},G===null?(P=G=Te,F=k):G=G.next=Te,rt.lanes|=fe,ho|=fe;Te=se.action,yl&&m(k,Te),k=se.hasEagerState?se.eagerState:m(k,Te)}else fe={lane:Te,revertLane:se.revertLane,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},G===null?(P=G=fe,F=k):G=G.next=fe,rt.lanes|=Te,ho|=Te;se=se.next}while(se!==null&&se!==h);if(G===null?F=k:G.next=P,!er(k,u.memoizedState)&&(Pn=!0,ye&&(m=sc,m!==null)))throw m;u.memoizedState=k,u.baseState=F,u.baseQueue=G,b.lastRenderedState=k}return S===null&&(b.lanes=0),[u.memoizedState,b.dispatch]}function Tw(u){var h=vn(),m=h.queue;if(m===null)throw Error(s(311));m.lastRenderedReducer=u;var b=m.dispatch,S=m.pending,k=h.memoizedState;if(S!==null){m.pending=null;var F=S=S.next;do k=u(k,F.action),F=F.next;while(F!==S);er(k,h.memoizedState)||(Pn=!0),h.memoizedState=k,h.baseQueue===null&&(h.baseState=k),m.lastRenderedState=k}return[k,b]}function nR(u,h,m){var b=rt,S=vn(),k=wt;if(k){if(m===void 0)throw Error(s(407));m=m()}else m=h();var F=!er((At||S).memoizedState,m);if(F&&(S.memoizedState=m,Pn=!0),S=S.queue,kw(aR.bind(null,b,S,u),[u]),S.getSnapshot!==h||F||xn!==null&&xn.memoizedState.tag&1){if(b.flags|=2048,ic(9,rR.bind(null,b,S,m,h),{destroy:void 0},null),Mt===null)throw Error(s(349));k||(to&60)!==0||sR(b,h,m)}return m}function sR(u,h,m){u.flags|=16384,u={getSnapshot:h,value:m},h=rt.updateQueue,h===null?(h=r0(),rt.updateQueue=h,h.stores=[u]):(m=h.stores,m===null?h.stores=[u]:m.push(u))}function rR(u,h,m,b){h.value=m,h.getSnapshot=b,iR(h)&&oR(u)}function aR(u,h,m){return m(function(){iR(h)&&oR(u)})}function iR(u){var h=u.getSnapshot;u=u.value;try{var m=h();return!er(u,m)}catch{return!0}}function oR(u){var h=Qi(u,2);h!==null&&Ns(h,u,2)}function Cw(u){var h=zs();if(typeof u=="function"){var m=u;if(u=m(),yl){Ki(!0);try{m()}finally{Ki(!1)}}}return h.memoizedState=h.baseState=u,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ni,lastRenderedState:u},h}function lR(u,h,m,b){return u.baseState=m,Sw(u,At,typeof b=="function"?b:ni)}function U7(u,h,m,b,S){if(u0(u))throw Error(s(485));if(u=h.action,u!==null){var k={payload:S,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(F){k.listeners.push(F)}};A.T!==null?m(!0):k.isTransition=!1,b(k),m=h.pending,m===null?(k.next=h.pending=k,uR(h,k)):(k.next=m.next,h.pending=m.next=k)}}function uR(u,h){var m=h.action,b=h.payload,S=u.state;if(h.isTransition){var k=A.T,F={};A.T=F;try{var P=m(S,b),G=A.S;G!==null&&G(F,P),cR(u,h,P)}catch(se){Nw(u,h,se)}finally{A.T=k}}else try{k=m(S,b),cR(u,h,k)}catch(se){Nw(u,h,se)}}function cR(u,h,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(b){hR(u,h,b)},function(b){return Nw(u,h,b)}):hR(u,h,m)}function hR(u,h,m){h.status="fulfilled",h.value=m,fR(h),u.state=m,h=u.pending,h!==null&&(m=h.next,m===h?u.pending=null:(m=m.next,h.next=m,uR(u,m)))}function Nw(u,h,m){var b=u.pending;if(u.pending=null,b!==null){b=b.next;do h.status="rejected",h.reason=m,fR(h),h=h.next;while(h!==b)}u.action=null}function fR(u){u=u.listeners;for(var h=0;h<u.length;h++)(0,u[h])()}function dR(u,h){return h}function pR(u,h){if(wt){var m=Mt.formState;if(m!==null){e:{var b=rt;if(wt){if(Jn){t:{for(var S=Jn,k=va;S.nodeType!==8;){if(!k){S=null;break t}if(S=Zr(S.nextSibling),S===null){S=null;break t}}k=S.data,S=k==="F!"||k==="F"?S:null}if(S){Jn=Zr(S.nextSibling),b=S.data==="F!";break e}}pl(b)}b=!1}b&&(h=m[0])}}return m=zs(),m.memoizedState=m.baseState=h,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dR,lastRenderedState:h},m.queue=b,m=DR.bind(null,rt,b),b.dispatch=m,b=Cw(!1),k=Rw.bind(null,rt,!1,b.queue),b=zs(),S={state:h,dispatch:null,action:u,pending:null},b.queue=S,m=U7.bind(null,rt,S,k,m),S.dispatch=m,b.memoizedState=u,[h,m,!1]}function mR(u){var h=vn();return gR(h,At,u)}function gR(u,h,m){h=Sw(u,h,dR)[0],u=i0(ni)[0],h=typeof h=="object"&&h!==null&&typeof h.then=="function"?Yf(h):h;var b=vn(),S=b.queue,k=S.dispatch;return m!==b.memoizedState&&(rt.flags|=2048,ic(9,j7.bind(null,S,m),{destroy:void 0},null)),[h,k,u]}function j7(u,h){u.action=h}function yR(u){var h=vn(),m=At;if(m!==null)return gR(h,m,u);vn(),h=h.memoizedState,m=vn();var b=m.queue.dispatch;return m.memoizedState=u,[h,b,!1]}function ic(u,h,m,b){return u={tag:u,create:h,inst:m,deps:b,next:null},h=rt.updateQueue,h===null&&(h=r0(),rt.updateQueue=h),m=h.lastEffect,m===null?h.lastEffect=u.next=u:(b=m.next,m.next=u,u.next=b,h.lastEffect=u),u}function bR(){return vn().memoizedState}function o0(u,h,m,b){var S=zs();rt.flags|=u,S.memoizedState=ic(1|h,m,{destroy:void 0},b===void 0?null:b)}function l0(u,h,m,b){var S=vn();b=b===void 0?null:b;var k=S.memoizedState.inst;At!==null&&b!==null&&gw(b,At.memoizedState.deps)?S.memoizedState=ic(h,m,k,b):(rt.flags|=u,S.memoizedState=ic(1|h,m,k,b))}function xR(u,h){o0(8390656,8,u,h)}function kw(u,h){l0(2048,8,u,h)}function vR(u,h){return l0(4,2,u,h)}function wR(u,h){return l0(4,4,u,h)}function SR(u,h){if(typeof h=="function"){u=u();var m=h(u);return function(){typeof m=="function"?m():h(null)}}if(h!=null)return u=u(),h.current=u,function(){h.current=null}}function TR(u,h,m){m=m!=null?m.concat([u]):null,l0(4,4,SR.bind(null,h,u),m)}function Ew(){}function CR(u,h){var m=vn();h=h===void 0?null:h;var b=m.memoizedState;return h!==null&&gw(h,b[1])?b[0]:(m.memoizedState=[u,h],u)}function NR(u,h){var m=vn();h=h===void 0?null:h;var b=m.memoizedState;if(h!==null&&gw(h,b[1]))return b[0];if(b=u(),yl){Ki(!0);try{u()}finally{Ki(!1)}}return m.memoizedState=[b,h],b}function $w(u,h,m){return m===void 0||(to&1073741824)!==0?u.memoizedState=h:(u.memoizedState=m,u=ED(),rt.lanes|=u,ho|=u,m)}function kR(u,h,m,b){return er(m,h)?m:tc.current!==null?(u=$w(u,m,b),er(u,h)||(Pn=!0),u):(to&42)===0?(Pn=!0,u.memoizedState=m):(u=ED(),rt.lanes|=u,ho|=u,h)}function ER(u,h,m,b,S){var k=he.p;he.p=k!==0&&8>k?k:8;var F=A.T,P={};A.T=P,Rw(u,!1,h,m);try{var G=S(),se=A.S;if(se!==null&&se(P,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var ye=P7(G,b);Zf(u,h,ye,rr(u))}else Zf(u,h,b,rr(u))}catch(Te){Zf(u,h,{then:function(){},status:"rejected",reason:Te},rr())}finally{he.p=k,A.T=F}}function W7(){}function Iw(u,h,m,b){if(u.tag!==5)throw Error(s(476));var S=$R(u).queue;ER(u,S,h,be,m===null?W7:function(){return IR(u),m(b)})}function $R(u){var h=u.memoizedState;if(h!==null)return h;h={memoizedState:be,baseState:be,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ni,lastRenderedState:be},next:null};var m={};return h.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ni,lastRenderedState:m},next:null},u.memoizedState=h,u=u.alternate,u!==null&&(u.memoizedState=h),h}function IR(u){var h=$R(u).next.queue;Zf(u,h,{},rr())}function Aw(){return os(yd)}function AR(){return vn().memoizedState}function RR(){return vn().memoizedState}function G7(u){for(var h=u.return;h!==null;){switch(h.tag){case 24:case 3:var m=rr();u=ao(m);var b=io(h,u,m);b!==null&&(Ns(b,h,m),ed(b,h,m)),h={cache:dw()},u.payload=h;return}h=h.return}}function H7(u,h,m){var b=rr();m={lane:b,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null},u0(u)?OR(h,m):(m=iw(u,h,m,b),m!==null&&(Ns(m,u,b),_R(m,h,b)))}function DR(u,h,m){var b=rr();Zf(u,h,m,b)}function Zf(u,h,m,b){var S={lane:b,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null};if(u0(u))OR(h,S);else{var k=u.alternate;if(u.lanes===0&&(k===null||k.lanes===0)&&(k=h.lastRenderedReducer,k!==null))try{var F=h.lastRenderedState,P=k(F,m);if(S.hasEagerState=!0,S.eagerState=P,er(P,F))return Hg(u,h,S,0),Mt===null&&Gg(),!1}catch{}finally{}if(m=iw(u,h,S,b),m!==null)return Ns(m,u,b),_R(m,h,b),!0}return!1}function Rw(u,h,m,b){if(b={lane:2,revertLane:v2(),action:b,hasEagerState:!1,eagerState:null,next:null},u0(u)){if(h)throw Error(s(479))}else h=iw(u,m,b,2),h!==null&&Ns(h,u,2)}function u0(u){var h=u.alternate;return u===rt||h!==null&&h===rt}function OR(u,h){rc=n0=!0;var m=u.pending;m===null?h.next=h:(h.next=m.next,m.next=h),u.pending=h}function _R(u,h,m){if((m&4194176)!==0){var b=h.lanes;b&=u.pendingLanes,m|=b,h.lanes=m,GI(u,m)}}var Sa={readContext:os,use:a0,useCallback:fn,useContext:fn,useEffect:fn,useImperativeHandle:fn,useLayoutEffect:fn,useInsertionEffect:fn,useMemo:fn,useReducer:fn,useRef:fn,useState:fn,useDebugValue:fn,useDeferredValue:fn,useTransition:fn,useSyncExternalStore:fn,useId:fn};Sa.useCacheRefresh=fn,Sa.useMemoCache=fn,Sa.useHostTransitionStatus=fn,Sa.useFormState=fn,Sa.useActionState=fn,Sa.useOptimistic=fn;var bl={readContext:os,use:a0,useCallback:function(u,h){return zs().memoizedState=[u,h===void 0?null:h],u},useContext:os,useEffect:xR,useImperativeHandle:function(u,h,m){m=m!=null?m.concat([u]):null,o0(4194308,4,SR.bind(null,h,u),m)},useLayoutEffect:function(u,h){return o0(4194308,4,u,h)},useInsertionEffect:function(u,h){o0(4,2,u,h)},useMemo:function(u,h){var m=zs();h=h===void 0?null:h;var b=u();if(yl){Ki(!0);try{u()}finally{Ki(!1)}}return m.memoizedState=[b,h],b},useReducer:function(u,h,m){var b=zs();if(m!==void 0){var S=m(h);if(yl){Ki(!0);try{m(h)}finally{Ki(!1)}}}else S=h;return b.memoizedState=b.baseState=S,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:S},b.queue=u,u=u.dispatch=H7.bind(null,rt,u),[b.memoizedState,u]},useRef:function(u){var h=zs();return u={current:u},h.memoizedState=u},useState:function(u){u=Cw(u);var h=u.queue,m=DR.bind(null,rt,h);return h.dispatch=m,[u.memoizedState,m]},useDebugValue:Ew,useDeferredValue:function(u,h){var m=zs();return $w(m,u,h)},useTransition:function(){var u=Cw(!1);return u=ER.bind(null,rt,u.queue,!0,!1),zs().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,h,m){var b=rt,S=zs();if(wt){if(m===void 0)throw Error(s(407));m=m()}else{if(m=h(),Mt===null)throw Error(s(349));(bt&60)!==0||sR(b,h,m)}S.memoizedState=m;var k={value:m,getSnapshot:h};return S.queue=k,xR(aR.bind(null,b,k,u),[u]),b.flags|=2048,ic(9,rR.bind(null,b,k,m,h),{destroy:void 0},null),m},useId:function(){var u=zs(),h=Mt.identifierPrefix;if(wt){var m=ei,b=Ja;m=(b&~(1<<32-Js(b)-1)).toString(32)+m,h=":"+h+"R"+m,m=s0++,0<m&&(h+="H"+m.toString(32)),h+=":"}else m=B7++,h=":"+h+"r"+m.toString(32)+":";return u.memoizedState=h},useCacheRefresh:function(){return zs().memoizedState=G7.bind(null,rt)}};bl.useMemoCache=ww,bl.useHostTransitionStatus=Aw,bl.useFormState=pR,bl.useActionState=pR,bl.useOptimistic=function(u){var h=zs();h.memoizedState=h.baseState=u;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=m,h=Rw.bind(null,rt,!0,m),m.dispatch=h,[u,h]};var no={readContext:os,use:a0,useCallback:CR,useContext:os,useEffect:kw,useImperativeHandle:TR,useInsertionEffect:vR,useLayoutEffect:wR,useMemo:NR,useReducer:i0,useRef:bR,useState:function(){return i0(ni)},useDebugValue:Ew,useDeferredValue:function(u,h){var m=vn();return kR(m,At.memoizedState,u,h)},useTransition:function(){var u=i0(ni)[0],h=vn().memoizedState;return[typeof u=="boolean"?u:Yf(u),h]},useSyncExternalStore:nR,useId:AR};no.useCacheRefresh=RR,no.useMemoCache=ww,no.useHostTransitionStatus=Aw,no.useFormState=mR,no.useActionState=mR,no.useOptimistic=function(u,h){var m=vn();return lR(m,At,u,h)};var xl={readContext:os,use:a0,useCallback:CR,useContext:os,useEffect:kw,useImperativeHandle:TR,useInsertionEffect:vR,useLayoutEffect:wR,useMemo:NR,useReducer:Tw,useRef:bR,useState:function(){return Tw(ni)},useDebugValue:Ew,useDeferredValue:function(u,h){var m=vn();return At===null?$w(m,u,h):kR(m,At.memoizedState,u,h)},useTransition:function(){var u=Tw(ni)[0],h=vn().memoizedState;return[typeof u=="boolean"?u:Yf(u),h]},useSyncExternalStore:nR,useId:AR};xl.useCacheRefresh=RR,xl.useMemoCache=ww,xl.useHostTransitionStatus=Aw,xl.useFormState=yR,xl.useActionState=yR,xl.useOptimistic=function(u,h){var m=vn();return At!==null?lR(m,At,u,h):(m.baseState=u,[u,m.queue.dispatch])};function Dw(u,h,m,b){h=u.memoizedState,m=m(b,h),m=m==null?h:_({},h,m),u.memoizedState=m,u.lanes===0&&(u.updateQueue.baseState=m)}var Ow={isMounted:function(u){return(u=u._reactInternals)?Q(u)===u:!1},enqueueSetState:function(u,h,m){u=u._reactInternals;var b=rr(),S=ao(b);S.payload=h,m!=null&&(S.callback=m),h=io(u,S,b),h!==null&&(Ns(h,u,b),ed(h,u,b))},enqueueReplaceState:function(u,h,m){u=u._reactInternals;var b=rr(),S=ao(b);S.tag=1,S.payload=h,m!=null&&(S.callback=m),h=io(u,S,b),h!==null&&(Ns(h,u,b),ed(h,u,b))},enqueueForceUpdate:function(u,h){u=u._reactInternals;var m=rr(),b=ao(m);b.tag=2,h!=null&&(b.callback=h),h=io(u,b,m),h!==null&&(Ns(h,u,m),ed(h,u,m))}};function FR(u,h,m,b,S,k,F){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(b,k,F):h.prototype&&h.prototype.isPureReactComponent?!zf(m,b)||!zf(S,k):!0}function LR(u,h,m,b){u=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(m,b),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(m,b),h.state!==u&&Ow.enqueueReplaceState(h,h.state,null)}function vl(u,h){var m=h;if("ref"in h){m={};for(var b in h)b!=="ref"&&(m[b]=h[b])}if(u=u.defaultProps){m===h&&(m=_({},m));for(var S in u)m[S]===void 0&&(m[S]=u[S])}return m}var c0=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)};function MR(u){c0(u)}function zR(u){console.error(u)}function PR(u){c0(u)}function h0(u,h){try{var m=u.onUncaughtError;m(h.value,{componentStack:h.stack})}catch(b){setTimeout(function(){throw b})}}function BR(u,h,m){try{var b=u.onCaughtError;b(m.value,{componentStack:m.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function _w(u,h,m){return m=ao(m),m.tag=3,m.payload={element:null},m.callback=function(){h0(u,h)},m}function VR(u){return u=ao(u),u.tag=3,u}function UR(u,h,m,b){var S=m.type.getDerivedStateFromError;if(typeof S=="function"){var k=b.value;u.payload=function(){return S(k)},u.callback=function(){BR(h,m,b)}}var F=m.stateNode;F!==null&&typeof F.componentDidCatch=="function"&&(u.callback=function(){BR(h,m,b),typeof S!="function"&&(fo===null?fo=new Set([this]):fo.add(this));var P=b.stack;this.componentDidCatch(b.value,{componentStack:P!==null?P:""})})}function q7(u,h,m,b,S){if(m.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(h=m.alternate,h!==null&&Jf(h,m,S,!0),m=$r.current,m!==null){switch(m.tag){case 13:return wa===null?m2():m.alternate===null&&nn===0&&(nn=3),m.flags&=-257,m.flags|=65536,m.lanes=S,b===cw?m.flags|=16384:(h=m.updateQueue,h===null?m.updateQueue=new Set([b]):h.add(b),y2(u,b,S)),!1;case 22:return m.flags|=65536,b===cw?m.flags|=16384:(h=m.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([b])},m.updateQueue=h):(m=h.retryQueue,m===null?h.retryQueue=new Set([b]):m.add(b)),y2(u,b,S)),!1}throw Error(s(435,m.tag))}return y2(u,b,S),m2(),!1}if(wt)return h=$r.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=S,b!==uw&&(u=Error(s(422),{cause:b}),Uf(Nr(u,m)))):(b!==uw&&(h=Error(s(423),{cause:b}),Uf(Nr(h,m))),u=u.current.alternate,u.flags|=65536,S&=-S,u.lanes|=S,b=Nr(b,m),S=_w(u.stateNode,b,S),Kw(u,S),nn!==4&&(nn=2)),!1;var k=Error(s(520),{cause:b});if(k=Nr(k,m),ld===null?ld=[k]:ld.push(k),nn!==4&&(nn=2),h===null)return!0;b=Nr(b,m),m=h;do{switch(m.tag){case 3:return m.flags|=65536,u=S&-S,m.lanes|=u,u=_w(m.stateNode,b,u),Kw(m,u),!1;case 1:if(h=m.type,k=m.stateNode,(m.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(fo===null||!fo.has(k))))return m.flags|=65536,S&=-S,m.lanes|=S,S=VR(S),UR(S,u,m,b),Kw(m,S),!1}m=m.return}while(m!==null);return!1}var jR=Error(s(461)),Pn=!1;function es(u,h,m,b){h.child=u===null?XA(h,null,m,b):ml(h,u.child,m,b)}function WR(u,h,m,b,S){m=m.render;var k=h.ref;if("ref"in b){var F={};for(var P in b)P!=="ref"&&(F[P]=b[P])}else F=b;return Sl(h),b=yw(u,h,m,F,k,S),P=bw(),u!==null&&!Pn?(xw(u,h,S),si(u,h,S)):(wt&&P&&ow(h),h.flags|=1,es(u,h,b,S),h.child)}function GR(u,h,m,b,S){if(u===null){var k=m.type;return typeof k=="function"&&!s2(k)&&k.defaultProps===void 0&&m.compare===null?(h.tag=15,h.type=k,HR(u,h,k,b,S)):(u=g0(m.type,null,b,h,h.mode,S),u.ref=h.ref,u.return=h,h.child=u)}if(k=u.child,!jw(u,S)){var F=k.memoizedProps;if(m=m.compare,m=m!==null?m:zf,m(F,b)&&u.ref===h.ref)return si(u,h,S)}return h.flags|=1,u=co(k,b),u.ref=h.ref,u.return=h,h.child=u}function HR(u,h,m,b,S){if(u!==null){var k=u.memoizedProps;if(zf(k,b)&&u.ref===h.ref)if(Pn=!1,h.pendingProps=b=k,jw(u,S))(u.flags&131072)!==0&&(Pn=!0);else return h.lanes=u.lanes,si(u,h,S)}return Fw(u,h,m,b,S)}function qR(u,h,m){var b=h.pendingProps,S=b.children,k=(h.stateNode._pendingVisibility&2)!==0,F=u!==null?u.memoizedState:null;if(Qf(u,h),b.mode==="hidden"||k){if((h.flags&128)!==0){if(b=F!==null?F.baseLanes|m:m,u!==null){for(S=h.child=u.child,k=0;S!==null;)k=k|S.lanes|S.childLanes,S=S.sibling;h.childLanes=k&~b}else h.childLanes=0,h.child=null;return XR(u,h,b,m)}if((m&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},u!==null&&t0(h,F!==null?F.cachePool:null),F!==null?KA(h,F):hw(),YA(h);else return h.lanes=h.childLanes=536870912,XR(u,h,F!==null?F.baseLanes|m:m,m)}else F!==null?(t0(h,F.cachePool),KA(h,F),eo(),h.memoizedState=null):(u!==null&&t0(h,null),hw(),eo());return es(u,h,S,m),h.child}function XR(u,h,m,b){var S=mw();return S=S===null?null:{parent:In._currentValue,pool:S},h.memoizedState={baseLanes:m,cachePool:S},u!==null&&t0(h,null),hw(),YA(h),u!==null&&Jf(u,h,b,!0),null}function Qf(u,h){var m=h.ref;if(m===null)u!==null&&u.ref!==null&&(h.flags|=2097664);else{if(typeof m!="function"&&typeof m!="object")throw Error(s(284));(u===null||u.ref!==m)&&(h.flags|=2097664)}}function Fw(u,h,m,b,S){return Sl(h),m=yw(u,h,m,b,void 0,S),b=bw(),u!==null&&!Pn?(xw(u,h,S),si(u,h,S)):(wt&&b&&ow(h),h.flags|=1,es(u,h,m,S),h.child)}function KR(u,h,m,b,S,k){return Sl(h),h.updateQueue=null,m=tR(h,b,m,S),eR(u),b=bw(),u!==null&&!Pn?(xw(u,h,k),si(u,h,k)):(wt&&b&&ow(h),h.flags|=1,es(u,h,m,k),h.child)}function YR(u,h,m,b,S){if(Sl(h),h.stateNode===null){var k=Zu,F=m.contextType;typeof F=="object"&&F!==null&&(k=os(F)),k=new m(b,k),h.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=Ow,h.stateNode=k,k._reactInternals=h,k=h.stateNode,k.props=b,k.state=h.memoizedState,k.refs={},qw(h),F=m.contextType,k.context=typeof F=="object"&&F!==null?os(F):Zu,k.state=h.memoizedState,F=m.getDerivedStateFromProps,typeof F=="function"&&(Dw(h,m,F,b),k.state=h.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(F=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),F!==k.state&&Ow.enqueueReplaceState(k,k.state,null),nd(h,b,k,S),td(),k.state=h.memoizedState),typeof k.componentDidMount=="function"&&(h.flags|=4194308),b=!0}else if(u===null){k=h.stateNode;var P=h.memoizedProps,G=vl(m,P);k.props=G;var se=k.context,ye=m.contextType;F=Zu,typeof ye=="object"&&ye!==null&&(F=os(ye));var Te=m.getDerivedStateFromProps;ye=typeof Te=="function"||typeof k.getSnapshotBeforeUpdate=="function",P=h.pendingProps!==P,ye||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(P||se!==F)&&LR(h,k,b,F),ro=!1;var fe=h.memoizedState;k.state=fe,nd(h,b,k,S),td(),se=h.memoizedState,P||fe!==se||ro?(typeof Te=="function"&&(Dw(h,m,Te,b),se=h.memoizedState),(G=ro||FR(h,m,G,b,fe,se,F))?(ye||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(h.flags|=4194308)):(typeof k.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=b,h.memoizedState=se),k.props=b,k.state=se,k.context=F,b=G):(typeof k.componentDidMount=="function"&&(h.flags|=4194308),b=!1)}else{k=h.stateNode,Xw(u,h),F=h.memoizedProps,ye=vl(m,F),k.props=ye,Te=h.pendingProps,fe=k.context,se=m.contextType,G=Zu,typeof se=="object"&&se!==null&&(G=os(se)),P=m.getDerivedStateFromProps,(se=typeof P=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(F!==Te||fe!==G)&&LR(h,k,b,G),ro=!1,fe=h.memoizedState,k.state=fe,nd(h,b,k,S),td();var ge=h.memoizedState;F!==Te||fe!==ge||ro||u!==null&&u.dependencies!==null&&f0(u.dependencies)?(typeof P=="function"&&(Dw(h,m,P,b),ge=h.memoizedState),(ye=ro||FR(h,m,ye,b,fe,ge,G)||u!==null&&u.dependencies!==null&&f0(u.dependencies))?(se||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(b,ge,G),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(b,ge,G)),typeof k.componentDidUpdate=="function"&&(h.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof k.componentDidUpdate!="function"||F===u.memoizedProps&&fe===u.memoizedState||(h.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||F===u.memoizedProps&&fe===u.memoizedState||(h.flags|=1024),h.memoizedProps=b,h.memoizedState=ge),k.props=b,k.state=ge,k.context=G,b=ye):(typeof k.componentDidUpdate!="function"||F===u.memoizedProps&&fe===u.memoizedState||(h.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||F===u.memoizedProps&&fe===u.memoizedState||(h.flags|=1024),b=!1)}return k=b,Qf(u,h),b=(h.flags&128)!==0,k||b?(k=h.stateNode,m=b&&typeof m.getDerivedStateFromError!="function"?null:k.render(),h.flags|=1,u!==null&&b?(h.child=ml(h,u.child,null,S),h.child=ml(h,null,m,S)):es(u,h,m,S),h.memoizedState=k.state,u=h.child):u=si(u,h,S),u}function ZR(u,h,m,b){return Vf(),h.flags|=256,es(u,h,m,b),h.child}var Lw={dehydrated:null,treeContext:null,retryLane:0};function Mw(u){return{baseLanes:u,cachePool:JA()}}function zw(u,h,m){return u=u!==null?u.childLanes&~m:0,h&&(u|=Dr),u}function QR(u,h,m){var b=h.pendingProps,S=!1,k=(h.flags&128)!==0,F;if((F=k)||(F=u!==null&&u.memoizedState===null?!1:($n.current&2)!==0),F&&(S=!0,h.flags&=-129),F=(h.flags&32)!==0,h.flags&=-33,u===null){if(wt){if(S?Ji(h):eo(),wt){var P=Jn,G;if(G=P){e:{for(G=P,P=va;G.nodeType!==8;){if(!P){P=null;break e}if(G=Zr(G.nextSibling),G===null){P=null;break e}}P=G}P!==null?(h.memoizedState={dehydrated:P,treeContext:fl!==null?{id:Ja,overflow:ei}:null,retryLane:536870912},G=Rr(18,null,null,0),G.stateNode=P,G.return=h,h.child=G,Cs=h,Jn=null,G=!0):G=!1}G||pl(h)}if(P=h.memoizedState,P!==null&&(P=P.dehydrated,P!==null))return P.data==="$!"?h.lanes=16:h.lanes=536870912,null;ti(h)}return P=b.children,b=b.fallback,S?(eo(),S=h.mode,P=Bw({mode:"hidden",children:P},S),b=Cl(b,S,m,null),P.return=h,b.return=h,P.sibling=b,h.child=P,S=h.child,S.memoizedState=Mw(m),S.childLanes=zw(u,F,m),h.memoizedState=Lw,b):(Ji(h),Pw(h,P))}if(G=u.memoizedState,G!==null&&(P=G.dehydrated,P!==null)){if(k)h.flags&256?(Ji(h),h.flags&=-257,h=Vw(u,h,m)):h.memoizedState!==null?(eo(),h.child=u.child,h.flags|=128,h=null):(eo(),S=b.fallback,P=h.mode,b=Bw({mode:"visible",children:b.children},P),S=Cl(S,P,m,null),S.flags|=2,b.return=h,S.return=h,b.sibling=S,h.child=b,ml(h,u.child,null,m),b=h.child,b.memoizedState=Mw(m),b.childLanes=zw(u,F,m),h.memoizedState=Lw,h=S);else if(Ji(h),P.data==="$!"){if(F=P.nextSibling&&P.nextSibling.dataset,F)var se=F.dgst;F=se,b=Error(s(419)),b.stack="",b.digest=F,Uf({value:b,source:null,stack:null}),h=Vw(u,h,m)}else if(Pn||Jf(u,h,m,!1),F=(m&u.childLanes)!==0,Pn||F){if(F=Mt,F!==null){if(b=m&-m,(b&42)!==0)b=1;else switch(b){case 2:b=1;break;case 8:b=4;break;case 32:b=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:b=64;break;case 268435456:b=134217728;break;default:b=0}if(b=(b&(F.suspendedLanes|m))!==0?0:b,b!==0&&b!==G.retryLane)throw G.retryLane=b,Qi(u,b),Ns(F,u,b),jR}P.data==="$?"||m2(),h=Vw(u,h,m)}else P.data==="$?"?(h.flags|=128,h.child=u.child,h=lW.bind(null,u),P._reactRetry=h,h=null):(u=G.treeContext,Jn=Zr(P.nextSibling),Cs=h,wt=!0,Kr=null,va=!1,u!==null&&(kr[Er++]=Ja,kr[Er++]=ei,kr[Er++]=fl,Ja=u.id,ei=u.overflow,fl=h),h=Pw(h,b.children),h.flags|=4096);return h}return S?(eo(),S=b.fallback,P=h.mode,G=u.child,se=G.sibling,b=co(G,{mode:"hidden",children:b.children}),b.subtreeFlags=G.subtreeFlags&31457280,se!==null?S=co(se,S):(S=Cl(S,P,m,null),S.flags|=2),S.return=h,b.return=h,b.sibling=S,h.child=b,b=S,S=h.child,P=u.child.memoizedState,P===null?P=Mw(m):(G=P.cachePool,G!==null?(se=In._currentValue,G=G.parent!==se?{parent:se,pool:se}:G):G=JA(),P={baseLanes:P.baseLanes|m,cachePool:G}),S.memoizedState=P,S.childLanes=zw(u,F,m),h.memoizedState=Lw,b):(Ji(h),m=u.child,u=m.sibling,m=co(m,{mode:"visible",children:b.children}),m.return=h,m.sibling=null,u!==null&&(F=h.deletions,F===null?(h.deletions=[u],h.flags|=16):F.push(u)),h.child=m,h.memoizedState=null,m)}function Pw(u,h){return h=Bw({mode:"visible",children:h},u.mode),h.return=u,u.child=h}function Bw(u,h){return CD(u,h,0,null)}function Vw(u,h,m){return ml(h,u.child,null,m),u=Pw(h,h.pendingProps.children),u.flags|=2,h.memoizedState=null,u}function JR(u,h,m){u.lanes|=h;var b=u.alternate;b!==null&&(b.lanes|=h),Gw(u.return,h,m)}function Uw(u,h,m,b,S){var k=u.memoizedState;k===null?u.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:b,tail:m,tailMode:S}:(k.isBackwards=h,k.rendering=null,k.renderingStartTime=0,k.last=b,k.tail=m,k.tailMode=S)}function eD(u,h,m){var b=h.pendingProps,S=b.revealOrder,k=b.tail;if(es(u,h,b.children,m),b=$n.current,(b&2)!==0)b=b&1|2,h.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=h.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&JR(u,m,h);else if(u.tag===19)JR(u,m,h);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===h)break e;for(;u.sibling===null;){if(u.return===null||u.return===h)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}b&=1}switch(De($n,b),S){case"forwards":for(m=h.child,S=null;m!==null;)u=m.alternate,u!==null&&e0(u)===null&&(S=m),m=m.sibling;m=S,m===null?(S=h.child,h.child=null):(S=m.sibling,m.sibling=null),Uw(h,!1,S,m,k);break;case"backwards":for(m=null,S=h.child,h.child=null;S!==null;){if(u=S.alternate,u!==null&&e0(u)===null){h.child=S;break}u=S.sibling,S.sibling=m,m=S,S=u}Uw(h,!0,m,null,k);break;case"together":Uw(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function si(u,h,m){if(u!==null&&(h.dependencies=u.dependencies),ho|=h.lanes,(m&h.childLanes)===0)if(u!==null){if(Jf(u,h,m,!1),(m&h.childLanes)===0)return null}else return null;if(u!==null&&h.child!==u.child)throw Error(s(153));if(h.child!==null){for(u=h.child,m=co(u,u.pendingProps),h.child=m,m.return=h;u.sibling!==null;)u=u.sibling,m=m.sibling=co(u,u.pendingProps),m.return=h;m.sibling=null}return h.child}function jw(u,h){return(u.lanes&h)!==0?!0:(u=u.dependencies,!!(u!==null&&f0(u)))}function X7(u,h,m){switch(h.tag){case 3:vt(h,h.stateNode.containerInfo),so(h,In,u.memoizedState.cache),Vf();break;case 27:case 5:It(h);break;case 4:vt(h,h.stateNode.containerInfo);break;case 10:so(h,h.type,h.memoizedProps.value);break;case 13:var b=h.memoizedState;if(b!==null)return b.dehydrated!==null?(Ji(h),h.flags|=128,null):(m&h.child.childLanes)!==0?QR(u,h,m):(Ji(h),u=si(u,h,m),u!==null?u.sibling:null);Ji(h);break;case 19:var S=(u.flags&128)!==0;if(b=(m&h.childLanes)!==0,b||(Jf(u,h,m,!1),b=(m&h.childLanes)!==0),S){if(b)return eD(u,h,m);h.flags|=128}if(S=h.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),De($n,$n.current),b)break;return null;case 22:case 23:return h.lanes=0,qR(u,h,m);case 24:so(h,In,u.memoizedState.cache)}return si(u,h,m)}function tD(u,h,m){if(u!==null)if(u.memoizedProps!==h.pendingProps)Pn=!0;else{if(!jw(u,m)&&(h.flags&128)===0)return Pn=!1,X7(u,h,m);Pn=(u.flags&131072)!==0}else Pn=!1,wt&&(h.flags&1048576)!==0&&PA(h,Kg,h.index);switch(h.lanes=0,h.tag){case 16:e:{u=h.pendingProps;var b=h.elementType,S=b._init;if(b=S(b._payload),h.type=b,typeof b=="function")s2(b)?(u=vl(b,u),h.tag=1,h=YR(null,h,b,u,m)):(h.tag=0,h=Fw(null,h,b,u,m));else{if(b!=null){if(S=b.$$typeof,S===y){h.tag=11,h=WR(null,h,b,u,m);break e}else if(S===w){h.tag=14,h=GR(null,h,b,u,m);break e}}throw h=O(b)||b,Error(s(306,h,""))}}return h;case 0:return Fw(u,h,h.type,h.pendingProps,m);case 1:return b=h.type,S=vl(b,h.pendingProps),YR(u,h,b,S,m);case 3:e:{if(vt(h,h.stateNode.containerInfo),u===null)throw Error(s(387));var k=h.pendingProps;S=h.memoizedState,b=S.element,Xw(u,h),nd(h,k,null,m);var F=h.memoizedState;if(k=F.cache,so(h,In,k),k!==S.cache&&Hw(h,[In],m,!0),td(),k=F.element,S.isDehydrated)if(S={element:k,isDehydrated:!1,cache:F.cache},h.updateQueue.baseState=S,h.memoizedState=S,h.flags&256){h=ZR(u,h,k,m);break e}else if(k!==b){b=Nr(Error(s(424)),h),Uf(b),h=ZR(u,h,k,m);break e}else for(Jn=Zr(h.stateNode.containerInfo.firstChild),Cs=h,wt=!0,Kr=null,va=!0,m=XA(h,null,k,m),h.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(Vf(),k===b){h=si(u,h,m);break e}es(u,h,k,m)}h=h.child}return h;case 26:return Qf(u,h),u===null?(m=r3(h.type,null,h.pendingProps,null))?h.memoizedState=m:wt||(m=h.type,u=h.pendingProps,b=$0(dt.current).createElement(m),b[is]=h,b[Ls]=u,ts(b,m,u),zn(b),h.stateNode=b):h.memoizedState=r3(h.type,u.memoizedProps,h.pendingProps,u.memoizedState),null;case 27:return It(h),u===null&&wt&&(b=h.stateNode=t3(h.type,h.pendingProps,dt.current),Cs=h,va=!0,Jn=Zr(b.firstChild)),b=h.pendingProps.children,u!==null||wt?es(u,h,b,m):h.child=ml(h,null,b,m),Qf(u,h),h.child;case 5:return u===null&&wt&&((S=b=Jn)&&(b=CW(b,h.type,h.pendingProps,va),b!==null?(h.stateNode=b,Cs=h,Jn=Zr(b.firstChild),va=!1,S=!0):S=!1),S||pl(h)),It(h),S=h.type,k=h.pendingProps,F=u!==null?u.memoizedProps:null,b=k.children,I2(S,k)?b=null:F!==null&&I2(S,F)&&(h.flags|=32),h.memoizedState!==null&&(S=yw(u,h,V7,null,null,m),yd._currentValue=S),Qf(u,h),es(u,h,b,m),h.child;case 6:return u===null&&wt&&((u=m=Jn)&&(m=NW(m,h.pendingProps,va),m!==null?(h.stateNode=m,Cs=h,Jn=null,u=!0):u=!1),u||pl(h)),null;case 13:return QR(u,h,m);case 4:return vt(h,h.stateNode.containerInfo),b=h.pendingProps,u===null?h.child=ml(h,null,b,m):es(u,h,b,m),h.child;case 11:return WR(u,h,h.type,h.pendingProps,m);case 7:return es(u,h,h.pendingProps,m),h.child;case 8:return es(u,h,h.pendingProps.children,m),h.child;case 12:return es(u,h,h.pendingProps.children,m),h.child;case 10:return b=h.pendingProps,so(h,h.type,b.value),es(u,h,b.children,m),h.child;case 9:return S=h.type._context,b=h.pendingProps.children,Sl(h),S=os(S),b=b(S),h.flags|=1,es(u,h,b,m),h.child;case 14:return GR(u,h,h.type,h.pendingProps,m);case 15:return HR(u,h,h.type,h.pendingProps,m);case 19:return eD(u,h,m);case 22:return qR(u,h,m);case 24:return Sl(h),b=os(In),u===null?(S=mw(),S===null&&(S=Mt,k=dw(),S.pooledCache=k,k.refCount++,k!==null&&(S.pooledCacheLanes|=m),S=k),h.memoizedState={parent:b,cache:S},qw(h),so(h,In,S)):((u.lanes&m)!==0&&(Xw(u,h),nd(h,null,null,m),td()),S=u.memoizedState,k=h.memoizedState,S.parent!==b?(S={parent:b,cache:b},h.memoizedState=S,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=S),so(h,In,b)):(b=k.cache,so(h,In,b),b!==S.cache&&Hw(h,[In],m,!0))),es(u,h,h.pendingProps.children,m),h.child;case 29:throw h.pendingProps}throw Error(s(156,h.tag))}var Ww=ke(null),wl=null,ri=null;function so(u,h,m){De(Ww,h._currentValue),h._currentValue=m}function ai(u){u._currentValue=Ww.current,Ae(Ww)}function Gw(u,h,m){for(;u!==null;){var b=u.alternate;if((u.childLanes&h)!==h?(u.childLanes|=h,b!==null&&(b.childLanes|=h)):b!==null&&(b.childLanes&h)!==h&&(b.childLanes|=h),u===m)break;u=u.return}}function Hw(u,h,m,b){var S=u.child;for(S!==null&&(S.return=u);S!==null;){var k=S.dependencies;if(k!==null){var F=S.child;k=k.firstContext;e:for(;k!==null;){var P=k;k=S;for(var G=0;G<h.length;G++)if(P.context===h[G]){k.lanes|=m,P=k.alternate,P!==null&&(P.lanes|=m),Gw(k.return,m,u),b||(F=null);break e}k=P.next}}else if(S.tag===18){if(F=S.return,F===null)throw Error(s(341));F.lanes|=m,k=F.alternate,k!==null&&(k.lanes|=m),Gw(F,m,u),F=null}else F=S.child;if(F!==null)F.return=S;else for(F=S;F!==null;){if(F===u){F=null;break}if(S=F.sibling,S!==null){S.return=F.return,F=S;break}F=F.return}S=F}}function Jf(u,h,m,b){u=null;for(var S=h,k=!1;S!==null;){if(!k){if((S.flags&524288)!==0)k=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var F=S.alternate;if(F===null)throw Error(s(387));if(F=F.memoizedProps,F!==null){var P=S.type;er(S.pendingProps.value,F.value)||(u!==null?u.push(P):u=[P])}}else if(S===$t.current){if(F=S.alternate,F===null)throw Error(s(387));F.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(u!==null?u.push(yd):u=[yd])}S=S.return}u!==null&&Hw(h,u,m,b),h.flags|=262144}function f0(u){for(u=u.firstContext;u!==null;){if(!er(u.context._currentValue,u.memoizedValue))return!0;u=u.next}return!1}function Sl(u){wl=u,ri=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function os(u){return nD(wl,u)}function d0(u,h){return wl===null&&Sl(u),nD(u,h)}function nD(u,h){var m=h._currentValue;if(h={context:h,memoizedValue:m,next:null},ri===null){if(u===null)throw Error(s(308));ri=h,u.dependencies={lanes:0,firstContext:h},u.flags|=524288}else ri=ri.next=h;return m}var ro=!1;function qw(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xw(u,h){u=u.updateQueue,h.updateQueue===u&&(h.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function ao(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function io(u,h,m){var b=u.updateQueue;if(b===null)return null;if(b=b.shared,(Kt&2)!==0){var S=b.pending;return S===null?h.next=h:(h.next=S.next,S.next=h),b.pending=h,h=qg(u),MA(u,null,m),h}return Hg(u,b,h,m),qg(u)}function ed(u,h,m){if(h=h.updateQueue,h!==null&&(h=h.shared,(m&4194176)!==0)){var b=h.lanes;b&=u.pendingLanes,m|=b,h.lanes=m,GI(u,m)}}function Kw(u,h){var m=u.updateQueue,b=u.alternate;if(b!==null&&(b=b.updateQueue,m===b)){var S=null,k=null;if(m=m.firstBaseUpdate,m!==null){do{var F={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};k===null?S=k=F:k=k.next=F,m=m.next}while(m!==null);k===null?S=k=h:k=k.next=h}else S=k=h;m={baseState:b.baseState,firstBaseUpdate:S,lastBaseUpdate:k,shared:b.shared,callbacks:b.callbacks},u.updateQueue=m;return}u=m.lastBaseUpdate,u===null?m.firstBaseUpdate=h:u.next=h,m.lastBaseUpdate=h}var Yw=!1;function td(){if(Yw){var u=sc;if(u!==null)throw u}}function nd(u,h,m,b){Yw=!1;var S=u.updateQueue;ro=!1;var k=S.firstBaseUpdate,F=S.lastBaseUpdate,P=S.shared.pending;if(P!==null){S.shared.pending=null;var G=P,se=G.next;G.next=null,F===null?k=se:F.next=se,F=G;var ye=u.alternate;ye!==null&&(ye=ye.updateQueue,P=ye.lastBaseUpdate,P!==F&&(P===null?ye.firstBaseUpdate=se:P.next=se,ye.lastBaseUpdate=G))}if(k!==null){var Te=S.baseState;F=0,ye=se=G=null,P=k;do{var fe=P.lane&-536870913,ge=fe!==P.lane;if(ge?(bt&fe)===fe:(b&fe)===fe){fe!==0&&fe===nc&&(Yw=!0),ye!==null&&(ye=ye.next={lane:0,tag:P.tag,payload:P.payload,callback:null,next:null});e:{var ze=u,Ye=P;fe=h;var sn=m;switch(Ye.tag){case 1:if(ze=Ye.payload,typeof ze=="function"){Te=ze.call(sn,Te,fe);break e}Te=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=Ye.payload,fe=typeof ze=="function"?ze.call(sn,Te,fe):ze,fe==null)break e;Te=_({},Te,fe);break e;case 2:ro=!0}}fe=P.callback,fe!==null&&(u.flags|=64,ge&&(u.flags|=8192),ge=S.callbacks,ge===null?S.callbacks=[fe]:ge.push(fe))}else ge={lane:fe,tag:P.tag,payload:P.payload,callback:P.callback,next:null},ye===null?(se=ye=ge,G=Te):ye=ye.next=ge,F|=fe;if(P=P.next,P===null){if(P=S.shared.pending,P===null)break;ge=P,P=ge.next,ge.next=null,S.lastBaseUpdate=ge,S.shared.pending=null}}while(!0);ye===null&&(G=Te),S.baseState=G,S.firstBaseUpdate=se,S.lastBaseUpdate=ye,k===null&&(S.shared.lanes=0),ho|=F,u.lanes=F,u.memoizedState=Te}}function sD(u,h){if(typeof u!="function")throw Error(s(191,u));u.call(h)}function rD(u,h){var m=u.callbacks;if(m!==null)for(u.callbacks=null,u=0;u<m.length;u++)sD(m[u],h)}function sd(u,h){try{var m=h.updateQueue,b=m!==null?m.lastEffect:null;if(b!==null){var S=b.next;m=S;do{if((m.tag&u)===u){b=void 0;var k=m.create,F=m.inst;b=k(),F.destroy=b}m=m.next}while(m!==S)}}catch(P){Ot(h,h.return,P)}}function oo(u,h,m){try{var b=h.updateQueue,S=b!==null?b.lastEffect:null;if(S!==null){var k=S.next;b=k;do{if((b.tag&u)===u){var F=b.inst,P=F.destroy;if(P!==void 0){F.destroy=void 0,S=h;var G=m;try{P()}catch(se){Ot(S,G,se)}}}b=b.next}while(b!==k)}}catch(se){Ot(h,h.return,se)}}function aD(u){var h=u.updateQueue;if(h!==null){var m=u.stateNode;try{rD(h,m)}catch(b){Ot(u,u.return,b)}}}function iD(u,h,m){m.props=vl(u.type,u.memoizedProps),m.state=u.memoizedState;try{m.componentWillUnmount()}catch(b){Ot(u,h,b)}}function Tl(u,h){try{var m=u.ref;if(m!==null){var b=u.stateNode;switch(u.tag){case 26:case 27:case 5:var S=b;break;default:S=b}typeof m=="function"?u.refCleanup=m(S):m.current=S}}catch(k){Ot(u,h,k)}}function tr(u,h){var m=u.ref,b=u.refCleanup;if(m!==null)if(typeof b=="function")try{b()}catch(S){Ot(u,h,S)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(S){Ot(u,h,S)}else m.current=null}function oD(u){var h=u.type,m=u.memoizedProps,b=u.stateNode;try{e:switch(h){case"button":case"input":case"select":case"textarea":m.autoFocus&&b.focus();break e;case"img":m.src?b.src=m.src:m.srcSet&&(b.srcset=m.srcSet)}}catch(S){Ot(u,u.return,S)}}function lD(u,h,m){try{var b=u.stateNode;xW(b,u.type,m,h),b[Ls]=h}catch(S){Ot(u,u.return,S)}}function uD(u){return u.tag===5||u.tag===3||u.tag===26||u.tag===27||u.tag===4}function Zw(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||uD(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==27&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function Qw(u,h,m){var b=u.tag;if(b===5||b===6)u=u.stateNode,h?m.nodeType===8?m.parentNode.insertBefore(u,h):m.insertBefore(u,h):(m.nodeType===8?(h=m.parentNode,h.insertBefore(u,m)):(h=m,h.appendChild(u)),m=m._reactRootContainer,m!=null||h.onclick!==null||(h.onclick=E0));else if(b!==4&&b!==27&&(u=u.child,u!==null))for(Qw(u,h,m),u=u.sibling;u!==null;)Qw(u,h,m),u=u.sibling}function p0(u,h,m){var b=u.tag;if(b===5||b===6)u=u.stateNode,h?m.insertBefore(u,h):m.appendChild(u);else if(b!==4&&b!==27&&(u=u.child,u!==null))for(p0(u,h,m),u=u.sibling;u!==null;)p0(u,h,m),u=u.sibling}var ii=!1,tn=!1,Jw=!1,cD=typeof WeakSet=="function"?WeakSet:Set,Bn=null,hD=!1;function K7(u,h){if(u=u.containerInfo,E2=_0,u=$A(u),tw(u)){if("selectionStart"in u)var m={start:u.selectionStart,end:u.selectionEnd};else e:{m=(m=u.ownerDocument)&&m.defaultView||window;var b=m.getSelection&&m.getSelection();if(b&&b.rangeCount!==0){m=b.anchorNode;var S=b.anchorOffset,k=b.focusNode;b=b.focusOffset;try{m.nodeType,k.nodeType}catch{m=null;break e}var F=0,P=-1,G=-1,se=0,ye=0,Te=u,fe=null;t:for(;;){for(var ge;Te!==m||S!==0&&Te.nodeType!==3||(P=F+S),Te!==k||b!==0&&Te.nodeType!==3||(G=F+b),Te.nodeType===3&&(F+=Te.nodeValue.length),(ge=Te.firstChild)!==null;)fe=Te,Te=ge;for(;;){if(Te===u)break t;if(fe===m&&++se===S&&(P=F),fe===k&&++ye===b&&(G=F),(ge=Te.nextSibling)!==null)break;Te=fe,fe=Te.parentNode}Te=ge}m=P===-1||G===-1?null:{start:P,end:G}}else m=null}m=m||{start:0,end:0}}else m=null;for($2={focusedElem:u,selectionRange:m},_0=!1,Bn=h;Bn!==null;)if(h=Bn,u=h.child,(h.subtreeFlags&1028)!==0&&u!==null)u.return=h,Bn=u;else for(;Bn!==null;){switch(h=Bn,k=h.alternate,u=h.flags,h.tag){case 0:break;case 11:case 15:break;case 1:if((u&1024)!==0&&k!==null){u=void 0,m=h,S=k.memoizedProps,k=k.memoizedState,b=m.stateNode;try{var ze=vl(m.type,S,m.elementType===m.type);u=b.getSnapshotBeforeUpdate(ze,k),b.__reactInternalSnapshotBeforeUpdate=u}catch(Ye){Ot(m,m.return,Ye)}}break;case 3:if((u&1024)!==0){if(u=h.stateNode.containerInfo,m=u.nodeType,m===9)D2(u);else if(m===1)switch(u.nodeName){case"HEAD":case"HTML":case"BODY":D2(u);break;default:u.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(s(163))}if(u=h.sibling,u!==null){u.return=h.return,Bn=u;break}Bn=h.return}return ze=hD,hD=!1,ze}function fD(u,h,m){var b=m.flags;switch(m.tag){case 0:case 11:case 15:li(u,m),b&4&&sd(5,m);break;case 1:if(li(u,m),b&4)if(u=m.stateNode,h===null)try{u.componentDidMount()}catch(P){Ot(m,m.return,P)}else{var S=vl(m.type,h.memoizedProps);h=h.memoizedState;try{u.componentDidUpdate(S,h,u.__reactInternalSnapshotBeforeUpdate)}catch(P){Ot(m,m.return,P)}}b&64&&aD(m),b&512&&Tl(m,m.return);break;case 3:if(li(u,m),b&64&&(b=m.updateQueue,b!==null)){if(u=null,m.child!==null)switch(m.child.tag){case 27:case 5:u=m.child.stateNode;break;case 1:u=m.child.stateNode}try{rD(b,u)}catch(P){Ot(m,m.return,P)}}break;case 26:li(u,m),b&512&&Tl(m,m.return);break;case 27:case 5:li(u,m),h===null&&b&4&&oD(m),b&512&&Tl(m,m.return);break;case 12:li(u,m);break;case 13:li(u,m),b&4&&mD(u,m);break;case 22:if(S=m.memoizedState!==null||ii,!S){h=h!==null&&h.memoizedState!==null||tn;var k=ii,F=tn;ii=S,(tn=h)&&!F?lo(u,m,(m.subtreeFlags&8772)!==0):li(u,m),ii=k,tn=F}b&512&&(m.memoizedProps.mode==="manual"?Tl(m,m.return):tr(m,m.return));break;default:li(u,m)}}function dD(u){var h=u.alternate;h!==null&&(u.alternate=null,dD(h)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(h=u.stateNode,h!==null&&Pv(h)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}var wn=null,nr=!1;function oi(u,h,m){for(m=m.child;m!==null;)pD(u,h,m),m=m.sibling}function pD(u,h,m){if(Ts&&typeof Ts.onCommitFiberUnmount=="function")try{Ts.onCommitFiberUnmount(xa,m)}catch{}switch(m.tag){case 26:tn||tr(m,h),oi(u,h,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:tn||tr(m,h);var b=wn,S=nr;for(wn=m.stateNode,oi(u,h,m),m=m.stateNode,h=m.attributes;h.length;)m.removeAttributeNode(h[0]);Pv(m),wn=b,nr=S;break;case 5:tn||tr(m,h);case 6:S=wn;var k=nr;if(wn=null,oi(u,h,m),wn=S,nr=k,wn!==null)if(nr)try{u=wn,b=m.stateNode,u.nodeType===8?u.parentNode.removeChild(b):u.removeChild(b)}catch(F){Ot(m,h,F)}else try{wn.removeChild(m.stateNode)}catch(F){Ot(m,h,F)}break;case 18:wn!==null&&(nr?(h=wn,m=m.stateNode,h.nodeType===8?R2(h.parentNode,m):h.nodeType===1&&R2(h,m),wd(h)):R2(wn,m.stateNode));break;case 4:b=wn,S=nr,wn=m.stateNode.containerInfo,nr=!0,oi(u,h,m),wn=b,nr=S;break;case 0:case 11:case 14:case 15:tn||oo(2,m,h),tn||oo(4,m,h),oi(u,h,m);break;case 1:tn||(tr(m,h),b=m.stateNode,typeof b.componentWillUnmount=="function"&&iD(m,h,b)),oi(u,h,m);break;case 21:oi(u,h,m);break;case 22:tn||tr(m,h),tn=(b=tn)||m.memoizedState!==null,oi(u,h,m),tn=b;break;default:oi(u,h,m)}}function mD(u,h){if(h.memoizedState===null&&(u=h.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{wd(u)}catch(m){Ot(h,h.return,m)}}function Y7(u){switch(u.tag){case 13:case 19:var h=u.stateNode;return h===null&&(h=u.stateNode=new cD),h;case 22:return u=u.stateNode,h=u._retryCache,h===null&&(h=u._retryCache=new cD),h;default:throw Error(s(435,u.tag))}}function e2(u,h){var m=Y7(u);h.forEach(function(b){var S=uW.bind(null,u,b);m.has(b)||(m.add(b),b.then(S,S))})}function Ir(u,h){var m=h.deletions;if(m!==null)for(var b=0;b<m.length;b++){var S=m[b],k=u,F=h,P=F;e:for(;P!==null;){switch(P.tag){case 27:case 5:wn=P.stateNode,nr=!1;break e;case 3:wn=P.stateNode.containerInfo,nr=!0;break e;case 4:wn=P.stateNode.containerInfo,nr=!0;break e}P=P.return}if(wn===null)throw Error(s(160));pD(k,F,S),wn=null,nr=!1,k=S.alternate,k!==null&&(k.return=null),S.return=null}if(h.subtreeFlags&13878)for(h=h.child;h!==null;)gD(h,u),h=h.sibling}var Yr=null;function gD(u,h){var m=u.alternate,b=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:Ir(h,u),Ar(u),b&4&&(oo(3,u,u.return),sd(3,u),oo(5,u,u.return));break;case 1:Ir(h,u),Ar(u),b&512&&(tn||m===null||tr(m,m.return)),b&64&&ii&&(u=u.updateQueue,u!==null&&(b=u.callbacks,b!==null&&(m=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=m===null?b:m.concat(b))));break;case 26:var S=Yr;if(Ir(h,u),Ar(u),b&512&&(tn||m===null||tr(m,m.return)),b&4){var k=m!==null?m.memoizedState:null;if(b=u.memoizedState,m===null)if(b===null)if(u.stateNode===null){e:{b=u.type,m=u.memoizedProps,S=S.ownerDocument||S;t:switch(b){case"title":k=S.getElementsByTagName("title")[0],(!k||k[If]||k[is]||k.namespaceURI==="http://www.w3.org/2000/svg"||k.hasAttribute("itemprop"))&&(k=S.createElement(b),S.head.insertBefore(k,S.querySelector("head > title"))),ts(k,b,m),k[is]=u,zn(k),b=k;break e;case"link":var F=o3("link","href",S).get(b+(m.href||""));if(F){for(var P=0;P<F.length;P++)if(k=F[P],k.getAttribute("href")===(m.href==null?null:m.href)&&k.getAttribute("rel")===(m.rel==null?null:m.rel)&&k.getAttribute("title")===(m.title==null?null:m.title)&&k.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){F.splice(P,1);break t}}k=S.createElement(b),ts(k,b,m),S.head.appendChild(k);break;case"meta":if(F=o3("meta","content",S).get(b+(m.content||""))){for(P=0;P<F.length;P++)if(k=F[P],k.getAttribute("content")===(m.content==null?null:""+m.content)&&k.getAttribute("name")===(m.name==null?null:m.name)&&k.getAttribute("property")===(m.property==null?null:m.property)&&k.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&k.getAttribute("charset")===(m.charSet==null?null:m.charSet)){F.splice(P,1);break t}}k=S.createElement(b),ts(k,b,m),S.head.appendChild(k);break;default:throw Error(s(468,b))}k[is]=u,zn(k),b=k}u.stateNode=b}else l3(S,u.type,u.stateNode);else u.stateNode=i3(S,b,u.memoizedProps);else k!==b?(k===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):k.count--,b===null?l3(S,u.type,u.stateNode):i3(S,b,u.memoizedProps)):b===null&&u.stateNode!==null&&lD(u,u.memoizedProps,m.memoizedProps)}break;case 27:if(b&4&&u.alternate===null){S=u.stateNode,k=u.memoizedProps;try{for(var G=S.firstChild;G;){var se=G.nextSibling,ye=G.nodeName;G[If]||ye==="HEAD"||ye==="BODY"||ye==="SCRIPT"||ye==="STYLE"||ye==="LINK"&&G.rel.toLowerCase()==="stylesheet"||S.removeChild(G),G=se}for(var Te=u.type,fe=S.attributes;fe.length;)S.removeAttributeNode(fe[0]);ts(S,Te,k),S[is]=u,S[Ls]=k}catch(ze){Ot(u,u.return,ze)}}case 5:if(Ir(h,u),Ar(u),b&512&&(tn||m===null||tr(m,m.return)),u.flags&32){S=u.stateNode;try{Wu(S,"")}catch(ze){Ot(u,u.return,ze)}}b&4&&u.stateNode!=null&&(S=u.memoizedProps,lD(u,S,m!==null?m.memoizedProps:S)),b&1024&&(Jw=!0);break;case 6:if(Ir(h,u),Ar(u),b&4){if(u.stateNode===null)throw Error(s(162));b=u.memoizedProps,m=u.stateNode;try{m.nodeValue=b}catch(ze){Ot(u,u.return,ze)}}break;case 3:if(R0=null,S=Yr,Yr=I0(h.containerInfo),Ir(h,u),Yr=S,Ar(u),b&4&&m!==null&&m.memoizedState.isDehydrated)try{wd(h.containerInfo)}catch(ze){Ot(u,u.return,ze)}Jw&&(Jw=!1,yD(u));break;case 4:b=Yr,Yr=I0(u.stateNode.containerInfo),Ir(h,u),Ar(u),Yr=b;break;case 12:Ir(h,u),Ar(u);break;case 13:Ir(h,u),Ar(u),u.child.flags&8192&&u.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(u2=en()),b&4&&(b=u.updateQueue,b!==null&&(u.updateQueue=null,e2(u,b)));break;case 22:if(b&512&&(tn||m===null||tr(m,m.return)),G=u.memoizedState!==null,se=m!==null&&m.memoizedState!==null,ye=ii,Te=tn,ii=ye||G,tn=Te||se,Ir(h,u),tn=Te,ii=ye,Ar(u),h=u.stateNode,h._current=u,h._visibility&=-3,h._visibility|=h._pendingVisibility&2,b&8192&&(h._visibility=G?h._visibility&-2:h._visibility|1,G&&(h=ii||tn,m===null||se||h||oc(u)),u.memoizedProps===null||u.memoizedProps.mode!=="manual"))e:for(m=null,h=u;;){if(h.tag===5||h.tag===26||h.tag===27){if(m===null){se=m=h;try{if(S=se.stateNode,G)k=S.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{F=se.stateNode,P=se.memoizedProps.style;var ge=P!=null&&P.hasOwnProperty("display")?P.display:null;F.style.display=ge==null||typeof ge=="boolean"?"":(""+ge).trim()}}catch(ze){Ot(se,se.return,ze)}}}else if(h.tag===6){if(m===null){se=h;try{se.stateNode.nodeValue=G?"":se.memoizedProps}catch(ze){Ot(se,se.return,ze)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===u)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break e;for(;h.sibling===null;){if(h.return===null||h.return===u)break e;m===h&&(m=null),h=h.return}m===h&&(m=null),h.sibling.return=h.return,h=h.sibling}b&4&&(b=u.updateQueue,b!==null&&(m=b.retryQueue,m!==null&&(b.retryQueue=null,e2(u,m))));break;case 19:Ir(h,u),Ar(u),b&4&&(b=u.updateQueue,b!==null&&(u.updateQueue=null,e2(u,b)));break;case 21:break;default:Ir(h,u),Ar(u)}}function Ar(u){var h=u.flags;if(h&2){try{if(u.tag!==27){e:{for(var m=u.return;m!==null;){if(uD(m)){var b=m;break e}m=m.return}throw Error(s(160))}switch(b.tag){case 27:var S=b.stateNode,k=Zw(u);p0(u,k,S);break;case 5:var F=b.stateNode;b.flags&32&&(Wu(F,""),b.flags&=-33);var P=Zw(u);p0(u,P,F);break;case 3:case 4:var G=b.stateNode.containerInfo,se=Zw(u);Qw(u,se,G);break;default:throw Error(s(161))}}}catch(ye){Ot(u,u.return,ye)}u.flags&=-3}h&4096&&(u.flags&=-4097)}function yD(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var h=u;yD(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),u=u.sibling}}function li(u,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)fD(u,h.alternate,h),h=h.sibling}function oc(u){for(u=u.child;u!==null;){var h=u;switch(h.tag){case 0:case 11:case 14:case 15:oo(4,h,h.return),oc(h);break;case 1:tr(h,h.return);var m=h.stateNode;typeof m.componentWillUnmount=="function"&&iD(h,h.return,m),oc(h);break;case 26:case 27:case 5:tr(h,h.return),oc(h);break;case 22:tr(h,h.return),h.memoizedState===null&&oc(h);break;default:oc(h)}u=u.sibling}}function lo(u,h,m){for(m=m&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var b=h.alternate,S=u,k=h,F=k.flags;switch(k.tag){case 0:case 11:case 15:lo(S,k,m),sd(4,k);break;case 1:if(lo(S,k,m),b=k,S=b.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(se){Ot(b,b.return,se)}if(b=k,S=b.updateQueue,S!==null){var P=b.stateNode;try{var G=S.shared.hiddenCallbacks;if(G!==null)for(S.shared.hiddenCallbacks=null,S=0;S<G.length;S++)sD(G[S],P)}catch(se){Ot(b,b.return,se)}}m&&F&64&&aD(k),Tl(k,k.return);break;case 26:case 27:case 5:lo(S,k,m),m&&b===null&&F&4&&oD(k),Tl(k,k.return);break;case 12:lo(S,k,m);break;case 13:lo(S,k,m),m&&F&4&&mD(S,k);break;case 22:k.memoizedState===null&&lo(S,k,m),Tl(k,k.return);break;default:lo(S,k,m)}h=h.sibling}}function t2(u,h){var m=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),u=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(u=h.memoizedState.cachePool.pool),u!==m&&(u!=null&&u.refCount++,m!=null&&qf(m))}function n2(u,h){u=null,h.alternate!==null&&(u=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==u&&(h.refCount++,u!=null&&qf(u))}function uo(u,h,m,b){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)bD(u,h,m,b),h=h.sibling}function bD(u,h,m,b){var S=h.flags;switch(h.tag){case 0:case 11:case 15:uo(u,h,m,b),S&2048&&sd(9,h);break;case 3:uo(u,h,m,b),S&2048&&(u=null,h.alternate!==null&&(u=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==u&&(h.refCount++,u!=null&&qf(u)));break;case 12:if(S&2048){uo(u,h,m,b),u=h.stateNode;try{var k=h.memoizedProps,F=k.id,P=k.onPostCommit;typeof P=="function"&&P(F,h.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(G){Ot(h,h.return,G)}}else uo(u,h,m,b);break;case 23:break;case 22:k=h.stateNode,h.memoizedState!==null?k._visibility&4?uo(u,h,m,b):rd(u,h):k._visibility&4?uo(u,h,m,b):(k._visibility|=4,lc(u,h,m,b,(h.subtreeFlags&10256)!==0)),S&2048&&t2(h.alternate,h);break;case 24:uo(u,h,m,b),S&2048&&n2(h.alternate,h);break;default:uo(u,h,m,b)}}function lc(u,h,m,b,S){for(S=S&&(h.subtreeFlags&10256)!==0,h=h.child;h!==null;){var k=u,F=h,P=m,G=b,se=F.flags;switch(F.tag){case 0:case 11:case 15:lc(k,F,P,G,S),sd(8,F);break;case 23:break;case 22:var ye=F.stateNode;F.memoizedState!==null?ye._visibility&4?lc(k,F,P,G,S):rd(k,F):(ye._visibility|=4,lc(k,F,P,G,S)),S&&se&2048&&t2(F.alternate,F);break;case 24:lc(k,F,P,G,S),S&&se&2048&&n2(F.alternate,F);break;default:lc(k,F,P,G,S)}h=h.sibling}}function rd(u,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var m=u,b=h,S=b.flags;switch(b.tag){case 22:rd(m,b),S&2048&&t2(b.alternate,b);break;case 24:rd(m,b),S&2048&&n2(b.alternate,b);break;default:rd(m,b)}h=h.sibling}}var ad=8192;function uc(u){if(u.subtreeFlags&ad)for(u=u.child;u!==null;)xD(u),u=u.sibling}function xD(u){switch(u.tag){case 26:uc(u),u.flags&ad&&u.memoizedState!==null&&zW(Yr,u.memoizedState,u.memoizedProps);break;case 5:uc(u);break;case 3:case 4:var h=Yr;Yr=I0(u.stateNode.containerInfo),uc(u),Yr=h;break;case 22:u.memoizedState===null&&(h=u.alternate,h!==null&&h.memoizedState!==null?(h=ad,ad=16777216,uc(u),ad=h):uc(u));break;default:uc(u)}}function vD(u){var h=u.alternate;if(h!==null&&(u=h.child,u!==null)){h.child=null;do h=u.sibling,u.sibling=null,u=h;while(u!==null)}}function id(u){var h=u.deletions;if((u.flags&16)!==0){if(h!==null)for(var m=0;m<h.length;m++){var b=h[m];Bn=b,SD(b,u)}vD(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)wD(u),u=u.sibling}function wD(u){switch(u.tag){case 0:case 11:case 15:id(u),u.flags&2048&&oo(9,u,u.return);break;case 3:id(u);break;case 12:id(u);break;case 22:var h=u.stateNode;u.memoizedState!==null&&h._visibility&4&&(u.return===null||u.return.tag!==13)?(h._visibility&=-5,m0(u)):id(u);break;default:id(u)}}function m0(u){var h=u.deletions;if((u.flags&16)!==0){if(h!==null)for(var m=0;m<h.length;m++){var b=h[m];Bn=b,SD(b,u)}vD(u)}for(u=u.child;u!==null;){switch(h=u,h.tag){case 0:case 11:case 15:oo(8,h,h.return),m0(h);break;case 22:m=h.stateNode,m._visibility&4&&(m._visibility&=-5,m0(h));break;default:m0(h)}u=u.sibling}}function SD(u,h){for(;Bn!==null;){var m=Bn;switch(m.tag){case 0:case 11:case 15:oo(8,m,h);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var b=m.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:qf(m.memoizedState.cache)}if(b=m.child,b!==null)b.return=m,Bn=b;else e:for(m=u;Bn!==null;){b=Bn;var S=b.sibling,k=b.return;if(dD(b),b===m){Bn=null;break e}if(S!==null){S.return=k,Bn=S;break e}Bn=k}}}function Z7(u,h,m,b){this.tag=u,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rr(u,h,m,b){return new Z7(u,h,m,b)}function s2(u){return u=u.prototype,!(!u||!u.isReactComponent)}function co(u,h){var m=u.alternate;return m===null?(m=Rr(u.tag,h,u.key,u.mode),m.elementType=u.elementType,m.type=u.type,m.stateNode=u.stateNode,m.alternate=u,u.alternate=m):(m.pendingProps=h,m.type=u.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=u.flags&31457280,m.childLanes=u.childLanes,m.lanes=u.lanes,m.child=u.child,m.memoizedProps=u.memoizedProps,m.memoizedState=u.memoizedState,m.updateQueue=u.updateQueue,h=u.dependencies,m.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},m.sibling=u.sibling,m.index=u.index,m.ref=u.ref,m.refCleanup=u.refCleanup,m}function TD(u,h){u.flags&=31457282;var m=u.alternate;return m===null?(u.childLanes=0,u.lanes=h,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=m.childLanes,u.lanes=m.lanes,u.child=m.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=m.memoizedProps,u.memoizedState=m.memoizedState,u.updateQueue=m.updateQueue,u.type=m.type,h=m.dependencies,u.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),u}function g0(u,h,m,b,S,k){var F=0;if(b=u,typeof u=="function")s2(u)&&(F=1);else if(typeof u=="string")F=LW(u,m,We.current)?26:u==="html"||u==="head"||u==="body"?27:5;else e:switch(u){case l:return Cl(m.children,S,k,h);case c:F=8,S|=24;break;case f:return u=Rr(12,m,h,S|2),u.elementType=f,u.lanes=k,u;case v:return u=Rr(13,m,h,S),u.elementType=v,u.lanes=k,u;case x:return u=Rr(19,m,h,S),u.elementType=x,u.lanes=k,u;case N:return CD(m,S,k,h);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case d:case g:F=10;break e;case p:F=9;break e;case y:F=11;break e;case w:F=14;break e;case T:F=16,b=null;break e}F=29,m=Error(s(130,u===null?"null":typeof u,"")),b=null}return h=Rr(F,m,h,S),h.elementType=u,h.type=b,h.lanes=k,h}function Cl(u,h,m,b){return u=Rr(7,u,b,h),u.lanes=m,u}function CD(u,h,m,b){u=Rr(22,u,b,h),u.elementType=N,u.lanes=m;var S={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var k=S._current;if(k===null)throw Error(s(456));if((S._pendingVisibility&2)===0){var F=Qi(k,2);F!==null&&(S._pendingVisibility|=2,Ns(F,k,2))}},attach:function(){var k=S._current;if(k===null)throw Error(s(456));if((S._pendingVisibility&2)!==0){var F=Qi(k,2);F!==null&&(S._pendingVisibility&=-3,Ns(F,k,2))}}};return u.stateNode=S,u}function r2(u,h,m){return u=Rr(6,u,null,h),u.lanes=m,u}function a2(u,h,m){return h=Rr(4,u.children!==null?u.children:[],u.key,h),h.lanes=m,h.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},h}function ui(u){u.flags|=4}function ND(u,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)u.flags&=-16777217;else if(u.flags|=16777216,!u3(h)){if(h=$r.current,h!==null&&((bt&4194176)===bt?wa!==null:(bt&62914560)!==bt&&(bt&536870912)===0||h!==wa))throw Wf=cw,UA;u.flags|=8192}}function y0(u,h){h!==null&&(u.flags|=4),u.flags&16384&&(h=u.tag!==22?jI():536870912,u.lanes|=h,hc|=h)}function od(u,h){if(!wt)switch(u.tailMode){case"hidden":h=u.tail;for(var m=null;h!==null;)h.alternate!==null&&(m=h),h=h.sibling;m===null?u.tail=null:m.sibling=null;break;case"collapsed":m=u.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?h||u.tail===null?u.tail=null:u.tail.sibling=null:b.sibling=null}}function Xt(u){var h=u.alternate!==null&&u.alternate.child===u.child,m=0,b=0;if(h)for(var S=u.child;S!==null;)m|=S.lanes|S.childLanes,b|=S.subtreeFlags&31457280,b|=S.flags&31457280,S.return=u,S=S.sibling;else for(S=u.child;S!==null;)m|=S.lanes|S.childLanes,b|=S.subtreeFlags,b|=S.flags,S.return=u,S=S.sibling;return u.subtreeFlags|=b,u.childLanes=m,h}function Q7(u,h,m){var b=h.pendingProps;switch(lw(h),h.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xt(h),null;case 1:return Xt(h),null;case 3:return m=h.stateNode,b=null,u!==null&&(b=u.memoizedState.cache),h.memoizedState.cache!==b&&(h.flags|=2048),ai(In),pt(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(u===null||u.child===null)&&(Bf(h)?ui(h):u===null||u.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Kr!==null&&(d2(Kr),Kr=null))),Xt(h),null;case 26:return m=h.memoizedState,u===null?(ui(h),m!==null?(Xt(h),ND(h,m)):(Xt(h),h.flags&=-16777217)):m?m!==u.memoizedState?(ui(h),Xt(h),ND(h,m)):(Xt(h),h.flags&=-16777217):(u.memoizedProps!==b&&ui(h),Xt(h),h.flags&=-16777217),null;case 27:Tt(h),m=dt.current;var S=h.type;if(u!==null&&h.stateNode!=null)u.memoizedProps!==b&&ui(h);else{if(!b){if(h.stateNode===null)throw Error(s(166));return Xt(h),null}u=We.current,Bf(h)?BA(h):(u=t3(S,b,m),h.stateNode=u,ui(h))}return Xt(h),null;case 5:if(Tt(h),m=h.type,u!==null&&h.stateNode!=null)u.memoizedProps!==b&&ui(h);else{if(!b){if(h.stateNode===null)throw Error(s(166));return Xt(h),null}if(u=We.current,Bf(h))BA(h);else{switch(S=$0(dt.current),u){case 1:u=S.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:u=S.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":u=S.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":u=S.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":u=S.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild);break;case"select":u=typeof b.is=="string"?S.createElement("select",{is:b.is}):S.createElement("select"),b.multiple?u.multiple=!0:b.size&&(u.size=b.size);break;default:u=typeof b.is=="string"?S.createElement(m,{is:b.is}):S.createElement(m)}}u[is]=h,u[Ls]=b;e:for(S=h.child;S!==null;){if(S.tag===5||S.tag===6)u.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===h)break e;for(;S.sibling===null;){if(S.return===null||S.return===h)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}h.stateNode=u;e:switch(ts(u,m,b),m){case"button":case"input":case"select":case"textarea":u=!!b.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&ui(h)}}return Xt(h),h.flags&=-16777217,null;case 6:if(u&&h.stateNode!=null)u.memoizedProps!==b&&ui(h);else{if(typeof b!="string"&&h.stateNode===null)throw Error(s(166));if(u=dt.current,Bf(h)){if(u=h.stateNode,m=h.memoizedProps,b=null,S=Cs,S!==null)switch(S.tag){case 27:case 5:b=S.memoizedProps}u[is]=h,u=!!(u.nodeValue===m||b!==null&&b.suppressHydrationWarning===!0||KD(u.nodeValue,m)),u||pl(h)}else u=$0(u).createTextNode(b),u[is]=h,h.stateNode=u}return Xt(h),null;case 13:if(b=h.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(S=Bf(h),b!==null&&b.dehydrated!==null){if(u===null){if(!S)throw Error(s(318));if(S=h.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(s(317));S[is]=h}else Vf(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Xt(h),S=!1}else Kr!==null&&(d2(Kr),Kr=null),S=!0;if(!S)return h.flags&256?(ti(h),h):(ti(h),null)}if(ti(h),(h.flags&128)!==0)return h.lanes=m,h;if(m=b!==null,u=u!==null&&u.memoizedState!==null,m){b=h.child,S=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(S=b.alternate.memoizedState.cachePool.pool);var k=null;b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(k=b.memoizedState.cachePool.pool),k!==S&&(b.flags|=2048)}return m!==u&&m&&(h.child.flags|=8192),y0(h,h.updateQueue),Xt(h),null;case 4:return pt(),u===null&&C2(h.stateNode.containerInfo),Xt(h),null;case 10:return ai(h.type),Xt(h),null;case 19:if(Ae($n),S=h.memoizedState,S===null)return Xt(h),null;if(b=(h.flags&128)!==0,k=S.rendering,k===null)if(b)od(S,!1);else{if(nn!==0||u!==null&&(u.flags&128)!==0)for(u=h.child;u!==null;){if(k=e0(u),k!==null){for(h.flags|=128,od(S,!1),u=k.updateQueue,h.updateQueue=u,y0(h,u),h.subtreeFlags=0,u=m,m=h.child;m!==null;)TD(m,u),m=m.sibling;return De($n,$n.current&1|2),h.child}u=u.sibling}S.tail!==null&&en()>b0&&(h.flags|=128,b=!0,od(S,!1),h.lanes=4194304)}else{if(!b)if(u=e0(k),u!==null){if(h.flags|=128,b=!0,u=u.updateQueue,h.updateQueue=u,y0(h,u),od(S,!0),S.tail===null&&S.tailMode==="hidden"&&!k.alternate&&!wt)return Xt(h),null}else 2*en()-S.renderingStartTime>b0&&m!==536870912&&(h.flags|=128,b=!0,od(S,!1),h.lanes=4194304);S.isBackwards?(k.sibling=h.child,h.child=k):(u=S.last,u!==null?u.sibling=k:h.child=k,S.last=k)}return S.tail!==null?(h=S.tail,S.rendering=h,S.tail=h.sibling,S.renderingStartTime=en(),h.sibling=null,u=$n.current,De($n,b?u&1|2:u&1),h):(Xt(h),null);case 22:case 23:return ti(h),fw(),b=h.memoizedState!==null,u!==null?u.memoizedState!==null!==b&&(h.flags|=8192):b&&(h.flags|=8192),b?(m&536870912)!==0&&(h.flags&128)===0&&(Xt(h),h.subtreeFlags&6&&(h.flags|=8192)):Xt(h),m=h.updateQueue,m!==null&&y0(h,m.retryQueue),m=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),b=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(b=h.memoizedState.cachePool.pool),b!==m&&(h.flags|=2048),u!==null&&Ae(gl),null;case 24:return m=null,u!==null&&(m=u.memoizedState.cache),h.memoizedState.cache!==m&&(h.flags|=2048),ai(In),Xt(h),null;case 25:return null}throw Error(s(156,h.tag))}function J7(u,h){switch(lw(h),h.tag){case 1:return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 3:return ai(In),pt(),u=h.flags,(u&65536)!==0&&(u&128)===0?(h.flags=u&-65537|128,h):null;case 26:case 27:case 5:return Tt(h),null;case 13:if(ti(h),u=h.memoizedState,u!==null&&u.dehydrated!==null){if(h.alternate===null)throw Error(s(340));Vf()}return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 19:return Ae($n),null;case 4:return pt(),null;case 10:return ai(h.type),null;case 22:case 23:return ti(h),fw(),u!==null&&Ae(gl),u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 24:return ai(In),null;case 25:return null;default:return null}}function kD(u,h){switch(lw(h),h.tag){case 3:ai(In),pt();break;case 26:case 27:case 5:Tt(h);break;case 4:pt();break;case 13:ti(h);break;case 19:Ae($n);break;case 10:ai(h.type);break;case 22:case 23:ti(h),fw(),u!==null&&Ae(gl);break;case 24:ai(In)}}var eW={getCacheForType:function(u){var h=os(In),m=h.data.get(u);return m===void 0&&(m=u(),h.data.set(u,m)),m}},tW=typeof WeakMap=="function"?WeakMap:Map,Kt=0,Mt=null,lt=null,bt=0,zt=0,sr=null,ci=!1,cc=!1,i2=!1,hi=0,nn=0,ho=0,Nl=0,o2=0,Dr=0,hc=0,ld=null,Ta=null,l2=!1,u2=0,b0=1/0,x0=null,fo=null,v0=!1,kl=null,ud=0,c2=0,h2=null,cd=0,f2=null;function rr(){if((Kt&2)!==0&&bt!==0)return bt&-bt;if(A.T!==null){var u=nc;return u!==0?u:v2()}return qI()}function ED(){Dr===0&&(Dr=(bt&536870912)===0||wt?UI():536870912);var u=$r.current;return u!==null&&(u.flags|=32),Dr}function Ns(u,h,m){(u===Mt&&zt===2||u.cancelPendingCommit!==null)&&(fc(u,0),fi(u,bt,Dr,!1)),$f(u,m),((Kt&2)===0||u!==Mt)&&(u===Mt&&((Kt&2)===0&&(Nl|=m),nn===4&&fi(u,bt,Dr,!1)),Ca(u))}function $D(u,h,m){if((Kt&6)!==0)throw Error(s(327));var b=!m&&(h&60)===0&&(h&u.expiredLanes)===0||Ef(u,h),S=b?rW(u,h):g2(u,h,!0),k=b;do{if(S===0){cc&&!b&&fi(u,h,0,!1);break}else if(S===6)fi(u,h,0,!ci);else{if(m=u.current.alternate,k&&!nW(m)){S=g2(u,h,!1),k=!1;continue}if(S===2){if(k=h,u.errorRecoveryDisabledLanes&k)var F=0;else F=u.pendingLanes&-536870913,F=F!==0?F:F&536870912?536870912:0;if(F!==0){h=F;e:{var P=u;S=ld;var G=P.current.memoizedState.isDehydrated;if(G&&(fc(P,F).flags|=256),F=g2(P,F,!1),F!==2){if(i2&&!G){P.errorRecoveryDisabledLanes|=k,Nl|=k,S=4;break e}k=Ta,Ta=S,k!==null&&d2(k)}S=F}if(k=!1,S!==2)continue}}if(S===1){fc(u,0),fi(u,h,0,!0);break}e:{switch(b=u,S){case 0:case 1:throw Error(s(345));case 4:if((h&4194176)===h){fi(b,h,Dr,!ci);break e}break;case 2:Ta=null;break;case 3:case 5:break;default:throw Error(s(329))}if(b.finishedWork=m,b.finishedLanes=h,(h&62914560)===h&&(k=u2+300-en(),10<k)){if(fi(b,h,Dr,!ci),Og(b,0)!==0)break e;b.timeoutHandle=QD(ID.bind(null,b,m,Ta,x0,l2,h,Dr,Nl,hc,ci,2,-0,0),k);break e}ID(b,m,Ta,x0,l2,h,Dr,Nl,hc,ci,0,-0,0)}}break}while(!0);Ca(u)}function d2(u){Ta===null?Ta=u:Ta.push.apply(Ta,u)}function ID(u,h,m,b,S,k,F,P,G,se,ye,Te,fe){var ge=h.subtreeFlags;if((ge&8192||(ge&16785408)===16785408)&&(gd={stylesheets:null,count:0,unsuspend:MW},xD(h),h=PW(),h!==null)){u.cancelPendingCommit=h(LD.bind(null,u,m,b,S,F,P,G,1,Te,fe)),fi(u,k,F,!se);return}LD(u,m,b,S,F,P,G,ye,Te,fe)}function nW(u){for(var h=u;;){var m=h.tag;if((m===0||m===11||m===15)&&h.flags&16384&&(m=h.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var b=0;b<m.length;b++){var S=m[b],k=S.getSnapshot;S=S.value;try{if(!er(k(),S))return!1}catch{return!1}}if(m=h.child,h.subtreeFlags&16384&&m!==null)m.return=h,h=m;else{if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function fi(u,h,m,b){h&=~o2,h&=~Nl,u.suspendedLanes|=h,u.pingedLanes&=~h,b&&(u.warmLanes|=h),b=u.expirationTimes;for(var S=h;0<S;){var k=31-Js(S),F=1<<k;b[k]=-1,S&=~F}m!==0&&WI(u,m,h)}function w0(){return(Kt&6)===0?(hd(0),!1):!0}function p2(){if(lt!==null){if(zt===0)var u=lt.return;else u=lt,ri=wl=null,vw(u),ec=null,Gf=0,u=lt;for(;u!==null;)kD(u.alternate,u),u=u.return;lt=null}}function fc(u,h){u.finishedWork=null,u.finishedLanes=0;var m=u.timeoutHandle;m!==-1&&(u.timeoutHandle=-1,wW(m)),m=u.cancelPendingCommit,m!==null&&(u.cancelPendingCommit=null,m()),p2(),Mt=u,lt=m=co(u.current,null),bt=h,zt=0,sr=null,ci=!1,cc=Ef(u,h),i2=!1,hc=Dr=o2=Nl=ho=nn=0,Ta=ld=null,l2=!1,(h&8)!==0&&(h|=h&32);var b=u.entangledLanes;if(b!==0)for(u=u.entanglements,b&=h;0<b;){var S=31-Js(b),k=1<<S;h|=u[S],b&=~k}return hi=h,Gg(),m}function AD(u,h){rt=null,A.H=Sa,h===jf?(h=GA(),zt=3):h===UA?(h=GA(),zt=4):zt=h===jR?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,sr=h,lt===null&&(nn=1,h0(u,Nr(h,u.current)))}function RD(){var u=A.H;return A.H=Sa,u===null?Sa:u}function DD(){var u=A.A;return A.A=eW,u}function m2(){nn=4,ci||(bt&4194176)!==bt&&$r.current!==null||(cc=!0),(ho&134217727)===0&&(Nl&134217727)===0||Mt===null||fi(Mt,bt,Dr,!1)}function g2(u,h,m){var b=Kt;Kt|=2;var S=RD(),k=DD();(Mt!==u||bt!==h)&&(x0=null,fc(u,h)),h=!1;var F=nn;e:do try{if(zt!==0&&lt!==null){var P=lt,G=sr;switch(zt){case 8:p2(),F=6;break e;case 3:case 2:case 6:$r.current===null&&(h=!0);var se=zt;if(zt=0,sr=null,dc(u,P,G,se),m&&cc){F=0;break e}break;default:se=zt,zt=0,sr=null,dc(u,P,G,se)}}sW(),F=nn;break}catch(ye){AD(u,ye)}while(!0);return h&&u.shellSuspendCounter++,ri=wl=null,Kt=b,A.H=S,A.A=k,lt===null&&(Mt=null,bt=0,Gg()),F}function sW(){for(;lt!==null;)OD(lt)}function rW(u,h){var m=Kt;Kt|=2;var b=RD(),S=DD();Mt!==u||bt!==h?(x0=null,b0=en()+500,fc(u,h)):cc=Ef(u,h);e:do try{if(zt!==0&&lt!==null){h=lt;var k=sr;t:switch(zt){case 1:zt=0,sr=null,dc(u,h,k,1);break;case 2:if(jA(k)){zt=0,sr=null,_D(h);break}h=function(){zt===2&&Mt===u&&(zt=7),Ca(u)},k.then(h,h);break e;case 3:zt=7;break e;case 4:zt=5;break e;case 7:jA(k)?(zt=0,sr=null,_D(h)):(zt=0,sr=null,dc(u,h,k,7));break;case 5:var F=null;switch(lt.tag){case 26:F=lt.memoizedState;case 5:case 27:var P=lt;if(!F||u3(F)){zt=0,sr=null;var G=P.sibling;if(G!==null)lt=G;else{var se=P.return;se!==null?(lt=se,S0(se)):lt=null}break t}}zt=0,sr=null,dc(u,h,k,5);break;case 6:zt=0,sr=null,dc(u,h,k,6);break;case 8:p2(),nn=6;break e;default:throw Error(s(462))}}aW();break}catch(ye){AD(u,ye)}while(!0);return ri=wl=null,A.H=b,A.A=S,Kt=m,lt!==null?0:(Mt=null,bt=0,Gg(),nn)}function aW(){for(;lt!==null&&!Ss();)OD(lt)}function OD(u){var h=tD(u.alternate,u,hi);u.memoizedProps=u.pendingProps,h===null?S0(u):lt=h}function _D(u){var h=u,m=h.alternate;switch(h.tag){case 15:case 0:h=KR(m,h,h.pendingProps,h.type,void 0,bt);break;case 11:h=KR(m,h,h.pendingProps,h.type.render,h.ref,bt);break;case 5:vw(h);default:kD(m,h),h=lt=TD(h,hi),h=tD(m,h,hi)}u.memoizedProps=u.pendingProps,h===null?S0(u):lt=h}function dc(u,h,m,b){ri=wl=null,vw(h),ec=null,Gf=0;var S=h.return;try{if(q7(u,S,h,m,bt)){nn=1,h0(u,Nr(m,u.current)),lt=null;return}}catch(k){if(S!==null)throw lt=S,k;nn=1,h0(u,Nr(m,u.current)),lt=null;return}h.flags&32768?(wt||b===1?u=!0:cc||(bt&536870912)!==0?u=!1:(ci=u=!0,(b===2||b===3||b===6)&&(b=$r.current,b!==null&&b.tag===13&&(b.flags|=16384))),FD(h,u)):S0(h)}function S0(u){var h=u;do{if((h.flags&32768)!==0){FD(h,ci);return}u=h.return;var m=Q7(h.alternate,h,hi);if(m!==null){lt=m;return}if(h=h.sibling,h!==null){lt=h;return}lt=h=u}while(h!==null);nn===0&&(nn=5)}function FD(u,h){do{var m=J7(u.alternate,u);if(m!==null){m.flags&=32767,lt=m;return}if(m=u.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!h&&(u=u.sibling,u!==null)){lt=u;return}lt=u=m}while(u!==null);nn=6,lt=null}function LD(u,h,m,b,S,k,F,P,G,se){var ye=A.T,Te=he.p;try{he.p=2,A.T=null,iW(u,h,m,b,Te,S,k,F,P,G,se)}finally{A.T=ye,he.p=Te}}function iW(u,h,m,b,S,k,F,P){do pc();while(kl!==null);if((Kt&6)!==0)throw Error(s(327));var G=u.finishedWork;if(b=u.finishedLanes,G===null)return null;if(u.finishedWork=null,u.finishedLanes=0,G===u.current)throw Error(s(177));u.callbackNode=null,u.callbackPriority=0,u.cancelPendingCommit=null;var se=G.lanes|G.childLanes;if(se|=aw,zj(u,b,se,k,F,P),u===Mt&&(lt=Mt=null,bt=0),(G.subtreeFlags&10256)===0&&(G.flags&10256)===0||v0||(v0=!0,c2=se,h2=m,cW(Qs,function(){return pc(),null})),m=(G.flags&15990)!==0,(G.subtreeFlags&15990)!==0||m?(m=A.T,A.T=null,k=he.p,he.p=2,F=Kt,Kt|=4,K7(u,G),gD(G,u),A7($2,u.containerInfo),_0=!!E2,$2=E2=null,u.current=G,fD(u,G.alternate,G),Ya(),Kt=F,he.p=k,A.T=m):u.current=G,v0?(v0=!1,kl=u,ud=b):MD(u,se),se=u.pendingLanes,se===0&&(fo=null),Lv(G.stateNode),Ca(u),h!==null)for(S=u.onRecoverableError,G=0;G<h.length;G++)se=h[G],S(se.value,{componentStack:se.stack});return(ud&3)!==0&&pc(),se=u.pendingLanes,(b&4194218)!==0&&(se&42)!==0?u===f2?cd++:(cd=0,f2=u):cd=0,hd(0),null}function MD(u,h){(u.pooledCacheLanes&=h)===0&&(h=u.pooledCache,h!=null&&(u.pooledCache=null,qf(h)))}function pc(){if(kl!==null){var u=kl,h=c2;c2=0;var m=HI(ud),b=A.T,S=he.p;try{if(he.p=32>m?32:m,A.T=null,kl===null)var k=!1;else{m=h2,h2=null;var F=kl,P=ud;if(kl=null,ud=0,(Kt&6)!==0)throw Error(s(331));var G=Kt;if(Kt|=4,wD(F.current),bD(F,F.current,P,m),Kt=G,hd(0,!1),Ts&&typeof Ts.onPostCommitFiberRoot=="function")try{Ts.onPostCommitFiberRoot(xa,F)}catch{}k=!0}return k}finally{he.p=S,A.T=b,MD(u,h)}}return!1}function zD(u,h,m){h=Nr(m,h),h=_w(u.stateNode,h,2),u=io(u,h,2),u!==null&&($f(u,2),Ca(u))}function Ot(u,h,m){if(u.tag===3)zD(u,u,m);else for(;h!==null;){if(h.tag===3){zD(h,u,m);break}else if(h.tag===1){var b=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(fo===null||!fo.has(b))){u=Nr(m,u),m=VR(2),b=io(h,m,2),b!==null&&(UR(m,b,h,u),$f(b,2),Ca(b));break}}h=h.return}}function y2(u,h,m){var b=u.pingCache;if(b===null){b=u.pingCache=new tW;var S=new Set;b.set(h,S)}else S=b.get(h),S===void 0&&(S=new Set,b.set(h,S));S.has(m)||(i2=!0,S.add(m),u=oW.bind(null,u,h,m),h.then(u,u))}function oW(u,h,m){var b=u.pingCache;b!==null&&b.delete(h),u.pingedLanes|=u.suspendedLanes&m,u.warmLanes&=~m,Mt===u&&(bt&m)===m&&(nn===4||nn===3&&(bt&62914560)===bt&&300>en()-u2?(Kt&2)===0&&fc(u,0):o2|=m,hc===bt&&(hc=0)),Ca(u)}function PD(u,h){h===0&&(h=jI()),u=Qi(u,h),u!==null&&($f(u,h),Ca(u))}function lW(u){var h=u.memoizedState,m=0;h!==null&&(m=h.retryLane),PD(u,m)}function uW(u,h){var m=0;switch(u.tag){case 13:var b=u.stateNode,S=u.memoizedState;S!==null&&(m=S.retryLane);break;case 19:b=u.stateNode;break;case 22:b=u.stateNode._retryCache;break;default:throw Error(s(314))}b!==null&&b.delete(h),PD(u,m)}function cW(u,h){return Jt(u,h)}var T0=null,mc=null,b2=!1,C0=!1,x2=!1,El=0;function Ca(u){u!==mc&&u.next===null&&(mc===null?T0=mc=u:mc=mc.next=u),C0=!0,b2||(b2=!0,fW(hW))}function hd(u,h){if(!x2&&C0){x2=!0;do for(var m=!1,b=T0;b!==null;){if(u!==0){var S=b.pendingLanes;if(S===0)var k=0;else{var F=b.suspendedLanes,P=b.pingedLanes;k=(1<<31-Js(42|u)+1)-1,k&=S&~(F&~P),k=k&201326677?k&201326677|1:k?k|2:0}k!==0&&(m=!0,UD(b,k))}else k=bt,k=Og(b,b===Mt?k:0),(k&3)===0||Ef(b,k)||(m=!0,UD(b,k));b=b.next}while(m);x2=!1}}function hW(){C0=b2=!1;var u=0;El!==0&&(vW()&&(u=El),El=0);for(var h=en(),m=null,b=T0;b!==null;){var S=b.next,k=BD(b,h);k===0?(b.next=null,m===null?T0=S:m.next=S,S===null&&(mc=m)):(m=b,(u!==0||(k&3)!==0)&&(C0=!0)),b=S}hd(u)}function BD(u,h){for(var m=u.suspendedLanes,b=u.pingedLanes,S=u.expirationTimes,k=u.pendingLanes&-62914561;0<k;){var F=31-Js(k),P=1<<F,G=S[F];G===-1?((P&m)===0||(P&b)!==0)&&(S[F]=Mj(P,h)):G<=h&&(u.expiredLanes|=P),k&=~P}if(h=Mt,m=bt,m=Og(u,u===h?m:0),b=u.callbackNode,m===0||u===h&&zt===2||u.cancelPendingCommit!==null)return b!==null&&b!==null&&wr(b),u.callbackNode=null,u.callbackPriority=0;if((m&3)===0||Ef(u,m)){if(h=m&-m,h===u.callbackPriority)return h;switch(b!==null&&wr(b),HI(m)){case 2:case 8:m=qr;break;case 32:m=Qs;break;case 268435456:m=zu;break;default:m=Qs}return b=VD.bind(null,u),m=Jt(m,b),u.callbackPriority=h,u.callbackNode=m,h}return b!==null&&b!==null&&wr(b),u.callbackPriority=2,u.callbackNode=null,2}function VD(u,h){var m=u.callbackNode;if(pc()&&u.callbackNode!==m)return null;var b=bt;return b=Og(u,u===Mt?b:0),b===0?null:($D(u,b,h),BD(u,en()),u.callbackNode!=null&&u.callbackNode===m?VD.bind(null,u):null)}function UD(u,h){if(pc())return null;$D(u,h,!0)}function fW(u){SW(function(){(Kt&6)!==0?Jt(Hr,u):u()})}function v2(){return El===0&&(El=UI()),El}function jD(u){return u==null||typeof u=="symbol"||typeof u=="boolean"?null:typeof u=="function"?u:zg(""+u)}function WD(u,h){var m=h.ownerDocument.createElement("input");return m.name=h.name,m.value=h.value,u.id&&m.setAttribute("form",u.id),h.parentNode.insertBefore(m,h),u=new FormData(u),m.parentNode.removeChild(m),u}function dW(u,h,m,b,S){if(h==="submit"&&m&&m.stateNode===S){var k=jD((S[Ls]||null).action),F=b.submitter;F&&(h=(h=F[Ls]||null)?jD(h.formAction):F.getAttribute("formAction"),h!==null&&(k=h,F=null));var P=new Ug("action","action",null,b,S);u.push({event:P,listeners:[{instance:null,listener:function(){if(b.defaultPrevented){if(El!==0){var G=F?WD(S,F):new FormData(S);Iw(m,{pending:!0,data:G,method:S.method,action:k},null,G)}}else typeof k=="function"&&(P.preventDefault(),G=F?WD(S,F):new FormData(S),Iw(m,{pending:!0,data:G,method:S.method,action:k},k,G))},currentTarget:S}]})}}for(var w2=0;w2<LA.length;w2++){var S2=LA[w2],pW=S2.toLowerCase(),mW=S2[0].toUpperCase()+S2.slice(1);Xr(pW,"on"+mW)}Xr(RA,"onAnimationEnd"),Xr(DA,"onAnimationIteration"),Xr(OA,"onAnimationStart"),Xr("dblclick","onDoubleClick"),Xr("focusin","onFocus"),Xr("focusout","onBlur"),Xr(D7,"onTransitionRun"),Xr(O7,"onTransitionStart"),Xr(_7,"onTransitionCancel"),Xr(_A,"onTransitionEnd"),Uu("onMouseEnter",["mouseout","mouseover"]),Uu("onMouseLeave",["mouseout","mouseover"]),Uu("onPointerEnter",["pointerout","pointerover"]),Uu("onPointerLeave",["pointerout","pointerover"]),ll("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ll("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ll("onBeforeInput",["compositionend","keypress","textInput","paste"]),ll("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ll("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ll("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gW=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fd));function GD(u,h){h=(h&4)!==0;for(var m=0;m<u.length;m++){var b=u[m],S=b.event;b=b.listeners;e:{var k=void 0;if(h)for(var F=b.length-1;0<=F;F--){var P=b[F],G=P.instance,se=P.currentTarget;if(P=P.listener,G!==k&&S.isPropagationStopped())break e;k=P,S.currentTarget=se;try{k(S)}catch(ye){c0(ye)}S.currentTarget=null,k=G}else for(F=0;F<b.length;F++){if(P=b[F],G=P.instance,se=P.currentTarget,P=P.listener,G!==k&&S.isPropagationStopped())break e;k=P,S.currentTarget=se;try{k(S)}catch(ye){c0(ye)}S.currentTarget=null,k=G}}}}function mt(u,h){var m=h[zv];m===void 0&&(m=h[zv]=new Set);var b=u+"__bubble";m.has(b)||(HD(h,u,2,!1),m.add(b))}function T2(u,h,m){var b=0;h&&(b|=4),HD(m,u,b,h)}var N0="_reactListening"+Math.random().toString(36).slice(2);function C2(u){if(!u[N0]){u[N0]=!0,KI.forEach(function(m){m!=="selectionchange"&&(gW.has(m)||T2(m,!1,u),T2(m,!0,u))});var h=u.nodeType===9?u:u.ownerDocument;h===null||h[N0]||(h[N0]=!0,T2("selectionchange",!1,h))}}function HD(u,h,m,b){switch(m3(h)){case 2:var S=UW;break;case 8:S=jW;break;default:S=M2}m=S.bind(null,h,m,u),S=void 0,!Hv||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(S=!0),b?S!==void 0?u.addEventListener(h,m,{capture:!0,passive:S}):u.addEventListener(h,m,!0):S!==void 0?u.addEventListener(h,m,{passive:S}):u.addEventListener(h,m,!1)}function N2(u,h,m,b,S){var k=b;if((h&1)===0&&(h&2)===0&&b!==null)e:for(;;){if(b===null)return;var F=b.tag;if(F===3||F===4){var P=b.stateNode.containerInfo;if(P===S||P.nodeType===8&&P.parentNode===S)break;if(F===4)for(F=b.return;F!==null;){var G=F.tag;if((G===3||G===4)&&(G=F.stateNode.containerInfo,G===S||G.nodeType===8&&G.parentNode===S))return;F=F.return}for(;P!==null;){if(F=ol(P),F===null)return;if(G=F.tag,G===5||G===6||G===26||G===27){b=k=F;continue e}P=P.parentNode}}b=b.return}oA(function(){var se=k,ye=Wv(m),Te=[];e:{var fe=FA.get(u);if(fe!==void 0){var ge=Ug,ze=u;switch(u){case"keypress":if(Bg(m)===0)break e;case"keydown":case"keyup":ge=u7;break;case"focusin":ze="focus",ge=Yv;break;case"focusout":ze="blur",ge=Yv;break;case"beforeblur":case"afterblur":ge=Yv;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=cA;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=Zj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=f7;break;case RA:case DA:case OA:ge=e7;break;case _A:ge=p7;break;case"scroll":case"scrollend":ge=Kj;break;case"wheel":ge=g7;break;case"copy":case"cut":case"paste":ge=n7;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=fA;break;case"toggle":case"beforetoggle":ge=b7}var Ye=(h&4)!==0,sn=!Ye&&(u==="scroll"||u==="scrollend"),oe=Ye?fe!==null?fe+"Capture":null:fe;Ye=[];for(var ne=se,le;ne!==null;){var xe=ne;if(le=xe.stateNode,xe=xe.tag,xe!==5&&xe!==26&&xe!==27||le===null||oe===null||(xe=Rf(ne,oe),xe!=null&&Ye.push(dd(ne,xe,le))),sn)break;ne=ne.return}0<Ye.length&&(fe=new ge(fe,ze,null,m,ye),Te.push({event:fe,listeners:Ye}))}}if((h&7)===0){e:{if(fe=u==="mouseover"||u==="pointerover",ge=u==="mouseout"||u==="pointerout",fe&&m!==jv&&(ze=m.relatedTarget||m.fromElement)&&(ol(ze)||ze[Pu]))break e;if((ge||fe)&&(fe=ye.window===ye?ye:(fe=ye.ownerDocument)?fe.defaultView||fe.parentWindow:window,ge?(ze=m.relatedTarget||m.toElement,ge=se,ze=ze?ol(ze):null,ze!==null&&(sn=Q(ze),Ye=ze.tag,ze!==sn||Ye!==5&&Ye!==27&&Ye!==6)&&(ze=null)):(ge=null,ze=se),ge!==ze)){if(Ye=cA,xe="onMouseLeave",oe="onMouseEnter",ne="mouse",(u==="pointerout"||u==="pointerover")&&(Ye=fA,xe="onPointerLeave",oe="onPointerEnter",ne="pointer"),sn=ge==null?fe:Af(ge),le=ze==null?fe:Af(ze),fe=new Ye(xe,ne+"leave",ge,m,ye),fe.target=sn,fe.relatedTarget=le,xe=null,ol(ye)===se&&(Ye=new Ye(oe,ne+"enter",ze,m,ye),Ye.target=le,Ye.relatedTarget=sn,xe=Ye),sn=xe,ge&&ze)t:{for(Ye=ge,oe=ze,ne=0,le=Ye;le;le=gc(le))ne++;for(le=0,xe=oe;xe;xe=gc(xe))le++;for(;0<ne-le;)Ye=gc(Ye),ne--;for(;0<le-ne;)oe=gc(oe),le--;for(;ne--;){if(Ye===oe||oe!==null&&Ye===oe.alternate)break t;Ye=gc(Ye),oe=gc(oe)}Ye=null}else Ye=null;ge!==null&&qD(Te,fe,ge,Ye,!1),ze!==null&&sn!==null&&qD(Te,sn,ze,Ye,!0)}}e:{if(fe=se?Af(se):window,ge=fe.nodeName&&fe.nodeName.toLowerCase(),ge==="select"||ge==="input"&&fe.type==="file")var Fe=vA;else if(bA(fe))if(wA)Fe=$7;else{Fe=k7;var it=N7}else ge=fe.nodeName,!ge||ge.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?se&&Uv(se.elementType)&&(Fe=vA):Fe=E7;if(Fe&&(Fe=Fe(u,se))){xA(Te,Fe,m,ye);break e}it&&it(u,fe,se),u==="focusout"&&se&&fe.type==="number"&&se.memoizedProps.value!=null&&Vv(fe,"number",fe.value)}switch(it=se?Af(se):window,u){case"focusin":(bA(it)||it.contentEditable==="true")&&(Xu=it,nw=se,Pf=null);break;case"focusout":Pf=nw=Xu=null;break;case"mousedown":sw=!0;break;case"contextmenu":case"mouseup":case"dragend":sw=!1,IA(Te,m,ye);break;case"selectionchange":if(R7)break;case"keydown":case"keyup":IA(Te,m,ye)}var Ue;if(Qv)e:{switch(u){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else qu?gA(u,m)&&(Ge="onCompositionEnd"):u==="keydown"&&m.keyCode===229&&(Ge="onCompositionStart");Ge&&(dA&&m.locale!=="ko"&&(qu||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&qu&&(Ue=lA()):(Zi=ye,qv="value"in Zi?Zi.value:Zi.textContent,qu=!0)),it=k0(se,Ge),0<it.length&&(Ge=new hA(Ge,u,null,m,ye),Te.push({event:Ge,listeners:it}),Ue?Ge.data=Ue:(Ue=yA(m),Ue!==null&&(Ge.data=Ue)))),(Ue=v7?w7(u,m):S7(u,m))&&(Ge=k0(se,"onBeforeInput"),0<Ge.length&&(it=new hA("onBeforeInput","beforeinput",null,m,ye),Te.push({event:it,listeners:Ge}),it.data=Ue)),dW(Te,u,se,m,ye)}GD(Te,h)})}function dd(u,h,m){return{instance:u,listener:h,currentTarget:m}}function k0(u,h){for(var m=h+"Capture",b=[];u!==null;){var S=u,k=S.stateNode;S=S.tag,S!==5&&S!==26&&S!==27||k===null||(S=Rf(u,m),S!=null&&b.unshift(dd(u,S,k)),S=Rf(u,h),S!=null&&b.push(dd(u,S,k))),u=u.return}return b}function gc(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5&&u.tag!==27);return u||null}function qD(u,h,m,b,S){for(var k=h._reactName,F=[];m!==null&&m!==b;){var P=m,G=P.alternate,se=P.stateNode;if(P=P.tag,G!==null&&G===b)break;P!==5&&P!==26&&P!==27||se===null||(G=se,S?(se=Rf(m,k),se!=null&&F.unshift(dd(m,se,G))):S||(se=Rf(m,k),se!=null&&F.push(dd(m,se,G)))),m=m.return}F.length!==0&&u.push({event:h,listeners:F})}var yW=/\r\n?/g,bW=/\u0000|\uFFFD/g;function XD(u){return(typeof u=="string"?u:""+u).replace(yW,`
`).replace(bW,"")}function KD(u,h){return h=XD(h),XD(u)===h}function E0(){}function Rt(u,h,m,b,S,k){switch(m){case"children":typeof b=="string"?h==="body"||h==="textarea"&&b===""||Wu(u,b):(typeof b=="number"||typeof b=="bigint")&&h!=="body"&&Wu(u,""+b);break;case"className":Fg(u,"class",b);break;case"tabIndex":Fg(u,"tabindex",b);break;case"dir":case"role":case"viewBox":case"width":case"height":Fg(u,m,b);break;case"style":aA(u,b,k);break;case"data":if(h!=="object"){Fg(u,"data",b);break}case"src":case"href":if(b===""&&(h!=="a"||m!=="href")){u.removeAttribute(m);break}if(b==null||typeof b=="function"||typeof b=="symbol"||typeof b=="boolean"){u.removeAttribute(m);break}b=zg(""+b),u.setAttribute(m,b);break;case"action":case"formAction":if(typeof b=="function"){u.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof k=="function"&&(m==="formAction"?(h!=="input"&&Rt(u,h,"name",S.name,S,null),Rt(u,h,"formEncType",S.formEncType,S,null),Rt(u,h,"formMethod",S.formMethod,S,null),Rt(u,h,"formTarget",S.formTarget,S,null)):(Rt(u,h,"encType",S.encType,S,null),Rt(u,h,"method",S.method,S,null),Rt(u,h,"target",S.target,S,null)));if(b==null||typeof b=="symbol"||typeof b=="boolean"){u.removeAttribute(m);break}b=zg(""+b),u.setAttribute(m,b);break;case"onClick":b!=null&&(u.onclick=E0);break;case"onScroll":b!=null&&mt("scroll",u);break;case"onScrollEnd":b!=null&&mt("scrollend",u);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(s(61));if(m=b.__html,m!=null){if(S.children!=null)throw Error(s(60));u.innerHTML=m}}break;case"multiple":u.multiple=b&&typeof b!="function"&&typeof b!="symbol";break;case"muted":u.muted=b&&typeof b!="function"&&typeof b!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(b==null||typeof b=="function"||typeof b=="boolean"||typeof b=="symbol"){u.removeAttribute("xlink:href");break}m=zg(""+b),u.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":b!=null&&typeof b!="function"&&typeof b!="symbol"?u.setAttribute(m,""+b):u.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":b&&typeof b!="function"&&typeof b!="symbol"?u.setAttribute(m,""):u.removeAttribute(m);break;case"capture":case"download":b===!0?u.setAttribute(m,""):b!==!1&&b!=null&&typeof b!="function"&&typeof b!="symbol"?u.setAttribute(m,b):u.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":b!=null&&typeof b!="function"&&typeof b!="symbol"&&!isNaN(b)&&1<=b?u.setAttribute(m,b):u.removeAttribute(m);break;case"rowSpan":case"start":b==null||typeof b=="function"||typeof b=="symbol"||isNaN(b)?u.removeAttribute(m):u.setAttribute(m,b);break;case"popover":mt("beforetoggle",u),mt("toggle",u),_g(u,"popover",b);break;case"xlinkActuate":Qa(u,"http://www.w3.org/1999/xlink","xlink:actuate",b);break;case"xlinkArcrole":Qa(u,"http://www.w3.org/1999/xlink","xlink:arcrole",b);break;case"xlinkRole":Qa(u,"http://www.w3.org/1999/xlink","xlink:role",b);break;case"xlinkShow":Qa(u,"http://www.w3.org/1999/xlink","xlink:show",b);break;case"xlinkTitle":Qa(u,"http://www.w3.org/1999/xlink","xlink:title",b);break;case"xlinkType":Qa(u,"http://www.w3.org/1999/xlink","xlink:type",b);break;case"xmlBase":Qa(u,"http://www.w3.org/XML/1998/namespace","xml:base",b);break;case"xmlLang":Qa(u,"http://www.w3.org/XML/1998/namespace","xml:lang",b);break;case"xmlSpace":Qa(u,"http://www.w3.org/XML/1998/namespace","xml:space",b);break;case"is":_g(u,"is",b);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=qj.get(m)||m,_g(u,m,b))}}function k2(u,h,m,b,S,k){switch(m){case"style":aA(u,b,k);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(s(61));if(m=b.__html,m!=null){if(S.children!=null)throw Error(s(60));u.innerHTML=m}}break;case"children":typeof b=="string"?Wu(u,b):(typeof b=="number"||typeof b=="bigint")&&Wu(u,""+b);break;case"onScroll":b!=null&&mt("scroll",u);break;case"onScrollEnd":b!=null&&mt("scrollend",u);break;case"onClick":b!=null&&(u.onclick=E0);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!YI.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(S=m.endsWith("Capture"),h=m.slice(2,S?m.length-7:void 0),k=u[Ls]||null,k=k!=null?k[m]:null,typeof k=="function"&&u.removeEventListener(h,k,S),typeof b=="function")){typeof k!="function"&&k!==null&&(m in u?u[m]=null:u.hasAttribute(m)&&u.removeAttribute(m)),u.addEventListener(h,b,S);break e}m in u?u[m]=b:b===!0?u.setAttribute(m,""):_g(u,m,b)}}}function ts(u,h,m){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":mt("error",u),mt("load",u);var b=!1,S=!1,k;for(k in m)if(m.hasOwnProperty(k)){var F=m[k];if(F!=null)switch(k){case"src":b=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,h));default:Rt(u,h,k,F,m,null)}}S&&Rt(u,h,"srcSet",m.srcSet,m,null),b&&Rt(u,h,"src",m.src,m,null);return;case"input":mt("invalid",u);var P=k=F=S=null,G=null,se=null;for(b in m)if(m.hasOwnProperty(b)){var ye=m[b];if(ye!=null)switch(b){case"name":S=ye;break;case"type":F=ye;break;case"checked":G=ye;break;case"defaultChecked":se=ye;break;case"value":k=ye;break;case"defaultValue":P=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(s(137,h));break;default:Rt(u,h,b,ye,m,null)}}tA(u,k,P,G,se,F,S,!1),Lg(u);return;case"select":mt("invalid",u),b=F=k=null;for(S in m)if(m.hasOwnProperty(S)&&(P=m[S],P!=null))switch(S){case"value":k=P;break;case"defaultValue":F=P;break;case"multiple":b=P;default:Rt(u,h,S,P,m,null)}h=k,m=F,u.multiple=!!b,h!=null?ju(u,!!b,h,!1):m!=null&&ju(u,!!b,m,!0);return;case"textarea":mt("invalid",u),k=S=b=null;for(F in m)if(m.hasOwnProperty(F)&&(P=m[F],P!=null))switch(F){case"value":b=P;break;case"defaultValue":S=P;break;case"children":k=P;break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(s(91));break;default:Rt(u,h,F,P,m,null)}sA(u,b,S,k),Lg(u);return;case"option":for(G in m)if(m.hasOwnProperty(G)&&(b=m[G],b!=null))switch(G){case"selected":u.selected=b&&typeof b!="function"&&typeof b!="symbol";break;default:Rt(u,h,G,b,m,null)}return;case"dialog":mt("cancel",u),mt("close",u);break;case"iframe":case"object":mt("load",u);break;case"video":case"audio":for(b=0;b<fd.length;b++)mt(fd[b],u);break;case"image":mt("error",u),mt("load",u);break;case"details":mt("toggle",u);break;case"embed":case"source":case"link":mt("error",u),mt("load",u);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in m)if(m.hasOwnProperty(se)&&(b=m[se],b!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,h));default:Rt(u,h,se,b,m,null)}return;default:if(Uv(h)){for(ye in m)m.hasOwnProperty(ye)&&(b=m[ye],b!==void 0&&k2(u,h,ye,b,m,void 0));return}}for(P in m)m.hasOwnProperty(P)&&(b=m[P],b!=null&&Rt(u,h,P,b,m,null))}function xW(u,h,m,b){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,k=null,F=null,P=null,G=null,se=null,ye=null;for(ge in m){var Te=m[ge];if(m.hasOwnProperty(ge)&&Te!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":G=Te;default:b.hasOwnProperty(ge)||Rt(u,h,ge,null,b,Te)}}for(var fe in b){var ge=b[fe];if(Te=m[fe],b.hasOwnProperty(fe)&&(ge!=null||Te!=null))switch(fe){case"type":k=ge;break;case"name":S=ge;break;case"checked":se=ge;break;case"defaultChecked":ye=ge;break;case"value":F=ge;break;case"defaultValue":P=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(s(137,h));break;default:ge!==Te&&Rt(u,h,fe,ge,b,Te)}}Bv(u,F,P,G,se,ye,k,S);return;case"select":ge=F=P=fe=null;for(k in m)if(G=m[k],m.hasOwnProperty(k)&&G!=null)switch(k){case"value":break;case"multiple":ge=G;default:b.hasOwnProperty(k)||Rt(u,h,k,null,b,G)}for(S in b)if(k=b[S],G=m[S],b.hasOwnProperty(S)&&(k!=null||G!=null))switch(S){case"value":fe=k;break;case"defaultValue":P=k;break;case"multiple":F=k;default:k!==G&&Rt(u,h,S,k,b,G)}h=P,m=F,b=ge,fe!=null?ju(u,!!m,fe,!1):!!b!=!!m&&(h!=null?ju(u,!!m,h,!0):ju(u,!!m,m?[]:"",!1));return;case"textarea":ge=fe=null;for(P in m)if(S=m[P],m.hasOwnProperty(P)&&S!=null&&!b.hasOwnProperty(P))switch(P){case"value":break;case"children":break;default:Rt(u,h,P,null,b,S)}for(F in b)if(S=b[F],k=m[F],b.hasOwnProperty(F)&&(S!=null||k!=null))switch(F){case"value":fe=S;break;case"defaultValue":ge=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(s(91));break;default:S!==k&&Rt(u,h,F,S,b,k)}nA(u,fe,ge);return;case"option":for(var ze in m)if(fe=m[ze],m.hasOwnProperty(ze)&&fe!=null&&!b.hasOwnProperty(ze))switch(ze){case"selected":u.selected=!1;break;default:Rt(u,h,ze,null,b,fe)}for(G in b)if(fe=b[G],ge=m[G],b.hasOwnProperty(G)&&fe!==ge&&(fe!=null||ge!=null))switch(G){case"selected":u.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:Rt(u,h,G,fe,b,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ye in m)fe=m[Ye],m.hasOwnProperty(Ye)&&fe!=null&&!b.hasOwnProperty(Ye)&&Rt(u,h,Ye,null,b,fe);for(se in b)if(fe=b[se],ge=m[se],b.hasOwnProperty(se)&&fe!==ge&&(fe!=null||ge!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(s(137,h));break;default:Rt(u,h,se,fe,b,ge)}return;default:if(Uv(h)){for(var sn in m)fe=m[sn],m.hasOwnProperty(sn)&&fe!==void 0&&!b.hasOwnProperty(sn)&&k2(u,h,sn,void 0,b,fe);for(ye in b)fe=b[ye],ge=m[ye],!b.hasOwnProperty(ye)||fe===ge||fe===void 0&&ge===void 0||k2(u,h,ye,fe,b,ge);return}}for(var oe in m)fe=m[oe],m.hasOwnProperty(oe)&&fe!=null&&!b.hasOwnProperty(oe)&&Rt(u,h,oe,null,b,fe);for(Te in b)fe=b[Te],ge=m[Te],!b.hasOwnProperty(Te)||fe===ge||fe==null&&ge==null||Rt(u,h,Te,fe,b,ge)}var E2=null,$2=null;function $0(u){return u.nodeType===9?u:u.ownerDocument}function YD(u){switch(u){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ZD(u,h){if(u===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return u===1&&h==="foreignObject"?0:u}function I2(u,h){return u==="textarea"||u==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var A2=null;function vW(){var u=window.event;return u&&u.type==="popstate"?u===A2?!1:(A2=u,!0):(A2=null,!1)}var QD=typeof setTimeout=="function"?setTimeout:void 0,wW=typeof clearTimeout=="function"?clearTimeout:void 0,JD=typeof Promise=="function"?Promise:void 0,SW=typeof queueMicrotask=="function"?queueMicrotask:typeof JD<"u"?function(u){return JD.resolve(null).then(u).catch(TW)}:QD;function TW(u){setTimeout(function(){throw u})}function R2(u,h){var m=h,b=0;do{var S=m.nextSibling;if(u.removeChild(m),S&&S.nodeType===8)if(m=S.data,m==="/$"){if(b===0){u.removeChild(S),wd(h);return}b--}else m!=="$"&&m!=="$?"&&m!=="$!"||b++;m=S}while(m);wd(h)}function D2(u){var h=u.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var m=h;switch(h=h.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":D2(m),Pv(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}u.removeChild(m)}}function CW(u,h,m,b){for(;u.nodeType===1;){var S=m;if(u.nodeName.toLowerCase()!==h.toLowerCase()){if(!b&&(u.nodeName!=="INPUT"||u.type!=="hidden"))break}else if(b){if(!u[If])switch(h){case"meta":if(!u.hasAttribute("itemprop"))break;return u;case"link":if(k=u.getAttribute("rel"),k==="stylesheet"&&u.hasAttribute("data-precedence"))break;if(k!==S.rel||u.getAttribute("href")!==(S.href==null?null:S.href)||u.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||u.getAttribute("title")!==(S.title==null?null:S.title))break;return u;case"style":if(u.hasAttribute("data-precedence"))break;return u;case"script":if(k=u.getAttribute("src"),(k!==(S.src==null?null:S.src)||u.getAttribute("type")!==(S.type==null?null:S.type)||u.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&k&&u.hasAttribute("async")&&!u.hasAttribute("itemprop"))break;return u;default:return u}}else if(h==="input"&&u.type==="hidden"){var k=S.name==null?null:""+S.name;if(S.type==="hidden"&&u.getAttribute("name")===k)return u}else return u;if(u=Zr(u.nextSibling),u===null)break}return null}function NW(u,h,m){if(h==="")return null;for(;u.nodeType!==3;)if((u.nodeType!==1||u.nodeName!=="INPUT"||u.type!=="hidden")&&!m||(u=Zr(u.nextSibling),u===null))return null;return u}function Zr(u){for(;u!=null;u=u.nextSibling){var h=u.nodeType;if(h===1||h===3)break;if(h===8){if(h=u.data,h==="$"||h==="$!"||h==="$?"||h==="F!"||h==="F")break;if(h==="/$")return null}}return u}function e3(u){u=u.previousSibling;for(var h=0;u;){if(u.nodeType===8){var m=u.data;if(m==="$"||m==="$!"||m==="$?"){if(h===0)return u;h--}else m==="/$"&&h++}u=u.previousSibling}return null}function t3(u,h,m){switch(h=$0(m),u){case"html":if(u=h.documentElement,!u)throw Error(s(452));return u;case"head":if(u=h.head,!u)throw Error(s(453));return u;case"body":if(u=h.body,!u)throw Error(s(454));return u;default:throw Error(s(451))}}var Or=new Map,n3=new Set;function I0(u){return typeof u.getRootNode=="function"?u.getRootNode():u.ownerDocument}var di=he.d;he.d={f:kW,r:EW,D:$W,C:IW,L:AW,m:RW,X:OW,S:DW,M:_W};function kW(){var u=di.f(),h=w0();return u||h}function EW(u){var h=Bu(u);h!==null&&h.tag===5&&h.type==="form"?IR(h):di.r(u)}var yc=typeof document>"u"?null:document;function s3(u,h,m){var b=yc;if(b&&typeof h=="string"&&h){var S=Tr(h);S='link[rel="'+u+'"][href="'+S+'"]',typeof m=="string"&&(S+='[crossorigin="'+m+'"]'),n3.has(S)||(n3.add(S),u={rel:u,crossOrigin:m,href:h},b.querySelector(S)===null&&(h=b.createElement("link"),ts(h,"link",u),zn(h),b.head.appendChild(h)))}}function $W(u){di.D(u),s3("dns-prefetch",u,null)}function IW(u,h){di.C(u,h),s3("preconnect",u,h)}function AW(u,h,m){di.L(u,h,m);var b=yc;if(b&&u&&h){var S='link[rel="preload"][as="'+Tr(h)+'"]';h==="image"&&m&&m.imageSrcSet?(S+='[imagesrcset="'+Tr(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(S+='[imagesizes="'+Tr(m.imageSizes)+'"]')):S+='[href="'+Tr(u)+'"]';var k=S;switch(h){case"style":k=bc(u);break;case"script":k=xc(u)}Or.has(k)||(u=_({rel:"preload",href:h==="image"&&m&&m.imageSrcSet?void 0:u,as:h},m),Or.set(k,u),b.querySelector(S)!==null||h==="style"&&b.querySelector(pd(k))||h==="script"&&b.querySelector(md(k))||(h=b.createElement("link"),ts(h,"link",u),zn(h),b.head.appendChild(h)))}}function RW(u,h){di.m(u,h);var m=yc;if(m&&u){var b=h&&typeof h.as=="string"?h.as:"script",S='link[rel="modulepreload"][as="'+Tr(b)+'"][href="'+Tr(u)+'"]',k=S;switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":k=xc(u)}if(!Or.has(k)&&(u=_({rel:"modulepreload",href:u},h),Or.set(k,u),m.querySelector(S)===null)){switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(md(k)))return}b=m.createElement("link"),ts(b,"link",u),zn(b),m.head.appendChild(b)}}}function DW(u,h,m){di.S(u,h,m);var b=yc;if(b&&u){var S=Vu(b).hoistableStyles,k=bc(u);h=h||"default";var F=S.get(k);if(!F){var P={loading:0,preload:null};if(F=b.querySelector(pd(k)))P.loading=5;else{u=_({rel:"stylesheet",href:u,"data-precedence":h},m),(m=Or.get(k))&&O2(u,m);var G=F=b.createElement("link");zn(G),ts(G,"link",u),G._p=new Promise(function(se,ye){G.onload=se,G.onerror=ye}),G.addEventListener("load",function(){P.loading|=1}),G.addEventListener("error",function(){P.loading|=2}),P.loading|=4,A0(F,h,b)}F={type:"stylesheet",instance:F,count:1,state:P},S.set(k,F)}}}function OW(u,h){di.X(u,h);var m=yc;if(m&&u){var b=Vu(m).hoistableScripts,S=xc(u),k=b.get(S);k||(k=m.querySelector(md(S)),k||(u=_({src:u,async:!0},h),(h=Or.get(S))&&_2(u,h),k=m.createElement("script"),zn(k),ts(k,"link",u),m.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},b.set(S,k))}}function _W(u,h){di.M(u,h);var m=yc;if(m&&u){var b=Vu(m).hoistableScripts,S=xc(u),k=b.get(S);k||(k=m.querySelector(md(S)),k||(u=_({src:u,async:!0,type:"module"},h),(h=Or.get(S))&&_2(u,h),k=m.createElement("script"),zn(k),ts(k,"link",u),m.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},b.set(S,k))}}function r3(u,h,m,b){var S=(S=dt.current)?I0(S):null;if(!S)throw Error(s(446));switch(u){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(h=bc(m.href),m=Vu(S).hoistableStyles,b=m.get(h),b||(b={type:"style",instance:null,count:0,state:null},m.set(h,b)),b):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){u=bc(m.href);var k=Vu(S).hoistableStyles,F=k.get(u);if(F||(S=S.ownerDocument||S,F={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},k.set(u,F),(k=S.querySelector(pd(u)))&&!k._p&&(F.instance=k,F.state.loading=5),Or.has(u)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},Or.set(u,m),k||FW(S,u,m,F.state))),h&&b===null)throw Error(s(528,""));return F}if(h&&b!==null)throw Error(s(529,""));return null;case"script":return h=m.async,m=m.src,typeof m=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=xc(m),m=Vu(S).hoistableScripts,b=m.get(h),b||(b={type:"script",instance:null,count:0,state:null},m.set(h,b)),b):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,u))}}function bc(u){return'href="'+Tr(u)+'"'}function pd(u){return'link[rel="stylesheet"]['+u+"]"}function a3(u){return _({},u,{"data-precedence":u.precedence,precedence:null})}function FW(u,h,m,b){u.querySelector('link[rel="preload"][as="style"]['+h+"]")?b.loading=1:(h=u.createElement("link"),b.preload=h,h.addEventListener("load",function(){return b.loading|=1}),h.addEventListener("error",function(){return b.loading|=2}),ts(h,"link",m),zn(h),u.head.appendChild(h))}function xc(u){return'[src="'+Tr(u)+'"]'}function md(u){return"script[async]"+u}function i3(u,h,m){if(h.count++,h.instance===null)switch(h.type){case"style":var b=u.querySelector('style[data-href~="'+Tr(m.href)+'"]');if(b)return h.instance=b,zn(b),b;var S=_({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return b=(u.ownerDocument||u).createElement("style"),zn(b),ts(b,"style",S),A0(b,m.precedence,u),h.instance=b;case"stylesheet":S=bc(m.href);var k=u.querySelector(pd(S));if(k)return h.state.loading|=4,h.instance=k,zn(k),k;b=a3(m),(S=Or.get(S))&&O2(b,S),k=(u.ownerDocument||u).createElement("link"),zn(k);var F=k;return F._p=new Promise(function(P,G){F.onload=P,F.onerror=G}),ts(k,"link",b),h.state.loading|=4,A0(k,m.precedence,u),h.instance=k;case"script":return k=xc(m.src),(S=u.querySelector(md(k)))?(h.instance=S,zn(S),S):(b=m,(S=Or.get(k))&&(b=_({},m),_2(b,S)),u=u.ownerDocument||u,S=u.createElement("script"),zn(S),ts(S,"link",b),u.head.appendChild(S),h.instance=S);case"void":return null;default:throw Error(s(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(b=h.instance,h.state.loading|=4,A0(b,m.precedence,u));return h.instance}function A0(u,h,m){for(var b=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=b.length?b[b.length-1]:null,k=S,F=0;F<b.length;F++){var P=b[F];if(P.dataset.precedence===h)k=P;else if(k!==S)break}k?k.parentNode.insertBefore(u,k.nextSibling):(h=m.nodeType===9?m.head:m,h.insertBefore(u,h.firstChild))}function O2(u,h){u.crossOrigin==null&&(u.crossOrigin=h.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=h.referrerPolicy),u.title==null&&(u.title=h.title)}function _2(u,h){u.crossOrigin==null&&(u.crossOrigin=h.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=h.referrerPolicy),u.integrity==null&&(u.integrity=h.integrity)}var R0=null;function o3(u,h,m){if(R0===null){var b=new Map,S=R0=new Map;S.set(m,b)}else S=R0,b=S.get(m),b||(b=new Map,S.set(m,b));if(b.has(u))return b;for(b.set(u,null),m=m.getElementsByTagName(u),S=0;S<m.length;S++){var k=m[S];if(!(k[If]||k[is]||u==="link"&&k.getAttribute("rel")==="stylesheet")&&k.namespaceURI!=="http://www.w3.org/2000/svg"){var F=k.getAttribute(h)||"";F=u+F;var P=b.get(F);P?P.push(k):b.set(F,[k])}}return b}function l3(u,h,m){u=u.ownerDocument||u,u.head.insertBefore(m,h==="title"?u.querySelector("head > title"):null)}function LW(u,h,m){if(m===1||h.itemProp!=null)return!1;switch(u){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;switch(h.rel){case"stylesheet":return u=h.disabled,typeof h.precedence=="string"&&u==null;default:return!0}case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function u3(u){return!(u.type==="stylesheet"&&(u.state.loading&3)===0)}var gd=null;function MW(){}function zW(u,h,m){if(gd===null)throw Error(s(475));var b=gd;if(h.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var S=bc(m.href),k=u.querySelector(pd(S));if(k){u=k._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(b.count++,b=D0.bind(b),u.then(b,b)),h.state.loading|=4,h.instance=k,zn(k);return}k=u.ownerDocument||u,m=a3(m),(S=Or.get(S))&&O2(m,S),k=k.createElement("link"),zn(k);var F=k;F._p=new Promise(function(P,G){F.onload=P,F.onerror=G}),ts(k,"link",m),h.instance=k}b.stylesheets===null&&(b.stylesheets=new Map),b.stylesheets.set(h,u),(u=h.state.preload)&&(h.state.loading&3)===0&&(b.count++,h=D0.bind(b),u.addEventListener("load",h),u.addEventListener("error",h))}}function PW(){if(gd===null)throw Error(s(475));var u=gd;return u.stylesheets&&u.count===0&&F2(u,u.stylesheets),0<u.count?function(h){var m=setTimeout(function(){if(u.stylesheets&&F2(u,u.stylesheets),u.unsuspend){var b=u.unsuspend;u.unsuspend=null,b()}},6e4);return u.unsuspend=h,function(){u.unsuspend=null,clearTimeout(m)}}:null}function D0(){if(this.count--,this.count===0){if(this.stylesheets)F2(this,this.stylesheets);else if(this.unsuspend){var u=this.unsuspend;this.unsuspend=null,u()}}}var O0=null;function F2(u,h){u.stylesheets=null,u.unsuspend!==null&&(u.count++,O0=new Map,h.forEach(BW,u),O0=null,D0.call(u))}function BW(u,h){if(!(h.state.loading&4)){var m=O0.get(u);if(m)var b=m.get(null);else{m=new Map,O0.set(u,m);for(var S=u.querySelectorAll("link[data-precedence],style[data-precedence]"),k=0;k<S.length;k++){var F=S[k];(F.nodeName==="LINK"||F.getAttribute("media")!=="not all")&&(m.set(F.dataset.precedence,F),b=F)}b&&m.set(null,b)}S=h.instance,F=S.getAttribute("data-precedence"),k=m.get(F)||b,k===b&&m.set(null,S),m.set(F,S),this.count++,b=D0.bind(this),S.addEventListener("load",b),S.addEventListener("error",b),k?k.parentNode.insertBefore(S,k.nextSibling):(u=u.nodeType===9?u.head:u,u.insertBefore(S,u.firstChild)),h.state.loading|=4}}var yd={$$typeof:g,Provider:null,Consumer:null,_currentValue:be,_currentValue2:be,_threadCount:0};function VW(u,h,m,b,S,k,F,P){this.tag=1,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Mv(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mv(0),this.hiddenUpdates=Mv(null),this.identifierPrefix=b,this.onUncaughtError=S,this.onCaughtError=k,this.onRecoverableError=F,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function c3(u,h,m,b,S,k,F,P,G,se,ye,Te){return u=new VW(u,h,m,F,P,G,se,Te),h=1,k===!0&&(h|=24),k=Rr(3,null,null,h),u.current=k,k.stateNode=u,h=dw(),h.refCount++,u.pooledCache=h,h.refCount++,k.memoizedState={element:b,isDehydrated:m,cache:h},qw(k),u}function h3(u){return u?(u=Zu,u):Zu}function f3(u,h,m,b,S,k){S=h3(S),b.context===null?b.context=S:b.pendingContext=S,b=ao(h),b.payload={element:m},k=k===void 0?null:k,k!==null&&(b.callback=k),m=io(u,b,h),m!==null&&(Ns(m,u,h),ed(m,u,h))}function d3(u,h){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var m=u.retryLane;u.retryLane=m!==0&&m<h?m:h}}function L2(u,h){d3(u,h),(u=u.alternate)&&d3(u,h)}function p3(u){if(u.tag===13){var h=Qi(u,67108864);h!==null&&Ns(h,u,67108864),L2(u,67108864)}}var _0=!0;function UW(u,h,m,b){var S=A.T;A.T=null;var k=he.p;try{he.p=2,M2(u,h,m,b)}finally{he.p=k,A.T=S}}function jW(u,h,m,b){var S=A.T;A.T=null;var k=he.p;try{he.p=8,M2(u,h,m,b)}finally{he.p=k,A.T=S}}function M2(u,h,m,b){if(_0){var S=z2(b);if(S===null)N2(u,h,b,F0,m),g3(u,b);else if(GW(S,u,h,m,b))b.stopPropagation();else if(g3(u,b),h&4&&-1<WW.indexOf(u)){for(;S!==null;){var k=Bu(S);if(k!==null)switch(k.tag){case 3:if(k=k.stateNode,k.current.memoizedState.isDehydrated){var F=il(k.pendingLanes);if(F!==0){var P=k;for(P.pendingLanes|=2,P.entangledLanes|=2;F;){var G=1<<31-Js(F);P.entanglements[1]|=G,F&=~G}Ca(k),(Kt&6)===0&&(b0=en()+500,hd(0))}}break;case 13:P=Qi(k,2),P!==null&&Ns(P,k,2),w0(),L2(k,2)}if(k=z2(b),k===null&&N2(u,h,b,F0,m),k===S)break;S=k}S!==null&&b.stopPropagation()}else N2(u,h,b,null,m)}}function z2(u){return u=Wv(u),P2(u)}var F0=null;function P2(u){if(F0=null,u=ol(u),u!==null){var h=Q(u);if(h===null)u=null;else{var m=h.tag;if(m===13){if(u=ie(h),u!==null)return u;u=null}else if(m===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;u=null}else h!==u&&(u=null)}}return F0=u,null}function m3(u){switch(u){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Gr()){case Hr:return 2;case qr:return 8;case Qs:case al:return 32;case zu:return 268435456;default:return 32}default:return 32}}var B2=!1,po=null,mo=null,go=null,bd=new Map,xd=new Map,yo=[],WW="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function g3(u,h){switch(u){case"focusin":case"focusout":po=null;break;case"dragenter":case"dragleave":mo=null;break;case"mouseover":case"mouseout":go=null;break;case"pointerover":case"pointerout":bd.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":xd.delete(h.pointerId)}}function vd(u,h,m,b,S,k){return u===null||u.nativeEvent!==k?(u={blockedOn:h,domEventName:m,eventSystemFlags:b,nativeEvent:k,targetContainers:[S]},h!==null&&(h=Bu(h),h!==null&&p3(h)),u):(u.eventSystemFlags|=b,h=u.targetContainers,S!==null&&h.indexOf(S)===-1&&h.push(S),u)}function GW(u,h,m,b,S){switch(h){case"focusin":return po=vd(po,u,h,m,b,S),!0;case"dragenter":return mo=vd(mo,u,h,m,b,S),!0;case"mouseover":return go=vd(go,u,h,m,b,S),!0;case"pointerover":var k=S.pointerId;return bd.set(k,vd(bd.get(k)||null,u,h,m,b,S)),!0;case"gotpointercapture":return k=S.pointerId,xd.set(k,vd(xd.get(k)||null,u,h,m,b,S)),!0}return!1}function y3(u){var h=ol(u.target);if(h!==null){var m=Q(h);if(m!==null){if(h=m.tag,h===13){if(h=ie(m),h!==null){u.blockedOn=h,Pj(u.priority,function(){if(m.tag===13){var b=rr(),S=Qi(m,b);S!==null&&Ns(S,m,b),L2(m,b)}});return}}else if(h===3&&m.stateNode.current.memoizedState.isDehydrated){u.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}u.blockedOn=null}function L0(u){if(u.blockedOn!==null)return!1;for(var h=u.targetContainers;0<h.length;){var m=z2(u.nativeEvent);if(m===null){m=u.nativeEvent;var b=new m.constructor(m.type,m);jv=b,m.target.dispatchEvent(b),jv=null}else return h=Bu(m),h!==null&&p3(h),u.blockedOn=m,!1;h.shift()}return!0}function b3(u,h,m){L0(u)&&m.delete(h)}function HW(){B2=!1,po!==null&&L0(po)&&(po=null),mo!==null&&L0(mo)&&(mo=null),go!==null&&L0(go)&&(go=null),bd.forEach(b3),xd.forEach(b3)}function M0(u,h){u.blockedOn===h&&(u.blockedOn=null,B2||(B2=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,HW)))}var z0=null;function x3(u){z0!==u&&(z0=u,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){z0===u&&(z0=null);for(var h=0;h<u.length;h+=3){var m=u[h],b=u[h+1],S=u[h+2];if(typeof b!="function"){if(P2(b||m)===null)continue;break}var k=Bu(m);k!==null&&(u.splice(h,3),h-=3,Iw(k,{pending:!0,data:S,method:m.method,action:b},b,S))}}))}function wd(u){function h(G){return M0(G,u)}po!==null&&M0(po,u),mo!==null&&M0(mo,u),go!==null&&M0(go,u),bd.forEach(h),xd.forEach(h);for(var m=0;m<yo.length;m++){var b=yo[m];b.blockedOn===u&&(b.blockedOn=null)}for(;0<yo.length&&(m=yo[0],m.blockedOn===null);)y3(m),m.blockedOn===null&&yo.shift();if(m=(u.ownerDocument||u).$$reactFormReplay,m!=null)for(b=0;b<m.length;b+=3){var S=m[b],k=m[b+1],F=S[Ls]||null;if(typeof k=="function")F||x3(m);else if(F){var P=null;if(k&&k.hasAttribute("formAction")){if(S=k,F=k[Ls]||null)P=F.formAction;else if(P2(S)!==null)continue}else P=F.action;typeof P=="function"?m[b+1]=P:(m.splice(b,3),b-=3),x3(m)}}}function V2(u){this._internalRoot=u}P0.prototype.render=V2.prototype.render=function(u){var h=this._internalRoot;if(h===null)throw Error(s(409));var m=h.current,b=rr();f3(m,b,u,h,null,null)},P0.prototype.unmount=V2.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var h=u.containerInfo;u.tag===0&&pc(),f3(u.current,2,null,u,null,null),w0(),h[Pu]=null}};function P0(u){this._internalRoot=u}P0.prototype.unstable_scheduleHydration=function(u){if(u){var h=qI();u={blockedOn:null,target:u,priority:h};for(var m=0;m<yo.length&&h!==0&&h<yo[m].priority;m++);yo.splice(m,0,u),m===0&&y3(u)}};var v3=e.version;if(v3!=="19.0.0")throw Error(s(527,v3,"19.0.0"));he.findDOMNode=function(u){var h=u._reactInternals;if(h===void 0)throw typeof u.render=="function"?Error(s(188)):(u=Object.keys(u).join(","),Error(s(268,u)));return u=ee(h),u=u!==null?ce(u):null,u=u===null?null:u.stateNode,u};var qW={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:A,findFiberByHostInstance:ol,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var B0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!B0.isDisabled&&B0.supportsFiber)try{xa=B0.inject(qW),Ts=B0}catch{}}return Td.createRoot=function(u,h){if(!r(u))throw Error(s(299));var m=!1,b="",S=MR,k=zR,F=PR,P=null;return h!=null&&(h.unstable_strictMode===!0&&(m=!0),h.identifierPrefix!==void 0&&(b=h.identifierPrefix),h.onUncaughtError!==void 0&&(S=h.onUncaughtError),h.onCaughtError!==void 0&&(k=h.onCaughtError),h.onRecoverableError!==void 0&&(F=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(P=h.unstable_transitionCallbacks)),h=c3(u,1,!1,null,null,m,b,S,k,F,P,null),u[Pu]=h.current,C2(u.nodeType===8?u.parentNode:u),new V2(h)},Td.hydrateRoot=function(u,h,m){if(!r(u))throw Error(s(299));var b=!1,S="",k=MR,F=zR,P=PR,G=null,se=null;return m!=null&&(m.unstable_strictMode===!0&&(b=!0),m.identifierPrefix!==void 0&&(S=m.identifierPrefix),m.onUncaughtError!==void 0&&(k=m.onUncaughtError),m.onCaughtError!==void 0&&(F=m.onCaughtError),m.onRecoverableError!==void 0&&(P=m.onRecoverableError),m.unstable_transitionCallbacks!==void 0&&(G=m.unstable_transitionCallbacks),m.formState!==void 0&&(se=m.formState)),h=c3(u,1,!0,h,m??null,b,S,k,F,P,G,se),h.context=h3(null),m=h.current,b=rr(),S=ao(b),S.callback=null,io(m,S,b),h.current.lanes=b,$f(h,b),Ca(h),u[Pu]=h.current,C2(u),new P0(h)},Td.version="19.0.0",Td}var A3;function rG(){if(A3)return W2.exports;A3=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),W2.exports=sG(),W2.exports}var aG=rG(),Cd={},R3;function iG(){if(R3)return Cd;R3=1,Object.defineProperty(Cd,"__esModule",{value:!0}),Cd.parse=i,Cd.serialize=c;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,r=Object.prototype.toString,a=(()=>{const p=function(){};return p.prototype=Object.create(null),p})();function i(p,g){const y=new a,v=p.length;if(v<2)return y;const x=(g==null?void 0:g.decode)||f;let w=0;do{const T=p.indexOf("=",w);if(T===-1)break;const N=p.indexOf(";",w),C=N===-1?v:N;if(T>C){w=p.lastIndexOf(";",T-1)+1;continue}const E=o(p,w,T),R=l(p,T,E),$=p.slice(E,R);if(y[$]===void 0){let O=o(p,T+1,C),A=l(p,C,O);const _=x(p.slice(O,A));y[$]=_}w=C+1}while(w<v);return y}function o(p,g,y){do{const v=p.charCodeAt(g);if(v!==32&&v!==9)return g}while(++g<y);return y}function l(p,g,y){for(;g>y;){const v=p.charCodeAt(--g);if(v!==32&&v!==9)return g+1}return y}function c(p,g,y){const v=(y==null?void 0:y.encode)||encodeURIComponent;if(!t.test(p))throw new TypeError(`argument name is invalid: ${p}`);const x=v(g);if(!e.test(x))throw new TypeError(`argument val is invalid: ${g}`);let w=p+"="+x;if(!y)return w;if(y.maxAge!==void 0){if(!Number.isInteger(y.maxAge))throw new TypeError(`option maxAge is invalid: ${y.maxAge}`);w+="; Max-Age="+y.maxAge}if(y.domain){if(!n.test(y.domain))throw new TypeError(`option domain is invalid: ${y.domain}`);w+="; Domain="+y.domain}if(y.path){if(!s.test(y.path))throw new TypeError(`option path is invalid: ${y.path}`);w+="; Path="+y.path}if(y.expires){if(!d(y.expires)||!Number.isFinite(y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${y.expires}`);w+="; Expires="+y.expires.toUTCString()}if(y.httpOnly&&(w+="; HttpOnly"),y.secure&&(w+="; Secure"),y.partitioned&&(w+="; Partitioned"),y.priority)switch(typeof y.priority=="string"?y.priority.toLowerCase():void 0){case"low":w+="; Priority=Low";break;case"medium":w+="; Priority=Medium";break;case"high":w+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${y.priority}`)}if(y.sameSite)switch(typeof y.sameSite=="string"?y.sameSite.toLowerCase():y.sameSite){case!0:case"strict":w+="; SameSite=Strict";break;case"lax":w+="; SameSite=Lax";break;case"none":w+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${y.sameSite}`)}return w}function f(p){if(p.indexOf("%")===-1)return p;try{return decodeURIComponent(p)}catch{return p}}function d(p){return r.call(p)==="[object Date]"}return Cd}iG();/**
 * react-router v7.4.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var D3="popstate";function oG(t={}){function e(s,r){let{pathname:a,search:i,hash:o}=s.location;return jS("",{pathname:a,search:i,hash:o},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:ep(r)}return uG(e,n,null,t)}function Qt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Va(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function lG(){return Math.random().toString(36).substring(2,10)}function O3(t,e){return{usr:t.state,key:t.key,idx:e}}function jS(t,e,n=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?th(e):e,state:n,key:e&&e.key||s||lG()}}function ep({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function th(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substring(s),t=t.substring(0,s)),t&&(e.pathname=t)}return e}function uG(t,e,n,s={}){let{window:r=document.defaultView,v5Compat:a=!1}=s,i=r.history,o="POP",l=null,c=f();c==null&&(c=0,i.replaceState({...i.state,idx:c},""));function f(){return(i.state||{idx:null}).idx}function d(){o="POP";let x=f(),w=x==null?null:x-c;c=x,l&&l({action:o,location:v.location,delta:w})}function p(x,w){o="PUSH";let T=jS(v.location,x,w);c=f()+1;let N=O3(T,c),C=v.createHref(T);try{i.pushState(N,"",C)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;r.location.assign(C)}a&&l&&l({action:o,location:v.location,delta:1})}function g(x,w){o="REPLACE";let T=jS(v.location,x,w);c=f();let N=O3(T,c),C=v.createHref(T);i.replaceState(N,"",C),a&&l&&l({action:o,location:v.location,delta:0})}function y(x){let w=r.location.origin!=="null"?r.location.origin:r.location.href,T=typeof x=="string"?x:ep(x);return T=T.replace(/ $/,"%20"),Qt(w,`No window.location.(origin|href) available to create URL for href: ${T}`),new URL(T,w)}let v={get action(){return o},get location(){return t(r,i)},listen(x){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(D3,d),l=x,()=>{r.removeEventListener(D3,d),l=null}},createHref(x){return e(r,x)},createURL:y,encodeLocation(x){let w=y(x);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:p,replace:g,go(x){return i.go(x)}};return v}function SL(t,e,n="/"){return cG(t,e,n,!1)}function cG(t,e,n,s){let r=typeof e=="string"?th(e):e,a=ki(r.pathname||"/",n);if(a==null)return null;let i=TL(t);hG(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=SG(a);o=vG(i[l],c,s)}return o}function TL(t,e=[],n=[],s=""){let r=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(Qt(l.relativePath.startsWith(s),`Absolute route path "${l.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(s.length));let c=Si([s,l.relativePath]),f=n.concat(l);a.children&&a.children.length>0&&(Qt(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),TL(a.children,e,f,c)),!(a.path==null&&!a.index)&&e.push({path:c,score:bG(c,a.index),routesMeta:f})};return t.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))r(a,i);else for(let l of CL(a.path))r(a,i,l)}),e}function CL(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),a=n.replace(/\?$/,"");if(s.length===0)return r?[a,""]:[a];let i=CL(s.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),r&&o.push(...i),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function hG(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:xG(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}var fG=/^:[\w-]+$/,dG=3,pG=2,mG=1,gG=10,yG=-2,_3=t=>t==="*";function bG(t,e){let n=t.split("/"),s=n.length;return n.some(_3)&&(s+=yG),e&&(s+=pG),n.filter(r=>!_3(r)).reduce((r,a)=>r+(fG.test(a)?dG:a===""?mG:gG),s)}function xG(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function vG(t,e,n=!1){let{routesMeta:s}=t,r={},a="/",i=[];for(let o=0;o<s.length;++o){let l=s[o],c=o===s.length-1,f=a==="/"?e:e.slice(a.length)||"/",d=n1({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},f),p=l.route;if(!d&&c&&n&&!s[s.length-1].route.index&&(d=n1({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},f)),!d)return null;Object.assign(r,d.params),i.push({params:r,pathname:Si([a,d.pathname]),pathnameBase:kG(Si([a,d.pathnameBase])),route:p}),d.pathnameBase!=="/"&&(a=Si([a,d.pathnameBase]))}return i}function n1(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=wG(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let a=r[0],i=a.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:s.reduce((c,{paramName:f,isOptional:d},p)=>{if(f==="*"){let y=o[p]||"";i=a.slice(0,a.length-y.length).replace(/(.)\/+$/,"$1")}const g=o[p];return d&&!g?c[f]=void 0:c[f]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:i,pattern:t}}function wG(t,e=!1,n=!0){Va(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(s.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function SG(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Va(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function ki(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function TG(t,e="/"){let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?th(t):t;return{pathname:n?n.startsWith("/")?n:CG(n,e):e,search:EG(s),hash:$G(r)}}function CG(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function X2(t,e,n,s){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function NG(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function NL(t){let e=NG(t);return e.map((n,s)=>s===e.length-1?n.pathname:n.pathnameBase)}function kL(t,e,n,s=!1){let r;typeof t=="string"?r=th(t):(r={...t},Qt(!r.pathname||!r.pathname.includes("?"),X2("?","pathname","search",r)),Qt(!r.pathname||!r.pathname.includes("#"),X2("#","pathname","hash",r)),Qt(!r.search||!r.search.includes("#"),X2("#","search","hash",r)));let a=t===""||r.pathname==="",i=a?"/":r.pathname,o;if(i==null)o=n;else{let d=e.length-1;if(!s&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),d-=1;r.pathname=p.join("/")}o=d>=0?e[d]:"/"}let l=TG(r,o),c=i&&i!=="/"&&i.endsWith("/"),f=(a||i===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||f)&&(l.pathname+="/"),l}var Si=t=>t.join("/").replace(/\/\/+/g,"/"),kG=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),EG=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,$G=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function IG(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var EL=["POST","PUT","PATCH","DELETE"];new Set(EL);var AG=["GET",...EL];new Set(AG);var nh=K.createContext(null);nh.displayName="DataRouter";var H1=K.createContext(null);H1.displayName="DataRouterState";var $L=K.createContext({isTransitioning:!1});$L.displayName="ViewTransition";var RG=K.createContext(new Map);RG.displayName="Fetchers";var DG=K.createContext(null);DG.displayName="Await";var qa=K.createContext(null);qa.displayName="Navigation";var Dp=K.createContext(null);Dp.displayName="Location";var Mi=K.createContext({outlet:null,matches:[],isDataRoute:!1});Mi.displayName="Route";var _C=K.createContext(null);_C.displayName="RouteError";function OG(t,{relative:e}={}){Qt(Op(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=K.useContext(qa),{hash:r,pathname:a,search:i}=_p(t,{relative:e}),o=a;return n!=="/"&&(o=a==="/"?n:Si([n,a])),s.createHref({pathname:o,search:i,hash:r})}function Op(){return K.useContext(Dp)!=null}function zi(){return Qt(Op(),"useLocation() may be used only in the context of a <Router> component."),K.useContext(Dp).location}var IL="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function AL(t){K.useContext(qa).static||K.useLayoutEffect(t)}function _G(){let{isDataRoute:t}=K.useContext(Mi);return t?qG():FG()}function FG(){Qt(Op(),"useNavigate() may be used only in the context of a <Router> component.");let t=K.useContext(nh),{basename:e,navigator:n}=K.useContext(qa),{matches:s}=K.useContext(Mi),{pathname:r}=zi(),a=JSON.stringify(NL(s)),i=K.useRef(!1);return AL(()=>{i.current=!0}),K.useCallback((l,c={})=>{if(Va(i.current,IL),!i.current)return;if(typeof l=="number"){n.go(l);return}let f=kL(l,JSON.parse(a),r,c.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Si([e,f.pathname])),(c.replace?n.replace:n.push)(f,c.state,c)},[e,n,a,r,t])}K.createContext(null);function _p(t,{relative:e}={}){let{matches:n}=K.useContext(Mi),{pathname:s}=zi(),r=JSON.stringify(NL(n));return K.useMemo(()=>kL(t,JSON.parse(r),s,e==="path"),[t,r,s,e])}function LG(t,e){return RL(t,e)}function RL(t,e,n,s){var T;Qt(Op(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r,static:a}=K.useContext(qa),{matches:i}=K.useContext(Mi),o=i[i.length-1],l=o?o.params:{},c=o?o.pathname:"/",f=o?o.pathnameBase:"/",d=o&&o.route;{let N=d&&d.path||"";DL(c,!d||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let p=zi(),g;if(e){let N=typeof e=="string"?th(e):e;Qt(f==="/"||((T=N.pathname)==null?void 0:T.startsWith(f)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${N.pathname}" was given in the \`location\` prop.`),g=N}else g=p;let y=g.pathname||"/",v=y;if(f!=="/"){let N=f.replace(/^\//,"").split("/");v="/"+y.replace(/^\//,"").split("/").slice(N.length).join("/")}let x=!a&&n&&n.matches&&n.matches.length>0?n.matches:SL(t,{pathname:v});Va(d||x!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),Va(x==null||x[x.length-1].route.element!==void 0||x[x.length-1].route.Component!==void 0||x[x.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=VG(x&&x.map(N=>Object.assign({},N,{params:Object.assign({},l,N.params),pathname:Si([f,r.encodeLocation?r.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?f:Si([f,r.encodeLocation?r.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),i,n,s);return e&&w?K.createElement(Dp.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},w):w}function MG(){let t=HG(),e=IG(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},a={padding:"2px 4px",backgroundColor:s},i=null;return console.error("Error handled by React Router default ErrorBoundary:",t),i=K.createElement(K.Fragment,null,K.createElement("p",null," Hey developer "),K.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",K.createElement("code",{style:a},"ErrorBoundary")," or"," ",K.createElement("code",{style:a},"errorElement")," prop on your route.")),K.createElement(K.Fragment,null,K.createElement("h2",null,"Unexpected Application Error!"),K.createElement("h3",{style:{fontStyle:"italic"}},e),n?K.createElement("pre",{style:r},n):null,i)}var zG=K.createElement(MG,null),PG=class extends K.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?K.createElement(Mi.Provider,{value:this.props.routeContext},K.createElement(_C.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function BG({routeContext:t,match:e,children:n}){let s=K.useContext(nh);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),K.createElement(Mi.Provider,{value:t},n)}function VG(t,e=[],n=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let r=t,a=n==null?void 0:n.errors;if(a!=null){let l=r.findIndex(c=>c.route.id&&(a==null?void 0:a[c.route.id])!==void 0);Qt(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),r=r.slice(0,Math.min(r.length,l+1))}let i=!1,o=-1;if(n)for(let l=0;l<r.length;l++){let c=r[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(o=l),c.route.id){let{loaderData:f,errors:d}=n,p=c.route.loader&&!f.hasOwnProperty(c.route.id)&&(!d||d[c.route.id]===void 0);if(c.route.lazy||p){i=!0,o>=0?r=r.slice(0,o+1):r=[r[0]];break}}}return r.reduceRight((l,c,f)=>{let d,p=!1,g=null,y=null;n&&(d=a&&c.route.id?a[c.route.id]:void 0,g=c.route.errorElement||zG,i&&(o<0&&f===0?(DL("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,y=null):o===f&&(p=!0,y=c.route.hydrateFallbackElement||null)));let v=e.concat(r.slice(0,f+1)),x=()=>{let w;return d?w=g:p?w=y:c.route.Component?w=K.createElement(c.route.Component,null):c.route.element?w=c.route.element:w=l,K.createElement(BG,{match:c,routeContext:{outlet:l,matches:v,isDataRoute:n!=null},children:w})};return n&&(c.route.ErrorBoundary||c.route.errorElement||f===0)?K.createElement(PG,{location:n.location,revalidation:n.revalidation,component:g,error:d,children:x(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):x()},null)}function FC(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function UG(t){let e=K.useContext(nh);return Qt(e,FC(t)),e}function jG(t){let e=K.useContext(H1);return Qt(e,FC(t)),e}function WG(t){let e=K.useContext(Mi);return Qt(e,FC(t)),e}function LC(t){let e=WG(t),n=e.matches[e.matches.length-1];return Qt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function GG(){return LC("useRouteId")}function HG(){var s;let t=K.useContext(_C),e=jG("useRouteError"),n=LC("useRouteError");return t!==void 0?t:(s=e.errors)==null?void 0:s[n]}function qG(){let{router:t}=UG("useNavigate"),e=LC("useNavigate"),n=K.useRef(!1);return AL(()=>{n.current=!0}),K.useCallback(async(r,a={})=>{Va(n.current,IL),n.current&&(typeof r=="number"?t.navigate(r):await t.navigate(r,{fromRouteId:e,...a}))},[t,e])}var F3={};function DL(t,e,n){!e&&!F3[t]&&(F3[t]=!0,Va(!1,n))}K.memo(XG);function XG({routes:t,future:e,state:n}){return RL(t,void 0,n,e)}function Sc(t){Qt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function KG({basename:t="/",children:e=null,location:n,navigationType:s="POP",navigator:r,static:a=!1}){Qt(!Op(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=t.replace(/^\/*/,"/"),o=K.useMemo(()=>({basename:i,navigator:r,static:a,future:{}}),[i,r,a]);typeof n=="string"&&(n=th(n));let{pathname:l="/",search:c="",hash:f="",state:d=null,key:p="default"}=n,g=K.useMemo(()=>{let y=ki(l,i);return y==null?null:{location:{pathname:y,search:c,hash:f,state:d,key:p},navigationType:s}},[i,l,c,f,d,p,s]);return Va(g!=null,`<Router basename="${i}"> is not able to match the URL "${l}${c}${f}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:K.createElement(qa.Provider,{value:o},K.createElement(Dp.Provider,{children:e,value:g}))}function YG({children:t,location:e}){return LG(WS(t),e)}function WS(t,e=[]){let n=[];return K.Children.forEach(t,(s,r)=>{if(!K.isValidElement(s))return;let a=[...e,r];if(s.type===K.Fragment){n.push.apply(n,WS(s.props.children,a));return}Qt(s.type===Sc,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Qt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let i={id:s.props.id||a.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(i.children=WS(s.props.children,a)),n.push(i)}),n}var uy="get",cy="application/x-www-form-urlencoded";function q1(t){return t!=null&&typeof t.tagName=="string"}function ZG(t){return q1(t)&&t.tagName.toLowerCase()==="button"}function QG(t){return q1(t)&&t.tagName.toLowerCase()==="form"}function JG(t){return q1(t)&&t.tagName.toLowerCase()==="input"}function e9(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function t9(t,e){return t.button===0&&(!e||e==="_self")&&!e9(t)}var V0=null;function n9(){if(V0===null)try{new FormData(document.createElement("form"),0),V0=!1}catch{V0=!0}return V0}var s9=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function K2(t){return t!=null&&!s9.has(t)?(Va(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${cy}"`),null):t}function r9(t,e){let n,s,r,a,i;if(QG(t)){let o=t.getAttribute("action");s=o?ki(o,e):null,n=t.getAttribute("method")||uy,r=K2(t.getAttribute("enctype"))||cy,a=new FormData(t)}else if(ZG(t)||JG(t)&&(t.type==="submit"||t.type==="image")){let o=t.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||o.getAttribute("action");if(s=l?ki(l,e):null,n=t.getAttribute("formmethod")||o.getAttribute("method")||uy,r=K2(t.getAttribute("formenctype"))||K2(o.getAttribute("enctype"))||cy,a=new FormData(o,t),!n9()){let{name:c,type:f,value:d}=t;if(f==="image"){let p=c?`${c}.`:"";a.append(`${p}x`,"0"),a.append(`${p}y`,"0")}else c&&a.append(c,d)}}else{if(q1(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=uy,s=null,r=cy,i=t}return a&&r==="text/plain"&&(i=a,a=void 0),{action:s,method:n.toLowerCase(),encType:r,formData:a,body:i}}function MC(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function a9(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function i9(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function o9(t,e,n){let s=await Promise.all(t.map(async r=>{let a=e.routes[r.route.id];if(a){let i=await a9(a,n);return i.links?i.links():[]}return[]}));return h9(s.flat(1).filter(i9).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function L3(t,e,n,s,r,a){let i=(l,c)=>n[c]?l.route.id!==n[c].route.id:!0,o=(l,c)=>{var f;return n[c].pathname!==l.pathname||((f=n[c].route.path)==null?void 0:f.endsWith("*"))&&n[c].params["*"]!==l.params["*"]};return a==="assets"?e.filter((l,c)=>i(l,c)||o(l,c)):a==="data"?e.filter((l,c)=>{var d;let f=s.routes[l.route.id];if(!f||!f.hasLoader)return!1;if(i(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let p=l.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((d=n[0])==null?void 0:d.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function l9(t,e,{includeHydrateFallback:n}={}){return u9(t.map(s=>{let r=e.routes[s.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function u9(t){return[...new Set(t)]}function c9(t){let e={},n=Object.keys(t).sort();for(let s of n)e[s]=t[s];return e}function h9(t,e){let n=new Set;return new Set(e),t.reduce((s,r)=>{let a=JSON.stringify(c9(r));return n.has(a)||(n.add(a),s.push({key:a,link:r})),s},[])}function f9(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&ki(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function OL(){let t=K.useContext(nh);return MC(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function d9(){let t=K.useContext(H1);return MC(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var zC=K.createContext(void 0);zC.displayName="FrameworkContext";function _L(){let t=K.useContext(zC);return MC(t,"You must render this element inside a <HydratedRouter> element"),t}function p9(t,e){let n=K.useContext(zC),[s,r]=K.useState(!1),[a,i]=K.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:f,onTouchStart:d}=e,p=K.useRef(null);K.useEffect(()=>{if(t==="render"&&i(!0),t==="viewport"){let v=w=>{w.forEach(T=>{i(T.isIntersecting)})},x=new IntersectionObserver(v,{threshold:.5});return p.current&&x.observe(p.current),()=>{x.disconnect()}}},[t]),K.useEffect(()=>{if(s){let v=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(v)}}},[s]);let g=()=>{r(!0)},y=()=>{r(!1),i(!1)};return n?t!=="intent"?[a,p,{}]:[a,p,{onFocus:Nd(o,g),onBlur:Nd(l,y),onMouseEnter:Nd(c,g),onMouseLeave:Nd(f,y),onTouchStart:Nd(d,g)}]:[!1,p,{}]}function Nd(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function m9({page:t,...e}){let{router:n}=OL(),s=K.useMemo(()=>SL(n.routes,t,n.basename),[n.routes,t,n.basename]);return s?K.createElement(y9,{page:t,matches:s,...e}):null}function g9(t){let{manifest:e,routeModules:n}=_L(),[s,r]=K.useState([]);return K.useEffect(()=>{let a=!1;return o9(t,e,n).then(i=>{a||r(i)}),()=>{a=!0}},[t,e,n]),s}function y9({page:t,matches:e,...n}){let s=zi(),{manifest:r,routeModules:a}=_L(),{basename:i}=OL(),{loaderData:o,matches:l}=d9(),c=K.useMemo(()=>L3(t,e,l,r,s,"data"),[t,e,l,r,s]),f=K.useMemo(()=>L3(t,e,l,r,s,"assets"),[t,e,l,r,s]),d=K.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let y=new Set,v=!1;if(e.forEach(w=>{var N;let T=r.routes[w.route.id];!T||!T.hasLoader||(!c.some(C=>C.route.id===w.route.id)&&w.route.id in o&&((N=a[w.route.id])!=null&&N.shouldRevalidate)||T.hasClientLoader?v=!0:y.add(w.route.id))}),y.size===0)return[];let x=f9(t,i);return v&&y.size>0&&x.searchParams.set("_routes",e.filter(w=>y.has(w.route.id)).map(w=>w.route.id).join(",")),[x.pathname+x.search]},[i,o,s,r,c,e,t,a]),p=K.useMemo(()=>l9(f,r),[f,r]),g=g9(f);return K.createElement(K.Fragment,null,d.map(y=>K.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...n})),p.map(y=>K.createElement("link",{key:y,rel:"modulepreload",href:y,...n})),g.map(({key:y,link:v})=>K.createElement("link",{key:y,...v})))}function b9(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var FL=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{FL&&(window.__reactRouterVersion="7.4.0")}catch{}function x9({basename:t,children:e,window:n}){let s=K.useRef();s.current==null&&(s.current=oG({window:n,v5Compat:!0}));let r=s.current,[a,i]=K.useState({action:r.action,location:r.location}),o=K.useCallback(l=>{K.startTransition(()=>i(l))},[i]);return K.useLayoutEffect(()=>r.listen(o),[r,o]),K.createElement(KG,{basename:t,children:e,location:a.location,navigationType:a.action,navigator:r})}var LL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Dc=K.forwardRef(function({onClick:e,discover:n="render",prefetch:s="none",relative:r,reloadDocument:a,replace:i,state:o,target:l,to:c,preventScrollReset:f,viewTransition:d,...p},g){let{basename:y}=K.useContext(qa),v=typeof c=="string"&&LL.test(c),x,w=!1;if(typeof c=="string"&&v&&(x=c,FL))try{let A=new URL(window.location.href),_=c.startsWith("//")?new URL(A.protocol+c):new URL(c),D=ki(_.pathname,y);_.origin===A.origin&&D!=null?c=D+_.search+_.hash:w=!0}catch{Va(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let T=OG(c,{relative:r}),[N,C,E]=p9(s,p),R=T9(c,{replace:i,state:o,target:l,preventScrollReset:f,relative:r,viewTransition:d});function $(A){e&&e(A),A.defaultPrevented||R(A)}let O=K.createElement("a",{...p,...E,href:x||T,onClick:w||a?e:$,ref:b9(g,C),target:l,"data-discover":!v&&n==="render"?"true":void 0});return N&&!v?K.createElement(K.Fragment,null,O,K.createElement(m9,{page:T})):O});Dc.displayName="Link";var v9=K.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:s="",end:r=!1,style:a,to:i,viewTransition:o,children:l,...c},f){let d=_p(i,{relative:c.relative}),p=zi(),g=K.useContext(H1),{navigator:y,basename:v}=K.useContext(qa),x=g!=null&&$9(d)&&o===!0,w=y.encodeLocation?y.encodeLocation(d).pathname:d.pathname,T=p.pathname,N=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;n||(T=T.toLowerCase(),N=N?N.toLowerCase():null,w=w.toLowerCase()),N&&v&&(N=ki(N,v)||N);const C=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let E=T===w||!r&&T.startsWith(w)&&T.charAt(C)==="/",R=N!=null&&(N===w||!r&&N.startsWith(w)&&N.charAt(w.length)==="/"),$={isActive:E,isPending:R,isTransitioning:x},O=E?e:void 0,A;typeof s=="function"?A=s($):A=[s,E?"active":null,R?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let _=typeof a=="function"?a($):a;return K.createElement(Dc,{...c,"aria-current":O,className:A,ref:f,style:_,to:i,viewTransition:o},typeof l=="function"?l($):l)});v9.displayName="NavLink";var w9=K.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:s,replace:r,state:a,method:i=uy,action:o,onSubmit:l,relative:c,preventScrollReset:f,viewTransition:d,...p},g)=>{let y=k9(),v=E9(o,{relative:c}),x=i.toLowerCase()==="get"?"get":"post",w=typeof o=="string"&&LL.test(o),T=N=>{if(l&&l(N),N.defaultPrevented)return;N.preventDefault();let C=N.nativeEvent.submitter,E=(C==null?void 0:C.getAttribute("formmethod"))||i;y(C||N.currentTarget,{fetcherKey:e,method:E,navigate:n,replace:r,state:a,relative:c,preventScrollReset:f,viewTransition:d})};return K.createElement("form",{ref:g,method:x,action:v,onSubmit:s?l:T,...p,"data-discover":!w&&t==="render"?"true":void 0})});w9.displayName="Form";function S9(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ML(t){let e=K.useContext(nh);return Qt(e,S9(t)),e}function T9(t,{target:e,replace:n,state:s,preventScrollReset:r,relative:a,viewTransition:i}={}){let o=_G(),l=zi(),c=_p(t,{relative:a});return K.useCallback(f=>{if(t9(f,e)){f.preventDefault();let d=n!==void 0?n:ep(l)===ep(c);o(t,{replace:d,state:s,preventScrollReset:r,relative:a,viewTransition:i})}},[l,o,c,n,s,e,t,r,a,i])}var C9=0,N9=()=>`__${String(++C9)}__`;function k9(){let{router:t}=ML("useSubmit"),{basename:e}=K.useContext(qa),n=GG();return K.useCallback(async(s,r={})=>{let{action:a,method:i,encType:o,formData:l,body:c}=r9(s,e);if(r.navigate===!1){let f=r.fetcherKey||N9();await t.fetch(f,n,r.action||a,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||i,formEncType:r.encType||o,flushSync:r.flushSync})}else await t.navigate(r.action||a,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||i,formEncType:r.encType||o,replace:r.replace,state:r.state,fromRouteId:n,flushSync:r.flushSync,viewTransition:r.viewTransition})},[t,e,n])}function E9(t,{relative:e}={}){let{basename:n}=K.useContext(qa),s=K.useContext(Mi);Qt(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),a={..._p(t||".",{relative:e})},i=zi();if(t==null){a.search=i.search;let o=new URLSearchParams(a.search),l=o.getAll("index");if(l.some(f=>f==="")){o.delete("index"),l.filter(d=>d).forEach(d=>o.append("index",d));let f=o.toString();a.search=f?`?${f}`:""}}return(!t||t===".")&&r.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:Si([n,a.pathname])),ep(a)}function $9(t,e={}){let n=K.useContext($L);Qt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=ML("useViewTransitionState"),r=_p(t,{relative:e.relative});if(!n.isTransitioning)return!1;let a=ki(n.currentLocation.pathname,s)||n.currentLocation.pathname,i=ki(n.nextLocation.pathname,s)||n.nextLocation.pathname;return n1(r.pathname,i)!=null||n1(r.pathname,a)!=null}new TextEncoder;const PC=K.createContext({});function BC(t){const e=K.useRef(null);return e.current===null&&(e.current=t()),e.current}const VC=typeof window<"u",zL=VC?K.useLayoutEffect:K.useEffect,X1=K.createContext(null),UC=K.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class I9 extends K.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const s=n.offsetParent,r=s instanceof HTMLElement&&s.offsetWidth||0,a=this.props.sizeRef.current;a.height=n.offsetHeight||0,a.width=n.offsetWidth||0,a.top=n.offsetTop,a.left=n.offsetLeft,a.right=r-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function A9({children:t,isPresent:e,anchorX:n}){const s=K.useId(),r=K.useRef(null),a=K.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:i}=K.useContext(UC);return K.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:f,right:d}=a.current;if(e||!r.current||!o||!l)return;const p=n==="left"?`left: ${f}`:`right: ${d}`;r.current.dataset.motionPopId=s;const g=document.createElement("style");return i&&(g.nonce=i),document.head.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            ${p}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.removeChild(g)}},[e]),L.jsx(I9,{isPresent:e,childRef:r,sizeRef:a,children:K.cloneElement(t,{ref:r})})}const R9=({children:t,initial:e,isPresent:n,onExitComplete:s,custom:r,presenceAffectsLayout:a,mode:i,anchorX:o})=>{const l=BC(D9),c=K.useId(),f=K.useCallback(p=>{l.set(p,!0);for(const g of l.values())if(!g)return;s&&s()},[l,s]),d=K.useMemo(()=>({id:c,initial:e,isPresent:n,custom:r,onExitComplete:f,register:p=>(l.set(p,!1),()=>l.delete(p))}),a?[Math.random(),f]:[n,f]);return K.useMemo(()=>{l.forEach((p,g)=>l.set(g,!1))},[n]),K.useEffect(()=>{!n&&!l.size&&s&&s()},[n]),i==="popLayout"&&(t=L.jsx(A9,{isPresent:n,anchorX:o,children:t})),L.jsx(X1.Provider,{value:d,children:t})};function D9(){return new Map}function PL(t=!0){const e=K.useContext(X1);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:s,register:r}=e,a=K.useId();K.useEffect(()=>{if(t)return r(a)},[t]);const i=K.useCallback(()=>t&&s&&s(a),[a,s,t]);return!n&&s?[!1,i]:[!0]}const U0=t=>t.key||"";function M3(t){const e=[];return K.Children.forEach(t,n=>{K.isValidElement(n)&&e.push(n)}),e}const wu=({children:t,custom:e,initial:n=!0,onExitComplete:s,presenceAffectsLayout:r=!0,mode:a="sync",propagate:i=!1,anchorX:o="left"})=>{const[l,c]=PL(i),f=K.useMemo(()=>M3(t),[t]),d=i&&!l?[]:f.map(U0),p=K.useRef(!0),g=K.useRef(f),y=BC(()=>new Map),[v,x]=K.useState(f),[w,T]=K.useState(f);zL(()=>{p.current=!1,g.current=f;for(let E=0;E<w.length;E++){const R=U0(w[E]);d.includes(R)?y.delete(R):y.get(R)!==!0&&y.set(R,!1)}},[w,d.length,d.join("-")]);const N=[];if(f!==v){let E=[...f];for(let R=0;R<w.length;R++){const $=w[R],O=U0($);d.includes(O)||(E.splice(R,0,$),N.push($))}return a==="wait"&&N.length&&(E=N),T(M3(E)),x(f),null}const{forceRender:C}=K.useContext(PC);return L.jsx(L.Fragment,{children:w.map(E=>{const R=U0(E),$=i&&!l?!1:f===w||d.includes(R),O=()=>{if(y.has(R))y.set(R,!0);else return;let A=!0;y.forEach(_=>{_||(A=!1)}),A&&(C==null||C(),T(g.current),i&&(c==null||c()),s&&s())};return L.jsx(R9,{isPresent:$,initial:!p.current||n?void 0:!1,custom:e,presenceAffectsLayout:r,mode:a,onExitComplete:$?void 0:O,anchorX:o,children:E},R)})})};function jC(t,e){t.indexOf(e)===-1&&t.push(e)}function WC(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const dr=t=>t;let BL=dr;const O9={useManualTiming:!1};function GC(t){let e;return()=>(e===void 0&&(e=t()),e)}const Mc=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s};class HC{constructor(){this.subscriptions=[]}add(e){return jC(this.subscriptions,e),()=>WC(this.subscriptions,e)}notify(e,n,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,n,s);else for(let a=0;a<r;a++){const i=this.subscriptions[a];i&&i(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ti=t=>t*1e3,Ci=t=>t/1e3;function VL(t,e){return e?t*(1e3/e):0}const _9=GC(()=>window.ScrollTimeline!==void 0);class F9{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let s=0;s<this.animations.length;s++)this.animations[s][e]=n}attachTimeline(e,n){const s=this.animations.map(r=>{if(_9()&&r.attachTimeline)return r.attachTimeline(e);if(typeof n=="function")return n(r)});return()=>{s.forEach((r,a)=>{r&&r(),this.animations[a].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class L9 extends F9{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function qC(t,e){return t?t[e]||t.default||t:void 0}const GS=2e4;function UL(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<GS;)e+=n,s=t.next(e);return e>=GS?1/0:e}function XC(t){return typeof t=="function"}function z3(t,e){t.timeline=e,t.onfinish=null}const KC=t=>Array.isArray(t)&&typeof t[0]=="number",M9={linearEasing:void 0};function z9(t,e){const n=GC(t);return()=>{var s;return(s=M9[e])!==null&&s!==void 0?s:n()}}const s1=z9(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),jL=(t,e,n=10)=>{let s="";const r=Math.max(Math.round(e/n),2);for(let a=0;a<r;a++)s+=t(Mc(0,r-1,a))+", ";return`linear(${s.substring(0,s.length-2)})`};function WL(t){return!!(typeof t=="function"&&s1()||!t||typeof t=="string"&&(t in HS||s1())||KC(t)||Array.isArray(t)&&t.every(WL))}const _d=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,HS={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:_d([0,.65,.55,1]),circOut:_d([.55,0,1,.45]),backIn:_d([.31,.01,.66,-.59]),backOut:_d([.33,1.53,.69,.99])};function GL(t,e){if(t)return typeof t=="function"&&s1()?jL(t,e):KC(t)?_d(t):Array.isArray(t)?t.map(n=>GL(n,e)||HS.easeOut):HS[t]}const j0=["read","resolveKeyframes","update","preRender","render","postRender"],P3={value:null};function P9(t,e){let n=new Set,s=new Set,r=!1,a=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(d){i.has(d)&&(f.schedule(d),t()),l++,d(o)}const f={schedule:(d,p=!1,g=!1)=>{const v=g&&r?n:s;return p&&i.add(d),v.has(d)||v.add(d),d},cancel:d=>{s.delete(d),i.delete(d)},process:d=>{if(o=d,r){a=!0;return}r=!0,[n,s]=[s,n],n.forEach(c),e&&P3.value&&P3.value.frameloop[e].push(l),l=0,n.clear(),r=!1,a&&(a=!1,f.process(d))}};return f}const B9=40;function HL(t,e){let n=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},a=()=>n=!0,i=j0.reduce((w,T)=>(w[T]=P9(a,e?T:void 0),w),{}),{read:o,resolveKeyframes:l,update:c,preRender:f,render:d,postRender:p}=i,g=()=>{const w=performance.now();n=!1,r.delta=s?1e3/60:Math.max(Math.min(w-r.timestamp,B9),1),r.timestamp=w,r.isProcessing=!0,o.process(r),l.process(r),c.process(r),f.process(r),d.process(r),p.process(r),r.isProcessing=!1,n&&e&&(s=!1,t(g))},y=()=>{n=!0,s=!0,r.isProcessing||t(g)};return{schedule:j0.reduce((w,T)=>{const N=i[T];return w[T]=(C,E=!1,R=!1)=>(n||y(),N.schedule(C,E,R)),w},{}),cancel:w=>{for(let T=0;T<j0.length;T++)i[j0[T]].cancel(w)},state:r,steps:i}}const{schedule:Pt,cancel:Ro,state:ns,steps:Y2}=HL(typeof requestAnimationFrame<"u"?requestAnimationFrame:dr,!0),{schedule:YC}=HL(queueMicrotask,!1);let hy;function V9(){hy=void 0}const _a={now:()=>(hy===void 0&&_a.set(ns.isProcessing||O9.useManualTiming?ns.timestamp:performance.now()),hy),set:t=>{hy=t,queueMicrotask(V9)}},ta={x:!1,y:!1};function qL(){return ta.x||ta.y}function U9(t){return t==="x"||t==="y"?ta[t]?null:(ta[t]=!0,()=>{ta[t]=!1}):ta.x||ta.y?null:(ta.x=ta.y=!0,()=>{ta.x=ta.y=!1})}function j9(t,e,n){var s;if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;const a=(s=void 0)!==null&&s!==void 0?s:r.querySelectorAll(t);return a?Array.from(a):[]}return Array.from(t)}function XL(t,e){const n=j9(t),s=new AbortController,r={passive:!0,...e,signal:s.signal};return[n,r,()=>s.abort()]}function B3(t){return!(t.pointerType==="touch"||qL())}function W9(t,e,n={}){const[s,r,a]=XL(t,n),i=o=>{if(!B3(o))return;const{target:l}=o,c=e(l,o);if(typeof c!="function"||!l)return;const f=d=>{B3(d)&&(c(d),l.removeEventListener("pointerleave",f))};l.addEventListener("pointerleave",f,r)};return s.forEach(o=>{o.addEventListener("pointerenter",i,r)}),a}function V3(t,e){const n=`${e}PointerCapture`;if(t.target instanceof Element&&n in t.target&&t.pointerId!==void 0)try{t.target[n](t.pointerId)}catch{}}const KL=(t,e)=>e?t===e?!0:KL(t,e.parentElement):!1,ZC=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,G9=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function H9(t){return G9.has(t.tagName)||t.tabIndex!==-1}const Fd=new WeakSet;function U3(t){return e=>{e.key==="Enter"&&t(e)}}function Z2(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const q9=(t,e)=>{const n=t.currentTarget;if(!n)return;const s=U3(()=>{if(Fd.has(n))return;Z2(n,"down");const r=U3(()=>{Z2(n,"up")}),a=()=>Z2(n,"cancel");n.addEventListener("keyup",r,e),n.addEventListener("blur",a,e)});n.addEventListener("keydown",s,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",s),e)};function j3(t){return ZC(t)&&!qL()}function X9(t,e,n={}){const[s,r,a]=XL(t,n),i=o=>{const l=o.currentTarget;if(!l||!j3(o)||Fd.has(l))return;Fd.add(l),V3(o,"set");const c=e(l,o),f=(g,y)=>{l.removeEventListener("pointerup",d),l.removeEventListener("pointercancel",p),V3(g,"release"),!(!j3(g)||!Fd.has(l))&&(Fd.delete(l),typeof c=="function"&&c(g,{success:y}))},d=g=>{(g.isTrusted?K9(g,l instanceof Element?l.getBoundingClientRect():{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight}):!1)?f(g,!1):f(g,!(l instanceof Element)||KL(l,g.target))},p=g=>{f(g,!1)};l.addEventListener("pointerup",d,r),l.addEventListener("pointercancel",p,r),l.addEventListener("lostpointercapture",p,r)};return s.forEach(o=>{o=n.useGlobalTarget?window:o;let l=!1;o instanceof HTMLElement&&(l=!0,!H9(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0)),o.addEventListener("pointerdown",i,r),l&&o.addEventListener("focus",c=>q9(c,r),r)}),a}function K9(t,e){return t.clientX<e.left||t.clientX>e.right||t.clientY<e.top||t.clientY>e.bottom}const W3=30,Y9=t=>!isNaN(parseFloat(t));class Z9{constructor(e,n={}){this.version="12.5.0",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,r=!0)=>{const a=_a.now();this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=_a.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Y9(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new HC);const s=this.events[e].add(n);return e==="change"?()=>{s(),Pt.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=_a.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>W3)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,W3);return VL(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function tp(t,e){return new Z9(t,e)}const YL=K.createContext({strict:!1}),G3={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},zc={};for(const t in G3)zc[t]={isEnabled:e=>G3[t].some(n=>!!e[n])};function Q9(t){for(const e in t)zc[e]={...zc[e],...t[e]}}const J9=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function r1(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||J9.has(t)}let ZL=t=>!r1(t);function eH(t){t&&(ZL=e=>e.startsWith("on")?!r1(e):t(e))}try{eH(require("@emotion/is-prop-valid").default)}catch{}function tH(t,e,n){const s={};for(const r in t)r==="values"&&typeof t.values=="object"||(ZL(r)||n===!0&&r1(r)||!e&&!r1(r)||t.draggable&&r.startsWith("onDrag"))&&(s[r]=t[r]);return s}function nH(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...s)=>t(...s);return new Proxy(n,{get:(s,r)=>r==="create"?t:(e.has(r)||e.set(r,t(r)),e.get(r))})}const K1=K.createContext({});function Y1(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function np(t){return typeof t=="string"||Array.isArray(t)}const QC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],JC=["initial",...QC];function Z1(t){return Y1(t.animate)||JC.some(e=>np(t[e]))}function QL(t){return!!(Z1(t)||t.variants)}function sH(t,e){if(Z1(t)){const{initial:n,animate:s}=t;return{initial:n===!1||np(n)?n:void 0,animate:np(s)?s:void 0}}return t.inherit!==!1?e:{}}function rH(t){const{initial:e,animate:n}=sH(t,K.useContext(K1));return K.useMemo(()=>({initial:e,animate:n}),[H3(e),H3(n)])}function H3(t){return Array.isArray(t)?t.join(" "):t}const aH=Symbol.for("motionComponentSymbol");function Nc(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function iH(t,e,n){return K.useCallback(s=>{s&&t.onMount&&t.onMount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):Nc(n)&&(n.current=s))},[e])}const eN=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),oH="framerAppearId",JL="data-"+eN(oH),eM=K.createContext({});function lH(t,e,n,s,r){var a,i;const{visualElement:o}=K.useContext(K1),l=K.useContext(YL),c=K.useContext(X1),f=K.useContext(UC).reducedMotion,d=K.useRef(null);s=s||l.renderer,!d.current&&s&&(d.current=s(t,{visualState:e,parent:o,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:f}));const p=d.current,g=K.useContext(eM);p&&!p.projection&&r&&(p.type==="html"||p.type==="svg")&&uH(d.current,n,r,g);const y=K.useRef(!1);K.useInsertionEffect(()=>{p&&y.current&&p.update(n,c)});const v=n[JL],x=K.useRef(!!v&&!(!((a=window.MotionHandoffIsComplete)===null||a===void 0)&&a.call(window,v))&&((i=window.MotionHasOptimisedAnimation)===null||i===void 0?void 0:i.call(window,v)));return zL(()=>{p&&(y.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),YC.render(p.render),x.current&&p.animationState&&p.animationState.animateChanges())}),K.useEffect(()=>{p&&(!x.current&&p.animationState&&p.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var w;(w=window.MotionHandoffMarkAsComplete)===null||w===void 0||w.call(window,v)}),x.current=!1))}),p}function uH(t,e,n,s){const{layoutId:r,layout:a,drag:i,dragConstraints:o,layoutScroll:l,layoutRoot:c}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:tM(t.parent)),t.projection.setOptions({layoutId:r,layout:a,alwaysMeasureLayout:!!i||o&&Nc(o),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:s,layoutScroll:l,layoutRoot:c})}function tM(t){if(t)return t.options.allowProjection!==!1?t.projection:tM(t.parent)}function cH({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:s,Component:r}){var a,i;t&&Q9(t);function o(c,f){let d;const p={...K.useContext(UC),...c,layoutId:hH(c)},{isStatic:g}=p,y=rH(c),v=s(c,g);if(!g&&VC){fH();const x=dH(p);d=x.MeasureLayout,y.visualElement=lH(r,v,p,e,x.ProjectionNode)}return L.jsxs(K1.Provider,{value:y,children:[d&&y.visualElement?L.jsx(d,{visualElement:y.visualElement,...p}):null,n(r,c,iH(v,y.visualElement,f),v,g,y.visualElement)]})}o.displayName=`motion.${typeof r=="string"?r:`create(${(i=(a=r.displayName)!==null&&a!==void 0?a:r.name)!==null&&i!==void 0?i:""})`}`;const l=K.forwardRef(o);return l[aH]=r,l}function hH({layoutId:t}){const e=K.useContext(PC).id;return e&&t!==void 0?e+"-"+t:t}function fH(t,e){K.useContext(YL).strict}function dH(t){const{drag:e,layout:n}=zc;if(!e&&!n)return{};const s={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}const nM=t=>e=>typeof e=="string"&&e.startsWith(t),tN=nM("--"),pH=nM("var(--"),nN=t=>pH(t)?mH.test(t.split("/*")[0].trim()):!1,mH=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,sp={};function gH(t){for(const e in t)sp[e]=t[e],tN(e)&&(sp[e].isCSSVariable=!0)}const sh=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Su=new Set(sh);function sM(t,{layout:e,layoutId:n}){return Su.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!sp[t]||t==="opacity")}const ms=t=>!!(t&&t.getVelocity),rM=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Ei=(t,e,n)=>n>e?e:n<t?t:n,rh={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},rp={...rh,transform:t=>Ei(0,1,t)},W0={...rh,default:1},Fp=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),vo=Fp("deg"),Fa=Fp("%"),He=Fp("px"),yH=Fp("vh"),bH=Fp("vw"),q3={...Fa,parse:t=>Fa.parse(t)/100,transform:t=>Fa.transform(t*100)},xH={borderWidth:He,borderTopWidth:He,borderRightWidth:He,borderBottomWidth:He,borderLeftWidth:He,borderRadius:He,radius:He,borderTopLeftRadius:He,borderTopRightRadius:He,borderBottomRightRadius:He,borderBottomLeftRadius:He,width:He,maxWidth:He,height:He,maxHeight:He,top:He,right:He,bottom:He,left:He,padding:He,paddingTop:He,paddingRight:He,paddingBottom:He,paddingLeft:He,margin:He,marginTop:He,marginRight:He,marginBottom:He,marginLeft:He,backgroundPositionX:He,backgroundPositionY:He},vH={rotate:vo,rotateX:vo,rotateY:vo,rotateZ:vo,scale:W0,scaleX:W0,scaleY:W0,scaleZ:W0,skew:vo,skewX:vo,skewY:vo,distance:He,translateX:He,translateY:He,translateZ:He,x:He,y:He,z:He,perspective:He,transformPerspective:He,opacity:rp,originX:q3,originY:q3,originZ:He},X3={...rh,transform:Math.round},sN={...xH,...vH,zIndex:X3,size:He,fillOpacity:rp,strokeOpacity:rp,numOctaves:X3},wH={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},SH=sh.length;function TH(t,e,n){let s="",r=!0;for(let a=0;a<SH;a++){const i=sh[a],o=t[i];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(i.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||n){const c=rM(o,sN[i]);if(!l){r=!1;const f=wH[i]||i;s+=`${f}(${c}) `}n&&(e[i]=c)}}return s=s.trim(),n?s=n(e,r?"":s):r&&(s="none"),s}function rN(t,e,n){const{style:s,vars:r,transformOrigin:a}=t;let i=!1,o=!1;for(const l in e){const c=e[l];if(Su.has(l)){i=!0;continue}else if(tN(l)){r[l]=c;continue}else{const f=rM(c,sN[l]);l.startsWith("origin")?(o=!0,a[l]=f):s[l]=f}}if(e.transform||(i||n?s.transform=TH(e,t.transform,n):s.transform&&(s.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:f=0}=a;s.transformOrigin=`${l} ${c} ${f}`}}const aN=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function aM(t,e,n){for(const s in e)!ms(e[s])&&!sM(s,n)&&(t[s]=e[s])}function CH({transformTemplate:t},e){return K.useMemo(()=>{const n=aN();return rN(n,e,t),Object.assign({},n.vars,n.style)},[e])}function NH(t,e){const n=t.style||{},s={};return aM(s,n,t),Object.assign(s,CH(t,e)),s}function kH(t,e){const n={},s=NH(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=s,n}const EH=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function iN(t){return typeof t!="string"||t.includes("-")?!1:!!(EH.indexOf(t)>-1||/[A-Z]/u.test(t))}const $H={offset:"stroke-dashoffset",array:"stroke-dasharray"},IH={offset:"strokeDashoffset",array:"strokeDasharray"};function AH(t,e,n=1,s=0,r=!0){t.pathLength=1;const a=r?$H:IH;t[a.offset]=He.transform(-s);const i=He.transform(e),o=He.transform(n);t[a.array]=`${i} ${o}`}function K3(t,e,n){return typeof t=="string"?t:He.transform(e+n*t)}function RH(t,e,n){const s=K3(e,t.x,t.width),r=K3(n,t.y,t.height);return`${s} ${r}`}function oN(t,{attrX:e,attrY:n,attrScale:s,originX:r,originY:a,pathLength:i,pathSpacing:o=1,pathOffset:l=0,...c},f,d){if(rN(t,c,d),f){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:p,style:g,dimensions:y}=t;p.transform&&(y&&(g.transform=p.transform),delete p.transform),y&&(r!==void 0||a!==void 0||g.transform)&&(g.transformOrigin=RH(y,r!==void 0?r:.5,a!==void 0?a:.5)),e!==void 0&&(p.x=e),n!==void 0&&(p.y=n),s!==void 0&&(p.scale=s),i!==void 0&&AH(p,i,o,l,!1)}const iM=()=>({...aN(),attrs:{}}),lN=t=>typeof t=="string"&&t.toLowerCase()==="svg";function DH(t,e,n,s){const r=K.useMemo(()=>{const a=iM();return oN(a,e,lN(s),t.transformTemplate),{...a.attrs,style:{...a.style}}},[e]);if(t.style){const a={};aM(a,t.style,t),r.style={...a,...r.style}}return r}function OH(t=!1){return(n,s,r,{latestValues:a},i)=>{const l=(iN(n)?DH:kH)(s,a,i,n),c=tH(s,typeof n=="string",t),f=n!==K.Fragment?{...c,...l,ref:r}:{},{children:d}=s,p=K.useMemo(()=>ms(d)?d.get():d,[d]);return K.createElement(n,{...f,children:p})}}function Y3(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function uN(t,e,n,s){if(typeof e=="function"){const[r,a]=Y3(s);e=e(n!==void 0?n:t.custom,r,a)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[r,a]=Y3(s);e=e(n!==void 0?n:t.custom,r,a)}return e}const qS=t=>Array.isArray(t),_H=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),FH=t=>qS(t)?t[t.length-1]||0:t;function fy(t){const e=ms(t)?t.get():t;return _H(e)?e.toValue():e}function LH({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:n},s,r,a){const i={latestValues:MH(s,r,a,t),renderState:e()};return n&&(i.onMount=o=>n({props:s,current:o,...i}),i.onUpdate=o=>n(o)),i}const oM=t=>(e,n)=>{const s=K.useContext(K1),r=K.useContext(X1),a=()=>LH(t,e,s,r);return n?a():BC(a)};function MH(t,e,n,s){const r={},a=s(t,{});for(const p in a)r[p]=fy(a[p]);let{initial:i,animate:o}=t;const l=Z1(t),c=QL(t);e&&c&&!l&&t.inherit!==!1&&(i===void 0&&(i=e.initial),o===void 0&&(o=e.animate));let f=n?n.initial===!1:!1;f=f||i===!1;const d=f?o:i;if(d&&typeof d!="boolean"&&!Y1(d)){const p=Array.isArray(d)?d:[d];for(let g=0;g<p.length;g++){const y=uN(t,p[g]);if(y){const{transitionEnd:v,transition:x,...w}=y;for(const T in w){let N=w[T];if(Array.isArray(N)){const C=f?N.length-1:0;N=N[C]}N!==null&&(r[T]=N)}for(const T in v)r[T]=v[T]}}}return r}function cN(t,e,n){var s;const{style:r}=t,a={};for(const i in r)(ms(r[i])||e.style&&ms(e.style[i])||sM(i,t)||((s=n==null?void 0:n.getValue(i))===null||s===void 0?void 0:s.liveStyle)!==void 0)&&(a[i]=r[i]);return a}const zH={useVisualState:oM({scrapeMotionValuesFromProps:cN,createRenderState:aN})};function lM(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}function uM(t,{style:e,vars:n},s,r){Object.assign(t.style,e,r&&r.getProjectionStyles(s));for(const a in n)t.style.setProperty(a,n[a])}const cM=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function hM(t,e,n,s){uM(t,e,void 0,s);for(const r in e.attrs)t.setAttribute(cM.has(r)?r:eN(r),e.attrs[r])}function fM(t,e,n){const s=cN(t,e,n);for(const r in t)if(ms(t[r])||ms(e[r])){const a=sh.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;s[a]=t[r]}return s}const Z3=["x","y","width","height","cx","cy","r"],PH={useVisualState:oM({scrapeMotionValuesFromProps:fM,createRenderState:iM,onUpdate:({props:t,prevProps:e,current:n,renderState:s,latestValues:r})=>{if(!n)return;let a=!!t.drag;if(!a){for(const o in r)if(Su.has(o)){a=!0;break}}if(!a)return;let i=!e;if(e)for(let o=0;o<Z3.length;o++){const l=Z3[o];t[l]!==e[l]&&(i=!0)}i&&Pt.read(()=>{lM(n,s),Pt.render(()=>{oN(s,r,lN(n.tagName),t.transformTemplate),hM(n,s)})})}})};function BH(t,e){return function(s,{forwardMotionProps:r}={forwardMotionProps:!1}){const i={...iN(s)?PH:zH,preloadedFeatures:t,useRender:OH(r),createVisualElement:e,Component:s};return cH(i)}}function ap(t,e,n){const s=t.getProps();return uN(s,e,n!==void 0?n:s.custom,t)}const dM=new Set(["width","height","top","left","right","bottom",...sh]);function VH(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,tp(n))}function UH(t,e){const n=ap(t,e);let{transitionEnd:s={},transition:r={},...a}=n||{};a={...a,...s};for(const i in a){const o=FH(a[i]);VH(t,i,o)}}function jH(t){return!!(ms(t)&&t.add)}function XS(t,e){const n=t.getValue("willChange");if(jH(n))return n.add(e)}function pM(t){return t.props[JL]}const mM=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,WH=1e-7,GH=12;function HH(t,e,n,s,r){let a,i,o=0;do i=e+(n-e)/2,a=mM(i,s,r)-t,a>0?n=i:e=i;while(Math.abs(a)>WH&&++o<GH);return i}function Lp(t,e,n,s){if(t===e&&n===s)return dr;const r=a=>HH(a,0,1,t,n);return a=>a===0||a===1?a:mM(r(a),e,s)}const gM=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,yM=t=>e=>1-t(1-e),bM=Lp(.33,1.53,.69,.99),hN=yM(bM),xM=gM(hN),vM=t=>(t*=2)<1?.5*hN(t):.5*(2-Math.pow(2,-10*(t-1))),fN=t=>1-Math.sin(Math.acos(t)),wM=yM(fN),SM=gM(fN),TM=t=>/^0[^.\s]+$/u.test(t);function qH(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||TM(t):!0}const Hd=t=>Math.round(t*1e5)/1e5,dN=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function XH(t){return t==null}const KH=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,pN=(t,e)=>n=>!!(typeof n=="string"&&KH.test(n)&&n.startsWith(t)||e&&!XH(n)&&Object.prototype.hasOwnProperty.call(n,e)),CM=(t,e,n)=>s=>{if(typeof s!="string")return s;const[r,a,i,o]=s.match(dN);return{[t]:parseFloat(r),[e]:parseFloat(a),[n]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},YH=t=>Ei(0,255,t),Q2={...rh,transform:t=>Math.round(YH(t))},Vl={test:pN("rgb","red"),parse:CM("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+Q2.transform(t)+", "+Q2.transform(e)+", "+Q2.transform(n)+", "+Hd(rp.transform(s))+")"};function ZH(t){let e="",n="",s="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,s+=s,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const KS={test:pN("#"),parse:ZH,transform:Vl.transform},kc={test:pN("hsl","hue"),parse:CM("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+Fa.transform(Hd(e))+", "+Fa.transform(Hd(n))+", "+Hd(rp.transform(s))+")"},us={test:t=>Vl.test(t)||KS.test(t)||kc.test(t),parse:t=>Vl.test(t)?Vl.parse(t):kc.test(t)?kc.parse(t):KS.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Vl.transform(t):kc.transform(t)},QH=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function JH(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(dN))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(QH))===null||n===void 0?void 0:n.length)||0)>0}const NM="number",kM="color",eq="var",tq="var(",Q3="${}",nq=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ip(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},r=[];let a=0;const o=e.replace(nq,l=>(us.test(l)?(s.color.push(a),r.push(kM),n.push(us.parse(l))):l.startsWith(tq)?(s.var.push(a),r.push(eq),n.push(l)):(s.number.push(a),r.push(NM),n.push(parseFloat(l))),++a,Q3)).split(Q3);return{values:n,split:o,indexes:s,types:r}}function EM(t){return ip(t).values}function $M(t){const{split:e,types:n}=ip(t),s=e.length;return r=>{let a="";for(let i=0;i<s;i++)if(a+=e[i],r[i]!==void 0){const o=n[i];o===NM?a+=Hd(r[i]):o===kM?a+=us.transform(r[i]):a+=r[i]}return a}}const sq=t=>typeof t=="number"?0:t;function rq(t){const e=EM(t);return $M(t)(e.map(sq))}const Do={test:JH,parse:EM,createTransformer:$M,getAnimatableNone:rq},aq=new Set(["brightness","contrast","saturate","opacity"]);function iq(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(dN)||[];if(!s)return t;const r=n.replace(s,"");let a=aq.has(e)?1:0;return s!==n&&(a*=100),e+"("+a+r+")"}const oq=/\b([a-z-]*)\(.*?\)/gu,YS={...Do,getAnimatableNone:t=>{const e=t.match(oq);return e?e.map(iq).join(" "):t}},lq={...sN,color:us,backgroundColor:us,outlineColor:us,fill:us,stroke:us,borderColor:us,borderTopColor:us,borderRightColor:us,borderBottomColor:us,borderLeftColor:us,filter:YS,WebkitFilter:YS},IM=t=>lq[t];function AM(t,e){let n=IM(t);return n!==YS&&(n=Do),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const uq=new Set(["auto","none","0"]);function cq(t,e,n){let s=0,r;for(;s<t.length&&!r;){const a=t[s];typeof a=="string"&&!uq.has(a)&&ip(a).values.length&&(r=t[s]),s++}if(r&&n)for(const a of e)t[a]=AM(n,r)}const Ul=t=>t*180/Math.PI,ZS=t=>{const e=Ul(Math.atan2(t[1],t[0]));return QS(e)},hq={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:ZS,rotateZ:ZS,skewX:t=>Ul(Math.atan(t[1])),skewY:t=>Ul(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},QS=t=>(t=t%360,t<0&&(t+=360),t),J3=ZS,eO=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),tO=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),fq={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:eO,scaleY:tO,scale:t=>(eO(t)+tO(t))/2,rotateX:t=>QS(Ul(Math.atan2(t[6],t[5]))),rotateY:t=>QS(Ul(Math.atan2(-t[2],t[0]))),rotateZ:J3,rotate:J3,skewX:t=>Ul(Math.atan(t[4])),skewY:t=>Ul(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function nO(t){return t.includes("scale")?1:0}function JS(t,e){if(!t||t==="none")return nO(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,r;if(n)s=fq,r=n;else{const o=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=hq,r=o}if(!r)return nO(e);const a=s[e],i=r[1].split(",").map(pq);return typeof a=="function"?a(i):i[a]}const dq=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return JS(n,e)};function pq(t){return parseFloat(t.trim())}const sO=t=>t===rh||t===He,mq=new Set(["x","y","z"]),gq=sh.filter(t=>!mq.has(t));function yq(t){const e=[];return gq.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const Pc={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>JS(e,"x"),y:(t,{transform:e})=>JS(e,"y")};Pc.translateX=Pc.x;Pc.translateY=Pc.y;const ql=new Set;let eT=!1,tT=!1;function RM(){if(tT){const t=Array.from(ql).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const r=yq(s);r.length&&(n.set(s,r),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const r=n.get(s);r&&r.forEach(([a,i])=>{var o;(o=s.getValue(a))===null||o===void 0||o.set(i)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}tT=!1,eT=!1,ql.forEach(t=>t.complete()),ql.clear()}function DM(){ql.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(tT=!0)})}function bq(){DM(),RM()}class mN{constructor(e,n,s,r,a,i=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=r,this.element=a,this.isAsync=i}scheduleResolve(){this.isScheduled=!0,this.isAsync?(ql.add(this),eT||(eT=!0,Pt.read(DM),Pt.resolveKeyframes(RM))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:r}=this;for(let a=0;a<e.length;a++)if(e[a]===null)if(a===0){const i=r==null?void 0:r.get(),o=e[e.length-1];if(i!==void 0)e[0]=i;else if(s&&n){const l=s.readValue(n,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),r&&i===void 0&&r.set(e[0])}else e[a]=e[a-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),ql.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,ql.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const OM=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),xq=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function vq(t){const e=xq.exec(t);if(!e)return[,];const[,n,s,r]=e;return[`--${n??s}`,r]}function _M(t,e,n=1){const[s,r]=vq(t);if(!s)return;const a=window.getComputedStyle(e).getPropertyValue(s);if(a){const i=a.trim();return OM(i)?parseFloat(i):i}return nN(r)?_M(r,e,n+1):r}const FM=t=>e=>e.test(t),wq={test:t=>t==="auto",parse:t=>t},LM=[rh,He,Fa,vo,bH,yH,wq],rO=t=>LM.find(FM(t));class MM extends mN{constructor(e,n,s,r,a){super(e,n,s,r,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),nN(c))){const f=_M(c,n.current);f!==void 0&&(e[l]=f),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!dM.has(s)||e.length!==2)return;const[r,a]=e,i=rO(r),o=rO(a);if(i!==o)if(sO(i)&&sO(o))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let r=0;r<e.length;r++)qH(e[r])&&s.push(r);s.length&&cq(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Pc[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&e.getValue(s,r).jump(r,!1)}measureEndState(){var e;const{element:n,name:s,unresolvedKeyframes:r}=this;if(!n||!n.current)return;const a=n.getValue(s);a&&a.jump(this.measuredOrigin,!1);const i=r.length-1,o=r[i];r[i]=Pc[s](n.measureViewportBox(),window.getComputedStyle(n.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{n.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const aO=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Do.test(t)||t==="0")&&!t.startsWith("url("));function Sq(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function Tq(t,e,n,s){const r=t[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const a=t[t.length-1],i=aO(r,e),o=aO(a,e);return!i||!o?!1:Sq(t)||(n==="spring"||XC(n))&&s}const Cq=t=>t!==null;function Q1(t,{repeat:e,repeatType:n="loop"},s){const r=t.filter(Cq),a=e&&n!=="loop"&&e%2===1?0:r.length-1;return!a||s===void 0?r[a]:s}const Nq=40;class zM{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:r=0,repeatDelay:a=0,repeatType:i="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=_a.now(),this.options={autoplay:e,delay:n,type:s,repeat:r,repeatDelay:a,repeatType:i,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Nq?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&bq(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=_a.now(),this.hasAttemptedResolve=!0;const{name:s,type:r,velocity:a,delay:i,onComplete:o,onUpdate:l,isGenerator:c}=this.options;if(!c&&!Tq(e,s,r,a))if(i)this.options.duration=0;else{l&&l(Q1(e,this.options,n)),o&&o(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,n);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...f},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear")}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Yt=(t,e,n)=>t+(e-t)*n;function J2(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function kq({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let r=0,a=0,i=0;if(!e)r=a=i=n;else{const o=n<.5?n*(1+e):n+e-n*e,l=2*n-o;r=J2(l,o,t+1/3),a=J2(l,o,t),i=J2(l,o,t-1/3)}return{red:Math.round(r*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:s}}function a1(t,e){return n=>n>0?e:t}const eS=(t,e,n)=>{const s=t*t,r=n*(e*e-s)+s;return r<0?0:Math.sqrt(r)},Eq=[KS,Vl,kc],$q=t=>Eq.find(e=>e.test(t));function iO(t){const e=$q(t);if(!e)return!1;let n=e.parse(t);return e===kc&&(n=kq(n)),n}const oO=(t,e)=>{const n=iO(t),s=iO(e);if(!n||!s)return a1(t,e);const r={...n};return a=>(r.red=eS(n.red,s.red,a),r.green=eS(n.green,s.green,a),r.blue=eS(n.blue,s.blue,a),r.alpha=Yt(n.alpha,s.alpha,a),Vl.transform(r))},Iq=(t,e)=>n=>e(t(n)),Mp=(...t)=>t.reduce(Iq),nT=new Set(["none","hidden"]);function Aq(t,e){return nT.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function Rq(t,e){return n=>Yt(t,e,n)}function gN(t){return typeof t=="number"?Rq:typeof t=="string"?nN(t)?a1:us.test(t)?oO:_q:Array.isArray(t)?PM:typeof t=="object"?us.test(t)?oO:Dq:a1}function PM(t,e){const n=[...t],s=n.length,r=t.map((a,i)=>gN(a)(a,e[i]));return a=>{for(let i=0;i<s;i++)n[i]=r[i](a);return n}}function Dq(t,e){const n={...t,...e},s={};for(const r in n)t[r]!==void 0&&e[r]!==void 0&&(s[r]=gN(t[r])(t[r],e[r]));return r=>{for(const a in s)n[a]=s[a](r);return n}}function Oq(t,e){var n;const s=[],r={color:0,var:0,number:0};for(let a=0;a<e.values.length;a++){const i=e.types[a],o=t.indexes[i][r[i]],l=(n=t.values[o])!==null&&n!==void 0?n:0;s[a]=l,r[i]++}return s}const _q=(t,e)=>{const n=Do.createTransformer(e),s=ip(t),r=ip(e);return s.indexes.var.length===r.indexes.var.length&&s.indexes.color.length===r.indexes.color.length&&s.indexes.number.length>=r.indexes.number.length?nT.has(t)&&!r.values.length||nT.has(e)&&!s.values.length?Aq(t,e):Mp(PM(Oq(s,r),r.values),n):a1(t,e)};function BM(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Yt(t,e,n):gN(t)(t,e)}const Fq=5;function VM(t,e,n){const s=Math.max(e-Fq,0);return VL(n-t(s),e-s)}const rn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},lO=.001;function Lq({duration:t=rn.duration,bounce:e=rn.bounce,velocity:n=rn.velocity,mass:s=rn.mass}){let r,a,i=1-e;i=Ei(rn.minDamping,rn.maxDamping,i),t=Ei(rn.minDuration,rn.maxDuration,Ci(t)),i<1?(r=c=>{const f=c*i,d=f*t,p=f-n,g=sT(c,i),y=Math.exp(-d);return lO-p/g*y},a=c=>{const d=c*i*t,p=d*n+n,g=Math.pow(i,2)*Math.pow(c,2)*t,y=Math.exp(-d),v=sT(Math.pow(c,2),i);return(-r(c)+lO>0?-1:1)*((p-g)*y)/v}):(r=c=>{const f=Math.exp(-c*t),d=(c-n)*t+1;return-.001+f*d},a=c=>{const f=Math.exp(-c*t),d=(n-c)*(t*t);return f*d});const o=5/t,l=zq(r,a,o);if(t=Ti(t),isNaN(l))return{stiffness:rn.stiffness,damping:rn.damping,duration:t};{const c=Math.pow(l,2)*s;return{stiffness:c,damping:i*2*Math.sqrt(s*c),duration:t}}}const Mq=12;function zq(t,e,n){let s=n;for(let r=1;r<Mq;r++)s=s-t(s)/e(s);return s}function sT(t,e){return t*Math.sqrt(1-e*e)}const Pq=["duration","bounce"],Bq=["stiffness","damping","mass"];function uO(t,e){return e.some(n=>t[n]!==void 0)}function Vq(t){let e={velocity:rn.velocity,stiffness:rn.stiffness,damping:rn.damping,mass:rn.mass,isResolvedFromDuration:!1,...t};if(!uO(t,Bq)&&uO(t,Pq))if(t.visualDuration){const n=t.visualDuration,s=2*Math.PI/(n*1.2),r=s*s,a=2*Ei(.05,1,1-(t.bounce||0))*Math.sqrt(r);e={...e,mass:rn.mass,stiffness:r,damping:a}}else{const n=Lq(t);e={...e,...n,mass:rn.mass},e.isResolvedFromDuration=!0}return e}function UM(t=rn.visualDuration,e=rn.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:s,restDelta:r}=n;const a=n.keyframes[0],i=n.keyframes[n.keyframes.length-1],o={done:!1,value:a},{stiffness:l,damping:c,mass:f,duration:d,velocity:p,isResolvedFromDuration:g}=Vq({...n,velocity:-Ci(n.velocity||0)}),y=p||0,v=c/(2*Math.sqrt(l*f)),x=i-a,w=Ci(Math.sqrt(l/f)),T=Math.abs(x)<5;s||(s=T?rn.restSpeed.granular:rn.restSpeed.default),r||(r=T?rn.restDelta.granular:rn.restDelta.default);let N;if(v<1){const E=sT(w,v);N=R=>{const $=Math.exp(-v*w*R);return i-$*((y+v*w*x)/E*Math.sin(E*R)+x*Math.cos(E*R))}}else if(v===1)N=E=>i-Math.exp(-w*E)*(x+(y+w*x)*E);else{const E=w*Math.sqrt(v*v-1);N=R=>{const $=Math.exp(-v*w*R),O=Math.min(E*R,300);return i-$*((y+v*w*x)*Math.sinh(O)+E*x*Math.cosh(O))/E}}const C={calculatedDuration:g&&d||null,next:E=>{const R=N(E);if(g)o.done=E>=d;else{let $=0;v<1&&($=E===0?Ti(y):VM(N,E,R));const O=Math.abs($)<=s,A=Math.abs(i-R)<=r;o.done=O&&A}return o.value=o.done?i:R,o},toString:()=>{const E=Math.min(UL(C),GS),R=jL($=>C.next(E*$).value,E,30);return E+"ms "+R}};return C}function cO({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:a=500,modifyTarget:i,min:o,max:l,restDelta:c=.5,restSpeed:f}){const d=t[0],p={done:!1,value:d},g=O=>o!==void 0&&O<o||l!==void 0&&O>l,y=O=>o===void 0?l:l===void 0||Math.abs(o-O)<Math.abs(l-O)?o:l;let v=n*e;const x=d+v,w=i===void 0?x:i(x);w!==x&&(v=w-d);const T=O=>-v*Math.exp(-O/s),N=O=>w+T(O),C=O=>{const A=T(O),_=N(O);p.done=Math.abs(A)<=c,p.value=p.done?w:_};let E,R;const $=O=>{g(p.value)&&(E=O,R=UM({keyframes:[p.value,y(p.value)],velocity:VM(N,O,p.value),damping:r,stiffness:a,restDelta:c,restSpeed:f}))};return $(0),{calculatedDuration:null,next:O=>{let A=!1;return!R&&E===void 0&&(A=!0,C(O),$(O)),E!==void 0&&O>=E?R.next(O-E):(!A&&C(O),p)}}}const Uq=Lp(.42,0,1,1),jq=Lp(0,0,.58,1),jM=Lp(.42,0,.58,1),Wq=t=>Array.isArray(t)&&typeof t[0]!="number",Gq={linear:dr,easeIn:Uq,easeInOut:jM,easeOut:jq,circIn:fN,circInOut:SM,circOut:wM,backIn:hN,backInOut:xM,backOut:bM,anticipate:vM},hO=t=>{if(KC(t)){BL(t.length===4);const[e,n,s,r]=t;return Lp(e,n,s,r)}else if(typeof t=="string")return Gq[t];return t};function Hq(t,e,n){const s=[],r=n||BM,a=t.length-1;for(let i=0;i<a;i++){let o=r(t[i],t[i+1]);if(e){const l=Array.isArray(e)?e[i]||dr:e;o=Mp(l,o)}s.push(o)}return s}function qq(t,e,{clamp:n=!0,ease:s,mixer:r}={}){const a=t.length;if(BL(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const i=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=Hq(e,s,r),l=o.length,c=f=>{if(i&&f<t[0])return e[0];let d=0;if(l>1)for(;d<t.length-2&&!(f<t[d+1]);d++);const p=Mc(t[d],t[d+1],f);return o[d](p)};return n?f=>c(Ei(t[0],t[a-1],f)):c}function Xq(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const r=Mc(0,e,s);t.push(Yt(n,1,r))}}function Kq(t){const e=[0];return Xq(e,t.length-1),e}function Yq(t,e){return t.map(n=>n*e)}function Zq(t,e){return t.map(()=>e||jM).splice(0,t.length-1)}function i1({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const r=Wq(s)?s.map(hO):hO(s),a={done:!1,value:e[0]},i=Yq(n&&n.length===e.length?n:Kq(e),t),o=qq(i,e,{ease:Array.isArray(r)?r:Zq(e,r)});return{calculatedDuration:t,next:l=>(a.value=o(l),a.done=l>=t,a)}}const Qq=t=>{const e=({timestamp:n})=>t(n);return{start:()=>Pt.update(e,!0),stop:()=>Ro(e),now:()=>ns.isProcessing?ns.timestamp:_a.now()}},Jq={decay:cO,inertia:cO,tween:i1,keyframes:i1,spring:UM},eX=t=>t/100;class yN extends zM{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:s,element:r,keyframes:a}=this.options,i=(r==null?void 0:r.KeyframeResolver)||mN,o=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new i(a,o,n,s,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:s=0,repeatDelay:r=0,repeatType:a,velocity:i=0}=this.options,o=XC(n)?n:Jq[n]||i1;let l,c;o!==i1&&typeof e[0]!="number"&&(l=Mp(eX,BM(e[0],e[1])),e=[0,100]);const f=o({...this.options,keyframes:e});a==="mirror"&&(c=o({...this.options,keyframes:[...e].reverse(),velocity:-i})),f.calculatedDuration===null&&(f.calculatedDuration=UL(f));const{calculatedDuration:d}=f,p=d+r,g=p*(s+1)-r;return{generator:f,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:d,resolvedDuration:p,totalDuration:g}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:s}=this;if(!s){const{keyframes:O}=this.options;return{done:!0,value:O[O.length-1]}}const{finalKeyframe:r,generator:a,mirroredGenerator:i,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:c,totalDuration:f,resolvedDuration:d}=s;if(this.startTime===null)return a.next(0);const{delay:p,repeat:g,repeatType:y,repeatDelay:v,onUpdate:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const w=this.currentTime-p*(this.speed>=0?1:-1),T=this.speed>=0?w<0:w>f;this.currentTime=Math.max(w,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let N=this.currentTime,C=a;if(g){const O=Math.min(this.currentTime,f)/d;let A=Math.floor(O),_=O%1;!_&&O>=1&&(_=1),_===1&&A--,A=Math.min(A,g+1),!!(A%2)&&(y==="reverse"?(_=1-_,v&&(_-=v/d)):y==="mirror"&&(C=i)),N=Ei(0,1,_)*d}const E=T?{done:!1,value:l[0]}:C.next(N);o&&(E.value=o(E.value));let{done:R}=E;!T&&c!==null&&(R=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const $=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&R);return $&&r!==void 0&&(E.value=Q1(l,this.options,r)),x&&x(E.value),$&&this.finish(),E}get duration(){const{resolved:e}=this;return e?Ci(e.calculatedDuration):0}get time(){return Ci(this.currentTime)}set time(e){e=Ti(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Ci(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Qq,onPlay:n,startTime:s}=this.options;this.driver||(this.driver=e(a=>this.tick(a))),n&&n();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=s??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const tX=new Set(["opacity","clipPath","filter","transform"]);function nX(t,e,n,{delay:s=0,duration:r=300,repeat:a=0,repeatType:i="loop",ease:o="easeInOut",times:l}={}){const c={[e]:n};l&&(c.offset=l);const f=GL(o,r);return Array.isArray(f)&&(c.easing=f),t.animate(c,{delay:s,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"})}const sX=GC(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),o1=10,rX=2e4;function aX(t){return XC(t.type)||t.type==="spring"||!WL(t.ease)}function iX(t,e){const n=new yN({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let s={done:!1,value:t[0]};const r=[];let a=0;for(;!s.done&&a<rX;)s=n.sample(a),r.push(s.value),a+=o1;return{times:void 0,keyframes:r,duration:a-o1,ease:"linear"}}const WM={anticipate:vM,backInOut:xM,circInOut:SM};function oX(t){return t in WM}class fO extends zM{constructor(e){super(e);const{name:n,motionValue:s,element:r,keyframes:a}=this.options;this.resolver=new MM(a,(i,o)=>this.onKeyframesResolved(i,o),n,s,r),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:s=300,times:r,ease:a,type:i,motionValue:o,name:l,startTime:c}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof a=="string"&&s1()&&oX(a)&&(a=WM[a]),aX(this.options)){const{onComplete:d,onUpdate:p,motionValue:g,element:y,...v}=this.options,x=iX(e,v);e=x.keyframes,e.length===1&&(e[1]=e[0]),s=x.duration,r=x.times,a=x.ease,i="keyframes"}const f=nX(o.owner.current,l,e,{...this.options,duration:s,times:r,ease:a});return f.startTime=c??this.calcStartTime(),this.pendingTimeline?(z3(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:d}=this.options;o.set(Q1(e,this.options,n)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:s,times:r,type:i,ease:a,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return Ci(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return Ci(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.currentTime=Ti(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return dr;const{animation:s}=n;z3(s,e)}return dr}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:s,duration:r,type:a,ease:i,times:o}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:f,onComplete:d,element:p,...g}=this.options,y=new yN({...g,keyframes:s,duration:r,type:a,ease:i,times:o,isGenerator:!0}),v=Ti(this.time);c.setWithVelocity(y.sample(v-o1).value,y.sample(v).value,o1)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:s,repeatDelay:r,repeatType:a,damping:i,type:o}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=n.owner.getProps();return sX()&&s&&tX.has(s)&&!l&&!c&&!r&&a!=="mirror"&&i!==0&&o!=="inertia"}}const lX={type:"spring",stiffness:500,damping:25,restSpeed:10},uX=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),cX={type:"keyframes",duration:.8},hX={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},fX=(t,{keyframes:e})=>e.length>2?cX:Su.has(t)?t.startsWith("scale")?uX(e[1]):lX:hX;function dX({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:r,repeat:a,repeatType:i,repeatDelay:o,from:l,elapsed:c,...f}){return!!Object.keys(f).length}const bN=(t,e,n,s={},r,a)=>i=>{const o=qC(s,t)||{},l=o.delay||s.delay||0;let{elapsed:c=0}=s;c=c-Ti(l);let f={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-c,onUpdate:p=>{e.set(p),o.onUpdate&&o.onUpdate(p)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:t,motionValue:e,element:a?void 0:r};dX(o)||(f={...f,...fX(t,f)}),f.duration&&(f.duration=Ti(f.duration)),f.repeatDelay&&(f.repeatDelay=Ti(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let d=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(d=!0)),f.allowFlatten=!o.type&&!o.ease,d&&!a&&e.get()!==void 0){const p=Q1(f.keyframes,o);if(p!==void 0)return Pt.update(()=>{f.onUpdate(p),f.onComplete()}),new L9([])}return!a&&fO.supports(f)?new fO(f):new yN(f)};function pX({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function GM(t,e,{delay:n=0,transitionOverride:s,type:r}={}){var a;let{transition:i=t.getDefaultTransition(),transitionEnd:o,...l}=e;s&&(i=s);const c=[],f=r&&t.animationState&&t.animationState.getState()[r];for(const d in l){const p=t.getValue(d,(a=t.latestValues[d])!==null&&a!==void 0?a:null),g=l[d];if(g===void 0||f&&pX(f,d))continue;const y={delay:n,...qC(i||{},d)};let v=!1;if(window.MotionHandoffAnimation){const w=pM(t);if(w){const T=window.MotionHandoffAnimation(w,d,Pt);T!==null&&(y.startTime=T,v=!0)}}XS(t,d),p.start(bN(d,p,g,t.shouldReduceMotion&&dM.has(d)?{type:!1}:y,t,v));const x=p.animation;x&&c.push(x)}return o&&Promise.all(c).then(()=>{Pt.update(()=>{o&&UH(t,o)})}),c}function rT(t,e,n={}){var s;const r=ap(t,e,n.type==="exit"?(s=t.presenceContext)===null||s===void 0?void 0:s.custom:void 0);let{transition:a=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(a=n.transitionOverride);const i=r?()=>Promise.all(GM(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:f=0,staggerChildren:d,staggerDirection:p}=a;return mX(t,e,f+c,d,p,n)}:()=>Promise.resolve(),{when:l}=a;if(l){const[c,f]=l==="beforeChildren"?[i,o]:[o,i];return c().then(()=>f())}else return Promise.all([i(),o(n.delay)])}function mX(t,e,n=0,s=0,r=1,a){const i=[],o=(t.variantChildren.size-1)*s,l=r===1?(c=0)=>c*s:(c=0)=>o-c*s;return Array.from(t.variantChildren).sort(gX).forEach((c,f)=>{c.notify("AnimationStart",e),i.push(rT(c,e,{...a,delay:n+l(f)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(i)}function gX(t,e){return t.sortNodePosition(e)}function yX(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const r=e.map(a=>rT(t,a,n));s=Promise.all(r)}else if(typeof e=="string")s=rT(t,e,n);else{const r=typeof e=="function"?ap(t,e,n.custom):e;s=Promise.all(GM(t,r,n))}return s.then(()=>{t.notify("AnimationComplete",e)})}function HM(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}const bX=JC.length;function qM(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?qM(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<bX;n++){const s=JC[n],r=t.props[s];(np(r)||r===!1)&&(e[s]=r)}return e}const xX=[...QC].reverse(),vX=QC.length;function wX(t){return e=>Promise.all(e.map(({animation:n,options:s})=>yX(t,n,s)))}function SX(t){let e=wX(t),n=dO(),s=!0;const r=l=>(c,f)=>{var d;const p=ap(t,f,l==="exit"?(d=t.presenceContext)===null||d===void 0?void 0:d.custom:void 0);if(p){const{transition:g,transitionEnd:y,...v}=p;c={...c,...v,...y}}return c};function a(l){e=l(t)}function i(l){const{props:c}=t,f=qM(t.parent)||{},d=[],p=new Set;let g={},y=1/0;for(let x=0;x<vX;x++){const w=xX[x],T=n[w],N=c[w]!==void 0?c[w]:f[w],C=np(N),E=w===l?T.isActive:null;E===!1&&(y=x);let R=N===f[w]&&N!==c[w]&&C;if(R&&s&&t.manuallyAnimateOnMount&&(R=!1),T.protectedKeys={...g},!T.isActive&&E===null||!N&&!T.prevProp||Y1(N)||typeof N=="boolean")continue;const $=TX(T.prevProp,N);let O=$||w===l&&T.isActive&&!R&&C||x>y&&C,A=!1;const _=Array.isArray(N)?N:[N];let D=_.reduce(r(w),{});E===!1&&(D={});const{prevResolvedValues:B={}}=T,j={...B,...D},W=Y=>{O=!0,p.has(Y)&&(A=!0,p.delete(Y)),T.needsAnimating[Y]=!0;const Q=t.getValue(Y);Q&&(Q.liveStyle=!1)};for(const Y in j){const Q=D[Y],ie=B[Y];if(g.hasOwnProperty(Y))continue;let V=!1;qS(Q)&&qS(ie)?V=!HM(Q,ie):V=Q!==ie,V?Q!=null?W(Y):p.add(Y):Q!==void 0&&p.has(Y)?W(Y):T.protectedKeys[Y]=!0}T.prevProp=N,T.prevResolvedValues=D,T.isActive&&(g={...g,...D}),s&&t.blockInitialAnimation&&(O=!1),O&&(!(R&&$)||A)&&d.push(..._.map(Y=>({animation:Y,options:{type:w}})))}if(p.size){const x={};if(typeof c.initial!="boolean"){const w=ap(t,Array.isArray(c.initial)?c.initial[0]:c.initial);w&&w.transition&&(x.transition=w.transition)}p.forEach(w=>{const T=t.getBaseTarget(w),N=t.getValue(w);N&&(N.liveStyle=!0),x[w]=T??null}),d.push({animation:x})}let v=!!d.length;return s&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(v=!1),s=!1,v?e(d):Promise.resolve()}function o(l,c){var f;if(n[l].isActive===c)return Promise.resolve();(f=t.variantChildren)===null||f===void 0||f.forEach(p=>{var g;return(g=p.animationState)===null||g===void 0?void 0:g.setActive(l,c)}),n[l].isActive=c;const d=i(l);for(const p in n)n[p].protectedKeys={};return d}return{animateChanges:i,setActive:o,setAnimateFunction:a,getState:()=>n,reset:()=>{n=dO(),s=!0}}}function TX(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!HM(e,t):!1}function $l(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function dO(){return{animate:$l(!0),whileInView:$l(),whileHover:$l(),whileTap:$l(),whileDrag:$l(),whileFocus:$l(),exit:$l()}}class qo{constructor(e){this.isMounted=!1,this.node=e}update(){}}class CX extends qo{constructor(e){super(e),e.animationState||(e.animationState=SX(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Y1(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let NX=0;class kX extends qo{constructor(){super(...arguments),this.id=NX++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const r=this.node.animationState.setActive("exit",!e);n&&!e&&r.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const EX={animation:{Feature:CX},exit:{Feature:kX}};function op(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}function zp(t){return{point:{x:t.pageX,y:t.pageY}}}const $X=t=>e=>ZC(e)&&t(e,zp(e));function qd(t,e,n,s){return op(t,e,$X(n),s)}function XM({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function IX({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function AX(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}const KM=1e-4,RX=1-KM,DX=1+KM,YM=.01,OX=0-YM,_X=0+YM;function Es(t){return t.max-t.min}function FX(t,e,n){return Math.abs(t-e)<=n}function pO(t,e,n,s=.5){t.origin=s,t.originPoint=Yt(e.min,e.max,t.origin),t.scale=Es(n)/Es(e),t.translate=Yt(n.min,n.max,t.origin)-t.originPoint,(t.scale>=RX&&t.scale<=DX||isNaN(t.scale))&&(t.scale=1),(t.translate>=OX&&t.translate<=_X||isNaN(t.translate))&&(t.translate=0)}function Xd(t,e,n,s){pO(t.x,e.x,n.x,s?s.originX:void 0),pO(t.y,e.y,n.y,s?s.originY:void 0)}function mO(t,e,n){t.min=n.min+e.min,t.max=t.min+Es(e)}function LX(t,e,n){mO(t.x,e.x,n.x),mO(t.y,e.y,n.y)}function gO(t,e,n){t.min=e.min-n.min,t.max=t.min+Es(e)}function Kd(t,e,n){gO(t.x,e.x,n.x),gO(t.y,e.y,n.y)}const yO=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ec=()=>({x:yO(),y:yO()}),bO=()=>({min:0,max:0}),dn=()=>({x:bO(),y:bO()});function Mr(t){return[t("x"),t("y")]}function tS(t){return t===void 0||t===1}function aT({scale:t,scaleX:e,scaleY:n}){return!tS(t)||!tS(e)||!tS(n)}function Ol(t){return aT(t)||ZM(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function ZM(t){return xO(t.x)||xO(t.y)}function xO(t){return t&&t!=="0%"}function l1(t,e,n){const s=t-n,r=e*s;return n+r}function vO(t,e,n,s,r){return r!==void 0&&(t=l1(t,r,s)),l1(t,n,s)+e}function iT(t,e=0,n=1,s,r){t.min=vO(t.min,e,n,s,r),t.max=vO(t.max,e,n,s,r)}function QM(t,{x:e,y:n}){iT(t.x,e.translate,e.scale,e.originPoint),iT(t.y,n.translate,n.scale,n.originPoint)}const wO=.999999999999,SO=1.0000000000001;function MX(t,e,n,s=!1){const r=n.length;if(!r)return;e.x=e.y=1;let a,i;for(let o=0;o<r;o++){a=n[o],i=a.projectionDelta;const{visualElement:l}=a.options;l&&l.props.style&&l.props.style.display==="contents"||(s&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Ic(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(e.x*=i.x.scale,e.y*=i.y.scale,QM(t,i)),s&&Ol(a.latestValues)&&Ic(t,a.latestValues))}e.x<SO&&e.x>wO&&(e.x=1),e.y<SO&&e.y>wO&&(e.y=1)}function $c(t,e){t.min=t.min+e,t.max=t.max+e}function TO(t,e,n,s,r=.5){const a=Yt(t.min,t.max,r);iT(t,e,n,a,s)}function Ic(t,e){TO(t.x,e.x,e.scaleX,e.scale,e.originX),TO(t.y,e.y,e.scaleY,e.scale,e.originY)}function JM(t,e){return XM(AX(t.getBoundingClientRect(),e))}function zX(t,e,n){const s=JM(t,n),{scroll:r}=e;return r&&($c(s.x,r.offset.x),$c(s.y,r.offset.y)),s}const ez=({current:t})=>t?t.ownerDocument.defaultView:null,CO=(t,e)=>Math.abs(t-e);function PX(t,e){const n=CO(t.x,e.x),s=CO(t.y,e.y);return Math.sqrt(n**2+s**2)}class tz{constructor(e,n,{transformPagePoint:s,contextWindow:r,dragSnapToOrigin:a=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=sS(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,g=PX(d.offset,{x:0,y:0})>=3;if(!p&&!g)return;const{point:y}=d,{timestamp:v}=ns;this.history.push({...y,timestamp:v});const{onStart:x,onMove:w}=this.handlers;p||(x&&x(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,d)},this.handlePointerMove=(d,p)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=nS(p,this.transformPagePoint),Pt.update(this.updatePoint,!0)},this.handlePointerUp=(d,p)=>{this.end();const{onEnd:g,onSessionEnd:y,resumeAnimation:v}=this.handlers;if(this.dragSnapToOrigin&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=sS(d.type==="pointercancel"?this.lastMoveEventInfo:nS(p,this.transformPagePoint),this.history);this.startEvent&&g&&g(d,x),y&&y(d,x)},!ZC(e))return;this.dragSnapToOrigin=a,this.handlers=n,this.transformPagePoint=s,this.contextWindow=r||window;const i=zp(e),o=nS(i,this.transformPagePoint),{point:l}=o,{timestamp:c}=ns;this.history=[{...l,timestamp:c}];const{onSessionStart:f}=n;f&&f(e,sS(o,this.history)),this.removeListeners=Mp(qd(this.contextWindow,"pointermove",this.handlePointerMove),qd(this.contextWindow,"pointerup",this.handlePointerUp),qd(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Ro(this.updatePoint)}}function nS(t,e){return e?{point:e(t.point)}:t}function NO(t,e){return{x:t.x-e.x,y:t.y-e.y}}function sS({point:t},e){return{point:t,delta:NO(t,nz(e)),offset:NO(t,BX(e)),velocity:VX(e,.1)}}function BX(t){return t[0]}function nz(t){return t[t.length-1]}function VX(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const r=nz(t);for(;n>=0&&(s=t[n],!(r.timestamp-s.timestamp>Ti(e)));)n--;if(!s)return{x:0,y:0};const a=Ci(r.timestamp-s.timestamp);if(a===0)return{x:0,y:0};const i={x:(r.x-s.x)/a,y:(r.y-s.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function UX(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?Yt(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?Yt(n,t,s.max):Math.min(t,n)),t}function kO(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function jX(t,{top:e,left:n,bottom:s,right:r}){return{x:kO(t.x,n,r),y:kO(t.y,e,s)}}function EO(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function WX(t,e){return{x:EO(t.x,e.x),y:EO(t.y,e.y)}}function GX(t,e){let n=.5;const s=Es(t),r=Es(e);return r>s?n=Mc(e.min,e.max-s,t.min):s>r&&(n=Mc(t.min,t.max-r,e.min)),Ei(0,1,n)}function HX(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const oT=.35;function qX(t=oT){return t===!1?t=0:t===!0&&(t=oT),{x:$O(t,"left","right"),y:$O(t,"top","bottom")}}function $O(t,e,n){return{min:IO(t,e),max:IO(t,n)}}function IO(t,e){return typeof t=="number"?t:t[e]||0}const XX=new WeakMap;class KX{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=dn(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const r=f=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(zp(f).point)},a=(f,d)=>{const{drag:p,dragPropagation:g,onDragStart:y}=this.getProps();if(p&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=U9(p),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Mr(x=>{let w=this.getAxisMotionValue(x).get()||0;if(Fa.test(w)){const{projection:T}=this.visualElement;if(T&&T.layout){const N=T.layout.layoutBox[x];N&&(w=Es(N)*(parseFloat(w)/100))}}this.originPoint[x]=w}),y&&Pt.postRender(()=>y(f,d)),XS(this.visualElement,"transform");const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},i=(f,d)=>{const{dragPropagation:p,dragDirectionLock:g,onDirectionLock:y,onDrag:v}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:x}=d;if(g&&this.currentDirection===null){this.currentDirection=YX(x),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",d.point,x),this.updateAxis("y",d.point,x),this.visualElement.render(),v&&v(f,d)},o=(f,d)=>this.stop(f,d),l=()=>Mr(f=>{var d;return this.getAnimationState(f)==="paused"&&((d=this.getAxisMotionValue(f).animation)===null||d===void 0?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new tz(e,{onSessionStart:r,onStart:a,onMove:i,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:ez(this.visualElement)})}stop(e,n){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:r}=n;this.startAnimation(r);const{onDragEnd:a}=this.getProps();a&&Pt.postRender(()=>a(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:r}=this.getProps();if(!s||!G0(e,r,this.currentDirection))return;const a=this.getAxisMotionValue(e);let i=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(i=UX(i,this.constraints[e],this.elastic[e])),a.set(i)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:s}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,a=this.constraints;n&&Nc(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&r?this.constraints=jX(r.layoutBox,n):this.constraints=!1,this.elastic=qX(s),a!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Mr(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=HX(r.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Nc(e))return!1;const s=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const a=zX(s,r.root,this.visualElement.getTransformPagePoint());let i=WX(r.layout.layoutBox,a);if(n){const o=n(IX(i));this.hasMutatedConstraints=!!o,o&&(i=XM(o))}return i}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:r,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Mr(f=>{if(!G0(f,n,this.currentDirection))return;let d=l&&l[f]||{};i&&(d={min:0,max:0});const p=r?200:1e6,g=r?40:1e7,y={type:"inertia",velocity:s?e[f]:0,bounceStiffness:p,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...a,...d};return this.startAxisValueAnimation(f,y)});return Promise.all(c).then(o)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return XS(this.visualElement,e),s.start(bN(e,s,0,n,this.visualElement,!1))}stopAnimation(){Mr(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Mr(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),r=s[n];return r||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){Mr(n=>{const{drag:s}=this.getProps();if(!G0(n,s,this.currentDirection))return;const{projection:r}=this.visualElement,a=this.getAxisMotionValue(n);if(r&&r.layout){const{min:i,max:o}=r.layout.layoutBox[n];a.set(e[n]-Yt(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!Nc(n)||!s||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Mr(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const l=o.get();r[i]=GX({min:l,max:l},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),Mr(i=>{if(!G0(i,e,null))return;const o=this.getAxisMotionValue(i),{min:l,max:c}=this.constraints[i];o.set(Yt(l,c,r[i]))})}addListeners(){if(!this.visualElement.current)return;XX.set(this.visualElement,this);const e=this.visualElement.current,n=qd(e,"pointerdown",l=>{const{drag:c,dragListener:f=!0}=this.getProps();c&&f&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();Nc(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,a=r.addEventListener("measure",s);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Pt.read(s);const i=op(window,"resize",()=>this.scalePositionWithinConstraints()),o=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Mr(f=>{const d=this.getAxisMotionValue(f);d&&(this.originPoint[f]+=l[f].translate,d.set(d.get()+l[f].translate))}),this.visualElement.render())});return()=>{i(),n(),a(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:r=!1,dragConstraints:a=!1,dragElastic:i=oT,dragMomentum:o=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:r,dragConstraints:a,dragElastic:i,dragMomentum:o}}}function G0(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function YX(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class ZX extends qo{constructor(e){super(e),this.removeGroupControls=dr,this.removeListeners=dr,this.controls=new KX(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||dr}unmount(){this.removeGroupControls(),this.removeListeners()}}const AO=t=>(e,n)=>{t&&Pt.postRender(()=>t(e,n))};class QX extends qo{constructor(){super(...arguments),this.removePointerDownListener=dr}onPointerDown(e){this.session=new tz(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:ez(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:r}=this.node.getProps();return{onSessionStart:AO(e),onStart:AO(n),onMove:s,onEnd:(a,i)=>{delete this.session,r&&Pt.postRender(()=>r(a,i))}}}mount(){this.removePointerDownListener=qd(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const dy={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function RO(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const kd={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(He.test(t))t=parseFloat(t);else return t;const n=RO(t,e.target.x),s=RO(t,e.target.y);return`${n}% ${s}%`}},JX={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,r=Do.parse(t);if(r.length>5)return s;const a=Do.createTransformer(t),i=typeof r[0]!="number"?1:0,o=n.x.scale*e.x,l=n.y.scale*e.y;r[0+i]/=o,r[1+i]/=l;const c=Yt(o,l,.5);return typeof r[2+i]=="number"&&(r[2+i]/=c),typeof r[3+i]=="number"&&(r[3+i]/=c),a(r)}};class eK extends K.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:r}=this.props,{projection:a}=e;gH(tK),a&&(n.group&&n.group.add(a),s&&s.register&&r&&s.register(a),a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),dy.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:r,isPresent:a}=this.props,i=s.projection;return i&&(i.isPresent=a,r||e.layoutDependency!==n||n===void 0||e.isPresent!==a?i.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?i.promote():i.relegate()||Pt.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),YC.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),s&&s.deregister&&s.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function sz(t){const[e,n]=PL(),s=K.useContext(PC);return L.jsx(eK,{...t,layoutGroup:s,switchLayoutGroup:K.useContext(eM),isPresent:e,safeToRemove:n})}const tK={borderRadius:{...kd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:kd,borderTopRightRadius:kd,borderBottomLeftRadius:kd,borderBottomRightRadius:kd,boxShadow:JX};function nK(t,e,n){const s=ms(t)?t:tp(t);return s.start(bN("",s,e,n)),s.animation}function sK(t){return t instanceof SVGElement&&t.tagName!=="svg"}const rK=(t,e)=>t.depth-e.depth;class aK{constructor(){this.children=[],this.isDirty=!1}add(e){jC(this.children,e),this.isDirty=!0}remove(e){WC(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(rK),this.isDirty=!1,this.children.forEach(e)}}function iK(t,e){const n=_a.now(),s=({timestamp:r})=>{const a=r-n;a>=e&&(Ro(s),t(a-e))};return Pt.read(s,!0),()=>Ro(s)}const rz=["TopLeft","TopRight","BottomLeft","BottomRight"],oK=rz.length,DO=t=>typeof t=="string"?parseFloat(t):t,OO=t=>typeof t=="number"||He.test(t);function lK(t,e,n,s,r,a){r?(t.opacity=Yt(0,n.opacity!==void 0?n.opacity:1,uK(s)),t.opacityExit=Yt(e.opacity!==void 0?e.opacity:1,0,cK(s))):a&&(t.opacity=Yt(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,s));for(let i=0;i<oK;i++){const o=`border${rz[i]}Radius`;let l=_O(e,o),c=_O(n,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||OO(l)===OO(c)?(t[o]=Math.max(Yt(DO(l),DO(c),s),0),(Fa.test(c)||Fa.test(l))&&(t[o]+="%")):t[o]=c}(e.rotate||n.rotate)&&(t.rotate=Yt(e.rotate||0,n.rotate||0,s))}function _O(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const uK=az(0,.5,wM),cK=az(.5,.95,dr);function az(t,e,n){return s=>s<t?0:s>e?1:n(Mc(t,e,s))}function FO(t,e){t.min=e.min,t.max=e.max}function _r(t,e){FO(t.x,e.x),FO(t.y,e.y)}function LO(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function MO(t,e,n,s,r){return t-=e,t=l1(t,1/n,s),r!==void 0&&(t=l1(t,1/r,s)),t}function hK(t,e=0,n=1,s=.5,r,a=t,i=t){if(Fa.test(e)&&(e=parseFloat(e),e=Yt(i.min,i.max,e/100)-i.min),typeof e!="number")return;let o=Yt(a.min,a.max,s);t===a&&(o-=e),t.min=MO(t.min,e,n,o,r),t.max=MO(t.max,e,n,o,r)}function zO(t,e,[n,s,r],a,i){hK(t,e[n],e[s],e[r],e.scale,a,i)}const fK=["x","scaleX","originX"],dK=["y","scaleY","originY"];function PO(t,e,n,s){zO(t.x,e,fK,n?n.x:void 0,s?s.x:void 0),zO(t.y,e,dK,n?n.y:void 0,s?s.y:void 0)}function BO(t){return t.translate===0&&t.scale===1}function iz(t){return BO(t.x)&&BO(t.y)}function VO(t,e){return t.min===e.min&&t.max===e.max}function pK(t,e){return VO(t.x,e.x)&&VO(t.y,e.y)}function UO(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function oz(t,e){return UO(t.x,e.x)&&UO(t.y,e.y)}function jO(t){return Es(t.x)/Es(t.y)}function WO(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class mK{constructor(){this.members=[]}add(e){jC(this.members,e),e.scheduleRender()}remove(e){if(WC(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(r=>e===r);if(n===0)return!1;let s;for(let r=n;r>=0;r--){const a=this.members[r];if(a.isPresent!==!1){s=a;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function gK(t,e,n){let s="";const r=t.x.translate/e.x,a=t.y.translate/e.y,i=(n==null?void 0:n.z)||0;if((r||a||i)&&(s=`translate3d(${r}px, ${a}px, ${i}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:f,rotateX:d,rotateY:p,skewX:g,skewY:y}=n;c&&(s=`perspective(${c}px) ${s}`),f&&(s+=`rotate(${f}deg) `),d&&(s+=`rotateX(${d}deg) `),p&&(s+=`rotateY(${p}deg) `),g&&(s+=`skewX(${g}deg) `),y&&(s+=`skewY(${y}deg) `)}const o=t.x.scale*e.x,l=t.y.scale*e.y;return(o!==1||l!==1)&&(s+=`scale(${o}, ${l})`),s||"none"}const rS=["","X","Y","Z"],yK={visibility:"hidden"},GO=1e3;let bK=0;function aS(t,e,n,s){const{latestValues:r}=e;r[t]&&(n[t]=r[t],e.setStaticValue(t,0),s&&(s[t]=0))}function lz(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=pM(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:a}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Pt,!(r||a))}const{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&lz(s)}function uz({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:r}){return class{constructor(i={},o=e==null?void 0:e()){this.id=bK++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(wK),this.nodes.forEach(kK),this.nodes.forEach(EK),this.nodes.forEach(SK)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new aK)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new HC),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const l=this.eventHandlers.get(i);l&&l.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=sK(i),this.instance=i;const{layoutId:l,layout:c,visualElement:f}=this.options;if(f&&!f.current&&f.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),t){let d;const p=()=>this.root.updateBlockedByResize=!1;t(i,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=iK(p,250),dy.hasAnimatedSinceResize&&(dy.hasAnimatedSinceResize=!1,this.nodes.forEach(qO))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&f&&(l||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:p,hasRelativeLayoutChanged:g,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||f.getDefaultTransition()||DK,{onLayoutAnimationStart:x,onLayoutAnimationComplete:w}=f.getProps(),T=!this.targetLayout||!oz(this.targetLayout,y),N=!p&&g;if(this.options.layoutRoot||this.resumeFrom||N||p&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(d,N);const C={...qC(v,"layout"),onPlay:x,onComplete:w};(f.shouldReduceMotion||this.options.layoutRoot)&&(C.delay=0,C.type=!1),this.startAnimation(C)}else p||qO(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ro(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach($K),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&lz(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const d=this.path[f];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(HO);return}this.isUpdating||this.nodes.forEach(CK),this.isUpdating=!1,this.nodes.forEach(NK),this.nodes.forEach(xK),this.nodes.forEach(vK),this.clearAllSnapshots();const o=_a.now();ns.delta=Ei(0,1e3/60,o-ns.timestamp),ns.timestamp=o,ns.isProcessing=!0,Y2.update.process(ns),Y2.preRender.process(ns),Y2.render.process(ns),ns.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,YC.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(TK),this.sharedNodes.forEach(IK)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Pt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Pt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Es(this.snapshot.measuredBox.x)&&!Es(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=dn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o){const l=s(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!r)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!iz(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,f=c!==this.prevTransformTemplateValue;i&&(o||Ol(this.latestValues)||f)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return i&&(l=this.removeTransform(l)),OK(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var i;const{visualElement:o}=this.options;if(!o)return dn();const l=o.measureViewportBox();if(!(((i=this.scroll)===null||i===void 0?void 0:i.wasRoot)||this.path.some(_K))){const{scroll:f}=this.root;f&&($c(l.x,f.offset.x),$c(l.y,f.offset.y))}return l}removeElementScroll(i){var o;const l=dn();if(_r(l,i),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let c=0;c<this.path.length;c++){const f=this.path[c],{scroll:d,options:p}=f;f!==this.root&&d&&p.layoutScroll&&(d.wasRoot&&_r(l,i),$c(l.x,d.offset.x),$c(l.y,d.offset.y))}return l}applyTransform(i,o=!1){const l=dn();_r(l,i);for(let c=0;c<this.path.length;c++){const f=this.path[c];!o&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Ic(l,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Ol(f.latestValues)&&Ic(l,f.latestValues)}return Ol(this.latestValues)&&Ic(l,this.latestValues),l}removeTransform(i){const o=dn();_r(o,i);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Ol(c.latestValues))continue;aT(c.latestValues)&&c.updateSnapshot();const f=dn(),d=c.measurePageBox();_r(f,d),PO(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,f)}return Ol(this.latestValues)&&PO(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ns.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(i||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:p}=this.options;if(!(!this.layout||!(d||p))){if(this.resolvedRelativeTargetAt=ns.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=dn(),this.relativeTargetOrigin=dn(),Kd(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),_r(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=dn(),this.targetWithTransforms=dn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),LX(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):_r(this.target,this.layout.layoutBox),QM(this.target,this.targetDelta)):_r(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=dn(),this.relativeTargetOrigin=dn(),Kd(this.relativeTargetOrigin,this.target,g.target),_r(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||aT(this.parent.latestValues)||ZM(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var i;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===ns.timestamp&&(c=!1),c)return;const{layout:f,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||d))return;_r(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,g=this.treeScale.y;MX(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=dn());const{target:y}=o;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(LO(this.prevProjectionDelta.x,this.projectionDelta.x),LO(this.prevProjectionDelta.y,this.projectionDelta.y)),Xd(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==g||!WO(this.projectionDelta.x,this.prevProjectionDelta.x)||!WO(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),i){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Ec(),this.projectionDelta=Ec(),this.projectionDeltaWithTransform=Ec()}setAnimationOrigin(i,o=!1){const l=this.snapshot,c=l?l.latestValues:{},f={...this.latestValues},d=Ec();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const p=dn(),g=l?l.source:void 0,y=this.layout?this.layout.source:void 0,v=g!==y,x=this.getStack(),w=!x||x.members.length<=1,T=!!(v&&!w&&this.options.crossfade===!0&&!this.path.some(RK));this.animationProgress=0;let N;this.mixTargetDelta=C=>{const E=C/1e3;XO(d.x,i.x,E),XO(d.y,i.y,E),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Kd(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),AK(this.relativeTarget,this.relativeTargetOrigin,p,E),N&&pK(this.relativeTarget,N)&&(this.isProjectionDirty=!1),N||(N=dn()),_r(N,this.relativeTarget)),v&&(this.animationValues=f,lK(f,c,this.latestValues,E,T,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ro(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Pt.update(()=>{dy.hasAnimatedSinceResize=!0,this.currentAnimation=nK(0,GO,{...i,onUpdate:o=>{this.mixTargetDelta(o),i.onUpdate&&i.onUpdate(o)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(GO),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:f}=i;if(!(!o||!l||!c)){if(this!==i&&this.layout&&c&&cz(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||dn();const d=Es(this.layout.layoutBox.x);l.x.min=i.target.x.min,l.x.max=l.x.min+d;const p=Es(this.layout.layoutBox.y);l.y.min=i.target.y.min,l.y.max=l.y.min+p}_r(o,l),Ic(o,f),Xd(this.projectionDeltaWithTransform,this.layoutCorrected,o,f)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new mK),this.sharedNodes.get(i).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var i;const{layoutId:o}=this.options;return o?((i=this.getStack())===null||i===void 0?void 0:i.lead)||this:this}getPrevLead(){var i;const{layoutId:o}=this.options;return o?(i=this.getStack())===null||i===void 0?void 0:i.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:l}=i;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&aS("z",i,c,this.animationValues);for(let f=0;f<rS.length;f++)aS(`rotate${rS[f]}`,i,c,this.animationValues),aS(`skew${rS[f]}`,i,c,this.animationValues);i.render();for(const f in c)i.setStaticValue(f,c[f]),this.animationValues&&(this.animationValues[f]=c[f]);i.scheduleRender()}getProjectionStyles(i){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return yK;const c={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=fy(i==null?void 0:i.pointerEvents)||"",c.transform=f?f(this.latestValues,""):"none",c;const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){const v={};return this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=fy(i==null?void 0:i.pointerEvents)||""),this.hasProjected&&!Ol(this.latestValues)&&(v.transform=f?f({},""):"none",this.hasProjected=!1),v}const p=d.animationValues||d.latestValues;this.applyTransformsToTarget(),c.transform=gK(this.projectionDeltaWithTransform,this.treeScale,p),f&&(c.transform=f(p,c.transform));const{x:g,y}=this.projectionDelta;c.transformOrigin=`${g.origin*100}% ${y.origin*100}% 0`,d.animationValues?c.opacity=d===this?(l=(o=p.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:c.opacity=d===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const v in sp){if(p[v]===void 0)continue;const{correct:x,applyTo:w,isCSSVariable:T}=sp[v],N=c.transform==="none"?p[v]:x(p[v],d);if(w){const C=w.length;for(let E=0;E<C;E++)c[w[E]]=N}else T?this.options.visualElement.renderState.vars[v]=N:c[v]=N}return this.options.layoutId&&(c.pointerEvents=d===this?fy(i==null?void 0:i.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var o;return(o=i.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(HO),this.root.sharedNodes.clear()}}}function xK(t){t.updateLayout()}function vK(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:r}=t.layout,{animationType:a}=t.options,i=n.source!==t.layout.source;a==="size"?Mr(d=>{const p=i?n.measuredBox[d]:n.layoutBox[d],g=Es(p);p.min=s[d].min,p.max=p.min+g}):cz(a,n.layoutBox,s)&&Mr(d=>{const p=i?n.measuredBox[d]:n.layoutBox[d],g=Es(s[d]);p.max=p.min+g,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[d].max=t.relativeTarget[d].min+g)});const o=Ec();Xd(o,s,n.layoutBox);const l=Ec();i?Xd(l,t.applyTransform(r,!0),n.measuredBox):Xd(l,s,n.layoutBox);const c=!iz(o);let f=!1;if(!t.resumeFrom){const d=t.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:p,layout:g}=d;if(p&&g){const y=dn();Kd(y,n.layoutBox,p.layoutBox);const v=dn();Kd(v,s,g.layoutBox),oz(y,v)||(f=!0),d.options.layoutRoot&&(t.relativeTarget=v,t.relativeTargetOrigin=y,t.relativeParent=d)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:n,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:f})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function wK(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function SK(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function TK(t){t.clearSnapshot()}function HO(t){t.clearMeasurements()}function CK(t){t.isLayoutDirty=!1}function NK(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function qO(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function kK(t){t.resolveTargetDelta()}function EK(t){t.calcProjection()}function $K(t){t.resetSkewAndRotation()}function IK(t){t.removeLeadSnapshot()}function XO(t,e,n){t.translate=Yt(e.translate,0,n),t.scale=Yt(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function KO(t,e,n,s){t.min=Yt(e.min,n.min,s),t.max=Yt(e.max,n.max,s)}function AK(t,e,n,s){KO(t.x,e.x,n.x,s),KO(t.y,e.y,n.y,s)}function RK(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const DK={duration:.45,ease:[.4,0,.1,1]},YO=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),ZO=YO("applewebkit/")&&!YO("chrome/")?Math.round:dr;function QO(t){t.min=ZO(t.min),t.max=ZO(t.max)}function OK(t){QO(t.x),QO(t.y)}function cz(t,e,n){return t==="position"||t==="preserve-aspect"&&!FX(jO(e),jO(n),.2)}function _K(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const FK=uz({attachResizeListener:(t,e)=>op(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),iS={current:void 0},hz=uz({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!iS.current){const t=new FK({});t.mount(window),t.setOptions({layoutScroll:!0}),iS.current=t}return iS.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),LK={pan:{Feature:QX},drag:{Feature:ZX,ProjectionNode:hz,MeasureLayout:sz}};function JO(t,e,n){const{props:s}=t;t.animationState&&s.whileHover&&t.animationState.setActive("whileHover",n==="Start");const r="onHover"+n,a=s[r];a&&Pt.postRender(()=>a(e,zp(e)))}class MK extends qo{mount(){const{current:e}=this.node;e&&(this.unmount=W9(e,(n,s)=>(JO(this.node,s,"Start"),r=>JO(this.node,r,"End"))))}unmount(){}}class zK extends qo{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Mp(op(this.node.current,"focus",()=>this.onFocus()),op(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function e_(t,e,n){const{props:s}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&s.whileTap&&t.animationState.setActive("whileTap",n==="Start");const r="onTap"+(n==="End"?"":n),a=s[r];a&&Pt.postRender(()=>a(e,zp(e)))}class PK extends qo{mount(){const{current:e}=this.node;e&&(this.unmount=X9(e,(n,s)=>(e_(this.node,s,"Start"),(r,{success:a})=>e_(this.node,r,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const lT=new WeakMap,oS=new WeakMap,BK=t=>{const e=lT.get(t.target);e&&e(t)},VK=t=>{t.forEach(BK)};function UK({root:t,...e}){const n=t||document;oS.has(n)||oS.set(n,{});const s=oS.get(n),r=JSON.stringify(e);return s[r]||(s[r]=new IntersectionObserver(VK,{root:t,...e})),s[r]}function jK(t,e,n){const s=UK(e);return lT.set(t,n),s.observe(t),()=>{lT.delete(t),s.unobserve(t)}}const WK={some:0,all:1};class GK extends qo{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:r="some",once:a}=e,i={root:n?n.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:WK[r]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,a&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:f,onViewportLeave:d}=this.node.getProps(),p=c?f:d;p&&p(l)};return jK(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(HK(e,n))&&this.startObserver()}unmount(){}}function HK({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const qK={inView:{Feature:GK},tap:{Feature:PK},focus:{Feature:zK},hover:{Feature:MK}},XK={layout:{ProjectionNode:hz,MeasureLayout:sz}},uT={current:null},fz={current:!1};function KK(){if(fz.current=!0,!!VC)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>uT.current=t.matches;t.addListener(e),e()}else uT.current=!1}const YK=[...LM,us,Do],ZK=t=>YK.find(FM(t)),QK=new WeakMap;function JK(t,e,n){for(const s in e){const r=e[s],a=n[s];if(ms(r))t.addValue(s,r);else if(ms(a))t.addValue(s,tp(r,{owner:t}));else if(a!==r)if(t.hasValue(s)){const i=t.getValue(s);i.liveStyle===!0?i.jump(r):i.hasAnimated||i.set(r)}else{const i=t.getStaticValue(s);t.addValue(s,tp(i!==void 0?i:r,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const t_=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class eY{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:r,blockInitialAnimation:a,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=mN,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=_a.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,Pt.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:f}=i;this.onUpdate=f,this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=Z1(n),this.isVariantNode=QL(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...p}=this.scrapeMotionValuesFromProps(n,{},this);for(const g in p){const y=p[g];l[g]!==void 0&&ms(y)&&y.set(l[g],!1)}}mount(e){this.current=e,QK.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),fz.current||KK(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:uT.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Ro(this.notifyUpdate),Ro(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=Su.has(e);s&&this.onBindTransform&&this.onBindTransform();const r=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&Pt.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),a=n.on("renderRequest",this.scheduleRender);let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{r(),a(),i&&i(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in zc){const n=zc[e];if(!n)continue;const{isEnabled:s,Feature:r}=n;if(!this.features[e]&&r&&s(this.props)&&(this.features[e]=new r(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):dn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<t_.length;s++){const r=t_[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const a="on"+r,i=e[a];i&&(this.propEventSubscriptions[r]=this.on(r,i))}this.prevMotionValues=JK(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=tp(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){var s;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(s=this.getBaseTargetFromProps(this.props,e))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&(OM(r)||TM(r))?r=parseFloat(r):!ZK(r)&&Do.test(n)&&(r=AM(e,n)),this.setBaseTarget(e,ms(r)?r.get():r)),ms(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:s}=this.props;let r;if(typeof s=="string"||typeof s=="object"){const i=uN(this.props,s,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);i&&(r=i[e])}if(s&&r!==void 0)return r;const a=this.getBaseTargetFromProps(this.props,e);return a!==void 0&&!ms(a)?a:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new HC),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class dz extends eY{constructor(){super(...arguments),this.KeyframeResolver=MM}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ms(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function tY(t){return window.getComputedStyle(t)}class nY extends dz{constructor(){super(...arguments),this.type="html",this.renderInstance=uM}readValueFromInstance(e,n){if(Su.has(n))return dq(e,n);{const s=tY(e),r=(tN(n)?s.getPropertyValue(n):s[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:n}){return JM(e,n)}build(e,n,s){rN(e,n,s.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return cN(e,n,s)}}class sY extends dz{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=dn,this.updateDimensions=()=>{this.current&&!this.renderState.dimensions&&lM(this.current,this.renderState)}}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Su.has(n)){const s=IM(n);return s&&s.default||0}return n=cM.has(n)?n:eN(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,s){return fM(e,n,s)}onBindTransform(){this.current&&!this.renderState.dimensions&&Pt.postRender(this.updateDimensions)}build(e,n,s){oN(e,n,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,s,r){hM(e,n,s,r)}mount(e){this.isSVGTag=lN(e.tagName),super.mount(e)}}const rY=(t,e)=>iN(t)?new sY(e):new nY(e,{allowProjection:t!==K.Fragment}),aY=BH({...EX,...qK,...LK,...XK},rY),je=nH(aY),iY=({onClose:t})=>{const[e,n]=K.useState([{text:"Hello! I'm your AI Crop Assistant.",sender:"bot"}]),[s,r]=K.useState(""),[a,i]=K.useState(!1),o=K.useRef(null);K.useEffect(()=>{var f;(f=o.current)==null||f.scrollIntoView({behavior:"smooth"})},[e]);const l=async()=>{if(s.trim()==="")return;const f={text:s,sender:"user"};n(d=>[...d,f]),r(""),i(!0);try{const d=await fetch("https://ai-based-crop-disease.onrender.com/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:s})});if(!d.ok)throw new Error("Server error!");const p=await d.json();i(!1),setTimeout(()=>{n(g=>[...g,{text:p.reply||"Not answer plese ",sender:"bot"}])},800)}catch(d){console.error("Error:",d),i(!1),n(p=>[...p,{text:"  Connection error. try again.",sender:"bot"}])}},c=f=>{f.key==="Enter"&&l()};return L.jsxs(je.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.2},className:"fixed   bg-white rounded-xl  right-5 w-96 shadow-2xl max-w-[90vw] border border-gray-200 overflow-hidden z-50 bottom-20",style:{backdropFilter:"blur(12px)",backgroundColor:"rgba(255, 255, 255, 0.96)",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"},children:[L.jsxs("div",{className:"flex   items-center  bg-gradient-to-r text-white justify-between from-green-600 p-4 to-green-800  ",children:[L.jsxs("div",{className:"flex   items-center space-x-2",children:[L.jsx("div",{className:"p-2  bg-opacity-20 rounded-full bg-white",children:L.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:L.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})})}),L.jsx("h2",{className:" font-semibold text-lg",children:"Crop Assistant"})]}),L.jsx("button",{onClick:t,className:"p-1  hover:bg-white transition rounded-full hover:bg-opacity-20 ","aria-label":"Close chat",children:L.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),L.jsxs("div",{className:"h-80 p-4 overflow-y-auto   bg-gray-50 space-y-3",children:[L.jsx(wu,{initial:!1,children:e.map((f,d)=>L.jsx(je.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.2},className:`flex ${f.sender==="user"?"justify-end":"justify-start"}`,children:L.jsx("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-2xl ${f.sender==="user"?"bg-green-600 text-white rounded-br-none":"bg-white text-gray-800 rounded-bl-none shadow-sm border border-gray-200"}`,children:f.text})},d))}),a&&L.jsxs(je.div,{initial:{opacity:0},animate:{opacity:1},className:"flex space-x-1 px-4 py-2",children:[L.jsx("div",{className:"w-2 h-2 bg-gray-400 animate-bounce  rounded-full",style:{animationDelay:"0ms"}}),L.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),L.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),L.jsx("div",{ref:o})]}),L.jsxs("div",{className:"p-3  border-gray-200 border-t bg-white",children:[L.jsxs("div",{className:"flex  space-x-2 items-center",children:[L.jsx("input",{type:"text",className:"flex-1 border  p-3 rounded-xl text-gray-800 focus:outline-none  focus:ring-green-500 border-gray-300 focus:border-transparent transition duration-200  placeholder-gray-400 focus:ring-2",placeholder:"Ask about crops, diseases...",value:s,onChange:f=>r(f.target.value),onKeyPress:c,autoFocus:!0}),L.jsx("button",{onClick:l,disabled:s.trim()==="",className:`p-3 rounded-xl ${s.trim()===""?"bg-gray-200 text-gray-400":"bg-green-600 text-white hover:bg-green-700"} transition duration-200`,children:L.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:L.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z",clipRule:"evenodd"})})})]}),L.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"Ask about plant diseases, or crop management"})]})]})},lS=["How can I help you today?","Ask me anything!","Need assistance?","Let's chat!","I'm here to help","What's on your mind?"];function oY({setIsChatOpen:t,isChatOpen:e}){const[n,s]=K.useState(lS[0]),[r,a]=K.useState(""),[i,o]=K.useState(!1),l=K.useRef(0);K.useEffect(()=>{let f=0,d;const p=()=>{f<=n.length?(a(n.slice(0,f)),f++,d=setTimeout(p,50+Math.random()*30)):o(!1)};return o(!0),p(),()=>clearTimeout(d)},[n]),K.useEffect(()=>{const f=setInterval(()=>{l.current=(l.current+1)%lS.length,s(lS[l.current])},4e3);return()=>clearInterval(f)},[]);const c={float:{y:[-5,5],transition:{y:{duration:2,repeat:1/0,repeatType:"reverse",ease:"easeInOut"}}},hover:{y:0,scale:1.1,transition:{duration:.3}}};return L.jsx("div",{className:"fixed  flex  items-end flex-col z-50 bottom-6 right-6",children:!e&&L.jsxs(L.Fragment,{children:[L.jsx(wu,{mode:"wait",children:L.jsxs(je.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"bg-gray-900 text-white px-4 py-3 rounded-xl shadow-xl mb-3 text-sm font-medium max-w-xs",style:{backdropFilter:"blur(10px)",backgroundColor:"rgba(17, 24, 39, 0.9)",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[L.jsxs("div",{className:"flex items-center",children:[L.jsxs("div",{className:"relative mr-2",children:[L.jsx("div",{className:"w-2 h-2  rounded-full animate-pulse bg-blue-400"}),L.jsx("div",{className:"absolute top-0 left-0 w-2 h-2 bg-blue-400 rounded-full opacity-75 animate-ping"})]}),L.jsxs("span",{children:[r,L.jsx("span",{className:`inline-block w-1 h-5 ml-1 bg-white ${i?"opacity-0":"animate-blink"}`})]})]}),L.jsx("div",{className:"absolute -bottom-1 right-6 w-4 h-4 bg-gray-900 transform rotate-45",style:{backgroundColor:"rgba(17, 24, 39, 0.9)",borderRight:"1px solid rgba(255, 255, 255, 0.1)",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"}})]},n)}),L.jsxs(je.button,{onClick:()=>t(!0),className:"bg-gradient-to-br bg-green-600 text-white font-bold py-3 px-6 rounded-full shadow-lg flex items-center gap-2 transition-transform duration-200 active:scale-95",variants:c,initial:"float",whileHover:"hover",children:[L.jsx("span",{children:""}),L.jsx("span",{children:"Ask the Plant AI"})]})]})})}/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lY=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),pz=(...t)=>t.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var uY={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cY=K.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:a,iconNode:i,...o},l)=>K.createElement("svg",{ref:l,...uY,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:pz("lucide",r),...o},[...i.map(([c,f])=>K.createElement(c,f)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=(t,e)=>{const n=K.forwardRef(({className:s,...r},a)=>K.createElement(cY,{ref:a,iconNode:e,className:pz(`lucide-${lY(t)}`,s),...r}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hY=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],fY=Xo("ClipboardCheck",hY);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dY=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]],pY=Xo("Heart",dY);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mY=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],gY=Xo("Image",mY);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yY=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],n_=Xo("MessageSquare",yY);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bY=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],xY=Xo("Scan",bY);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vY=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],wY=Xo("Trash2",vY);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SY=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],s_=Xo("Upload",SY);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TY=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],CY=Xo("X",TY),NY=({onClose:t})=>L.jsx(wu,{children:L.jsx(je.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 backdrop-blur-sm",children:L.jsxs(je.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-white w-11/12 md:w-3/4 lg:w-1/2 xl:w-2/5 p-8 rounded-2xl shadow-xl relative border border-gray-100",children:[L.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-1 rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close",children:L.jsx(CY,{className:"w-6 h-6 text-gray-500 hover:text-gray-700"})}),L.jsxs("div",{className:"text-center",children:[L.jsx("div",{className:"inline-flex items-center justify-center bg-green-100 text-green-700 rounded-full p-3 mb-4",children:L.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),L.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"How Our AI Crop Doctor Works"}),L.jsx("p",{className:"text-gray-600 mt-3 max-w-2xl mx-auto",children:"Our advanced AI analyzes crop images with 95% accuracy to detect diseases and provide actionable solutions."}),L.jsxs("div",{className:"grid md:grid-cols-3 gap-8 mt-8",children:[L.jsxs(je.div,{whileHover:{y:-5},className:"bg-green-50 p-6 rounded-xl",children:[L.jsx("div",{className:"flex items-center justify-center w-16 h-16 mx-auto mb-4 bg-green-100 rounded-full text-green-600",children:L.jsx(s_,{className:"w-8 h-8"})}),L.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Upload Image"}),L.jsx("p",{className:"text-gray-600 text-sm",children:"Simply upload a clear photo of your affected crop leaves or fruits."})]}),L.jsxs(je.div,{whileHover:{y:-5},className:"bg-green-50 p-6 rounded-xl",children:[L.jsx("div",{className:"flex items-center justify-center w-16 h-16 mx-auto mb-4 bg-green-100 rounded-full text-green-600",children:L.jsx(xY,{className:"w-8 h-8"})}),L.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"AI Analysis"}),L.jsx("p",{className:"text-gray-600 text-sm",children:"Our deep learning model scans and identifies potential diseases within seconds."})]}),L.jsxs(je.div,{whileHover:{y:-5},className:"bg-green-50 p-6 rounded-xl",children:[L.jsx("div",{className:"flex items-center justify-center w-16 h-16 mx-auto mb-4 bg-green-100 rounded-full text-green-600",children:L.jsx(fY,{className:"w-8 h-8"})}),L.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Get Report"}),L.jsx("p",{className:"text-gray-600 text-sm",children:"Receive detailed diagnosis with treatment recommendations and prevention tips."})]})]}),L.jsx("div",{className:"mt-10",children:L.jsxs(je.a,{href:"/upload",whileHover:{scale:1.05},whileTap:{scale:.95},className:"inline-flex items-center justify-center px-8 py-3 bg-gradient-to-r from-green-600 to-emerald-600 text-white font-medium rounded-lg shadow-lg hover:shadow-xl transition-all",children:[L.jsx(s_,{className:"w-5 h-5 mr-2"}),"Try It Now - Upload Your Image"]})})]})]})})});/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */function kY(t,e,n){return(e=$Y(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Ce(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?r_(Object(n),!0).forEach(function(s){kY(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r_(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function EY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $Y(t){var e=EY(t,"string");return typeof e=="symbol"?e:e+""}const a_=()=>{};let xN={},mz={},gz=null,yz={mark:a_,measure:a_};try{typeof window<"u"&&(xN=window),typeof document<"u"&&(mz=document),typeof MutationObserver<"u"&&(gz=MutationObserver),typeof performance<"u"&&(yz=performance)}catch{}const{userAgent:i_=""}=xN.navigator||{},Oo=xN,Bt=mz,o_=gz,H0=yz;Oo.document;const Pi=!!Bt.documentElement&&!!Bt.head&&typeof Bt.addEventListener=="function"&&typeof Bt.createElement=="function",bz=~i_.indexOf("MSIE")||~i_.indexOf("Trident/");var IY=/fa(s|r|l|t|d|dr|dl|dt|b|k|kd|ss|sr|sl|st|sds|sdr|sdl|sdt)?[\-\ ]/,AY=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp Duotone|Sharp|Kit)?.*/i,xz={classic:{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fab:"brands","fa-brands":"brands"},duotone:{fa:"solid",fad:"solid","fa-solid":"solid","fa-duotone":"solid",fadr:"regular","fa-regular":"regular",fadl:"light","fa-light":"light",fadt:"thin","fa-thin":"thin"},sharp:{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"},"sharp-duotone":{fa:"solid",fasds:"solid","fa-solid":"solid",fasdr:"regular","fa-regular":"regular",fasdl:"light","fa-light":"light",fasdt:"thin","fa-thin":"thin"}},RY={GROUP:"duotone-group",PRIMARY:"primary",SECONDARY:"secondary"},vz=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],gs="classic",J1="duotone",DY="sharp",OY="sharp-duotone",wz=[gs,J1,DY,OY],_Y={classic:{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},duotone:{900:"fad",400:"fadr",300:"fadl",100:"fadt"},sharp:{900:"fass",400:"fasr",300:"fasl",100:"fast"},"sharp-duotone":{900:"fasds",400:"fasdr",300:"fasdl",100:"fasdt"}},FY={"Font Awesome 6 Free":{900:"fas",400:"far"},"Font Awesome 6 Pro":{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},"Font Awesome 6 Brands":{400:"fab",normal:"fab"},"Font Awesome 6 Duotone":{900:"fad",400:"fadr",normal:"fadr",300:"fadl",100:"fadt"},"Font Awesome 6 Sharp":{900:"fass",400:"fasr",normal:"fasr",300:"fasl",100:"fast"},"Font Awesome 6 Sharp Duotone":{900:"fasds",400:"fasdr",normal:"fasdr",300:"fasdl",100:"fasdt"}},LY=new Map([["classic",{defaultShortPrefixId:"fas",defaultStyleId:"solid",styleIds:["solid","regular","light","thin","brands"],futureStyleIds:[],defaultFontWeight:900}],["sharp",{defaultShortPrefixId:"fass",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["duotone",{defaultShortPrefixId:"fad",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["sharp-duotone",{defaultShortPrefixId:"fasds",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}]]),MY={classic:{solid:"fas",regular:"far",light:"fal",thin:"fat",brands:"fab"},duotone:{solid:"fad",regular:"fadr",light:"fadl",thin:"fadt"},sharp:{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"},"sharp-duotone":{solid:"fasds",regular:"fasdr",light:"fasdl",thin:"fasdt"}},zY=["fak","fa-kit","fakd","fa-kit-duotone"],l_={kit:{fak:"kit","fa-kit":"kit"},"kit-duotone":{fakd:"kit-duotone","fa-kit-duotone":"kit-duotone"}},PY=["kit"],BY={kit:{"fa-kit":"fak"}},VY=["fak","fakd"],UY={kit:{fak:"fa-kit"}},u_={kit:{kit:"fak"},"kit-duotone":{"kit-duotone":"fakd"}},q0={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},jY=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],WY=["fak","fa-kit","fakd","fa-kit-duotone"],GY={"Font Awesome Kit":{400:"fak",normal:"fak"},"Font Awesome Kit Duotone":{400:"fakd",normal:"fakd"}},HY={classic:{"fa-brands":"fab","fa-duotone":"fad","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},duotone:{"fa-regular":"fadr","fa-light":"fadl","fa-thin":"fadt"},sharp:{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"},"sharp-duotone":{"fa-solid":"fasds","fa-regular":"fasdr","fa-light":"fasdl","fa-thin":"fasdt"}},qY={classic:["fas","far","fal","fat","fad"],duotone:["fadr","fadl","fadt"],sharp:["fass","fasr","fasl","fast"],"sharp-duotone":["fasds","fasdr","fasdl","fasdt"]},cT={classic:{fab:"fa-brands",fad:"fa-duotone",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},duotone:{fadr:"fa-regular",fadl:"fa-light",fadt:"fa-thin"},sharp:{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"},"sharp-duotone":{fasds:"fa-solid",fasdr:"fa-regular",fasdl:"fa-light",fasdt:"fa-thin"}},XY=["fa-solid","fa-regular","fa-light","fa-thin","fa-duotone","fa-brands"],hT=["fa","fas","far","fal","fat","fad","fadr","fadl","fadt","fab","fass","fasr","fasl","fast","fasds","fasdr","fasdl","fasdt",...jY,...XY],KY=["solid","regular","light","thin","duotone","brands"],Sz=[1,2,3,4,5,6,7,8,9,10],YY=Sz.concat([11,12,13,14,15,16,17,18,19,20]),ZY=[...Object.keys(qY),...KY,"2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",q0.GROUP,q0.SWAP_OPACITY,q0.PRIMARY,q0.SECONDARY].concat(Sz.map(t=>"".concat(t,"x"))).concat(YY.map(t=>"w-".concat(t))),QY={"Font Awesome 5 Free":{900:"fas",400:"far"},"Font Awesome 5 Pro":{900:"fas",400:"far",normal:"far",300:"fal"},"Font Awesome 5 Brands":{400:"fab",normal:"fab"},"Font Awesome 5 Duotone":{900:"fad"}};const $i="___FONT_AWESOME___",fT=16,Tz="fa",Cz="svg-inline--fa",eu="data-fa-i2svg",dT="data-fa-pseudo-element",JY="data-fa-pseudo-element-pending",vN="data-prefix",wN="data-icon",c_="fontawesome-i2svg",eZ="async",tZ=["HTML","HEAD","STYLE","SCRIPT"],Nz=(()=>{try{return!0}catch{return!1}})();function Pp(t){return new Proxy(t,{get(e,n){return n in e?e[n]:e[gs]}})}const kz=Ce({},xz);kz[gs]=Ce(Ce(Ce(Ce({},{"fa-duotone":"duotone"}),xz[gs]),l_.kit),l_["kit-duotone"]);const nZ=Pp(kz),pT=Ce({},MY);pT[gs]=Ce(Ce(Ce(Ce({},{duotone:"fad"}),pT[gs]),u_.kit),u_["kit-duotone"]);const h_=Pp(pT),mT=Ce({},cT);mT[gs]=Ce(Ce({},mT[gs]),UY.kit);const SN=Pp(mT),gT=Ce({},HY);gT[gs]=Ce(Ce({},gT[gs]),BY.kit);Pp(gT);const sZ=IY,Ez="fa-layers-text",rZ=AY,aZ=Ce({},_Y);Pp(aZ);const iZ=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],uS=RY,oZ=[...PY,...ZY],Yd=Oo.FontAwesomeConfig||{};function lZ(t){var e=Bt.querySelector("script["+t+"]");if(e)return e.getAttribute(t)}function uZ(t){return t===""?!0:t==="false"?!1:t==="true"?!0:t}Bt&&typeof Bt.querySelector=="function"&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(e=>{let[n,s]=e;const r=uZ(lZ(n));r!=null&&(Yd[s]=r)});const $z={styleDefault:"solid",familyDefault:gs,cssPrefix:Tz,replacementClass:Cz,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};Yd.familyPrefix&&(Yd.cssPrefix=Yd.familyPrefix);const Bc=Ce(Ce({},$z),Yd);Bc.autoReplaceSvg||(Bc.observeMutations=!1);const Ve={};Object.keys($z).forEach(t=>{Object.defineProperty(Ve,t,{enumerable:!0,set:function(e){Bc[t]=e,Zd.forEach(n=>n(Ve))},get:function(){return Bc[t]}})});Object.defineProperty(Ve,"familyPrefix",{enumerable:!0,set:function(t){Bc.cssPrefix=t,Zd.forEach(e=>e(Ve))},get:function(){return Bc.cssPrefix}});Oo.FontAwesomeConfig=Ve;const Zd=[];function cZ(t){return Zd.push(t),()=>{Zd.splice(Zd.indexOf(t),1)}}const xo=fT,Aa={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function hZ(t){if(!t||!Pi)return;const e=Bt.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=t;const n=Bt.head.childNodes;let s=null;for(let r=n.length-1;r>-1;r--){const a=n[r],i=(a.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(i)>-1&&(s=a)}return Bt.head.insertBefore(e,s),t}const fZ="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function lp(){let t=12,e="";for(;t-- >0;)e+=fZ[Math.random()*62|0];return e}function ah(t){const e=[];for(let n=(t||[]).length>>>0;n--;)e[n]=t[n];return e}function TN(t){return t.classList?ah(t.classList):(t.getAttribute("class")||"").split(" ").filter(e=>e)}function Iz(t){return"".concat(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function dZ(t){return Object.keys(t||{}).reduce((e,n)=>e+"".concat(n,'="').concat(Iz(t[n]),'" '),"").trim()}function eb(t){return Object.keys(t||{}).reduce((e,n)=>e+"".concat(n,": ").concat(t[n].trim(),";"),"")}function CN(t){return t.size!==Aa.size||t.x!==Aa.x||t.y!==Aa.y||t.rotate!==Aa.rotate||t.flipX||t.flipY}function pZ(t){let{transform:e,containerWidth:n,iconWidth:s}=t;const r={transform:"translate(".concat(n/2," 256)")},a="translate(".concat(e.x*32,", ").concat(e.y*32,") "),i="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),o="rotate(".concat(e.rotate," 0 0)"),l={transform:"".concat(a," ").concat(i," ").concat(o)},c={transform:"translate(".concat(s/2*-1," -256)")};return{outer:r,inner:l,path:c}}function mZ(t){let{transform:e,width:n=fT,height:s=fT,startCentered:r=!1}=t,a="";return r&&bz?a+="translate(".concat(e.x/xo-n/2,"em, ").concat(e.y/xo-s/2,"em) "):r?a+="translate(calc(-50% + ".concat(e.x/xo,"em), calc(-50% + ").concat(e.y/xo,"em)) "):a+="translate(".concat(e.x/xo,"em, ").concat(e.y/xo,"em) "),a+="scale(".concat(e.size/xo*(e.flipX?-1:1),", ").concat(e.size/xo*(e.flipY?-1:1),") "),a+="rotate(".concat(e.rotate,"deg) "),a}var gZ=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Free";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Free";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Pro";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Pro";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-regular: normal 400 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-light: normal 300 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-thin: normal 100 1em/1 "Font Awesome 6 Duotone";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-duotone-solid: normal 900 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-regular: normal 400 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-light: normal 300 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-thin: normal 100 1em/1 "Font Awesome 6 Sharp Duotone";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-counter-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(-1 * var(--fa-li-width, 2em));
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  animation-name: fa-beat;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  animation-name: fa-bounce;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  animation-name: fa-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  animation-name: fa-beat-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  animation-name: fa-flip;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  animation-name: fa-shake;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  animation-name: fa-spin;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 2s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  animation-name: fa-spin;
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    animation-delay: -1ms;
    animation-duration: 1ms;
    animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@keyframes fa-beat {
  0%, 90% {
    transform: scale(1);
  }
  45% {
    transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-bounce {
  0% {
    transform: scale(1, 1) translateY(0);
  }
  10% {
    transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    transform: scale(1, 1) translateY(0);
  }
  100% {
    transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-flip {
  50% {
    transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-shake {
  0% {
    transform: rotate(-15deg);
  }
  4% {
    transform: rotate(15deg);
  }
  8%, 24% {
    transform: rotate(-18deg);
  }
  12%, 28% {
    transform: rotate(18deg);
  }
  16% {
    transform: rotate(-22deg);
  }
  20% {
    transform: rotate(22deg);
  }
  32% {
    transform: rotate(-12deg);
  }
  36% {
    transform: rotate(12deg);
  }
  40%, 100% {
    transform: rotate(0deg);
  }
}
@keyframes fa-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  transform: rotate(90deg);
}

.fa-rotate-180 {
  transform: rotate(180deg);
}

.fa-rotate-270 {
  transform: rotate(270deg);
}

.fa-flip-horizontal {
  transform: scale(-1, 1);
}

.fa-flip-vertical {
  transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  transform: scale(-1, -1);
}

.fa-rotate-by {
  transform: rotate(var(--fa-rotate-angle, 0));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}`;function Az(){const t=Tz,e=Cz,n=Ve.cssPrefix,s=Ve.replacementClass;let r=gZ;if(n!==t||s!==e){const a=new RegExp("\\.".concat(t,"\\-"),"g"),i=new RegExp("\\--".concat(t,"\\-"),"g"),o=new RegExp("\\.".concat(e),"g");r=r.replace(a,".".concat(n,"-")).replace(i,"--".concat(n,"-")).replace(o,".".concat(s))}return r}let f_=!1;function cS(){Ve.autoAddCss&&!f_&&(hZ(Az()),f_=!0)}var yZ={mixout(){return{dom:{css:Az,insertCss:cS}}},hooks(){return{beforeDOMElementCreation(){cS()},beforeI2svg(){cS()}}}};const Ii=Oo||{};Ii[$i]||(Ii[$i]={});Ii[$i].styles||(Ii[$i].styles={});Ii[$i].hooks||(Ii[$i].hooks={});Ii[$i].shims||(Ii[$i].shims=[]);var Ra=Ii[$i];const Rz=[],Dz=function(){Bt.removeEventListener("DOMContentLoaded",Dz),u1=1,Rz.map(t=>t())};let u1=!1;Pi&&(u1=(Bt.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Bt.readyState),u1||Bt.addEventListener("DOMContentLoaded",Dz));function bZ(t){Pi&&(u1?setTimeout(t,0):Rz.push(t))}function Bp(t){const{tag:e,attributes:n={},children:s=[]}=t;return typeof t=="string"?Iz(t):"<".concat(e," ").concat(dZ(n),">").concat(s.map(Bp).join(""),"</").concat(e,">")}function d_(t,e,n){if(t&&t[e]&&t[e][n])return{prefix:e,iconName:n,icon:t[e][n]}}var hS=function(e,n,s,r){var a=Object.keys(e),i=a.length,o=n,l,c,f;for(s===void 0?(l=1,f=e[a[0]]):(l=0,f=s);l<i;l++)c=a[l],f=o(f,e[c],c,e);return f};function xZ(t){const e=[];let n=0;const s=t.length;for(;n<s;){const r=t.charCodeAt(n++);if(r>=55296&&r<=56319&&n<s){const a=t.charCodeAt(n++);(a&64512)==56320?e.push(((r&1023)<<10)+(a&1023)+65536):(e.push(r),n--)}else e.push(r)}return e}function yT(t){const e=xZ(t);return e.length===1?e[0].toString(16):null}function vZ(t,e){const n=t.length;let s=t.charCodeAt(e),r;return s>=55296&&s<=56319&&n>e+1&&(r=t.charCodeAt(e+1),r>=56320&&r<=57343)?(s-55296)*1024+r-56320+65536:s}function p_(t){return Object.keys(t).reduce((e,n)=>{const s=t[n];return!!s.icon?e[s.iconName]=s.icon:e[n]=s,e},{})}function bT(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{skipHooks:s=!1}=n,r=p_(e);typeof Ra.hooks.addPack=="function"&&!s?Ra.hooks.addPack(t,p_(e)):Ra.styles[t]=Ce(Ce({},Ra.styles[t]||{}),r),t==="fas"&&bT("fa",e)}const{styles:up,shims:wZ}=Ra,Oz=Object.keys(SN),SZ=Oz.reduce((t,e)=>(t[e]=Object.keys(SN[e]),t),{});let NN=null,_z={},Fz={},Lz={},Mz={},zz={};function TZ(t){return~oZ.indexOf(t)}function CZ(t,e){const n=e.split("-"),s=n[0],r=n.slice(1).join("-");return s===t&&r!==""&&!TZ(r)?r:null}const Pz=()=>{const t=s=>hS(up,(r,a,i)=>(r[i]=hS(a,s,{}),r),{});_z=t((s,r,a)=>(r[3]&&(s[r[3]]=a),r[2]&&r[2].filter(o=>typeof o=="number").forEach(o=>{s[o.toString(16)]=a}),s)),Fz=t((s,r,a)=>(s[a]=a,r[2]&&r[2].filter(o=>typeof o=="string").forEach(o=>{s[o]=a}),s)),zz=t((s,r,a)=>{const i=r[2];return s[a]=a,i.forEach(o=>{s[o]=a}),s});const e="far"in up||Ve.autoFetchSvg,n=hS(wZ,(s,r)=>{const a=r[0];let i=r[1];const o=r[2];return i==="far"&&!e&&(i="fas"),typeof a=="string"&&(s.names[a]={prefix:i,iconName:o}),typeof a=="number"&&(s.unicodes[a.toString(16)]={prefix:i,iconName:o}),s},{names:{},unicodes:{}});Lz=n.names,Mz=n.unicodes,NN=tb(Ve.styleDefault,{family:Ve.familyDefault})};cZ(t=>{NN=tb(t.styleDefault,{family:Ve.familyDefault})});Pz();function kN(t,e){return(_z[t]||{})[e]}function NZ(t,e){return(Fz[t]||{})[e]}function jl(t,e){return(zz[t]||{})[e]}function Bz(t){return Lz[t]||{prefix:null,iconName:null}}function kZ(t){const e=Mz[t],n=kN("fas",t);return e||(n?{prefix:"fas",iconName:n}:null)||{prefix:null,iconName:null}}function _o(){return NN}const Vz=()=>({prefix:null,iconName:null,rest:[]});function EZ(t){let e=gs;const n=Oz.reduce((s,r)=>(s[r]="".concat(Ve.cssPrefix,"-").concat(r),s),{});return wz.forEach(s=>{(t.includes(n[s])||t.some(r=>SZ[s].includes(r)))&&(e=s)}),e}function tb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{family:n=gs}=e,s=nZ[n][t];if(n===J1&&!t)return"fad";const r=h_[n][t]||h_[n][s],a=t in Ra.styles?t:null;return r||a||null}function $Z(t){let e=[],n=null;return t.forEach(s=>{const r=CZ(Ve.cssPrefix,s);r?n=r:s&&e.push(s)}),{iconName:n,rest:e}}function m_(t){return t.sort().filter((e,n,s)=>s.indexOf(e)===n)}function nb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{skipLookups:n=!1}=e;let s=null;const r=hT.concat(WY),a=m_(t.filter(d=>r.includes(d))),i=m_(t.filter(d=>!hT.includes(d))),o=a.filter(d=>(s=d,!vz.includes(d))),[l=null]=o,c=EZ(a),f=Ce(Ce({},$Z(i)),{},{prefix:tb(l,{family:c})});return Ce(Ce(Ce({},f),DZ({values:t,family:c,styles:up,config:Ve,canonical:f,givenPrefix:s})),IZ(n,s,f))}function IZ(t,e,n){let{prefix:s,iconName:r}=n;if(t||!s||!r)return{prefix:s,iconName:r};const a=e==="fa"?Bz(r):{},i=jl(s,r);return r=a.iconName||i||r,s=a.prefix||s,s==="far"&&!up.far&&up.fas&&!Ve.autoFetchSvg&&(s="fas"),{prefix:s,iconName:r}}const AZ=wz.filter(t=>t!==gs||t!==J1),RZ=Object.keys(cT).filter(t=>t!==gs).map(t=>Object.keys(cT[t])).flat();function DZ(t){const{values:e,family:n,canonical:s,givenPrefix:r="",styles:a={},config:i={}}=t,o=n===J1,l=e.includes("fa-duotone")||e.includes("fad"),c=i.familyDefault==="duotone",f=s.prefix==="fad"||s.prefix==="fa-duotone";if(!o&&(l||c||f)&&(s.prefix="fad"),(e.includes("fa-brands")||e.includes("fab"))&&(s.prefix="fab"),!s.prefix&&AZ.includes(n)&&(Object.keys(a).find(p=>RZ.includes(p))||i.autoFetchSvg)){const p=LY.get(n).defaultShortPrefixId;s.prefix=p,s.iconName=jl(s.prefix,s.iconName)||s.iconName}return(s.prefix==="fa"||r==="fa")&&(s.prefix=_o()||"fas"),s}class OZ{constructor(){this.definitions={}}add(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];const r=n.reduce(this._pullDefinitions,{});Object.keys(r).forEach(a=>{this.definitions[a]=Ce(Ce({},this.definitions[a]||{}),r[a]),bT(a,r[a]);const i=SN[gs][a];i&&bT(i,r[a]),Pz()})}reset(){this.definitions={}}_pullDefinitions(e,n){const s=n.prefix&&n.iconName&&n.icon?{0:n}:n;return Object.keys(s).map(r=>{const{prefix:a,iconName:i,icon:o}=s[r],l=o[2];e[a]||(e[a]={}),l.length>0&&l.forEach(c=>{typeof c=="string"&&(e[a][c]=o)}),e[a][i]=o}),e}}let g_=[],Ac={};const Oc={},_Z=Object.keys(Oc);function FZ(t,e){let{mixoutsTo:n}=e;return g_=t,Ac={},Object.keys(Oc).forEach(s=>{_Z.indexOf(s)===-1&&delete Oc[s]}),g_.forEach(s=>{const r=s.mixout?s.mixout():{};if(Object.keys(r).forEach(a=>{typeof r[a]=="function"&&(n[a]=r[a]),typeof r[a]=="object"&&Object.keys(r[a]).forEach(i=>{n[a]||(n[a]={}),n[a][i]=r[a][i]})}),s.hooks){const a=s.hooks();Object.keys(a).forEach(i=>{Ac[i]||(Ac[i]=[]),Ac[i].push(a[i])})}s.provides&&s.provides(Oc)}),n}function xT(t,e){for(var n=arguments.length,s=new Array(n>2?n-2:0),r=2;r<n;r++)s[r-2]=arguments[r];return(Ac[t]||[]).forEach(i=>{e=i.apply(null,[e,...s])}),e}function tu(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),s=1;s<e;s++)n[s-1]=arguments[s];(Ac[t]||[]).forEach(a=>{a.apply(null,n)})}function Fo(){const t=arguments[0],e=Array.prototype.slice.call(arguments,1);return Oc[t]?Oc[t].apply(null,e):void 0}function vT(t){t.prefix==="fa"&&(t.prefix="fas");let{iconName:e}=t;const n=t.prefix||_o();if(e)return e=jl(n,e)||e,d_(Uz.definitions,n,e)||d_(Ra.styles,n,e)}const Uz=new OZ,LZ=()=>{Ve.autoReplaceSvg=!1,Ve.observeMutations=!1,tu("noAuto")},MZ={i2svg:function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Pi?(tu("beforeI2svg",t),Fo("pseudoElements2svg",t),Fo("i2svg",t)):Promise.reject(new Error("Operation requires a DOM of some kind."))},watch:function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:e}=t;Ve.autoReplaceSvg===!1&&(Ve.autoReplaceSvg=!0),Ve.observeMutations=!0,bZ(()=>{PZ({autoReplaceSvgRoot:e}),tu("watch",t)})}},zZ={icon:t=>{if(t===null)return null;if(typeof t=="object"&&t.prefix&&t.iconName)return{prefix:t.prefix,iconName:jl(t.prefix,t.iconName)||t.iconName};if(Array.isArray(t)&&t.length===2){const e=t[1].indexOf("fa-")===0?t[1].slice(3):t[1],n=tb(t[0]);return{prefix:n,iconName:jl(n,e)||e}}if(typeof t=="string"&&(t.indexOf("".concat(Ve.cssPrefix,"-"))>-1||t.match(sZ))){const e=nb(t.split(" "),{skipLookups:!0});return{prefix:e.prefix||_o(),iconName:jl(e.prefix,e.iconName)||e.iconName}}if(typeof t=="string"){const e=_o();return{prefix:e,iconName:jl(e,t)||t}}}},xr={noAuto:LZ,config:Ve,dom:MZ,parse:zZ,library:Uz,findIconDefinition:vT,toHtml:Bp},PZ=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:e=Bt}=t;(Object.keys(Ra.styles).length>0||Ve.autoFetchSvg)&&Pi&&Ve.autoReplaceSvg&&xr.dom.i2svg({node:e})};function sb(t,e){return Object.defineProperty(t,"abstract",{get:e}),Object.defineProperty(t,"html",{get:function(){return t.abstract.map(n=>Bp(n))}}),Object.defineProperty(t,"node",{get:function(){if(!Pi)return;const n=Bt.createElement("div");return n.innerHTML=t.html,n.children}}),t}function BZ(t){let{children:e,main:n,mask:s,attributes:r,styles:a,transform:i}=t;if(CN(i)&&n.found&&!s.found){const{width:o,height:l}=n,c={x:o/l/2,y:.5};r.style=eb(Ce(Ce({},a),{},{"transform-origin":"".concat(c.x+i.x/16,"em ").concat(c.y+i.y/16,"em")}))}return[{tag:"svg",attributes:r,children:e}]}function VZ(t){let{prefix:e,iconName:n,children:s,attributes:r,symbol:a}=t;const i=a===!0?"".concat(e,"-").concat(Ve.cssPrefix,"-").concat(n):a;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Ce(Ce({},r),{},{id:i}),children:s}]}]}function EN(t){const{icons:{main:e,mask:n},prefix:s,iconName:r,transform:a,symbol:i,title:o,maskId:l,titleId:c,extra:f,watchable:d=!1}=t,{width:p,height:g}=n.found?n:e,y=VY.includes(s),v=[Ve.replacementClass,r?"".concat(Ve.cssPrefix,"-").concat(r):""].filter(E=>f.classes.indexOf(E)===-1).filter(E=>E!==""||!!E).concat(f.classes).join(" ");let x={children:[],attributes:Ce(Ce({},f.attributes),{},{"data-prefix":s,"data-icon":r,class:v,role:f.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(g)})};const w=y&&!~f.classes.indexOf("fa-fw")?{width:"".concat(p/g*16*.0625,"em")}:{};d&&(x.attributes[eu]=""),o&&(x.children.push({tag:"title",attributes:{id:x.attributes["aria-labelledby"]||"title-".concat(c||lp())},children:[o]}),delete x.attributes.title);const T=Ce(Ce({},x),{},{prefix:s,iconName:r,main:e,mask:n,maskId:l,transform:a,symbol:i,styles:Ce(Ce({},w),f.styles)}),{children:N,attributes:C}=n.found&&e.found?Fo("generateAbstractMask",T)||{children:[],attributes:{}}:Fo("generateAbstractIcon",T)||{children:[],attributes:{}};return T.children=N,T.attributes=C,i?VZ(T):BZ(T)}function y_(t){const{content:e,width:n,height:s,transform:r,title:a,extra:i,watchable:o=!1}=t,l=Ce(Ce(Ce({},i.attributes),a?{title:a}:{}),{},{class:i.classes.join(" ")});o&&(l[eu]="");const c=Ce({},i.styles);CN(r)&&(c.transform=mZ({transform:r,startCentered:!0,width:n,height:s}),c["-webkit-transform"]=c.transform);const f=eb(c);f.length>0&&(l.style=f);const d=[];return d.push({tag:"span",attributes:l,children:[e]}),a&&d.push({tag:"span",attributes:{class:"sr-only"},children:[a]}),d}function UZ(t){const{content:e,title:n,extra:s}=t,r=Ce(Ce(Ce({},s.attributes),n?{title:n}:{}),{},{class:s.classes.join(" ")}),a=eb(s.styles);a.length>0&&(r.style=a);const i=[];return i.push({tag:"span",attributes:r,children:[e]}),n&&i.push({tag:"span",attributes:{class:"sr-only"},children:[n]}),i}const{styles:fS}=Ra;function wT(t){const e=t[0],n=t[1],[s]=t.slice(4);let r=null;return Array.isArray(s)?r={tag:"g",attributes:{class:"".concat(Ve.cssPrefix,"-").concat(uS.GROUP)},children:[{tag:"path",attributes:{class:"".concat(Ve.cssPrefix,"-").concat(uS.SECONDARY),fill:"currentColor",d:s[0]}},{tag:"path",attributes:{class:"".concat(Ve.cssPrefix,"-").concat(uS.PRIMARY),fill:"currentColor",d:s[1]}}]}:r={tag:"path",attributes:{fill:"currentColor",d:s}},{found:!0,width:e,height:n,icon:r}}const jZ={found:!1,width:512,height:512};function WZ(t,e){!Nz&&!Ve.showMissingIcons&&t&&console.error('Icon with name "'.concat(t,'" and prefix "').concat(e,'" is missing.'))}function ST(t,e){let n=e;return e==="fa"&&Ve.styleDefault!==null&&(e=_o()),new Promise((s,r)=>{if(n==="fa"){const a=Bz(t)||{};t=a.iconName||t,e=a.prefix||e}if(t&&e&&fS[e]&&fS[e][t]){const a=fS[e][t];return s(wT(a))}WZ(t,e),s(Ce(Ce({},jZ),{},{icon:Ve.showMissingIcons&&t?Fo("missingIconAbstract")||{}:{}}))})}const b_=()=>{},TT=Ve.measurePerformance&&H0&&H0.mark&&H0.measure?H0:{mark:b_,measure:b_},Ld='FA "6.7.2"',GZ=t=>(TT.mark("".concat(Ld," ").concat(t," begins")),()=>jz(t)),jz=t=>{TT.mark("".concat(Ld," ").concat(t," ends")),TT.measure("".concat(Ld," ").concat(t),"".concat(Ld," ").concat(t," begins"),"".concat(Ld," ").concat(t," ends"))};var $N={begin:GZ,end:jz};const py=()=>{};function x_(t){return typeof(t.getAttribute?t.getAttribute(eu):null)=="string"}function HZ(t){const e=t.getAttribute?t.getAttribute(vN):null,n=t.getAttribute?t.getAttribute(wN):null;return e&&n}function qZ(t){return t&&t.classList&&t.classList.contains&&t.classList.contains(Ve.replacementClass)}function XZ(){return Ve.autoReplaceSvg===!0?my.replace:my[Ve.autoReplaceSvg]||my.replace}function KZ(t){return Bt.createElementNS("http://www.w3.org/2000/svg",t)}function YZ(t){return Bt.createElement(t)}function Wz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{ceFn:n=t.tag==="svg"?KZ:YZ}=e;if(typeof t=="string")return Bt.createTextNode(t);const s=n(t.tag);return Object.keys(t.attributes||[]).forEach(function(a){s.setAttribute(a,t.attributes[a])}),(t.children||[]).forEach(function(a){s.appendChild(Wz(a,{ceFn:n}))}),s}function ZZ(t){let e=" ".concat(t.outerHTML," ");return e="".concat(e,"Font Awesome fontawesome.com "),e}const my={replace:function(t){const e=t[0];if(e.parentNode)if(t[1].forEach(n=>{e.parentNode.insertBefore(Wz(n),e)}),e.getAttribute(eu)===null&&Ve.keepOriginalSource){let n=Bt.createComment(ZZ(e));e.parentNode.replaceChild(n,e)}else e.remove()},nest:function(t){const e=t[0],n=t[1];if(~TN(e).indexOf(Ve.replacementClass))return my.replace(t);const s=new RegExp("".concat(Ve.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){const a=n[0].attributes.class.split(" ").reduce((i,o)=>(o===Ve.replacementClass||o.match(s)?i.toSvg.push(o):i.toNode.push(o),i),{toNode:[],toSvg:[]});n[0].attributes.class=a.toSvg.join(" "),a.toNode.length===0?e.removeAttribute("class"):e.setAttribute("class",a.toNode.join(" "))}const r=n.map(a=>Bp(a)).join(`
`);e.setAttribute(eu,""),e.innerHTML=r}};function v_(t){t()}function Gz(t,e){const n=typeof e=="function"?e:py;if(t.length===0)n();else{let s=v_;Ve.mutateApproach===eZ&&(s=Oo.requestAnimationFrame||v_),s(()=>{const r=XZ(),a=$N.begin("mutate");t.map(r),a(),n()})}}let IN=!1;function Hz(){IN=!0}function CT(){IN=!1}let c1=null;function w_(t){if(!o_||!Ve.observeMutations)return;const{treeCallback:e=py,nodeCallback:n=py,pseudoElementsCallback:s=py,observeMutationsRoot:r=Bt}=t;c1=new o_(a=>{if(IN)return;const i=_o();ah(a).forEach(o=>{if(o.type==="childList"&&o.addedNodes.length>0&&!x_(o.addedNodes[0])&&(Ve.searchPseudoElements&&s(o.target),e(o.target)),o.type==="attributes"&&o.target.parentNode&&Ve.searchPseudoElements&&s(o.target.parentNode),o.type==="attributes"&&x_(o.target)&&~iZ.indexOf(o.attributeName))if(o.attributeName==="class"&&HZ(o.target)){const{prefix:l,iconName:c}=nb(TN(o.target));o.target.setAttribute(vN,l||i),c&&o.target.setAttribute(wN,c)}else qZ(o.target)&&n(o.target)})}),Pi&&c1.observe(r,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}function QZ(){c1&&c1.disconnect()}function JZ(t){const e=t.getAttribute("style");let n=[];return e&&(n=e.split(";").reduce((s,r)=>{const a=r.split(":"),i=a[0],o=a.slice(1);return i&&o.length>0&&(s[i]=o.join(":").trim()),s},{})),n}function eQ(t){const e=t.getAttribute("data-prefix"),n=t.getAttribute("data-icon"),s=t.innerText!==void 0?t.innerText.trim():"";let r=nb(TN(t));return r.prefix||(r.prefix=_o()),e&&n&&(r.prefix=e,r.iconName=n),r.iconName&&r.prefix||(r.prefix&&s.length>0&&(r.iconName=NZ(r.prefix,t.innerText)||kN(r.prefix,yT(t.innerText))),!r.iconName&&Ve.autoFetchSvg&&t.firstChild&&t.firstChild.nodeType===Node.TEXT_NODE&&(r.iconName=t.firstChild.data)),r}function tQ(t){const e=ah(t.attributes).reduce((r,a)=>(r.name!=="class"&&r.name!=="style"&&(r[a.name]=a.value),r),{}),n=t.getAttribute("title"),s=t.getAttribute("data-fa-title-id");return Ve.autoA11y&&(n?e["aria-labelledby"]="".concat(Ve.replacementClass,"-title-").concat(s||lp()):(e["aria-hidden"]="true",e.focusable="false")),e}function nQ(){return{iconName:null,title:null,titleId:null,prefix:null,transform:Aa,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function S_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0};const{iconName:n,prefix:s,rest:r}=eQ(t),a=tQ(t),i=xT("parseNodeAttributes",{},t);let o=e.styleParser?JZ(t):[];return Ce({iconName:n,title:t.getAttribute("title"),titleId:t.getAttribute("data-fa-title-id"),prefix:s,transform:Aa,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:r,styles:o,attributes:a}},i)}const{styles:sQ}=Ra;function qz(t){const e=Ve.autoReplaceSvg==="nest"?S_(t,{styleParser:!1}):S_(t);return~e.extra.classes.indexOf(Ez)?Fo("generateLayersText",t,e):Fo("generateSvgReplacementMutation",t,e)}function rQ(){return[...zY,...hT]}function T_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Pi)return Promise.resolve();const n=Bt.documentElement.classList,s=f=>n.add("".concat(c_,"-").concat(f)),r=f=>n.remove("".concat(c_,"-").concat(f)),a=Ve.autoFetchSvg?rQ():vz.concat(Object.keys(sQ));a.includes("fa")||a.push("fa");const i=[".".concat(Ez,":not([").concat(eu,"])")].concat(a.map(f=>".".concat(f,":not([").concat(eu,"])"))).join(", ");if(i.length===0)return Promise.resolve();let o=[];try{o=ah(t.querySelectorAll(i))}catch{}if(o.length>0)s("pending"),r("complete");else return Promise.resolve();const l=$N.begin("onTree"),c=o.reduce((f,d)=>{try{const p=qz(d);p&&f.push(p)}catch(p){Nz||p.name==="MissingIcon"&&console.error(p)}return f},[]);return new Promise((f,d)=>{Promise.all(c).then(p=>{Gz(p,()=>{s("active"),s("complete"),r("pending"),typeof e=="function"&&e(),l(),f()})}).catch(p=>{l(),d(p)})})}function aQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;qz(t).then(n=>{n&&Gz([n],e)})}function iQ(t){return function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=(e||{}).icon?e:vT(e||{});let{mask:r}=n;return r&&(r=(r||{}).icon?r:vT(r||{})),t(s,Ce(Ce({},n),{},{mask:r}))}}const oQ=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:n=Aa,symbol:s=!1,mask:r=null,maskId:a=null,title:i=null,titleId:o=null,classes:l=[],attributes:c={},styles:f={}}=e;if(!t)return;const{prefix:d,iconName:p,icon:g}=t;return sb(Ce({type:"icon"},t),()=>(tu("beforeDOMElementCreation",{iconDefinition:t,params:e}),Ve.autoA11y&&(i?c["aria-labelledby"]="".concat(Ve.replacementClass,"-title-").concat(o||lp()):(c["aria-hidden"]="true",c.focusable="false")),EN({icons:{main:wT(g),mask:r?wT(r.icon):{found:!1,width:null,height:null,icon:{}}},prefix:d,iconName:p,transform:Ce(Ce({},Aa),n),symbol:s,title:i,maskId:a,titleId:o,extra:{attributes:c,styles:f,classes:l}})))};var lQ={mixout(){return{icon:iQ(oQ)}},hooks(){return{mutationObserverCallbacks(t){return t.treeCallback=T_,t.nodeCallback=aQ,t}}},provides(t){t.i2svg=function(e){const{node:n=Bt,callback:s=()=>{}}=e;return T_(n,s)},t.generateSvgReplacementMutation=function(e,n){const{iconName:s,title:r,titleId:a,prefix:i,transform:o,symbol:l,mask:c,maskId:f,extra:d}=n;return new Promise((p,g)=>{Promise.all([ST(s,i),c.iconName?ST(c.iconName,c.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(y=>{let[v,x]=y;p([e,EN({icons:{main:v,mask:x},prefix:i,iconName:s,transform:o,symbol:l,maskId:f,title:r,titleId:a,extra:d,watchable:!0})])}).catch(g)})},t.generateAbstractIcon=function(e){let{children:n,attributes:s,main:r,transform:a,styles:i}=e;const o=eb(i);o.length>0&&(s.style=o);let l;return CN(a)&&(l=Fo("generateAbstractTransformGrouping",{main:r,transform:a,containerWidth:r.width,iconWidth:r.width})),n.push(l||r.icon),{children:n,attributes:s}}}},uQ={mixout(){return{layer(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{classes:n=[]}=e;return sb({type:"layer"},()=>{tu("beforeDOMElementCreation",{assembler:t,params:e});let s=[];return t(r=>{Array.isArray(r)?r.map(a=>{s=s.concat(a.abstract)}):s=s.concat(r.abstract)}),[{tag:"span",attributes:{class:["".concat(Ve.cssPrefix,"-layers"),...n].join(" ")},children:s}]})}}}},cQ={mixout(){return{counter(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{title:n=null,classes:s=[],attributes:r={},styles:a={}}=e;return sb({type:"counter",content:t},()=>(tu("beforeDOMElementCreation",{content:t,params:e}),UZ({content:t.toString(),title:n,extra:{attributes:r,styles:a,classes:["".concat(Ve.cssPrefix,"-layers-counter"),...s]}})))}}}},hQ={mixout(){return{text(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:n=Aa,title:s=null,classes:r=[],attributes:a={},styles:i={}}=e;return sb({type:"text",content:t},()=>(tu("beforeDOMElementCreation",{content:t,params:e}),y_({content:t,transform:Ce(Ce({},Aa),n),title:s,extra:{attributes:a,styles:i,classes:["".concat(Ve.cssPrefix,"-layers-text"),...r]}})))}}},provides(t){t.generateLayersText=function(e,n){const{title:s,transform:r,extra:a}=n;let i=null,o=null;if(bz){const l=parseInt(getComputedStyle(e).fontSize,10),c=e.getBoundingClientRect();i=c.width/l,o=c.height/l}return Ve.autoA11y&&!s&&(a.attributes["aria-hidden"]="true"),Promise.resolve([e,y_({content:e.innerHTML,width:i,height:o,transform:r,title:s,extra:a,watchable:!0})])}}};const fQ=new RegExp('"',"ug"),C_=[1105920,1112319],N_=Ce(Ce(Ce(Ce({},{FontAwesome:{normal:"fas",400:"fas"}}),FY),QY),GY),NT=Object.keys(N_).reduce((t,e)=>(t[e.toLowerCase()]=N_[e],t),{}),dQ=Object.keys(NT).reduce((t,e)=>{const n=NT[e];return t[e]=n[900]||[...Object.entries(n)][0][1],t},{});function pQ(t){const e=t.replace(fQ,""),n=vZ(e,0),s=n>=C_[0]&&n<=C_[1],r=e.length===2?e[0]===e[1]:!1;return{value:yT(r?e[0]:e),isSecondary:s||r}}function mQ(t,e){const n=t.replace(/^['"]|['"]$/g,"").toLowerCase(),s=parseInt(e),r=isNaN(s)?"normal":s;return(NT[n]||{})[r]||dQ[n]}function k_(t,e){const n="".concat(JY).concat(e.replace(":","-"));return new Promise((s,r)=>{if(t.getAttribute(n)!==null)return s();const i=ah(t.children).filter(p=>p.getAttribute(dT)===e)[0],o=Oo.getComputedStyle(t,e),l=o.getPropertyValue("font-family"),c=l.match(rZ),f=o.getPropertyValue("font-weight"),d=o.getPropertyValue("content");if(i&&!c)return t.removeChild(i),s();if(c&&d!=="none"&&d!==""){const p=o.getPropertyValue("content");let g=mQ(l,f);const{value:y,isSecondary:v}=pQ(p),x=c[0].startsWith("FontAwesome");let w=kN(g,y),T=w;if(x){const N=kZ(y);N.iconName&&N.prefix&&(w=N.iconName,g=N.prefix)}if(w&&!v&&(!i||i.getAttribute(vN)!==g||i.getAttribute(wN)!==T)){t.setAttribute(n,T),i&&t.removeChild(i);const N=nQ(),{extra:C}=N;C.attributes[dT]=e,ST(w,g).then(E=>{const R=EN(Ce(Ce({},N),{},{icons:{main:E,mask:Vz()},prefix:g,iconName:T,extra:C,watchable:!0})),$=Bt.createElementNS("http://www.w3.org/2000/svg","svg");e==="::before"?t.insertBefore($,t.firstChild):t.appendChild($),$.outerHTML=R.map(O=>Bp(O)).join(`
`),t.removeAttribute(n),s()}).catch(r)}else s()}else s()})}function gQ(t){return Promise.all([k_(t,"::before"),k_(t,"::after")])}function yQ(t){return t.parentNode!==document.head&&!~tZ.indexOf(t.tagName.toUpperCase())&&!t.getAttribute(dT)&&(!t.parentNode||t.parentNode.tagName!=="svg")}function E_(t){if(Pi)return new Promise((e,n)=>{const s=ah(t.querySelectorAll("*")).filter(yQ).map(gQ),r=$N.begin("searchPseudoElements");Hz(),Promise.all(s).then(()=>{r(),CT(),e()}).catch(()=>{r(),CT(),n()})})}var bQ={hooks(){return{mutationObserverCallbacks(t){return t.pseudoElementsCallback=E_,t}}},provides(t){t.pseudoElements2svg=function(e){const{node:n=Bt}=e;Ve.searchPseudoElements&&E_(n)}}};let $_=!1;var xQ={mixout(){return{dom:{unwatch(){Hz(),$_=!0}}}},hooks(){return{bootstrap(){w_(xT("mutationObserverCallbacks",{}))},noAuto(){QZ()},watch(t){const{observeMutationsRoot:e}=t;$_?CT():w_(xT("mutationObserverCallbacks",{observeMutationsRoot:e}))}}}};const I_=t=>{let e={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return t.toLowerCase().split(" ").reduce((n,s)=>{const r=s.toLowerCase().split("-"),a=r[0];let i=r.slice(1).join("-");if(a&&i==="h")return n.flipX=!0,n;if(a&&i==="v")return n.flipY=!0,n;if(i=parseFloat(i),isNaN(i))return n;switch(a){case"grow":n.size=n.size+i;break;case"shrink":n.size=n.size-i;break;case"left":n.x=n.x-i;break;case"right":n.x=n.x+i;break;case"up":n.y=n.y-i;break;case"down":n.y=n.y+i;break;case"rotate":n.rotate=n.rotate+i;break}return n},e)};var vQ={mixout(){return{parse:{transform:t=>I_(t)}}},hooks(){return{parseNodeAttributes(t,e){const n=e.getAttribute("data-fa-transform");return n&&(t.transform=I_(n)),t}}},provides(t){t.generateAbstractTransformGrouping=function(e){let{main:n,transform:s,containerWidth:r,iconWidth:a}=e;const i={transform:"translate(".concat(r/2," 256)")},o="translate(".concat(s.x*32,", ").concat(s.y*32,") "),l="scale(".concat(s.size/16*(s.flipX?-1:1),", ").concat(s.size/16*(s.flipY?-1:1),") "),c="rotate(".concat(s.rotate," 0 0)"),f={transform:"".concat(o," ").concat(l," ").concat(c)},d={transform:"translate(".concat(a/2*-1," -256)")},p={outer:i,inner:f,path:d};return{tag:"g",attributes:Ce({},p.outer),children:[{tag:"g",attributes:Ce({},p.inner),children:[{tag:n.icon.tag,children:n.icon.children,attributes:Ce(Ce({},n.icon.attributes),p.path)}]}]}}}};const dS={x:0,y:0,width:"100%",height:"100%"};function A_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.attributes&&(t.attributes.fill||e)&&(t.attributes.fill="black"),t}function wQ(t){return t.tag==="g"?t.children:[t]}var SQ={hooks(){return{parseNodeAttributes(t,e){const n=e.getAttribute("data-fa-mask"),s=n?nb(n.split(" ").map(r=>r.trim())):Vz();return s.prefix||(s.prefix=_o()),t.mask=s,t.maskId=e.getAttribute("data-fa-mask-id"),t}}},provides(t){t.generateAbstractMask=function(e){let{children:n,attributes:s,main:r,mask:a,maskId:i,transform:o}=e;const{width:l,icon:c}=r,{width:f,icon:d}=a,p=pZ({transform:o,containerWidth:f,iconWidth:l}),g={tag:"rect",attributes:Ce(Ce({},dS),{},{fill:"white"})},y=c.children?{children:c.children.map(A_)}:{},v={tag:"g",attributes:Ce({},p.inner),children:[A_(Ce({tag:c.tag,attributes:Ce(Ce({},c.attributes),p.path)},y))]},x={tag:"g",attributes:Ce({},p.outer),children:[v]},w="mask-".concat(i||lp()),T="clip-".concat(i||lp()),N={tag:"mask",attributes:Ce(Ce({},dS),{},{id:w,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[g,x]},C={tag:"defs",children:[{tag:"clipPath",attributes:{id:T},children:wQ(d)},N]};return n.push(C,{tag:"rect",attributes:Ce({fill:"currentColor","clip-path":"url(#".concat(T,")"),mask:"url(#".concat(w,")")},dS)}),{children:n,attributes:s}}}},TQ={provides(t){let e=!1;Oo.matchMedia&&(e=Oo.matchMedia("(prefers-reduced-motion: reduce)").matches),t.missingIconAbstract=function(){const n=[],s={fill:"currentColor"},r={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};n.push({tag:"path",attributes:Ce(Ce({},s),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});const a=Ce(Ce({},r),{},{attributeName:"opacity"}),i={tag:"circle",attributes:Ce(Ce({},s),{},{cx:"256",cy:"364",r:"28"}),children:[]};return e||i.children.push({tag:"animate",attributes:Ce(Ce({},r),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:Ce(Ce({},a),{},{values:"1;0;1;1;0;1;"})}),n.push(i),n.push({tag:"path",attributes:Ce(Ce({},s),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:e?[]:[{tag:"animate",attributes:Ce(Ce({},a),{},{values:"1;0;0;0;0;1;"})}]}),e||n.push({tag:"path",attributes:Ce(Ce({},s),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:Ce(Ce({},a),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:n}}}},CQ={hooks(){return{parseNodeAttributes(t,e){const n=e.getAttribute("data-fa-symbol"),s=n===null?!1:n===""?!0:n;return t.symbol=s,t}}}},NQ=[yZ,lQ,uQ,cQ,hQ,bQ,xQ,vQ,SQ,TQ,CQ];FZ(NQ,{mixoutsTo:xr});xr.noAuto;xr.config;xr.library;xr.dom;const kT=xr.parse;xr.findIconDefinition;xr.toHtml;const kQ=xr.icon;xr.layer;xr.text;xr.counter;var pS={exports:{}},mS,R_;function EQ(){if(R_)return mS;R_=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return mS=t,mS}var gS,D_;function $Q(){if(D_)return gS;D_=1;var t=EQ();function e(){}function n(){}return n.resetWarningCache=e,gS=function(){function s(i,o,l,c,f,d){if(d!==t){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}s.isRequired=s;function r(){return s}var a={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:r,element:s,elementType:s,instanceOf:r,node:s,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:n,resetWarningCache:e};return a.PropTypes=a,a},gS}var O_;function IQ(){return O_||(O_=1,pS.exports=$Q()()),pS.exports}var AQ=IQ();const ut=RC(AQ);function __(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function ka(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?__(Object(n),!0).forEach(function(s){Rc(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):__(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function h1(t){"@babel/helpers - typeof";return h1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h1(t)}function Rc(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RQ(t,e){if(t==null)return{};var n={},s=Object.keys(t),r,a;for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function DQ(t,e){if(t==null)return{};var n=RQ(t,e),s,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)s=a[r],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function ET(t){return OQ(t)||_Q(t)||FQ(t)||LQ()}function OQ(t){if(Array.isArray(t))return $T(t)}function _Q(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function FQ(t,e){if(t){if(typeof t=="string")return $T(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $T(t,e)}}function $T(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,s=new Array(e);n<e;n++)s[n]=t[n];return s}function LQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MQ(t){var e,n=t.beat,s=t.fade,r=t.beatFade,a=t.bounce,i=t.shake,o=t.flash,l=t.spin,c=t.spinPulse,f=t.spinReverse,d=t.pulse,p=t.fixedWidth,g=t.inverse,y=t.border,v=t.listItem,x=t.flip,w=t.size,T=t.rotation,N=t.pull,C=(e={"fa-beat":n,"fa-fade":s,"fa-beat-fade":r,"fa-bounce":a,"fa-shake":i,"fa-flash":o,"fa-spin":l,"fa-spin-reverse":f,"fa-spin-pulse":c,"fa-pulse":d,"fa-fw":p,"fa-inverse":g,"fa-border":y,"fa-li":v,"fa-flip":x===!0,"fa-flip-horizontal":x==="horizontal"||x==="both","fa-flip-vertical":x==="vertical"||x==="both"},Rc(e,"fa-".concat(w),typeof w<"u"&&w!==null),Rc(e,"fa-rotate-".concat(T),typeof T<"u"&&T!==null&&T!==0),Rc(e,"fa-pull-".concat(N),typeof N<"u"&&N!==null),Rc(e,"fa-swap-opacity",t.swapOpacity),e);return Object.keys(C).map(function(E){return C[E]?E:null}).filter(function(E){return E})}function zQ(t){return t=t-0,t===t}function Xz(t){return zQ(t)?t:(t=t.replace(/[\-_\s]+(.)?/g,function(e,n){return n?n.toUpperCase():""}),t.substr(0,1).toLowerCase()+t.substr(1))}var PQ=["style"];function BQ(t){return t.charAt(0).toUpperCase()+t.slice(1)}function VQ(t){return t.split(";").map(function(e){return e.trim()}).filter(function(e){return e}).reduce(function(e,n){var s=n.indexOf(":"),r=Xz(n.slice(0,s)),a=n.slice(s+1).trim();return r.startsWith("webkit")?e[BQ(r)]=a:e[r]=a,e},{})}function Kz(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string")return e;var s=(e.children||[]).map(function(l){return Kz(t,l)}),r=Object.keys(e.attributes||{}).reduce(function(l,c){var f=e.attributes[c];switch(c){case"class":l.attrs.className=f,delete e.attributes.class;break;case"style":l.attrs.style=VQ(f);break;default:c.indexOf("aria-")===0||c.indexOf("data-")===0?l.attrs[c.toLowerCase()]=f:l.attrs[Xz(c)]=f}return l},{attrs:{}}),a=n.style,i=a===void 0?{}:a,o=DQ(n,PQ);return r.attrs.style=ka(ka({},r.attrs.style),i),t.apply(void 0,[e.tag,ka(ka({},r.attrs),o)].concat(ET(s)))}var Yz=!1;try{Yz=!0}catch{}function UQ(){if(!Yz&&console&&typeof console.error=="function"){var t;(t=console).error.apply(t,arguments)}}function F_(t){if(t&&h1(t)==="object"&&t.prefix&&t.iconName&&t.icon)return t;if(kT.icon)return kT.icon(t);if(t===null)return null;if(t&&h1(t)==="object"&&t.prefix&&t.iconName)return t;if(Array.isArray(t)&&t.length===2)return{prefix:t[0],iconName:t[1]};if(typeof t=="string")return{prefix:"fas",iconName:t}}function yS(t,e){return Array.isArray(e)&&e.length>0||!Array.isArray(e)&&e?Rc({},t,e):{}}var L_={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1},mi=wi.forwardRef(function(t,e){var n=ka(ka({},L_),t),s=n.icon,r=n.mask,a=n.symbol,i=n.className,o=n.title,l=n.titleId,c=n.maskId,f=F_(s),d=yS("classes",[].concat(ET(MQ(n)),ET((i||"").split(" ")))),p=yS("transform",typeof n.transform=="string"?kT.transform(n.transform):n.transform),g=yS("mask",F_(r)),y=kQ(f,ka(ka(ka(ka({},d),p),g),{},{symbol:a,title:o,titleId:l,maskId:c}));if(!y)return UQ("Could not find icon",f),null;var v=y.abstract,x={ref:e};return Object.keys(n).forEach(function(w){L_.hasOwnProperty(w)||(x[w]=n[w])}),jQ(v[0],x)});mi.displayName="FontAwesomeIcon";mi.propTypes={beat:ut.bool,border:ut.bool,beatFade:ut.bool,bounce:ut.bool,className:ut.string,fade:ut.bool,flash:ut.bool,mask:ut.oneOfType([ut.object,ut.array,ut.string]),maskId:ut.string,fixedWidth:ut.bool,inverse:ut.bool,flip:ut.oneOf([!0,!1,"horizontal","vertical","both"]),icon:ut.oneOfType([ut.object,ut.array,ut.string]),listItem:ut.bool,pull:ut.oneOf(["right","left"]),pulse:ut.bool,rotation:ut.oneOf([0,90,180,270]),shake:ut.bool,size:ut.oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:ut.bool,spinPulse:ut.bool,spinReverse:ut.bool,symbol:ut.oneOfType([ut.bool,ut.string]),title:ut.string,titleId:ut.string,transform:ut.oneOfType([ut.string,ut.object]),swapOpacity:ut.bool};var jQ=Kz.bind(null,wi.createElement);/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const WQ={prefix:"fas",iconName:"lightbulb",icon:[384,512,[128161],"f0eb","M272 384c9.6-31.9 29.5-59.1 49.2-86.2c0 0 0 0 0 0c5.2-7.1 10.4-14.2 15.4-21.4c19.8-28.5 31.4-63 31.4-100.3C368 78.8 289.2 0 192 0S16 78.8 16 176c0 37.3 11.6 71.9 31.4 100.3c5 7.2 10.2 14.3 15.4 21.4c0 0 0 0 0 0c19.8 27.1 39.7 54.4 49.2 86.2l160 0zM192 512c44.2 0 80-35.8 80-80l0-16-160 0 0 16c0 44.2 35.8 80 80 80zM112 176c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-61.9 50.1-112 112-112c8.8 0 16 7.2 16 16s-7.2 16-16 16c-44.2 0-80 35.8-80 80z"]},GQ={prefix:"fas",iconName:"globe",icon:[512,512,[127760],"f0ac","M352 256c0 22.2-1.2 43.6-3.3 64l-185.3 0c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64l185.3 0c2.2 20.4 3.3 41.8 3.3 64zm28.8-64l123.1 0c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64l-123.1 0c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64zm112.6-32l-116.7 0c-10-63.9-29.8-117.4-55.3-151.6c78.3 20.7 142 77.5 171.9 151.6zm-149.1 0l-176.6 0c6.1-36.4 15.5-68.6 27-94.7c10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5c11.6 26 20.9 58.2 27 94.7zm-209 0L18.6 160C48.6 85.9 112.2 29.1 190.6 8.4C165.1 42.6 145.3 96.1 135.3 160zM8.1 192l123.1 0c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64L8.1 320C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64zM194.7 446.6c-11.6-26-20.9-58.2-27-94.6l176.6 0c-6.1 36.4-15.5 68.6-27 94.6c-10.5 23.6-22.2 40.7-33.5 51.5C272.6 508.8 263.3 512 256 512s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6C112.2 482.9 48.6 426.1 18.6 352l116.7 0zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6c25.5-34.2 45.2-87.7 55.3-151.6l116.7 0z"]},HQ={prefix:"fas",iconName:"cloud-arrow-down",icon:[640,512,[62337,"cloud-download","cloud-download-alt"],"f0ed","M144 480C64.5 480 0 415.5 0 336c0-62.8 40.2-116.2 96.2-135.9c-.1-2.7-.2-5.4-.2-8.1c0-88.4 71.6-160 160-160c59.3 0 111 32.2 138.7 80.2C409.9 102 428.3 96 448 96c53 0 96 43 96 96c0 12.2-2.3 23.8-6.4 34.6C596 238.4 640 290.1 640 352c0 70.7-57.3 128-128 128l-368 0zm79-167l80 80c9.4 9.4 24.6 9.4 33.9 0l80-80c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-39 39L344 184c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 134.1-39-39c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9z"]},qQ={prefix:"fas",iconName:"leaf",icon:[512,512,[],"f06c","M272 96c-78.6 0-145.1 51.5-167.7 122.5c33.6-17 71.5-26.5 111.7-26.5l88 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-16 0-72 0s0 0 0 0c-16.6 0-32.7 1.9-48.3 5.4c-25.9 5.9-49.9 16.4-71.4 30.7c0 0 0 0 0 0C38.3 298.8 0 364.9 0 440l0 16c0 13.3 10.7 24 24 24s24-10.7 24-24l0-16c0-48.7 20.7-92.5 53.8-123.2C121.6 392.3 190.3 448 272 448l1 0c132.1-.7 239-130.9 239-291.4c0-42.6-7.5-83.1-21.1-119.6c-2.6-6.9-12.7-6.6-16.2-.1C455.9 72.1 418.7 96 376 96L272 96z"]},XQ={prefix:"fas",iconName:"phone",icon:[512,512,[128222,128379],"f095","M164.9 24.6c-7.7-18.6-28-28.5-47.4-23.2l-88 24C12.1 30.2 0 46 0 64C0 311.4 200.6 512 448 512c18 0 33.8-12.1 38.6-29.5l24-88c5.3-19.4-4.6-39.7-23.2-47.4l-96-40c-16.3-6.8-35.2-2.1-46.3 11.6L304.7 368C234.3 334.7 177.3 277.7 144 207.3L193.3 167c13.7-11.2 18.4-30 11.6-46.3l-40-96z"]},KQ={prefix:"fas",iconName:"envelope",icon:[512,512,[128386,9993,61443],"f0e0","M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48L48 64zM0 176L0 384c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-208L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"]},YQ={prefix:"fas",iconName:"mobile-screen",icon:[384,512,["mobile-android-alt"],"f3cf","M16 64C16 28.7 44.7 0 80 0L304 0c35.3 0 64 28.7 64 64l0 384c0 35.3-28.7 64-64 64L80 512c-35.3 0-64-28.7-64-64L16 64zM144 448c0 8.8 7.2 16 16 16l64 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-64 0c-8.8 0-16 7.2-16 16zM304 64L80 64l0 320 224 0 0-320z"]},ZQ={prefix:"fas",iconName:"bell",icon:[448,512,[128276,61602],"f0f3","M224 0c-17.7 0-32 14.3-32 32l0 19.2C119 66 64 130.6 64 208l0 18.8c0 47-17.3 92.4-48.5 127.6l-7.4 8.3c-8.4 9.4-10.4 22.9-5.3 34.4S19.4 416 32 416l384 0c12.6 0 24-7.4 29.2-18.9s3.1-25-5.3-34.4l-7.4-8.3C401.3 319.2 384 273.9 384 226.8l0-18.8c0-77.4-55-142-128-156.8L256 32c0-17.7-14.3-32-32-32zm45.3 493.3c12-12 18.7-28.3 18.7-45.3l-64 0-64 0c0 17 6.7 33.3 18.7 45.3s28.3 18.7 45.3 18.7s33.3-6.7 45.3-18.7z"]},QQ={prefix:"fas",iconName:"location-dot",icon:[384,512,["map-marker-alt"],"f3c5","M215.7 499.2C267 435 384 279.4 384 192C384 86 298 0 192 0S0 86 0 192c0 87.4 117 243 168.3 307.2c12.3 15.3 35.1 15.3 47.4 0zM192 128a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"]},JQ=QQ,eJ={prefix:"fas",iconName:"database",icon:[448,512,[],"f1c0","M448 80l0 48c0 44.2-100.3 80-224 80S0 172.2 0 128L0 80C0 35.8 100.3 0 224 0S448 35.8 448 80zM393.2 214.7c20.8-7.4 39.9-16.9 54.8-28.6L448 288c0 44.2-100.3 80-224 80S0 332.2 0 288L0 186.1c14.9 11.8 34 21.2 54.8 28.6C99.7 230.7 159.5 240 224 240s124.3-9.3 169.2-25.3zM0 346.1c14.9 11.8 34 21.2 54.8 28.6C99.7 390.7 159.5 400 224 400s124.3-9.3 169.2-25.3c20.8-7.4 39.9-16.9 54.8-28.6l0 85.9c0 44.2-100.3 80-224 80S0 476.2 0 432l0-85.9z"]},tJ={prefix:"fas",iconName:"paper-plane",icon:[512,512,[61913],"f1d8","M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480l0-83.6c0-4 1.5-7.8 4.2-10.8L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"]},nJ={prefix:"fas",iconName:"brain",icon:[512,512,[129504],"f5dc","M184 0c30.9 0 56 25.1 56 56l0 400c0 30.9-25.1 56-56 56c-28.9 0-52.7-21.9-55.7-50.1c-5.2 1.4-10.7 2.1-16.3 2.1c-35.3 0-64-28.7-64-64c0-7.4 1.3-14.6 3.6-21.2C21.4 367.4 0 338.2 0 304c0-31.9 18.7-59.5 45.8-72.3C37.1 220.8 32 207 32 192c0-30.7 21.6-56.3 50.4-62.6C80.8 123.9 80 118 80 112c0-29.9 20.6-55.1 48.3-62.1C131.3 21.9 155.1 0 184 0zM328 0c28.9 0 52.6 21.9 55.7 49.9c27.8 7 48.3 32.1 48.3 62.1c0 6-.8 11.9-2.4 17.4c28.8 6.2 50.4 31.9 50.4 62.6c0 15-5.1 28.8-13.8 39.7C493.3 244.5 512 272.1 512 304c0 34.2-21.4 63.4-51.6 74.8c2.3 6.6 3.6 13.8 3.6 21.2c0 35.3-28.7 64-64 64c-5.6 0-11.1-.7-16.3-2.1c-3 28.2-26.8 50.1-55.7 50.1c-30.9 0-56-25.1-56-56l0-400c0-30.9 25.1-56 56-56z"]},sJ=()=>{const t=[{icon:nJ,title:"AI-Powered Precision",description:"97.3% accurate disease detection using deep learning models trained on millions of crop images.",color:"from-purple-500 to-indigo-500"},{icon:qQ,title:"Comprehensive Coverage",description:"Detects 58+ diseases across 12 major crops with localized treatment recommendations.",color:"from-emerald-500 to-teal-500"},{icon:YQ,title:"Field-Ready Mobile",description:"Optimized for low-bandwidth conditions with offline-first functionality.",color:"from-blue-500 to-cyan-500"},{icon:WQ,title:"Smart Farming Insights",description:"Personalized AI recommendations for irrigation and fertilization schedules.",color:"from-amber-500 to-yellow-500"},{icon:GQ,title:"Global Accessibility",description:"Available in 18 languages with regional adaptations for local practices.",color:"from-rose-500 to-pink-500"},{icon:HQ,title:"Offline Capabilities",description:"Critical features work without internet, syncing when back online.",color:"from-gray-500 to-slate-500"},{icon:ZQ,title:"Predictive Alerts",description:"Early warnings for disease outbreaks based on weather patterns.",color:"from-orange-500 to-red-500"},{icon:eJ,title:"Farm Analytics",description:"Cloud-based historical data tracking with yield prediction models.",color:"from-sky-500 to-blue-500"}],e={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.1}}},n={hidden:{opacity:0,y:30},visible:{opacity:1,y:0,transition:{duration:.6,ease:"easeOut"}}};return L.jsx("section",{className:"py-2 bg-gradient-to-b from-white to-gray-50 h-fit",children:L.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[L.jsxs(je.div,{initial:{opacity:0,y:-20},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0,margin:"-100px"},className:"max-w-4xl mx-auto text-center mb-20",children:[L.jsx("span",{className:"inline-block bg-green-100 text-green-800 text-sm font-semibold px-4 py-2 rounded-full mb-6",children:"Cutting-Edge Technology"}),L.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-6",children:"Your Farming with AI"}),L.jsx("p",{className:"text-xl text-gray-600",children:"Our platform combines agricultural expertise with artificial intelligence to deliver unparalleled crop protection."})]}),L.jsx(je.div,{initial:"hidden",whileInView:"visible",variants:e,viewport:{once:!0,margin:"-100px"},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:t.map((s,r)=>L.jsxs(je.div,{variants:n,whileHover:{y:-10,transition:{duration:.2}},className:"relative group",children:[L.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${s.color} rounded-2xl opacity-0 group-hover:opacity-100 blur-lg transition-opacity duration-300`}),L.jsxs("div",{className:"relative h-full bg-white rounded-2xl overflow-hidden shadow-xl group-hover:shadow-2xl transition-all duration-300 border border-gray-100",children:[L.jsxs("div",{className:`p-8 bg-gradient-to-br ${s.color} text-white`,children:[L.jsx("div",{className:"w-16 h-16 flex items-center justify-center rounded-xl bg-white/20 backdrop-blur-sm",children:L.jsx(mi,{icon:s.icon,className:"text-2xl"})}),L.jsx("h3",{className:"text-xl font-bold mt-6",children:s.title})]}),L.jsxs("div",{className:"p-8",children:[L.jsx("p",{className:"text-gray-600 mb-6",children:s.description}),L.jsxs("div",{className:"flex items-center text-sm font-medium text-green-600 group-hover:text-green-700 transition-colors cursor-pointer",children:["Learn more",L.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-2 transition-transform group-hover:translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]},r))}),L.jsx(je.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{delay:.3},viewport:{once:!0},className:"mt-20 text-center"})]})})};var Zz={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},M_=wi.createContext&&wi.createContext(Zz),rJ=["attr","size","title"];function aJ(t,e){if(t==null)return{};var n=iJ(t,e),s,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)s=a[r],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function iJ(t,e){if(t==null)return{};var n={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function f1(){return f1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},f1.apply(this,arguments)}function z_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function d1(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?z_(Object(n),!0).forEach(function(s){oJ(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z_(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function oJ(t,e,n){return e=lJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lJ(t){var e=uJ(t,"string");return typeof e=="symbol"?e:e+""}function uJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qz(t){return t&&t.map((e,n)=>wi.createElement(e.tag,d1({key:n},e.attr),Qz(e.child)))}function ss(t){return e=>wi.createElement(cJ,f1({attr:d1({},t.attr)},e),Qz(t.child))}function cJ(t){var e=n=>{var{attr:s,size:r,title:a}=t,i=aJ(t,rJ),o=r||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),wi.createElement("svg",f1({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,i,{className:l,style:d1(d1({color:t.color||n.color},n.style),t.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),a&&wi.createElement("title",null,a),t.children)};return M_!==void 0?wi.createElement(M_.Consumer,null,n=>e(n)):e(Zz)}function hJ(t){return ss({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"},child:[]}]})(t)}function fJ(t){return ss({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(t)}function dJ(t){return ss({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(t)}function pJ(t){return ss({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M537.6 226.6c4.1-10.7 6.4-22.4 6.4-34.6 0-53-43-96-96-96-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32c-88.4 0-160 71.6-160 160 0 2.7.1 5.4.2 8.1C40.2 219.8 0 273.2 0 336c0 79.5 64.5 144 144 144h368c70.7 0 128-57.3 128-128 0-61.9-44-113.6-102.4-125.4zM393.4 288H328v112c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V288h-65.4c-14.3 0-21.4-17.2-11.3-27.3l105.4-105.4c6.2-6.2 16.4-6.2 22.6 0l105.4 105.4c10.1 10.1 2.9 27.3-11.3 27.3z"},child:[]}]})(t)}function mJ(t){return ss({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M416 192c0-88.4-93.1-160-208-160S0 103.6 0 192c0 34.3 14.1 65.9 38 92-13.4 30.2-35.5 54.2-35.8 54.5-2.2 2.3-2.8 5.7-1.5 8.7S4.8 352 8 352c36.6 0 66.9-12.3 88.7-25 32.2 15.7 70.3 25 111.3 25 114.9 0 208-71.6 208-160zm122 220c23.9-26 38-57.7 38-92 0-66.9-53.5-124.2-129.3-148.1.9 6.6 1.3 13.3 1.3 20.1 0 105.9-107.7 192-240 192-10.8 0-21.3-.8-31.7-1.9C207.8 439.6 281.8 480 368 480c41 0 79.1-9.2 111.3-25 21.8 12.7 52.1 25 88.7 25 3.2 0 6.1-1.9 7.3-4.8 1.3-2.9.7-6.3-1.5-8.7-.3-.3-22.4-24.2-35.8-54.5z"},child:[]}]})(t)}function gJ(t){return ss({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(t)}function yJ(t){return ss({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(t)}function Qd(t){return ss({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M546.2 9.7c-5.6-12.5-21.6-13-28.3-1.2C486.9 62.4 431.4 96 368 96h-80C182 96 96 182 96 288c0 7 .8 13.7 1.5 20.5C161.3 262.8 253.4 224 384 224c8.8 0 16 7.2 16 16s-7.2 16-16 16C132.6 256 26 410.1 2.4 468c-6.6 16.3 1.2 34.9 17.5 41.6 16.4 6.8 35-1.1 41.8-17.3 1.5-3.6 20.9-47.9 71.9-90.6 32.4 43.9 94 85.8 174.9 77.2C465.5 467.5 576 326.7 576 154.3c0-50.2-10.8-102.2-29.8-144.6z"},child:[]}]})(t)}function P_(t){return ss({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 256h-80v-64c0-35.3 28.7-64 64-64h8c13.3 0 24-10.7 24-24V56c0-13.3-10.7-24-24-24h-8c-88.4 0-160 71.6-160 160v240c0 26.5 21.5 48 48 48h128c26.5 0 48-21.5 48-48V304c0-26.5-21.5-48-48-48zm-288 0H96v-64c0-35.3 28.7-64 64-64h8c13.3 0 24-10.7 24-24V56c0-13.3-10.7-24-24-24h-8C71.6 32 0 103.6 0 192v240c0 26.5 21.5 48 48 48h128c26.5 0 48-21.5 48-48V304c0-26.5-21.5-48-48-48z"},child:[]}]})(t)}function Jz(t){return ss({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(t)}function bJ(t){return ss({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"},child:[]}]})(t)}function xJ(t){return ss({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(t)}function vJ(t){return ss({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M296 384h-80c-13.3 0-24-10.7-24-24V192h-87.7c-17.8 0-26.7-21.5-14.1-34.1L242.3 5.7c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1H320v168c0 13.3-10.7 24-24 24zm216-8v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(t)}function B_(t){return ss({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"},child:[]}]})(t)}function V_(t){return ss({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(t)}function U_(t){return ss({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(t)}const ar=[{name:"Mohan Singh",feedback:"This system saved my crops! The disease detection is incredibly accurate and the treatment suggestions helped me act quickly. Highly recommend to all farmers.",image:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=300&auto=format&fit=crop&q=60",rating:5,role:"Organic Farmer"},{name:"Anjali Singh",feedback:"As someone new to farming, this tool has been invaluable. It's accurate and easy to use. The mobile interface makes it perfect for field use. A must-have for modern farmers.",image:"https://images.unsplash.com/photo-1619895862022-09114b41f16f?w=300&auto=format&fit=crop&q=60",rating:4.5,role:"Small Farm Owner"},{name:"Sapna yadav",feedback:"The early detection system helped me identify diseases weeks before visible symptoms appeared. This early warning saved my entire yield this season.",image:"https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=300&auto=format&fit=crop&q=60",rating:5,role:"Agricultural Specialist"},{name:"Rahul Sharma",feedback:"Very effective for small-scale farmers like me! The localized recommendations work perfectly for our regional crops and conditions.",image:"https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=300&auto=format&fit=crop&q=60",rating:4.8,role:"Subsistence Farmer"},{name:"Priya Verma",feedback:"The AI-powered suggestions have improved my farm's productivity by at least 30%. The seasonal planning tools are game-changers!",image:"https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=300&auto=format&fit=crop&q=60",rating:5,role:"Commercial Farm Manager"}],wJ=()=>{const[t,e]=K.useState(0),[n,s]=K.useState(1);K.useEffect(()=>{const l=setInterval(()=>{s(1),e(c=>(c+1)%ar.length)},8e3);return()=>clearInterval(l)},[]);const r=()=>{s(1),e(l=>(l+1)%ar.length)},a=()=>{s(-1),e(l=>l===0?ar.length-1:l-1)},i=l=>{s(l>t?1:-1),e(l)},o={enter:l=>({x:l>0?300:-300,opacity:0,scale:.9}),center:{x:0,opacity:1,scale:1},exit:l=>({x:l<0?300:-300,opacity:0,scale:.9})};return L.jsx("section",{className:"py-16 bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 transition-all duration-300",children:L.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[L.jsxs(je.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},className:"text-center mb-12",children:[L.jsx("span",{className:"inline-block py-1 px-3 mb-4 text-xs font-semibold text-green-600 bg-green-100 rounded-full dark:bg-green-900 dark:text-green-200",children:"Testimonials"}),L.jsx("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-bold text-gray-900 dark:text-white mb-4",children:"Trusted by Farmers Worldwide"}),L.jsx("p",{className:"max-w-2xl mx-auto text-lg text-gray-600 dark:text-gray-300",children:"Hear from real users who transformed their farming with our solutions"})]}),L.jsxs("div",{className:"relative max-w-5xl mx-auto",children:[L.jsx("button",{onClick:a,"aria-label":"Previous testimonial",className:"hidden sm:flex absolute left-0 top-1/2 -translate-y-1/2 z-10 bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg hover:shadow-xl hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-green-500",children:L.jsx(B_,{className:"text-gray-700 dark:text-white text-xl"})}),L.jsx("button",{onClick:r,"aria-label":"Next testimonial",className:"hidden sm:flex absolute right-0 top-1/2 -translate-y-1/2 z-10 bg-white dark:bg-gray-800 p-3 rounded-full shadow-lg hover:shadow-xl hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-green-500",children:L.jsx(V_,{className:"text-gray-700 dark:text-white text-xl"})}),L.jsx("div",{className:"overflow-hidden h-[400px] sm:h-[450px] relative",children:L.jsx(wu,{custom:n,initial:!1,children:L.jsx(je.div,{custom:n,variants:o,initial:"enter",animate:"center",exit:"exit",transition:{x:{type:"spring",stiffness:300,damping:30},opacity:{duration:.3},scale:{duration:.2}},className:"absolute inset-0 flex flex-col items-center p-6 sm:p-8",children:L.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-500 w-full h-full max-w-3xl flex flex-col",children:L.jsxs("div",{className:"flex-1 p-6 sm:p-8 flex flex-col items-center text-center",children:[L.jsxs("div",{className:"relative mb-6",children:[L.jsx("img",{src:ar[t].image,alt:`Portrait of ${ar[t].name}`,className:"rounded-full h-20 w-20 sm:h-24 sm:w-24 object-cover border-4 border-white dark:border-gray-800 shadow-md",loading:"lazy"}),L.jsx("div",{className:"absolute -bottom-2 -right-2 bg-green-500 text-white p-2 rounded-full",children:L.jsx(P_,{className:"text-xs"})})]}),L.jsxs("div",{className:"flex mb-4",children:[Array.from({length:5},(l,c)=>L.jsx(bJ,{className:`text-xl ${c<Math.floor(ar[t].rating)?"text-yellow-500":ar[t].rating%1>0&&c===Math.floor(ar[t].rating)?"text-yellow-500 opacity-70":"text-gray-300 dark:text-gray-600"}`},c)),L.jsx("span",{className:"ml-2 text-gray-600 dark:text-gray-400 text-sm",children:ar[t].rating.toFixed(1)})]}),L.jsxs("p",{className:"text-gray-700 dark:text-gray-300 mb-6 text-lg sm:text-xl leading-relaxed relative",children:[L.jsx(P_,{className:"absolute -top-6 left-0 text-gray-200 dark:text-gray-700 text-4xl -z-10"}),ar[t].feedback]}),L.jsxs("div",{className:"mt-auto",children:[L.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:ar[t].name}),L.jsx("p",{className:"text-green-600 dark:text-green-400 text-sm font-medium",children:ar[t].role})]})]})})},t)})}),L.jsxs("div",{className:"flex sm:hidden justify-center mt-6 space-x-4",children:[L.jsx("button",{onClick:a,"aria-label":"Previous testimonial",className:"bg-white dark:bg-gray-800 p-3 rounded-full shadow-md hover:shadow-lg transition-all duration-300",children:L.jsx(B_,{className:"text-gray-700 dark:text-white"})}),L.jsx("button",{onClick:r,"aria-label":"Next testimonial",className:"bg-white dark:bg-gray-800 p-3 rounded-full shadow-md hover:shadow-lg transition-all duration-300",children:L.jsx(V_,{className:"text-gray-700 dark:text-white"})})]}),L.jsx("div",{className:"flex justify-center mt-8 space-x-2",children:ar.map((l,c)=>L.jsx("button",{"aria-label":`Go to testimonial ${c+1}`,className:`h-2.5 w-2.5 sm:h-3 sm:w-3 rounded-full transition-all duration-300 focus:outline-none ${t===c?"bg-green-500 w-6 sm:w-8":"bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500"}`,onClick:()=>i(c)},c))})]})]})})},SJ=()=>{const[t,e]=K.useState(""),n="AI-Powered Crop Disease Detection",[s,r]=K.useState(0),[a,i]=K.useState(!1),[o,l]=K.useState(!1),[c,f]=K.useState(!1),[d,p]=K.useState(typeof window<"u"?window.innerWidth:0);K.useEffect(()=>{if(s<n.length){const y=setTimeout(()=>{e(t+n[s]),r(s+1)},d<768?120:100);return()=>clearTimeout(y)}},[s,t,d]),K.useEffect(()=>{const y=()=>{p(window.innerWidth)},v=()=>{f(window.scrollY>50)};return window.addEventListener("resize",y),window.addEventListener("scroll",v),()=>{window.removeEventListener("resize",y),window.removeEventListener("scroll",v)}},[]);const g=()=>d<640?L.jsxs(L.Fragment,{children:[L.jsx("span",{className:"text-green-400",children:t.substring(0,2)}),L.jsx("span",{className:"text-white",children:t.substring(2)}),s<n.length&&L.jsx("span",{className:"ml-1 inline-block w-2 h-8 bg-green-400 animate-pulse align-middle"})]}):L.jsxs(L.Fragment,{children:[L.jsx("span",{className:"text-green-400",children:t.substring(0,2)}),L.jsx("span",{className:"text-white",children:t.substring(2)}),s<n.length&&L.jsx("span",{className:"ml-1 inline-block w-2 h-10 bg-green-400 animate-pulse align-middle"})]});return L.jsxs("div",{className:"relative",children:[L.jsxs("section",{className:"relative h-screen flex flex-col items-center justify-center text-center px-4 sm:px-6 overflow-hidden",style:{backgroundImage:`
            linear-gradient(to right, rgba(0,0,0,0.8), rgba(0,0,0,0.4)),
            url('https://images.unsplash.com/photo-1605000797499-95a51c5269ae?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=3000&q=80')
          `,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:d<1024?"scroll":"fixed"},children:[d>640&&L.jsx("div",{className:"absolute inset-0 overflow-hidden",children:[...Array(d<768?8:15)].map((y,v)=>L.jsx(je.div,{className:"absolute bg-green-400 rounded-full",initial:{opacity:0,x:Math.random()*1e3,y:Math.random()*1e3,width:Math.random()*10+2,height:Math.random()*10+2},animate:{opacity:[0,.5,0],y:[Math.random()*100,Math.random()*800],x:[Math.random()*100,Math.random()*1e3]},transition:{duration:Math.random()*10+10,repeat:1/0,ease:"linear"}},v))}),L.jsxs(je.div,{initial:{opacity:0,y:20},animate:{opacity:2,y:0},transition:{duration:.8},className:"relative z-10 text-white w-full px-4",style:{maxWidth:d<768?"100%":"56rem",padding:d<640?"0 1rem":"0"},children:[L.jsx("h1",{className:`font-bold mb-4 sm:mb-6 leading-tight ${d<640?"text-3xl":d<768?"text-4xl":"text-5xl sm:text-6xl"}`,children:g()}),L.jsxs(je.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:n.length*.1+.5,duration:1},className:`mb-6 sm:mb-8 mx-auto leading-relaxed ${d<640?"text-base max-w-xs":"text-lg sm:text-xl max-w-2xl"}`,children:["Revolutionizing agriculture with cutting-edge AI technology to detect and diagnose crop diseases with ",L.jsx("span",{className:"font-semibold text-green-300",children:"95% accuracy"}),", helping farmers protect their yields and livelihoods."]}),L.jsxs(je.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:n.length*.1+.8,duration:1},className:`flex justify-center gap-3 sm:gap-4 mb-8 sm:mb-12 ${d<640?"flex-col":"flex-row"}`,children:[L.jsx(je.a,{href:"/upload",whileHover:{y:d<640?0:-3,scale:d<640?1.01:1.02},whileTap:{scale:.98},className:`bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold rounded-lg shadow-lg transition-all duration-300 ${d<640?"py-3 px-6 text-sm":d<768?"py-3 px-6 text-base":"py-4 px-8 text-lg"}`,children:d<640?"Detect Disease":"Upload Image to Detect Disease"}),L.jsx(je.button,{onClick:()=>i(!0),whileHover:{y:d<640?0:-3,scale:d<640?1.01:1.02},whileTap:{scale:.98},className:`bg-white text-green-700 hover:bg-gray-100 font-bold rounded-lg shadow-lg transition-all duration-300 ${d<640?"py-3 px-6 text-sm border border-green-300":d<768?"py-3 px-6 text-base border-2 border-transparent hover:border-green-300":"py-4 px-8 text-lg border-2 border-transparent hover:border-green-300"}`,children:"Learn More"})]}),L.jsxs(je.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:n.length*.1+1,duration:1},className:`flex justify-center ${d<640?"flex-col items-center gap-2":"flex-wrap gap-3 sm:gap-6"}`,children:[L.jsxs("div",{className:"bg-green-800 bg-opacity-60 backdrop-blur-sm px-3 sm:px-4 py-1 sm:py-2 rounded-full flex items-center",children:[L.jsx("span",{className:"text-green-300 mr-2",children:""}),L.jsx("span",{className:"text-sm sm:text-base",children:"95% Detection Accuracy"})]}),L.jsxs("div",{className:"bg-green-800 bg-opacity-60 backdrop-blur-sm px-3 sm:px-4 py-1 sm:py-2 rounded-full flex items-center",children:[L.jsx("span",{className:"text-green-300 mr-2",children:""}),L.jsx("span",{className:"text-sm sm:text-base",children:"10,000+ Farmers"})]}),L.jsxs("div",{className:"bg-green-800 bg-opacity-60 backdrop-blur-sm px-3 sm:px-4 py-1 sm:py-2 rounded-full flex items-center",children:[L.jsx("span",{className:"text-green-300 mr-2",children:""}),L.jsx("span",{className:"text-sm sm:text-base",children:"Instant Results"})]})]})]}),L.jsx(je.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:2},className:"absolute bottom-4 sm:bottom-8 left-1/2 transform -translate-x-1/2",children:L.jsxs("a",{href:"#features",className:"flex flex-col items-center group","aria-label":"Scroll down to learn more",children:[L.jsx(je.span,{className:"text-white font-medium mb-1 sm:mb-2 text-sm sm:text-base",animate:{y:[0,5,0]},transition:{duration:1.5,repeat:1/0},children:"Discover More"}),L.jsx(je.div,{animate:{y:[0,8,0]},transition:{duration:1.5,repeat:1/0},children:L.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`text-green-400 group-hover:text-green-300 transition-colors ${d<640?"h-6 w-6":"h-8 w-8"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})})]})})]}),L.jsx("section",{id:"features",className:"py-12 sm:py-16 md:py-20 bg-gradient-to-b from-gray-50 to-white",children:L.jsx(sJ,{})}),L.jsx("section",{className:"py-12 sm:py-16 md:py-20 bg-gradient-to-b from-white to-gray-50",children:L.jsx(wJ,{})}),L.jsx(oY,{setIsChatOpen:l,isMobile:d<768}),L.jsxs(wu,{children:[a&&L.jsx(NY,{onClose:()=>i(!1),isMobile:d<768}),o&&L.jsx(iY,{onClose:()=>l(!1),isMobile:d<768})]})]})};var bS={},Il={};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TJ=1e-7,CJ=1e-4;class AN{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class rb{refCount(e){return Ps("refCount")}incRef(e){return Ps("incRef")}timerAvailable(){return!0}time(e){return Ps("time")}read(e){return Ps("read")}readSync(e){return Ps("readSync")}readToGPU(e,n){return Ps("readToGPU")}numDataIds(){return Ps("numDataIds")}disposeData(e,n){return Ps("disposeData")}write(e,n,s){return Ps("write")}move(e,n,s,r,a){return Ps("move")}createTensorFromGPUData(e,n,s){return Ps("createTensorFromGPUData")}memory(){return Ps("memory")}floatPrecision(){return Ps("floatPrecision")}epsilon(){return this.floatPrecision()===32?TJ:CJ}dispose(){return Ps("dispose")}}function Ps(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RN(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,xi(t,e,n)}function NJ(t,e){if(t.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${e.length}`);let n=t.length,s=0;for(;n>0;)s=Math.random()*n|0,n--,xi(t,n,s),xi(e,n,s)}function Lo(t,e,n){return Math.max(t,Math.min(e,n))}function ab(t){return t%2===0?t:t+1}function xi(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function eP(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function kJ(t,e){const n=Math.random();return e*n+(1-n)*t}function EJ(t,e){let n=0;for(let s=0;s<t.length;s++){const r=Number(t[s])-Number(e[s]);n+=r*r}return n}function M(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Xn(t,e,n=""){M(at(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function Tu(t){M(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function de(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function $J(t){return t.length===0}function tP(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function at(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function nu(t){return t%1===0}function IJ(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function p1(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function AJ(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return RN(e),e}function Xl(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function IT(t,e=r=>0,n,s){return new Promise((r,a)=>{let i=0;const o=()=>{if(t()){r();return}i++;const l=e(i);if(n!=null&&i>=n){a();return}s!=null?s(o,l):setTimeout(o,l)};o()})}function DN(t,e){let n=1,s=-1;for(let a=0;a<t.length;++a)if(t[a]>=0)n*=t[a];else if(t[a]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${a}`);s=a}else if(t[a]<0)throw Error(`Shapes can not be < 0. Found ${t[a]} at dim ${a}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function nt(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),M(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),M(t.every(s=>nu(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function Bi(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,a=e==null||r?null:nt(e,t).sort();let i=0;for(let o=0;o<t.length;++o){if(a!=null){if(a[i]===o&&t[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${t[o]}' is not 1`);(a[i]==null||a[i]>o)&&t[o]===1&&(n.push(t[o]),s.push(o)),a[i]<=o&&i++}t[o]!==1&&(n.push(t[o]),s.push(o))}return{newShape:n,keptDims:s}}function On(t,e){return Zt(t,e)}function Zt(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function nP(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function sP(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function ON(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function cp(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function rP(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function Da(t){return typeof t=="string"||t instanceof String}function aP(t){return typeof t=="boolean"}function m1(t){return typeof t=="number"}function Cu(t){return Array.isArray(t)?Cu(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":m1(t)?"float32":Da(t)?"string":aP(t)?"bool":"float32"}function Mo(t){return!!(t&&t.constructor&&t.call&&t.apply)}function g1(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Be(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function iP(t,e,n,s=!1){const r=new Array;if(e.length===1){const a=e[0]*(s?2:1);for(let i=0;i<a;i++)r[i]=n[t+i]}else{const a=e[0],i=e.slice(1),o=i.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<a;l++)r[l]=iP(t+l*o,i,n,s)}return r}function pr(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,a)=>r*a)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return iP(0,t,e,n)}function oP(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function ib(t,e){const n=qn(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function qn(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function _N(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return pr(t,new Float32Array(n));if(e==="int32")return pr(t,new Int32Array(n));if(e==="bool")return pr(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function Ys(t){t.forEach(e=>{M(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function ia(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function Nu(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function Ai(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j_="tfjsflags";class lP{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=RJ,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(ae().getBool("IS_TEST")||ae().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];ae().getBool("IS_TEST")||ae().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Ai(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);j_ in e&&e[j_].split(",").forEach(s=>{const[r,a]=s.split(":");this.urlFlags[r]=OJ(r,a)})}}function RJ(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(DJ(e,s[0],s[1]),s.join("="))),e}function DJ(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function OJ(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function ae(){return FN}let FN=null;function _J(t){FN=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let xS;function uP(){if(xS==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");xS=t}return xS}function FJ(){const t=uP();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function LN(t,e){const n=FJ();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const Vp="Abs",ih="Acos",oh="Acosh",ku="Add",Up="AddN",ob="All",lb="Any",jp="ArgMax",Wp="ArgMin",lh="Asin",uh="Asinh",ch="Atan",hh="Atanh",fh="Atan2",Gp="AvgPool",ub="AvgPoolGrad",Hp="AvgPool3D",cb="AvgPool3DGrad",qp="BatchMatMul",Xp="BatchToSpaceND",hb="Bincount",Kp="BitwiseAnd",cP="BroadcastTo",fb="BroadcastArgs",dh="Cast",ph="Ceil",mh="ClipByValue",db="Complex",Yp="ComplexAbs",Zp="Concat",Qp="Conv2D",pb="Conv2DBackpropFilter",Jp="Conv2DBackpropInput",em="Conv3D",mb="Conv3DBackpropFilterV2",gb="Conv3DBackpropInputV2",gh="Cos",yh="Cosh",yb="Cumprod",tm="Cumsum",bb="CropAndResize",xb="DenseBincount",vb="DepthToSpace",nm="DepthwiseConv2dNative",wb="DepthwiseConv2dNativeBackpropFilter",Sb="DepthwiseConv2dNativeBackpropInput",Tb="Diag",sm="Dilation2D",y1="Dilation2DBackpropInput",b1="Dilation2DBackpropFilter",Cb="Draw",bh="RealDiv",Nb="Einsum",xh="Elu",kb="EluGrad",vh="Erf",rm="Equal",wh="Exp",am="ExpandDims",Sh="Expm1",Eb="FFT",$b="Fill",Ib="FlipLeftRight",Th="Floor",Ch="FloorDiv",im="FusedBatchNorm",om="GatherV2",Ab="GatherNd",lm="Greater",Nh="GreaterEqual",kh="Identity",Rb="IFFT",Db="Imag",Eh="IsFinite",$h="IsInf",Ih="IsNan",um="LeakyRelu",cm="Less",hm="LessEqual",Ob="LinSpace",Ah="Log",Rh="Log1p",fm="LogicalAnd",dm="LogicalNot",pm="LogicalOr",LJ="LogicalXor",hP="LogSoftmax",MJ="LowerBound",mm="LRN",_b="LRNGrad",zJ="MatrixBandPart",gm="Max",Dh="Maximum",ym="MaxPool",Fb="MaxPoolGrad",bm="MaxPool3D",Lb="MaxPool3DGrad",Mb="MaxPoolWithArgmax",xm="Mean",vm="Min",Oh="Minimum",wm="MirrorPad",_h="Mod",zb="Multinomial",Fh="Multiply",Sm="Neg",Tm="NotEqual",Pb="NonMaxSuppressionV3",Bb="NonMaxSuppressionV4",Vb="NonMaxSuppressionV5",Cm="OnesLike",Nm="OneHot",km="Pack",Em="PadV2",PJ="Pool",Lh="Pow",$m="Prelu",Im="Prod",Ub="RaggedGather",jb="RaggedRange",Wb="RaggedTensorToTensor",Gb="Range",Hb="Real",Mh="Reciprocal",zh="Relu",Am="Reshape",Rm="ResizeNearestNeighbor",qb="ResizeNearestNeighborGrad",Dm="ResizeBilinear",Xb="ResizeBilinearGrad",Ph="Relu6",Om="Reverse",Bh="Round",Vh="Rsqrt",Kb="ScatterNd",Yb="TensorScatterUpdate",Zb="SearchSorted",_m="Select",Uh="Selu",Fm="Slice",jh="Sin",Wh="Sinh",Gh="Sign",Hh="Sigmoid",qh="Softplus",Xh="Sqrt",Lm="Sum",Mm="SpaceToBatchND",zm="SplitV",Pm="Softmax",Qb="SparseFillEmptyRows",Jb="SparseReshape",ex="SparseSegmentMean",tx="SparseSegmentSum",nx="SparseToDense",Kh="SquaredDifference",sx="Square",Bm="StaticRegexReplace",rx="StridedSlice",ax="StringNGrams",ix="StringSplit",ox="StringToHashBucketFast",Yh="Sub",Zh="Tan",Qh="Tanh",Jh="Tile",lx="TopK",ux="Transform",Kl="Transpose",cx="Unique",Vm="Unpack",Um="UnsortedSegmentSum",BJ="UpperBound",jm="ZerosLike",ef="Step",x1="FromPixels",hx="RotateWithOffset",hp="_FusedMatMul",fp="FusedConv2D",dp="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lr(...t){ae().getBool("IS_TEST")||ae().getBool("PROD")||console.warn(...t)}function VJ(...t){ae().getBool("IS_TEST")||ae().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vc=LN("kernelRegistry",()=>new Map),pp=LN("gradRegistry",()=>new Map);function mp(t,e){const n=MN(t,e);return Vc.get(n)}function AT(t){return pp.get(t)}function v1(t){const e=Vc.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[a,i]=r,[o]=a.split("_");o===t&&n.push(i)}return n}function fx(t){const{kernelName:e,backendName:n}=t,s=MN(e,n);Vc.has(s)&&lr(`The kernel '${e}' for backend '${n}' is already registered`),Vc.set(s,t)}function fP(t){const{kernelName:e}=t;pp.has(e)&&ae().getBool("DEBUG")&&lr(`Overriding the gradient for '${e}'`),pp.set(e,t)}function UJ(t,e){const n=MN(t,e);if(!Vc.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);Vc.delete(n)}function jJ(t){if(!pp.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);pp.delete(t)}function WJ(t,e){v1(t).forEach(s=>{const r=Object.assign({},s,{backendName:e});fx(r)})}function MN(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dP(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var vS,W_;function GJ(){if(W_)return vS;W_=1,vS=e;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e(_,D,B){this.low=_|0,this.high=D|0,this.unsigned=!!B}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function n(_){return(_&&_.__isLong__)===!0}e.isLong=n;var s={},r={};function a(_,D){var B,j,W;return D?(_>>>=0,(W=0<=_&&_<256)&&(j=r[_],j)?j:(B=o(_,(_|0)<0?-1:0,!0),W&&(r[_]=B),B)):(_|=0,(W=-128<=_&&_<128)&&(j=s[_],j)?j:(B=o(_,_<0?-1:0,!1),W&&(s[_]=B),B))}e.fromInt=a;function i(_,D){if(isNaN(_))return D?T:w;if(D){if(_<0)return T;if(_>=y)return $}else{if(_<=-9223372036854776e3)return O;if(_+1>=v)return R}return _<0?i(-_,D).neg():o(_%g|0,_/g|0,D)}e.fromNumber=i;function o(_,D,B){return new e(_,D,B)}e.fromBits=o;var l=Math.pow;function c(_,D,B){if(_.length===0)throw Error("empty string");if(_==="NaN"||_==="Infinity"||_==="+Infinity"||_==="-Infinity")return w;if(typeof D=="number"?(B=D,D=!1):D=!!D,B=B||10,B<2||36<B)throw RangeError("radix");var j;if((j=_.indexOf("-"))>0)throw Error("interior hyphen");if(j===0)return c(_.substring(1),D,B).neg();for(var W=i(l(B,8)),X=w,U=0;U<_.length;U+=8){var Y=Math.min(8,_.length-U),Q=parseInt(_.substring(U,U+Y),B);if(Y<8){var ie=i(l(B,Y));X=X.mul(ie).add(i(Q))}else X=X.mul(W),X=X.add(i(Q))}return X.unsigned=D,X}e.fromString=c;function f(_,D){return typeof _=="number"?i(_,D):typeof _=="string"?c(_,D):o(_.low,_.high,typeof D=="boolean"?D:_.unsigned)}e.fromValue=f;var d=65536,p=1<<24,g=d*d,y=g*g,v=y/2,x=a(p),w=a(0);e.ZERO=w;var T=a(0,!0);e.UZERO=T;var N=a(1);e.ONE=N;var C=a(1,!0);e.UONE=C;var E=a(-1);e.NEG_ONE=E;var R=o(-1,2147483647,!1);e.MAX_VALUE=R;var $=o(-1,-1,!0);e.MAX_UNSIGNED_VALUE=$;var O=o(0,-2147483648,!1);e.MIN_VALUE=O;var A=e.prototype;return A.toInt=function(){return this.unsigned?this.low>>>0:this.low},A.toNumber=function(){return this.unsigned?(this.high>>>0)*g+(this.low>>>0):this.high*g+(this.low>>>0)},A.toString=function(D){if(D=D||10,D<2||36<D)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(O)){var B=i(D),j=this.div(B),W=j.mul(B).sub(this);return j.toString(D)+W.toInt().toString(D)}else return"-"+this.neg().toString(D);for(var X=i(l(D,6),this.unsigned),U=this,Y="";;){var Q=U.div(X),ie=U.sub(Q.mul(X)).toInt()>>>0,V=ie.toString(D);if(U=Q,U.isZero())return V+Y;for(;V.length<6;)V="0"+V;Y=""+V+Y}},A.getHighBits=function(){return this.high},A.getHighBitsUnsigned=function(){return this.high>>>0},A.getLowBits=function(){return this.low},A.getLowBitsUnsigned=function(){return this.low>>>0},A.getNumBitsAbs=function(){if(this.isNegative())return this.eq(O)?64:this.neg().getNumBitsAbs();for(var D=this.high!=0?this.high:this.low,B=31;B>0&&(D&1<<B)==0;B--);return this.high!=0?B+33:B+1},A.isZero=function(){return this.high===0&&this.low===0},A.eqz=A.isZero,A.isNegative=function(){return!this.unsigned&&this.high<0},A.isPositive=function(){return this.unsigned||this.high>=0},A.isOdd=function(){return(this.low&1)===1},A.isEven=function(){return(this.low&1)===0},A.equals=function(D){return n(D)||(D=f(D)),this.unsigned!==D.unsigned&&this.high>>>31===1&&D.high>>>31===1?!1:this.high===D.high&&this.low===D.low},A.eq=A.equals,A.notEquals=function(D){return!this.eq(D)},A.neq=A.notEquals,A.ne=A.notEquals,A.lessThan=function(D){return this.comp(D)<0},A.lt=A.lessThan,A.lessThanOrEqual=function(D){return this.comp(D)<=0},A.lte=A.lessThanOrEqual,A.le=A.lessThanOrEqual,A.greaterThan=function(D){return this.comp(D)>0},A.gt=A.greaterThan,A.greaterThanOrEqual=function(D){return this.comp(D)>=0},A.gte=A.greaterThanOrEqual,A.ge=A.greaterThanOrEqual,A.compare=function(D){if(n(D)||(D=f(D)),this.eq(D))return 0;var B=this.isNegative(),j=D.isNegative();return B&&!j?-1:!B&&j?1:this.unsigned?D.high>>>0>this.high>>>0||D.high===this.high&&D.low>>>0>this.low>>>0?-1:1:this.sub(D).isNegative()?-1:1},A.comp=A.compare,A.negate=function(){return!this.unsigned&&this.eq(O)?O:this.not().add(N)},A.neg=A.negate,A.add=function(D){n(D)||(D=f(D));var B=this.high>>>16,j=this.high&65535,W=this.low>>>16,X=this.low&65535,U=D.high>>>16,Y=D.high&65535,Q=D.low>>>16,ie=D.low&65535,V=0,ee=0,ce=0,ue=0;return ue+=X+ie,ce+=ue>>>16,ue&=65535,ce+=W+Q,ee+=ce>>>16,ce&=65535,ee+=j+Y,V+=ee>>>16,ee&=65535,V+=B+U,V&=65535,o(ce<<16|ue,V<<16|ee,this.unsigned)},A.subtract=function(D){return n(D)||(D=f(D)),this.add(D.neg())},A.sub=A.subtract,A.multiply=function(D){if(this.isZero())return w;if(n(D)||(D=f(D)),t){var B=t.mul(this.low,this.high,D.low,D.high);return o(B,t.get_high(),this.unsigned)}if(D.isZero())return w;if(this.eq(O))return D.isOdd()?O:w;if(D.eq(O))return this.isOdd()?O:w;if(this.isNegative())return D.isNegative()?this.neg().mul(D.neg()):this.neg().mul(D).neg();if(D.isNegative())return this.mul(D.neg()).neg();if(this.lt(x)&&D.lt(x))return i(this.toNumber()*D.toNumber(),this.unsigned);var j=this.high>>>16,W=this.high&65535,X=this.low>>>16,U=this.low&65535,Y=D.high>>>16,Q=D.high&65535,ie=D.low>>>16,V=D.low&65535,ee=0,ce=0,ue=0,he=0;return he+=U*V,ue+=he>>>16,he&=65535,ue+=X*V,ce+=ue>>>16,ue&=65535,ue+=U*ie,ce+=ue>>>16,ue&=65535,ce+=W*V,ee+=ce>>>16,ce&=65535,ce+=X*ie,ee+=ce>>>16,ce&=65535,ce+=U*Q,ee+=ce>>>16,ce&=65535,ee+=j*V+W*ie+X*Q+U*Y,ee&=65535,o(ue<<16|he,ee<<16|ce,this.unsigned)},A.mul=A.multiply,A.divide=function(D){if(n(D)||(D=f(D)),D.isZero())throw Error("division by zero");if(t){if(!this.unsigned&&this.high===-2147483648&&D.low===-1&&D.high===-1)return this;var B=(this.unsigned?t.div_u:t.div_s)(this.low,this.high,D.low,D.high);return o(B,t.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?T:w;var j,W,X;if(this.unsigned){if(D.unsigned||(D=D.toUnsigned()),D.gt(this))return T;if(D.gt(this.shru(1)))return C;X=T}else{if(this.eq(O)){if(D.eq(N)||D.eq(E))return O;if(D.eq(O))return N;var U=this.shr(1);return j=U.div(D).shl(1),j.eq(w)?D.isNegative()?N:E:(W=this.sub(D.mul(j)),X=j.add(W.div(D)),X)}else if(D.eq(O))return this.unsigned?T:w;if(this.isNegative())return D.isNegative()?this.neg().div(D.neg()):this.neg().div(D).neg();if(D.isNegative())return this.div(D.neg()).neg();X=w}for(W=this;W.gte(D);){j=Math.max(1,Math.floor(W.toNumber()/D.toNumber()));for(var Y=Math.ceil(Math.log(j)/Math.LN2),Q=Y<=48?1:l(2,Y-48),ie=i(j),V=ie.mul(D);V.isNegative()||V.gt(W);)j-=Q,ie=i(j,this.unsigned),V=ie.mul(D);ie.isZero()&&(ie=N),X=X.add(ie),W=W.sub(V)}return X},A.div=A.divide,A.modulo=function(D){if(n(D)||(D=f(D)),t){var B=(this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,D.low,D.high);return o(B,t.get_high(),this.unsigned)}return this.sub(this.div(D).mul(D))},A.mod=A.modulo,A.rem=A.modulo,A.not=function(){return o(~this.low,~this.high,this.unsigned)},A.and=function(D){return n(D)||(D=f(D)),o(this.low&D.low,this.high&D.high,this.unsigned)},A.or=function(D){return n(D)||(D=f(D)),o(this.low|D.low,this.high|D.high,this.unsigned)},A.xor=function(D){return n(D)||(D=f(D)),o(this.low^D.low,this.high^D.high,this.unsigned)},A.shiftLeft=function(D){return n(D)&&(D=D.toInt()),(D&=63)===0?this:D<32?o(this.low<<D,this.high<<D|this.low>>>32-D,this.unsigned):o(0,this.low<<D-32,this.unsigned)},A.shl=A.shiftLeft,A.shiftRight=function(D){return n(D)&&(D=D.toInt()),(D&=63)===0?this:D<32?o(this.low>>>D|this.high<<32-D,this.high>>D,this.unsigned):o(this.high>>D-32,this.high>=0?0:-1,this.unsigned)},A.shr=A.shiftRight,A.shiftRightUnsigned=function(D){if(n(D)&&(D=D.toInt()),D&=63,D===0)return this;var B=this.high;if(D<32){var j=this.low;return o(j>>>D|B<<32-D,B>>>D,this.unsigned)}else return D===32?o(B,0,this.unsigned):o(B>>>D-32,0,this.unsigned)},A.shru=A.shiftRightUnsigned,A.shr_u=A.shiftRightUnsigned,A.toSigned=function(){return this.unsigned?o(this.low,this.high,!1):this},A.toUnsigned=function(){return this.unsigned?this:o(this.low,this.high,!0)},A.toBytes=function(D){return D?this.toBytesLE():this.toBytesBE()},A.toBytesLE=function(){var D=this.high,B=this.low;return[B&255,B>>>8&255,B>>>16&255,B>>>24,D&255,D>>>8&255,D>>>16&255,D>>>24]},A.toBytesBE=function(){var D=this.high,B=this.low;return[D>>>24,D>>>16&255,D>>>8&255,D&255,B>>>24,B>>>16&255,B>>>8&255,B&255]},e.fromBytes=function(D,B,j){return j?e.fromBytesLE(D,B):e.fromBytesBE(D,B)},e.fromBytesLE=function(D,B){return new e(D[0]|D[1]<<8|D[2]<<16|D[3]<<24,D[4]|D[5]<<8|D[6]<<16|D[7]<<24,B)},e.fromBytesBE=function(D,B){return new e(D[4]<<24|D[5]<<16|D[6]<<8|D[7],D[0]<<24|D[1]<<16|D[2]<<8|D[3],B)},vS}var pP=GJ();const mP=RC(pP),HJ=KW({__proto__:null,default:mP},[pP]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ll=mP||HJ;function Wm(t){return Ll.fromString(t,!0,16)}const gP=Wm("c3a5c85c97cb3127"),_l=Wm("b492b66fbe98f273"),hs=Wm("9ae16a3b2f90404f");function RT(t){return t.xor(t.shru(47))}function yP(t,e,n){const s=t.slice(e,e+n);return Ll.fromBytes(Array.from(s),!0,!0)}function _t(t,e){return yP(t,e,8)}function G_(t,e){return yP(t,e,4)}function An(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Eo(t,e,n=Wm("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function qJ(t,e,n,s,r,a){r=r.add(t),a=An(a.add(r).add(s),21);const i=r;return r=r.add(e),r=r.add(n),a=a.add(An(r,44)),[r.add(s),a.add(i)]}function X0(t,e,n,s){return qJ(_t(t,e),_t(t,e+8),_t(t,e+16),_t(t,e+24),n,s)}function XJ(t,e=t.length){if(e>=8){const n=hs.add(e*2),s=_t(t,0).add(hs),r=_t(t,e-8),a=An(r,37).mul(n).add(s),i=An(s,25).add(r).mul(n);return Eo(a,i,n)}if(e>=4){const n=hs.add(e*2),s=G_(t,0);return Eo(s.shl(3).add(e),G_(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],a=n+(s<<8),i=e+(r<<2);return RT(hs.mul(a).xor(gP.mul(i))).mul(hs)}return hs}function KJ(t,e=t.length){const n=hs.add(e*2),s=_t(t,0).mul(_l),r=_t(t,8),a=_t(t,e-8).mul(n),i=_t(t,e-16).mul(hs);return Eo(An(s.add(r),43).add(An(a,30)).add(i),s.add(An(r.add(hs),18)).add(a),n)}function YJ(t,e=t.length){const n=hs.add(e*2),s=_t(t,0).mul(hs),r=_t(t,8),a=_t(t,e-8).mul(n),i=_t(t,e-16).mul(hs),o=An(s.add(r),43).add(An(a,30)).add(i),l=Eo(o,s.add(An(r.add(hs),18)).add(a),n),c=_t(t,16).mul(n),f=_t(t,24),d=o.add(_t(t,e-32)).mul(n),p=l.add(_t(t,e-24)).mul(n);return Eo(An(c.add(f),43).add(An(d,30)).add(p),c.add(An(f.add(s),18)).add(d),n)}function bP(t,e=t.length){const n=Ll.fromNumber(81,!0);if(e<=32)return e<=16?XJ(t,e):KJ(t,e);if(e<=64)return YJ(t,e);let s=n,r=n.mul(_l).add(113),a=RT(r.mul(hs).add(113)).mul(hs),i=[Ll.UZERO,Ll.UZERO],o=[Ll.UZERO,Ll.UZERO];s=s.mul(hs).add(_t(t,0));let l=0;const c=(e-1>>6)*64,f=c+(e-1&63)-63;do s=An(s.add(r).add(i[0]).add(_t(t,l+8)),37).mul(_l),r=An(r.add(i[1]).add(_t(t,l+48)),42).mul(_l),s=s.xor(o[1]),r=r.add(i[0]).add(_t(t,l+40)),a=An(a.add(o[0]),33).mul(_l),i=X0(t,l,i[1].mul(_l),s.add(o[0])),o=X0(t,l+32,a.add(o[1]),r.add(_t(t,l+16))),[a,s]=[s,a],l+=64;while(l!==c);const d=_l.add(a.and(255).shl(1));return l=f,o[0]=o[0].add(e-1&63),i[0]=i[0].add(o[0]),o[0]=o[0].add(i[0]),s=An(s.add(r).add(i[0]).add(_t(t,l+8)),37).mul(d),r=An(r.add(i[1]).add(_t(t,l+48)),42).mul(d),s=s.xor(o[1].mul(9)),r=r.add(i[0].mul(9).add(_t(t,l+40))),a=An(a.add(o[0]),33).mul(d),i=X0(t,l,i[1].mul(d),s.add(o[0])),o=X0(t,l+32,a.add(o[1]),r.add(_t(t,l+16))),[a,s]=[s,a],Eo(Eo(i[0],o[0],d).add(RT(r).mul(gP)).add(a),Eo(i[1],o[1],d).add(s),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vi(t,e){return e==="string"?La(t):Ko([t],e)}function ZJ(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Ko(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Ua(t)),ae().getBool("DEBUG")&&nP(t,e),ZJ(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Un(){return ae().platform.now()}function xP(t,e){return ae().platform.fetch(t,e)}function La(t,e="utf-8"){return e=e||"utf-8",ae().platform.encode(t,e)}function Ri(t,e="utf-8"){return e=e||"utf-8",ae().platform.decode(t,e)}function Sn(t){return ae().platform.isTypedArray!=null?ae().platform.isTypedArray(t):dP(t)}function Ua(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||Ai(t)||t==null||Sn(t)&&n)e.push(t);else if(Array.isArray(t)||Sn(t))for(let s=0;s<t.length;++s)Ua(t[s],e,n);else{let s=-1;for(const r of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Ua(t[r],e,n)}return e}const QJ=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:at,arraysEqualWithNull:tP,assert:M,assertNonNegativeIntegerDimensions:Ys,assertNonNull:Tu,assertShapesMatch:Xn,bytesFromStringArray:rP,bytesPerElement:cp,checkConversionForErrors:nP,clamp:Lo,computeStrides:Be,convertBackendValuesAndArrayBuffer:oP,createScalarValue:Vi,createShuffledIndices:AJ,decodeString:Ri,distSquared:EJ,encodeString:La,fetch:xP,fingerPrint64:bP,flatten:Ua,getArrayFromDType:Zt,getTypedArrayFromDType:On,hasEncodingLoss:ON,hexToLong:Wm,indexToLoc:Nu,inferDtype:Cu,inferFromImplicitShape:DN,isBoolean:aP,isFunction:Mo,isInt:nu,isNumber:m1,isPromise:Ai,isScalarShape:$J,isString:Da,isTypedArray:Sn,isValidDtype:sP,locToIndex:ia,makeOnesTypedArray:ib,makeZerosNestedTypedArray:_N,makeZerosTypedArray:qn,nearestDivisor:g1,nearestLargerEven:ab,now:Un,parseAxisParam:nt,randUniform:kJ,repeatedTry:IT,rightPad:Xl,shuffle:RN,shuffleCombo:NJ,sizeFromShape:de,sizeToSquarishShape:p1,squeezeShape:Bi,sum:eP,swap:xi,tanh:IJ,toNestedArray:pr,toTypedArray:Ko},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JJ{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new tee)}profileKernel(e,n,s){let r;const a=()=>{r=s()};let i;const o=Un();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(a);else{a();for(const c of r)c.dataSync();i=Promise.resolve({kernelMs:Un()-o})}if(ae().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const f=r[c];f.data().then(d=>{eee(d,f.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:i.then(c=>c.kernelMs),extraInfo:i.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:a,extraInfo:i}=e;s.forEach(o=>{Promise.all([o.data(),r,i]).then(l=>{this.logger.logKernelProfile(n,o,l[0],l[1],a,l[2])})})}}function eee(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class tee{logKernelProfile(e,n,s,r,a,i){const o=typeof r=="number"?Xl(`${r}ms`,9):r.error,l=Xl(e,25),c=n.rank,f=n.size,d=Xl(n.shape.toString(),14);let p="";for(const g in a){const y=a[g];if(y!=null){const v=y.shape||n.shape,x=v.length;p+=`${g}: ${x}D ${x>0?v:""} `}}console.log(`%c${l}	%c${o}	%c${c}D ${d}	%c${f}	%c${p}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nee(t,e,n){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],f=c.inputs;for(const d in f){const p=f[d];let g=!1;for(let y=0;y<e.length;y++)if(s[p.id]){c.outputs.forEach(v=>s[v.id]=!0),g=!0,r[c.id]=!0;break}if(g)break}}const a={};a[n.id]=!0;const i={};for(let l=t.length-1;l>=0;l--){const c=t[l],f=c.inputs;for(let d=0;d<c.outputs.length;d++)if(a[c.outputs[d].id]){for(const p in f)a[f[p].id]=!0,i[c.id]=!0;break}}const o=[];for(let l=0;l<t.length;l++){const c=t[l];if(r[c.id]&&i[c.id]){const f={};for(const p in c.inputs){const g=c.inputs[p];s[g.id]&&(f[p]=g)}const d=Object.assign({},c);d.inputs=f,d.outputs=c.outputs,o.push(d)}}return o}function see(t,e,n,s){for(let r=e.length-1;r>=0;r--){const a=e[r],i=[];if(a.outputs.forEach(l=>{const c=t[l.id];c!=null?i.push(c):i.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const o=a.gradient(i);for(const l in a.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const c=n(()=>o[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const f=a.inputs[l];if(!at(c.shape,f.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${f.shape}'`);if(t[f.id]==null)t[f.id]=c;else{const d=t[f.id];t[f.id]=s(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H_=20,Ed=3,wS=7;function ree(t,e,n,s){const r=Be(e),a=aee(t,e,n,r),i=e.length,o=gy(t,e,n,r,a),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(o.map(c=>"    "+c).join(`
`)),l.join(`
`)}function aee(t,e,n,s){const r=de(e),a=s[s.length-1],i=new Array(a).fill(0),o=e.length,l=n==="complex64"?zd(t):t;if(o>1)for(let c=0;c<r/a;c++){const f=c*a;for(let d=0;d<a;d++)i[d]=Math.max(i[d],Md(l[f+d],0,n).length)}return i}function Md(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(wS))} + ${parseFloat(t[1].toFixed(wS))}j`:Da(t)?s=`'${t}'`:n==="bool"?s=vP(t):s=parseFloat(t.toFixed(wS)).toString(),Xl(s,e)}function vP(t){return t===0?"false":"true"}function gy(t,e,n,s,r,a=!0){const i=n==="complex64"?2:1,o=e[0],l=e.length;if(l===0){if(n==="complex64"){const v=zd(t);return[Md(v[0],0,n)]}return n==="bool"?[vP(t[0])]:[t[0].toString()]}if(l===1){if(o>H_){const x=Ed*i;let w=Array.from(t.slice(0,x)),T=Array.from(t.slice((o-Ed)*i,o*i));return n==="complex64"&&(w=zd(w),T=zd(T)),["["+w.map((N,C)=>Md(N,r[C],n)).join(", ")+", ..., "+T.map((N,C)=>Md(N,r[o-Ed+C],n)).join(", ")+"]"]}return["["+(n==="complex64"?zd(t):Array.from(t)).map((x,w)=>Md(x,r[w],n)).join(", ")+"]"]}const c=e.slice(1),f=s.slice(1),d=s[0]*i,p=[];if(o>H_){for(let v=0;v<Ed;v++){const x=v*d,w=x+d;p.push(...gy(t.slice(x,w),c,n,f,r,!1))}p.push("...");for(let v=o-Ed;v<o;v++){const x=v*d,w=x+d;p.push(...gy(t.slice(x,w),c,n,f,r,v===o-1))}}else for(let v=0;v<o;v++){const x=v*d,w=x+d;p.push(...gy(t.slice(x,w),c,n,f,r,v===o-1))}const g=l===2?",":"";p[0]="["+(o>0?p[0]+g:"");for(let v=1;v<p.length-1;v++)p[v]=" "+p[v]+g;let y=`,
`;for(let v=2;v<l;v++)y+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(a?"":y),p}function zd(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yn{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=de(e),s!=null){const r=s.length;M(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Zt(n,this.size),this.strides=Be(e)}set(e,...n){n.length===0&&(n=[0]),M(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const a=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(a)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return ra().makeTensor(this.values,this.shape,this.dtype)}}let ra=null,Tc=null;function iee(t){ra=t}function oee(t){Tc=t}class gt{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=de(e),this.strides=Be(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Tc.buffer(this.shape,this.dtype,e)}bufferSync(){return Tc.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return pr(this.shape,e,this.dtype==="complex64")}arraySync(){return pr(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=ra().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>Ri(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),ra().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=ra().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Ri(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await ra().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),ra().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Tc.print(this,e)}clone(){return this.throwIfDisposed(),Tc.clone(this)}toString(e=!1){const n=this.dataSync();return ree(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Tc.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),ra().makeVariable(this,e,n,s)}}Object.defineProperty(gt,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function pe(){return LN("Tensor",()=>gt)}pe();class gp extends gt{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!at(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);ra().disposeTensor(this),this.dataId=e.dataId,ra().incRef(this,null)}dispose(){ra().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(gp,Symbol.hasInstance,{value:t=>t instanceof gt&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var DT;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(DT||(DT={}));var OT;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(OT||(OT={}));var _T;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(_T||(_T={}));var FT;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(FT||(FT={}));var LT;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(LT||(LT={}));const lee={float32:FT,int32:OT,bool:_T,complex64:LT};function As(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return lee[t][e]}function dx(t){return As(t,"int32")}function wP(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function SP(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ht(t,e){if(t.dtype===e.dtype)return[t,e];const n=As(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function TP(t,e){M(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function px(t,e){return e.some(n=>n.id===t.id)}function Di(t){const e=[];return CP(t,e,new Set),e}function CP(t,e,n){if(t==null)return;if(t instanceof gt){e.push(t);return}if(!uee(t))return;const s=t;for(const r in s){const a=s[r];n.has(a)||(n.add(a),CP(a,e,n))}}function uee(t){return Array.isArray(t)||typeof t=="object"}const cee=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:TP,getTensorsInContainer:Di,isTensorInList:px,makeTypesMatch:Ht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SS(t){return t.kernelName!=null}class q_{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Uc{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new q_}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(lr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new JJ(this.backendInstance),!0}setupRegisteredKernels(){v1(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){v1(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof rb)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,a=s.then(i=>r<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,lr(`Initialization of backend ${e} failed`),lr(i.stack||i.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return lr(`Initialization of backend ${e} failed`),lr(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:a}=this.initializeBackend(s);if(a||r)return{name:s,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,a=this.readSync(n),i=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,a,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return Uc.nextTensorId++}nextVariableId(){return Uc.nextVariableId++}clone(e){const n=H.runKernel(kh,{x:e}),s={x:e},r=i=>({x:()=>{const o="float32",l={x:i},c={dtype:o};return H.runKernel(dh,l,c)}}),a=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,a,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(mp(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let a=0;s.forEach(l=>{a+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-n-a-i;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),a=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const c=SS(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(SS(e)){const{kernelName:y,inputs:v,attrs:x}=e;this.backendName==null&&this.backend;const w=mp(y,this.backendName);M(w!=null,()=>`Cannot find registered kernel '${y}' for backend '${this.backendName}'`),o=()=>{const T=this.backend.numDataIds();l=w.kernelFunc({inputs:v,attrs:x,backend:this.backend});const N=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(y,T,N);const C=N.map(E=>E.rank!=null?E:this.makeTensorFromTensorInfo(E));if(r){const E=this.getTensorsForGradient(y,v,C);s=this.saveTensorsForBackwardMode(E)}return C}}else{const{forwardFunc:y}=e,v=x=>{r&&(s=x.map(w=>this.keep(this.clone(w))))};o=()=>{const x=this.backend.numDataIds();l=this.tidy(()=>y(this.backend,v));const w=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,x,w),w}}const{inputs:f,attrs:d}=e,p=SS(e)?null:e.backwardsFunc;let g;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=o():(g=this.profiler.profileKernel(c,f,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(g),n=g.outputs)}),r&&this.addTapeNode(c,f,n,p,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(f).map(y=>f[y]!=null?f[y].shape:null),outputShapes:n.map(y=>y.shape),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=AT(e);if(r!=null){const a=r.inputsToSave||[],i=r.outputsToSave||[];let o;r.saveAllInputs?(M(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(n).map(c=>n[c])):o=a.map(c=>n[c]);const l=s.filter((c,f)=>i[f]);return o.concat(l)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let a=e;s==="string"&&Da(e[0])&&(a=e.map(l=>La(l)));const i=r.write(a,n,s),o=new gt(n,s,i,this.nextTensorId());if(this.trackTensor(o,r),s==="string"){const l=this.state.tensorInfo.get(i),c=rP(a);this.state.numBytes+=c-l.bytes,l.bytes=c}return o}makeTensorFromDataId(e,n,s,r){s=s||"float32";const a={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:a}=e,i=new gt(r,a,s,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const a=new gp(e,n,s,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*cp(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof gp||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*cp(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,a,i){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:a},l=AT(e);l!=null&&(r=l.gradFunc),r!=null&&(o.gradient=c=>(c=c.map((f,d)=>{if(f==null){const p=s[d],g=qn(p.size,p.dtype);return this.makeTensor(g,p.shape,p.dtype)}return f}),r(c.length>1?c:c[0],a,i))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=Di(e),s=new Set(n.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){const i=this.state.activeScope.track[a];!i.kept&&!s.has(i.id)&&i.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(a=>{!a.kept&&a.scopeId===r.id&&this.track(a)})}gradients(e,n,s,r=!1){if(M(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));M(a instanceof gt,()=>"The result y returned by f() must be a tensor.");const i=nee(this.state.activeTape,n,a);if(!r&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[a.id]=s??hee(a.shape),see(o,i,c=>this.tidy(c),fee);const l=n.map(c=>o[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const f of c.saved)f.dispose()}),this.state.activeTape=null),{value:a,grads:l}})}customGrad(e){return M(Mo(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{M(n.every(o=>o instanceof gt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((o,l)=>{r[l]=o});const a=(o,l)=>(s=e(...n,l),M(s.value instanceof gt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),M(Mo(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(o,l)=>{const c=s.gradFunc(o,l),f=Array.isArray(c)?c:[c];M(f.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),M(f.every(p=>p instanceof gt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return f.forEach((p,g)=>{d[g]=()=>p}),d};return this.runKernelFunc({forwardFunc:a,backwardsFunc:i,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Un(),s=await this.backend.time(e);return s.wallMs=Un()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new q_;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Uc.nextTensorId=0;Uc.nextVariableId=0;function hee(t){const e=ib(de(t),"float32");return H.makeTensor(e,t,"float32")}function NP(){const t=uP();if(t._tfengine==null){const e=new lP(t);t._tfengine=new Uc(e)}return _J(t._tfengine.ENV),iee(()=>t._tfengine),t._tfengine}const H=NP();function fee(t,e){const n={a:t,b:e};return H.runKernel(ku,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dee(){return typeof navigator<"u"&&navigator!=null}let MT;function pee(t){MT=t}function zN(t){if(MT!==void 0)return MT;if(t||dee()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function PN(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const mee=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:PN,isMobile:zN,mockIsMobile:pee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rs=ae();Rs.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Rs.registerFlag("IS_BROWSER",()=>PN());Rs.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Rs.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Rs.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Rs.registerFlag("PROD",()=>!1);Rs.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Rs.getBool("DEBUG"));Rs.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Rs.registerFlag("IS_TEST",()=>!1);Rs.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Rs.getBool("DEBUG"));Rs.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Rs.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Rs.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ja(t,e){let n=t;if(Sn(t))return e==="string"?[]:[t.length];if(wP(t)){const r=t.channels||"RGBA";return[t.height,t.width*r.length]}else if(SP(t))return[t.buffer.size/(e==null?4:cp(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||Sn(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&ae().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&kP(t,s,[]),s}function kP(t,e,n){if(n=n||[],!Array.isArray(t)&&!Sn(t)){M(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}M(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),M(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)kP(t[r],s,n.concat(r))}function X_(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function z(t,e,n,s="numeric"){if(t instanceof pe())return X_(s,t.dtype,e,n),t;let r=Cu(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),X_(s,r,e,n),t==null||!Sn(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const a=ja(t,r);!Sn(t)&&!Array.isArray(t)&&(t=[t]);const o=r!=="string"?Ko(t,r):Ua(t,[],!0);return H.makeTensor(o,a,r)}function yp(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((a,i)=>z(a,`${e}[${i}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BN="__op";function q(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+BN;const r=(...a)=>{H.startScope(n);try{const i=s(...a);return Ai(i)&&console.error("Cannot return a Promise inside of tidy."),H.endScope(i),i}catch(i){throw H.endScope(null),i}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gee(t,e){const n=z(t,"real","complex"),s=z(e,"imag","complex");Xn(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return H.runKernel(db,r)}const Oi=q({complex_:gee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yo(t,e,n,s){if(s==null)s=Cu(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(SP(t)||wP(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return H.backend.createTensorFromGPUData(t,e||n,s)}if(!Sn(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Ys(e);const r=de(e),a=de(n);M(r===a,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${a}`);for(let i=0;i<n.length;++i){const o=n[i],l=i===n.length-1?o!==de(e.slice(i)):!0;M(n[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Sn(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?Ko(t,s):Ua(t,[],!0),H.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ws(t,e,n){const s=ja(t,n);return Yo(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const su={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class pa{static join(e){return new pa(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>Sn(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const a=n+r.byteLength;this.shards.push({buffer:r,start:n,end:a}),n=a}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=n-e,a=new ArrayBuffer(r),i=new Uint8Array(a);let o=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],d=e+o-c.start,p=o,y=Math.min(n,c.end)-c.start,v=new Uint8Array(c.buffer,d,y-d);if(i.set(v,p),o+=v.length,n<c.end)break}return a}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(r){return e<r.start?-1:e>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=yee(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function yee(t,e){let n=0,s=t.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,a=e(t[r]);if(a===0)return r;a<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bee(){ae().set("PROD",!0)}function xee(){ae().set("DEBUG",!0)}function vee(){ae().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function wee(t){ae().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function See(){H.disposeVariables()}function sa(){return H}function zT(){return H.memory()}function Tee(t){return H.profile(t)}function re(t,e){return H.tidy(t,e)}function Xe(t){Di(t).forEach(n=>n.dispose())}function Tn(t){return H.keep(t)}function Cee(t){return H.time(t)}function Nee(t){return H.setBackend(t)}function kee(){return H.ready()}function EP(){return H.backendName}function Eee(t){H.removeBackend(t)}function $ee(t){return H.findBackend(t)}function Iee(t){return H.findBackendFactory(t)}function VN(t,e,n=1){return H.registerBackend(t,e,n)}function UN(){return H.backend}function Aee(t,e){ae().setPlatform(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zo=4;async function PT(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<r.length;++i){const o=r[i],l=Array.isArray(t)?t[i].tensor:t[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const c={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const f=new Promise(async d=>{const p=await l.bytes(),g=p.reduce((x,w)=>x+w.length,0)+zo*p.length,y=new Uint8Array(g);let v=0;for(let x=0;x<p.length;x++){const w=p[x],T=new Uint8Array(new Uint32Array([w.length]).buffer);y.set(T,v),v+=zo,y.set(w,v),v+=w.length}d(y)});s.push(f)}else s.push(l.data());e!=null&&(c.group=e),n.push(c)}const a=await Promise.all(s);return{data:Oee(a),specs:n}}function jN(t,e){const n=new pa(t),s={};let r=0;for(const a of e){const i=Ree(a,(o,l)=>n.slice(r+o,r+l));s[a.name]=$P(a,n.slice(r,r+i)),r+=i}return s}function Ree(t,e){const n=de(t.shape);let s;if("quantization"in t){const r=t.quantization;s=su[r.dtype]}else if(t.dtype==="string"){let r=0;for(let a=0;a<n;a++)r+=zo+new Uint32Array(e(r,r+zo))[0];return r}else s=su[t.dtype];return n*s}async function Dee(t,e){const n=de(t.shape);let s;if("quantization"in t){const r=t.quantization;s=su[r.dtype]}else if(t.dtype==="string"){let r=0;for(let a=0;a<n;a++)r+=zo+new Uint32Array(await e(r,r+zo))[0];return r}else s=su[t.dtype];return n*s}function $P(t,e){const n=t.name,s=t.dtype,r=t.shape,a=de(r);let i,o=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=su[l.dtype],f=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(s==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){i=new Float32Array(f.length);for(let d=0;d<f.length;d++){const p=f[d];i[d]=p*l.scale+l.min}}else if(l.dtype==="float16")i=Pee()(f);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(s==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);i=new Int32Array(f.length);for(let d=0;d<f.length;d++){const p=f[d];i[d]=Math.round(p*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);o+=a*c}else if(s==="string"){const l=de(t.shape);i=[];for(let c=0;c<l;c++){const f=new Uint32Array(e.slice(o,o+zo))[0];o+=zo;const d=new Uint8Array(e.slice(o,o+f));i.push(d),o+=f}}else{const l=su[s];if(s==="float32")i=new Float32Array(e);else if(s==="int32")i=new Int32Array(e);else if(s==="bool")i=new Uint8Array(e);else if(s==="complex64"){i=new Float32Array(e);const c=new Float32Array(i.length/2),f=new Float32Array(i.length/2);for(let y=0;y<c.length;y++)c[y]=i[y*2],f[y]=i[y*2+1];const d=Ws(c,r,"float32"),p=Ws(f,r,"float32"),g=Oi(d,p);return d.dispose(),p.dispose(),g}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);o+=a*l}return Ws(i,r,s)}async function K_(t,e,n){let s=new Uint8Array(e);for(;s.byteLength<n;){const{done:r,value:a}=await t.read();if(r&&a==null){const o=n-s.byteLength;throw new Error(`Reader is done but ${o} bytes are still expected`)}const i=new Uint8Array(s.length+a.byteLength);i.set(s,0),i.set(new Uint8Array(a),s.length),s=i}return s.buffer}async function IP(t,e){const n={},s=t.getReader();let r=new ArrayBuffer(0);for(const a of e){const i=await Dee(a,async(c,f)=>(r=await K_(s,r,f),r.slice(c,f)));r=await K_(s,r,i);const o=r.slice(0,i);r=r.slice(i);const l=$P(a,o);if(n[a.name]=l,EP()==="webgpu"){const c=UN();"uploadToGPU"in c&&de(l.shape)>=ae().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(l.dataId)}}return n}function Oee(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(a=>{if(e+=a.byteLength,n.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${a.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(a=>{s.set(new Uint8Array(a.buffer),r),r+=a.byteLength}),s.buffer}const WN=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Y_(t){return WN?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function _ee(t){if(WN)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function Fee(t){if(WN){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function AP(t){return pa.join(t)}function Z_(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function RP(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function GN(t,e,n){const s={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(s.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=n}return t.signature!=null&&(s.signature=t.signature),t.userDefinedMetadata!=null&&(s.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(s.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(s.initializerSignature=t.initializerSignature),s}async function HN(t,e){let n,s;return t.weightsManifest!=null&&([n,s]=await e(t.weightsManifest)),GN(t,n,s)}function Gm(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:Y_(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:Y_(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new pa(t.weightData).byteLength}}function w1(t){const e=[];for(const n of t)e.push(...n.weights);return e}function Lee(){const t=n=>{let s=n<<13,r=0;for(;(s&8388608)===0;)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function Mee(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function zee(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function Pee(){const t=Lee(),e=Mee(),n=zee();return s=>{const r=new ArrayBuffer(4*s.length),a=new Uint32Array(r);for(let i=0;i<s.length;i++){const o=s[i],l=t[n[o>>10]+(o&1023)]+e[o>>10];a[i]=l}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jt{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return jt.instance==null&&(jt.instance=new jt),jt.instance}static registerSaveRouter(e){jt.getInstance().saveRouters.push(e)}static registerLoadRouter(e){jt.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return jt.getHandlers(e,"save")}static getLoadHandlers(e,n){return jt.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?jt.getInstance().loadRouters:jt.getInstance().saveRouters).forEach(i=>{const o=i(e,s);o!==null&&r.push(o)}),r}}const Bee=t=>jt.registerSaveRouter(t),Vee=t=>jt.registerLoadRouter(t),DP=t=>jt.getSaveHandlers(t),OP=(t,e)=>jt.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BT="tensorflowjs",VT=1,Wl="models_store",To="model_info_store";function _P(){if(!ae().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function UT(t){const e=t.result;e.createObjectStore(Wl,{keyPath:"modelPath"}),e.createObjectStore(To,{keyPath:"modelPath"})}class ru{constructor(e){if(this.indexedDB=_P(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const a=this.indexedDB.open(BT,VT);a.onupgradeneeded=()=>UT(a),a.onsuccess=()=>{const i=a.result;if(n==null){const o=i.transaction(Wl,"readonly"),c=o.objectStore(Wl).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return i.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=f=>(i.close(),r(c.error)),o.oncomplete=()=>i.close()}else{n.weightData=pa.join(n.weightData);const o=Gm(n),l=i.transaction(To,"readwrite");let c=l.objectStore(To),f;try{f=c.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(p){return r(p)}let d;f.onsuccess=()=>{d=i.transaction(Wl,"readwrite");const p=d.objectStore(Wl);let g;try{g=p.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:o})}catch(y){return r(y)}g.onsuccess=()=>s({modelArtifactsInfo:o}),g.onerror=y=>{c=l.objectStore(To);const v=c.delete(this.modelPath);v.onsuccess=()=>(i.close(),r(g.error)),v.onerror=x=>(i.close(),r(g.error))}},f.onerror=p=>(i.close(),r(f.error)),l.oncomplete=()=>{d==null?i.close():d.oncomplete=()=>i.close()}}},a.onerror=i=>r(a.error)})}}ru.URL_SCHEME="indexeddb://";const FP=t=>ae().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ru.URL_SCHEME)?Uee(t.slice(ru.URL_SCHEME.length)):null;jt.registerSaveRouter(FP);jt.registerLoadRouter(FP);function Uee(t){return new ru(t)}function jee(t){return t.startsWith(ru.URL_SCHEME)?t.slice(ru.URL_SCHEME.length):t}class Wee{constructor(){this.indexedDB=_P()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(BT,VT);s.onupgradeneeded=()=>UT(s),s.onsuccess=()=>{const r=s.result,a=r.transaction(To,"readonly"),o=a.objectStore(To).getAll();o.onsuccess=()=>{const l={};for(const c of o.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},o.onerror=l=>(r.close(),n(o.error)),a.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=jee(e),new Promise((n,s)=>{const r=this.indexedDB.open(BT,VT);r.onupgradeneeded=()=>UT(r),r.onsuccess=()=>{const a=r.result,i=a.transaction(To,"readwrite"),o=i.objectStore(To),l=o.get(e);let c;l.onsuccess=()=>{if(l.result==null)return a.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const f=o.delete(e),d=()=>{c=a.transaction(Wl,"readwrite");const g=c.objectStore(Wl).delete(e);g.onsuccess=()=>n(l.result.modelArtifactsInfo),g.onerror=y=>s(l.error)};f.onsuccess=d,f.onerror=p=>(d(),a.close(),s(l.error))}},l.onerror=f=>(a.close(),s(l.error)),i.oncomplete=()=>{c==null?a.close():c.oncomplete=()=>a.close()}},r.onerror=a=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vi="/",Cc="tensorflowjs_models",LP="info",Gee="model_topology",Hee="weight_specs",qee="weight_data",Xee="model_metadata";function MP(t){return{info:[Cc,t,LP].join(vi),topology:[Cc,t,Gee].join(vi),weightSpecs:[Cc,t,Hee].join(vi),weightData:[Cc,t,qee].join(vi),modelMetadata:[Cc,t,Xee].join(vi)}}function zP(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function Kee(t){const e=t.split(vi);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(vi)}function Yee(t){return t.startsWith(au.URL_SCHEME)?t.slice(au.URL_SCHEME.length):t}class au{constructor(e){if(!ae().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=MP(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=Gm(e),a=pa.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,_ee(a));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw zP(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){const o=JSON.parse(a);n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,o.signature!=null&&(n.signature=o.signature),o.userDefinedMetadata!=null&&(n.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(n.modelInitializer=o.modelInitializer),o.initializerSignature!=null&&(n.initializerSignature=o.initializerSignature),o.trainingConfig!=null&&(n.trainingConfig=o.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=Fee(i),n}}au.URL_SCHEME="localstorage://";const PP=t=>ae().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(au.URL_SCHEME)?Zee(t.slice(au.URL_SCHEME.length)):null;jt.registerSaveRouter(PP);jt.registerLoadRouter(PP);function Zee(t){return new au(t)}class Qee{constructor(){M(ae().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),M(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Cc+vi,s=vi+LP;for(let r=0;r<this.LS.length;++r){const a=this.LS.key(r);if(a.startsWith(n)&&a.endsWith(s)){const i=Kee(a);e[i]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){e=Yee(e);const n=MP(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return zP(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _c="://";class cs{constructor(){this.managers={}}static getInstance(){return cs.instance==null&&(cs.instance=new cs),cs.instance}static registerManager(e,n){M(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(_c)&&(e=e.slice(0,e.indexOf(_c))),M(e.length>0,()=>"scheme must not be an empty string.");const s=cs.getInstance();M(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=cs.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(cs.getInstance().managers)}}function yy(t){if(t.indexOf(_c)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${cs.getSchemes().join(",")}`);return{scheme:t.split(_c)[0],path:t.split(_c)[1]}}async function BP(t,e,n=!1){M(t!==e,()=>`Old path and new path are the same: '${t}'`);const s=jt.getLoadHandlers(t);M(s.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),M(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${t}.`);const r=s[0],a=jt.getSaveHandlers(e);M(a.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),M(a.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const i=a[0],o=yy(t).scheme,l=yy(t).path,c=o===yy(t).scheme,f=await r.load();n&&c&&await cs.getManager(o).removeModel(l);const d=await i.save(f);return n&&!c&&await cs.getManager(o).removeModel(l),d.modelArtifactsInfo}async function Jee(){const t=cs.getSchemes(),e={};for(const n of t){const s=await cs.getManager(n).listModels();for(const r in s){const a=n+_c+r;e[a]=s[r]}}return e}async function ete(t){const e=yy(t);return cs.getManager(e.scheme).removeModel(e.path)}async function tte(t,e){return BP(t,e,!1)}async function nte(t,e){return BP(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ste{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!ae().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return dP(e)}}if(ae().get("IS_BROWSER")){ae().setPlatform("browser",new ste);try{cs.registerManager(au.URL_SCHEME,new Qee)}catch{}try{cs.registerManager(ru.URL_SCHEME,new Wee)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rte={importFetch:()=>require("node-fetch")};let TS;class ate{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return ae().global.fetch!=null?ae().global.fetch(e,n):(TS==null&&(TS=rte.importFetch()),TS(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}ae().get("IS_NODE")&&!ae().get("IS_BROWSER")&&ae().setPlatform("node",new ate);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qe(t,e="float32",n){return e=e||"float32",Ys(t),new yn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ite(t,e){const n=z(t,"x","cast");if(!sP(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return H.runKernel(dh,s,r)}const Ne=q({cast_:ite});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ote(t){const n={x:z(t,"x","clone","string_or_numeric")};return H.runKernel(kh,n)}const Ma=q({clone_:ote});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qN(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */NP();const lte={buffer:Qe,cast:Ne,clone:Ma,print:qN};oee(lte);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ute(t,e){let n=z(t,"a","add"),s=z(e,"b","add");[n,s]=Ht(n,s);const r={a:n,b:s};return H.runKernel(ku,r)}const ve=q({add_:ute});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cte(t,e){let n=z(t,"a","floorDiv"),s=z(e,"b","floorDiv");[n,s]=Ht(n,s);const r={a:n,b:s};return H.runKernel(Ch,r)}const mx=q({floorDiv_:cte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hte(t,e){let n=z(t,"a","div"),s=z(e,"b","div");if([n,s]=Ht(n,s),n.dtype==="int32"&&s.dtype==="int32")return mx(n,s);const r={a:n,b:s},a={};return H.runKernel(bh,r,a)}const Le=q({div_:hte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fte(t,e){let n=z(t,"a","mul"),s=z(e,"b","mul");[n,s]=Ht(n,s);const r={a:n,b:s};return H.runKernel(Fh,r)}const Z=q({mul_:fte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dte(t){const e=z(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return H.runKernel(Yp,n)}else{const n={x:e};return H.runKernel(Vp,n)}}const pn=q({abs_:dte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pte(t){const n={x:z(t,"x","acos")};return H.runKernel(ih,n)}const XN=q({acos_:pte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mte(t){const n={x:z(t,"x","acosh")};return H.runKernel(oh,n)}const KN=q({acosh_:mte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gte(t){M(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),M(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((r,a)=>z(r,`tensors${a}`,"addN")),n=e[0];e.forEach(r=>{if(r.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(r=>{if(!at(r.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return H.runKernel(Up,s)}const VP=q({addN_:gte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yte(t,e=null,n=!1){const r={x:z(t,"x","all","bool")},a={axis:e,keepDims:n};return H.runKernel(ob,r,a)}const gx=q({all_:yte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bte(t,e=null,n=!1){const r={x:z(t,"x","any","bool")},a={axis:e,keepDims:n};return H.runKernel(lb,r,a)}const bp=q({any_:bte});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xte(t,e=0){const s={x:z(t,"x","argMax")},r={axis:e};return H.runKernel(jp,s,r)}const iu=q({argMax_:xte});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vte(t,e=0){const s={x:z(t,"x","argMin")},r={axis:e};return H.runKernel(Wp,s,r)}const YN=q({argMin_:vte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wte(t){const n={x:z(t,"x","asin")};return H.runKernel(lh,n)}const ZN=q({asin_:wte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ste(t){const n={x:z(t,"x","asinh")};return H.runKernel(uh,n)}const QN=q({asinh_:Ste});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tte(t){const n={x:z(t,"x","atan")};return H.runKernel(ch,n)}const JN=q({atan_:Tte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cte(t,e){let n=z(t,"a","atan2"),s=z(e,"b","atan2");[n,s]=Ht(n,s);const r={a:n,b:s};return H.runKernel(fh,r)}const ek=q({atan2_:Cte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nte(t){const n={x:z(t,"x","atanh")};return H.runKernel(hh,n)}const tk=q({atanh_:Nte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hm(t,e,n,s,r="NHWC",a){const i=t[3],o=[...e,i],l=ji(r);return Ln(t,o,n,a,s,null,null,l)}function Ur(t,e,n,s,r,a,i="channelsLast"){const[o,l]=xp(e);let c;if(i==="channelsLast")c=[o,l,t[3],t[3]];else if(i==="channelsFirst")c=[o,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return Ln(t,c,n,s,r,a,!1,i)}function Ui(t,e,n,s,r,a,i="NDHWC"){const[o,l,c]=jT(e);let f,d;if(i==="NDHWC")d="channelsLast",f=[o,l,c,t[4],t[4]];else if(i==="NCDHW")d="channelsFirst",f=[o,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return Zo(t,f,n,s,r,!1,d,a)}function Ln(t,e,n,s,r,a,i=!1,o="channelsLast"){let[l,c,f,d]=[-1,-1,-1,-1];if(o==="channelsLast")[l,c,f,d]=t;else if(o==="channelsFirst")[l,d,c,f]=t;else throw new Error(`Unknown dataFormat ${o}`);const[p,g,,y]=e,[v,x]=xp(n),[w,T]=xp(s),N=Fc(p,w),C=Fc(g,T),{padInfo:E,outHeight:R,outWidth:$}=$te(r,c,f,v,x,N,C,a,o),O=i?y*d:y;let A;return o==="channelsFirst"?A=[l,O,R,$]:o==="channelsLast"&&(A=[l,R,$,O]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:f,inChannels:d,outHeight:R,outWidth:$,outChannels:O,padInfo:E,strideHeight:v,strideWidth:x,filterHeight:p,filterWidth:g,effectiveFilterHeight:N,effectiveFilterWidth:C,dilationHeight:w,dilationWidth:T,inShape:t,outShape:A,filterShape:e}}function Zo(t,e,n,s,r,a=!1,i="channelsLast",o){let[l,c,f,d,p]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,c,f,d,p]=t;else if(i==="channelsFirst")[l,p,c,f,d]=t;else throw new Error(`Unknown dataFormat ${i}`);const[g,y,v,,x]=e,[w,T,N]=jT(n),[C,E,R]=jT(s),$=Fc(g,C),O=Fc(y,E),A=Fc(v,R),{padInfo:_,outDepth:D,outHeight:B,outWidth:j}=Ite(r,c,f,d,w,T,N,$,O,A,o),W=a?x*p:x;let X;return i==="channelsFirst"?X=[l,W,D,B,j]:i==="channelsLast"&&(X=[l,D,B,j,W]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:f,inWidth:d,inChannels:p,outDepth:D,outHeight:B,outWidth:j,outChannels:W,padInfo:_,strideDepth:w,strideHeight:T,strideWidth:N,filterDepth:g,filterHeight:y,filterWidth:v,effectiveFilterDepth:$,effectiveFilterHeight:O,effectiveFilterWidth:A,dilationDepth:C,dilationHeight:E,dilationWidth:R,inShape:t,outShape:X,filterShape:e}}function kte(t,e,n,s,r){s==null&&(s=nk(t,e,n));const a=t[0],i=t[1],o=vp((a-e+2*s)/n+1,r),l=vp((i-e+2*s)/n+1,r);return[o,l]}function Ete(t,e,n,s,r,a){r==null&&(r=nk(t,e[0],s[0]));const i=[0,0,0,n];for(let o=0;o<3;o++)t[o]+2*r>=e[o]&&(i[o]=vp((t[o]-e[o]+2*r)/s[o]+1,a));return i}function nk(t,e,n,s=1){const r=Fc(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function xp(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function jT(t){return typeof t=="number"?[t,t,t]:t}function Fc(t,e){return e<=1?t:t+(t-1)*(e-1)}function $te(t,e,n,s,r,a,i,o,l){let c,f,d;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const g=kte([e,n],a,s,t,o);f=g[0],d=g[1]}else if(t==="same"){f=Math.ceil(e/s),d=Math.ceil(n/r);const p=Math.max(0,(f-1)*s+a-e),g=Math.max(0,(d-1)*r+i-n),y=Math.floor(p/2),v=p-y,x=Math.floor(g/2),w=g-x;c={top:y,bottom:v,left:x,right:w,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},f=Math.ceil((e-a+1)/s),d=Math.ceil((n-i+1)/r);else if(typeof t=="object"){const p=l==="channelsLast"?t[1][0]:t[2][0],g=l==="channelsLast"?t[1][1]:t[2][1],y=l==="channelsLast"?t[2][0]:t[3][0],v=l==="channelsLast"?t[2][1]:t[3][1];c={top:p,bottom:g,left:y,right:v,type:p===0&&g===0&&y===0&&v===0?"VALID":"EXPLICIT"},f=vp((e-a+p+g)/s+1,o),d=vp((n-i+y+v)/r+1,o)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:f,outWidth:d}}function Ite(t,e,n,s,r,a,i,o,l,c,f){let d,p,g,y;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const x=Ete([e,n,s,1],[o,l,c],1,[r,a,i],t,f);p=x[0],g=x[1],y=x[2]}else if(t==="same"){p=Math.ceil(e/r),g=Math.ceil(n/a),y=Math.ceil(s/i);const v=(p-1)*r+o-e,x=(g-1)*a+l-n,w=(y-1)*i+c-s,T=Math.floor(v/2),N=v-T,C=Math.floor(x/2),E=x-C,R=Math.floor(w/2),$=w-R;d={top:C,bottom:E,left:R,right:$,front:T,back:N,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:p,outHeight:g,outWidth:y}}function vp(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Po(t){const[e,n,s]=xp(t);return e===1&&n===1&&s===1}function Kn(t,e){return Po(t)||Po(e)}function ou(t){return xp(t).every(e=>e>0)}function ji(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function xs(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")M(nu(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{M(nu(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ate(t,e){const s={x:z(t,"x","reshape","string_or_numeric")},r={shape:e};return H.runKernel(Am,s,r)}const J=q({reshape_:Ate});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rte(t,e,n,s,r){const a=z(t,"x","avgPool","float32"),i=1;M(Kn(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let o=a,l=!1;a.rank===3&&(l=!0,o=J(a,[1,a.shape[0],a.shape[1],a.shape[2]])),M(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),xs("avgPool",s,r);const c={x:o},f={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let d=H.runKernel(Gp,c,f);return d=Ne(d,a.dtype),l?J(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const qm=q({avgPool_:Rte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dte(t,e,n,s,r,a="NDHWC"){const i=z(t,"x","avgPool3d","float32");let o=i,l=!1;i.rank===4&&(l=!0,o=J(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),M(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),M(a==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),M(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),xs("avgPool3d",s,r);const c={x:o},f={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:a};let d=H.runKernel(Hp,c,f);return d=Ne(d,o.dtype),l?J(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const sk=q({avgPool3d_:Dte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ote(t,e=0){M(t.length>=1,()=>"Pass at least one tensor to concat");const n=yp(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(a=>{if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${a.dtype}. `)}),n.length===1)return Ma(n[0]);const s=n,r={axis:e};return H.runKernel(Zp,s,r)}const an=q({concat_:Ote});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _te(t,e,n=!1,s=!1){let r=z(t,"a","matMul"),a=z(e,"b","matMul");[r,a]=Ht(r,a);const i={a:r,b:a},o={transposeA:n,transposeB:s};return H.runKernel(qp,i,o)}const tt=q({matMul_:_te});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fte(t){const n={x:z(t,"x","sigmoid","float32")};return H.runKernel(Hh,n)}const oa=q({sigmoid_:Fte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lte(t,e,n){const s=z(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},a={begin:e,size:n};return H.runKernel(Fm,r,a)}const ct=q({slice_:Lte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mte(t){const n={x:z(t,"x","tanh","float32")};return H.runKernel(Qh,n)}const Bo=q({tanh_:Mte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zte(t,e,n,s,r,a){const i=z(t,"forgetBias","basicLSTMCell"),o=z(e,"lstmKernel","basicLSTMCell"),l=z(n,"lstmBias","basicLSTMCell"),c=z(s,"data","basicLSTMCell"),f=z(r,"c","basicLSTMCell"),d=z(a,"h","basicLSTMCell"),p=an([c,d],1),g=tt(p,o),y=ve(g,l),v=y.shape[0],x=y.shape[1]/4,w=[v,x],T=ct(y,[0,0],w),N=ct(y,[0,x],w),C=ct(y,[0,x*2],w),E=ct(y,[0,x*3],w),R=ve(Z(oa(T),Bo(N)),Z(f,oa(ve(i,C)))),$=Z(Bo(R),oa(E));return[R,$]}const UP=q({basicLSTMCell_:zte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pte(t,e,n){const s=z(t,"x","batchToSpaceND"),r=e.reduce((o,l)=>o*l);M(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),M(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),M(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const a={x:s},i={blockShape:e,crops:n};return H.runKernel(Xp,a,i)}const Xm=q({batchToSpaceND_:Pte});function Bte(t){let e;return t.rank===0||t.rank===1?e=J(t,[1,1,1,t.size]):t.rank===2?e=J(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=J(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vte(t,e,n,s,r,a){a==null&&(a=.001);const i=z(t,"x","batchNorm"),o=z(e,"mean","batchNorm"),l=z(n,"variance","batchNorm");let c;r!=null&&(c=z(r,"scale","batchNorm"));let f;s!=null&&(f=z(s,"offset","batchNorm")),M(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),M(f==null||o.rank===f.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),M(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const p={x:Bte(i),scale:c,offset:f,mean:o,variance:l},g={varianceEpsilon:a},y=H.runKernel(im,p,g);return J(y,i.shape)}const tf=q({batchNorm_:Vte});function Ute(t,e,n,s,r,a){const i=z(t,"x","batchNorm"),o=z(e,"mean","batchNorm"),l=z(n,"variance","batchNorm");let c;r!=null&&(c=z(r,"scale","batchNorm"));let f;return s!=null&&(f=z(s,"offset","batchNorm")),M(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),M(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),M(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&M(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),f!=null&&M(f.rank===2||f.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${f.rank}.`),tf(i,o,l,f,c,a)}const rk=q({batchNorm2d_:Ute});function jte(t,e,n,s,r,a){const i=z(t,"x","batchNorm"),o=z(e,"mean","batchNorm"),l=z(n,"variance","batchNorm");let c;r!=null&&(c=z(r,"scale","batchNorm"));let f;return s!=null&&(f=z(s,"offset","batchNorm")),M(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),M(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),M(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&M(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),f!=null&&M(f.rank===3||f.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${f.rank}.`),tf(i,o,l,f,c,a)}const ak=q({batchNorm3d_:jte});function Wte(t,e,n,s,r,a){const i=z(t,"x","batchNorm"),o=z(e,"mean","batchNorm"),l=z(n,"variance","batchNorm");let c;r!=null&&(c=z(r,"scale","batchNorm"));let f;return s!=null&&(f=z(s,"offset","batchNorm")),M(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),M(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),M(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&M(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),f!=null&&M(f.rank===4||f.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${f.rank}.`),tf(i,o,l,f,c,a)}const ik=q({batchNorm4d_:Wte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gte(t,e,n){const s=z(t,"x","bincount"),r=z(e,"weights","bincount");M(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),M(n>=0,()=>`size must be non-negative, but got ${n}.`),M(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const a={x:s,weights:r},i={size:n};return H.runKernel(hb,a,i)}const ok=q({bincount_:Gte});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hte(t,e){const n=z(t,"x","bitwiseAnd"),s=z(e,"y","bitwiseAnd");if(!at(n.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${s.shape}`);if(n.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${s.dtype}`);const r={a:n,b:s};return H.runKernel(Kp,r)}const jP=q({bitwiseAnd_:Hte});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qte(t,e){const n=z(t,"s0","broadcastArgs","int32"),s=z(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:n,s1:s};return H.runKernel(fb,r)}const WP=q({broadcastArgs_:qte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xte(t,e){let n=z(t,"broadcastTo","x");const s=n.shape;if(Ys(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=J(n,c)}const r=n.shape,a=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])a[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(a.map((c,f)=>c>1?f:-1).filter(c=>c>=0).length===0)return Ma(n);const o={x:n},l={reps:a};return H.runKernel(Jh,o,l)}const Yl=q({broadcastTo_:Xte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kte(t){const n={x:z(t,"x","ceil","float32")};return H.runKernel(ph,n)}const lk=q({ceil_:Kte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eu(t,e,n){Ys(t),n=n||Cu(e);const s={shape:t,value:e,dtype:n};return H.runKernel($b,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yte(t,e,n){const s=z(t,"x","clipByValue");if(M(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Eu(s.shape,e,s.dtype);const r={x:s},a={clipValueMin:e,clipValueMax:n};return H.runKernel(mh,r,a)}const Ds=q({clipByValue_:Yte});function Zte(t){return an(t,0)}const uk=q({concat1d_:Zte});function Qte(t,e){return an(t,e)}const ck=q({concat2d_:Qte});function Jte(t,e){return an(t,e)}const hk=q({concat3d_:Jte});function ene(t,e){return an(t,e)}const fk=q({concat4d_:ene});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tne(t,e,n,s,r="NHWC",a=[1,1],i){const o=z(t,"x","conv2d","float32"),l=z(e,"filter","conv2d","float32");let c=o,f=!1;o.rank===3&&(f=!0,c=J(o,[1,o.shape[0],o.shape[1],o.shape[2]])),M(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),M(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),xs("conv2d",s,i);const d=r==="NHWC"?c.shape[3]:c.shape[1];M(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),M(Kn(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),M(ou(a),()=>"Error in conv2D: Dilated rates should be larger than 0."),M(ou(n),()=>"Error in conv2D: Strides should be larger than 0.");const p={x:c,filter:l},g={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i},y=H.runKernel(Qp,p,g);return f?J(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const _i=q({conv2d_:tne});function nne(t,e,n,s,r="NWC",a=1,i){const o=z(t,"x","conv1d"),l=z(e,"filter","conv1d");let c=o,f=!1;o.rank===2&&(f=!0,c=J(o,[1,o.shape[0],o.shape[1]])),M(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),M(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),xs("conv1d",s,i),M(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),M(Kn(n,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${a}'`),M(ou(a),()=>"Error in conv1D: Dilated rates should be larger than 0."),M(ou(n),()=>"Error in conv1D: Stride should be larger than 0."),M(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const d=J(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=J(c,[c.shape[0],1,c.shape[1],c.shape[2]]),x=_i(p,d,[1,n],s,"NHWC",[1,a],i);return f?J(x,[x.shape[2],x.shape[3]]):J(x,[x.shape[0],x.shape[2],x.shape[3]])}const yx=q({conv1d_:nne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sne(t,e,n,s,r,a="NHWC",i){M(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,l=e,c=!1;e.rank===3&&(c=!0,l=J(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,t[0],t[1],t[2]]),M(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),M(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),M(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const f=a==="NHWC"?o[3]:o[1],d=a==="NHWC"?l.shape[3]:l.shape[1];M(f===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${f}) must match input depth for filter ${n.shape[2]}.`),M(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),xs("conv2dDerInput",r,i);const p={dy:l,filter:n},g={strides:s,pad:r,dataFormat:a,dimRoundingMode:i,inputShape:o},y=H.runKernel(Jp,p,g);return c?J(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const dk=q({conv2DBackpropInput_:sne});function rne(t,e,n,s,r,a){const i=z(t,"x","conv2dTranspose"),o=z(e,"filter","conv2dTranspose");return dk(n,i,o,s,r,"NHWC",a)}const bx=q({conv2dTranspose_:rne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ane(t,e,n,s,r="NDHWC",a=[1,1,1]){const i=z(t,"x","conv3d"),o=z(e,"filter","conv3d");let l=i,c=!1;i.rank===4&&(c=!0,l=J(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),M(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),M(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),M(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),M(Kn(n,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),M(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),M(ou(a),()=>"Error in conv3D: Dilated rates should be larger than 0."),M(ou(n),()=>"Error in conv3D: Strides should be larger than 0.");const f={x:l,filter:o},d={strides:n,pad:s,dataFormat:r,dilations:a},p=H.runKernel(em,f,d);return c?J(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const pk=q({conv3d_:ane});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ine(t,e,n,s,r){M(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,i=e,o=!1;e.rank===4&&(o=!0,i=J(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,t[0],t[1],t[2],t[3]]);const l=a[4],c=i.shape[4];M(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),M(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),M(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),M(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),M(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const f={dy:i,filter:n},d={pad:r,strides:s,inputShape:a},p=H.runKernel(gb,f,d);return o?J(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const GP=q({conv3DBackpropInput_:ine});function one(t,e,n,s,r){const a=z(t,"x","conv3dTranspose"),i=z(e,"filter","conv3dTranspose");return GP(n,a,i,s,r)}const mk=q({conv3dTranspose_:one});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lne(t){const n={x:z(t,"x","cos","float32")};return H.runKernel(gh,n)}const Km=q({cos_:lne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function une(t){const n={x:z(t,"x","cosh","float32")};return H.runKernel(yh,n)}const xx=q({cosh_:une});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cne(t,e=0,n=!1,s=!1){const a={x:z(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:s};return H.runKernel(yb,a,i)}const wp=q({cumprod_:cne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hne(t,e=0,n=!1,s=!1){const a={x:z(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:s};return H.runKernel(tm,a,i)}const vx=q({cumsum_:hne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fne(t,e,n,s=!1){const r=z(t,"x","denseBincount"),a=z(e,"weights","denseBincount");M(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),M(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),M(n>=0,()=>`size must be non-negative, but got ${n}.`),M(a.size===r.size||a.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${a.shape}.`);const i={x:r,weights:a},o={size:n,binaryOutput:s};return H.runKernel(xb,i,o)}const S1=q({denseBincount_:fne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dne(t,e,n="NHWC"){const s=z(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],a=n==="NHWC"?s.shape[2]:s.shape[3],i=n==="NHWC"?s.shape[3]:s.shape[1];M(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),M(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),M(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${e} for depthToSpace with input shape
        ${s.shape}`),M(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${s.shape}`);const o={x:s},l={blockSize:e,dataFormat:n};return H.runKernel(vb,o,l)}const gk=q({depthToSpace_:dne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pne(t,e,n,s,r="NHWC",a=[1,1],i){const o=z(t,"x","depthwiseConv2d","float32"),l=z(e,"filter","depthwiseConv2d","float32");let c=o,f=!1;o.rank===3&&(f=!0,c=J(o,[1,o.shape[0],o.shape[1],o.shape[2]])),M(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),M(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=r==="NHWC"?c.shape[3]:c.shape[1];M(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),xs("depthwiseConv2d",s,i);const p={x:c,filter:l},g={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i},y=H.runKernel(nm,p,g);return f?J(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const nf=q({depthwiseConv2d_:pne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mne(t){const n={x:z(t,"x","diag")};return H.runKernel(Tb,n)}const HP=q({diag_:mne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gne(t,e,n,s,r=[1,1],a="NHWC"){const i=z(t,"x","dilation2d"),o=z(e,"filter","dilation2d");M(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),M(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),M(a==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let l=i,c=!1;i.rank===3&&(l=J(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0),M(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);const f={x:l,filter:o},d={strides:n,pad:s,dilations:r},p=H.runKernel(sm,f,d);return c?J(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const yk=q({dilation2d_:gne});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lu(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const a=n-1-r,i=t[a]||1;(e[e.length-1-r]||1)>1&&i===1&&s.unshift(a)}return s}function bn(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],a=e.length-s-1,i=e[a];(r==null||r===1&&i>1)&&n.unshift(a)}return n}function Ke(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let r=0;r<n;r++){let a=t[t.length-r-1];a==null&&(a=1);let i=e[e.length-r-1];if(i==null&&(i=1),a===1)s[n-r-1]=i;else if(i===1)s[n-r-1]=a;else if(a!==i){const o=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(o)}else s[n-r-1]=a}return s}const yne=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:Ke,getBroadcastDims:lu,getReductionAxes:bn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bne(t,e){let n=z(t,"a","equal","string_or_numeric"),s=z(e,"b","equal","string_or_numeric");[n,s]=Ht(n,s),Ke(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(rm,r)}const Hs=q({equal_:bne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xne(t,e,n){const s=z(e,"a","where"),r=z(n,"b","where"),a=z(t,"condition","where","bool"),i=Ke(Ke(a.shape,s.shape),r.shape),o=Yl(a,i),l=Yl(s,i),c=Yl(r,i),f={condition:o,t:l,e:c};return H.runKernel(_m,f)}const Dn=q({where_:xne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vne(t){const n={x:z(t,"x","zerosLike")};return H.runKernel(jm,n)}const ht=q({zerosLike_:vne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wne(t,e){let n=z(t,"a","div"),s=z(e,"b","div");[n,s]=Ht(n,s);const r=Le(n,s),a=ht(r),i=Hs(s,a);return Dn(i,a,r)}const bk=q({divNoNan_:wne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sne(t,e){const n=z(t,"t1","dot"),s=z(e,"t2","dot");M((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],a=s.rank===1?s.size:s.shape[0];if(M(r===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${a}.`),n.rank===1&&s.rank===1){const i=J(n,[1,-1]),o=J(s,[-1,1]),l=tt(i,o);return J(l,[])}else if(n.rank===1&&s.rank===2){const i=J(n,[1,-1]),o=J(s,[s.shape[0],s.shape[1]]),l=tt(i,o);return J(l,[l.size])}else if(n.rank===2&&s.rank===1){const i=J(s,[-1,1]),o=tt(n,i);return J(o,[o.size])}else{const i=J(s,[s.shape[0],s.shape[1]]);return tt(n,i)}}const xk=q({dot_:Sne});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tne(t,...e){const n=e.map((r,a)=>z(r,`tensors${a}`,"einsum")),s={equation:t};return H.runKernel(Nb,n,s)}const Ml=q({einsum_:Tne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cne(t){const n={x:z(t,"x","elu","float32")};return H.runKernel(xh,n)}const sf=q({elu_:Cne});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nne(t,e){const n=z(t,"x","ensureShape","string_or_numeric");if(!tP(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const qP=q({ensureShape_:Nne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kne(t){let e=z(t,"x","erf");M(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Ne(e,"float32"));const n={x:e};return H.runKernel(vh,n)}const wx=q({erf_:kne});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vk(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function XP(t,e,n){const s=t.length+e.length,r=[];let a=0,i=0;for(let o=0;o<s;o++)n.indexOf(o)===-1?r.push(t[a++]):r.push(e[i++]);return r}function Mn(t,e){const n=[],s=t.length;for(let a=0;a<s;a++)e.indexOf(a)===-1&&n.push(t[a]);const r=e.map(a=>t[a]);return[n,r]}function on(t,e){const n=e.map(s=>1);return XP(t,n,e)}function Yn(t,e,n){M(vk(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function qt(t,e){if(vk(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function Qo(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function un(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ene(t,e=null,n=!1){const r={x:z(t,"x","max")},a={reductionIndices:e,keepDims:n};return H.runKernel(gm,r,a)}const mr=q({max_:Ene});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ne(t,e=null,n=!1){const r={x:z(t,"x","min")},a={axis:e,keepDims:n};return H.runKernel(vm,r,a)}const jc=q({min_:$ne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ine(t,e){let n=z(t,"base","pow"),s=z(e,"exp","pow");[n,s]=Ht(n,s);const r={a:n,b:s};return H.runKernel(Lh,r)}const Wa=q({pow_:Ine});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pe(t,e){if((Sn(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Sn(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Yo(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ane(t){const n={x:z(t,"x","sqrt","float32")};return H.runKernel(Xh,n)}const _n=q({sqrt_:Ane});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rne(t){const e=z(t,"x","square"),n={};return H.runKernel("Square",{x:e},n)}const kt=q({square_:Rne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dne(t,e=null,n=!1){let s=z(t,"x","sum");s.dtype==="bool"&&(s=Ne(s,"int32"));const r={x:s},a={axis:e,keepDims:n};return H.runKernel(Lm,r,a)}const Oe=q({sum_:Dne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function One(t,e="euclidean",n=null,s=!1){t=z(t,"x","norm");const r=KP(t,e,n);let a=r.shape;if(s){const i=nt(n,t.shape);a=on(r.shape,i)}return J(r,a)}function KP(t,e,n=null){if(t.rank===0)return pn(t);if(t.rank!==1&&n===null)return KP(J(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Oe(pn(t),n);if(e===1/0)return mr(pn(t),n);if(e===-1/0)return jc(pn(t),n);if(e==="euclidean"||e===2)return _n(Oe(Wa(pn(t),Pe(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return mr(Oe(pn(t),n[0]),n[1]-1);if(e===1/0)return mr(Oe(pn(t),n[1]),n[0]);if(e===-1/0)return jc(Oe(pn(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return _n(Oe(kt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const rf=q({norm_:One});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ne(t,e=null,n=!1){return rf(t,"euclidean",e,n)}const wk=q({euclideanNorm_:_ne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fne(t){const n={x:z(t,"x","exp")};return H.runKernel(wh,n)}const Os=q({exp_:Fne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lne(t,e=0){const n=z(t,"x","expandDims","string_or_numeric");M(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return H.runKernel(am,s,r)}const jn=q({expandDims_:Lne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mne(t){const n={x:z(t,"x","expm1")};return H.runKernel(Sh,n)}const Sk=q({expm1_:Mne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zne(t,e){const n=z(t,"x","tile","string_or_numeric");M(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return H.runKernel(Jh,s,r)}const cr=q({tile_:zne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pne(t,e,n,s="float32"){e==null&&(e=t);const r=Qe([t,e],s),a=t<=e?t:e;for(let o=0;o<a;++o)r.set(1,o,o);const i=J(r.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return cr(jn(i,0),[n[0],1,1]);if(n.length===2)return cr(jn(jn(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return cr(jn(jn(jn(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const Sx=q({eye_:Pne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bne(t){const n={x:z(t,"x","floor","float32")};return H.runKernel(Th,n)}const af=q({floor_:Bne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vne(t,e,n=0,s=0){const r=z(t,"x","gather"),a=z(e,"indices","gather","int32"),i={x:r,indices:a},o={axis:n,batchDims:s};return H.runKernel(om,i,o)}const of=q({gather_:Vne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Une(t,e){let n=z(t,"a","greater","string_or_numeric"),s=z(e,"b","greater","string_or_numeric");[n,s]=Ht(n,s),Ke(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(lm,r)}const vs=q({greater_:Une});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jne(t,e){let n=z(t,"a","greaterEqual","string_or_numeric"),s=z(e,"b","greaterEqual","string_or_numeric");[n,s]=Ht(n,s),Ke(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(Nh,r)}const Wi=q({greaterEqual_:jne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wne(t){const n={input:z(t,"input","imag")};return H.runKernel(Db,n)}const Ym=q({imag_:Wne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gne(t){const n={x:z(t,"x","isFinite")};return H.runKernel(Eh,n)}const Tk=q({isFinite_:Gne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hne(t){const n={x:z(t,"x","isInf")};return H.runKernel($h,n)}const Ck=q({isInf_:Hne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qne(t){const n={x:z(t,"x","isNaN")};return H.runKernel(Ih,n)}const Nk=q({isNaN_:qne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xne(t,e=.2){const s={x:z(t,"x","leakyRelu")},r={alpha:e};return H.runKernel(um,s,r)}const Zm=q({leakyRelu_:Xne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kne(t,e){let n=z(t,"a","less","string_or_numeric"),s=z(e,"b","less","string_or_numeric");[n,s]=Ht(n,s),Ke(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(cm,r)}const Wc=q({less_:Kne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yne(t,e){let n=z(t,"a","lessEqual","string_or_numeric"),s=z(e,"b","lessEqual","string_or_numeric");[n,s]=Ht(n,s),Ke(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(hm,r)}const Jo=q({lessEqual_:Yne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YP(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const s={start:t,stop:e,num:n};return H.runKernel(Ob,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zne(t,e=5,n=1,s=1,r=.5){const a=z(t,"x","localResponseNormalization");M(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),M(nu(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=a,o=!1;a.rank===3&&(o=!0,i=J(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const l={x:i},c={depthRadius:e,bias:n,alpha:s,beta:r},f=H.runKernel(mm,l,c);return o?J(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const kk=q({localResponseNormalization_:Zne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qne(t){const n={x:z(t,"x","log","float32")};return H.runKernel(Ah,n)}const qs=q({log_:Qne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jne(t){const n={x:z(t,"x","log1p")};return H.runKernel(Rh,n)}const Qm=q({log1p_:Jne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ese(t){return M(Mo(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const s=z(e,"x","tf.grad","string_or_numeric"),r=n!=null?z(n,"dy","tf.grad"):null;return H.tidy(()=>{const{value:a,grads:i}=H.gradients(()=>t(s),[s],r);return r!=null&&Xn(a.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Tx(i),i[0]})}}function tse(t){return M(Mo(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{M(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=yp(e,"args","tf.grads","string_or_numeric"),r=n!=null?z(n,"dy","tf.grads"):null;return H.tidy(()=>{const{value:a,grads:i}=H.gradients(()=>t(...s),s,r);return r!=null&&Xn(a.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Tx(i),i})}}function nse(t){return M(Mo(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{M(e instanceof gt,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),M(n==null||n instanceof gt,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:r}=H.gradients(()=>t(e),[e],n);return Tx(s),{grad:s[0],value:r}}}function sse(t){return M(Mo(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{M(Array.isArray(e)&&e.every(r=>r instanceof gt),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),M(n==null||n instanceof gt,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=H.gradients(()=>t(...e),e,n);return n!=null&&Xn(s.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Tx(s.grads),s}}function ZP(t,e){M(Mo(t),()=>"The f passed in variableGrads(f) must be a function"),M(e==null||Array.isArray(e)&&e.every(c=>c instanceof gp),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in H.registeredVariables)e.push(H.registeredVariables[c])}const s=n?e.filter(c=>!c.trainable):null,r=e.length;e=e.filter(c=>c.trainable),M(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const a=!0,{value:i,grads:o}=H.gradients(t,e,null,a);M(o.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),M(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((c,f)=>{o[f]!=null&&(l[c.name]=o[f])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:i,grads:l}}function Ga(t){return H.customGrad(t)}function Tx(t){if(t.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rse(t){const n={x:z(t,"x","neg")};return H.runKernel(Sm,n)}const Ft=q({neg_:rse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ase(t){const n={x:z(t,"x","softplus")};return H.runKernel(qh,n)}const $u=q({softplus_:ase});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ise(t){const e=z(t,"x","logSigmoid");return Ga(s=>({value:Ft($u(Ft(s))),gradFunc:i=>Z(i,oa(Ft(s)))}))(e)}const Ek=q({logSigmoid_:ise});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ose(t,e){let n=z(t,"a","sub"),s=z(e,"b","sub");[n,s]=Ht(n,s);const r={a:n,b:s};return H.runKernel(Yh,r)}const Re=q({sub_:ose});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lse(t,e=-1){const n=z(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Ga((r,a)=>{const o=mr(r,e,!0),l=Re(r,o),c=Re(Ne(l,"float32"),qs(Oe(Os(l),e,!0)));return a([c]),{value:c,gradFunc:(d,p)=>{const[g]=p,y=!0,v=Os(g);return Re(d,Z(Oe(d,e,y),v))}}})(n)}const Cx=q({logSoftmax_:lse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function use(t,e=null,n=!1){const s=z(t,"x","logSumExp"),r=nt(e,s.shape),a=mr(s,r,!0),i=Re(s,a),o=Os(i),l=Oe(o,r),c=qs(l),f=ve(J(a,c.shape),c);if(n){const d=on(f.shape,r);return J(f,d)}return f}const Jm=q({logSumExp_:use});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cse(t,e){const n=z(t,"a","logicalAnd","bool"),s=z(e,"b","logicalAnd","bool");Ke(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(fm,r)}const Vr=q({logicalAnd_:cse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hse(t){const n={x:z(t,"x","logicalNot","bool")};return H.runKernel(dm,n)}const eg=q({logicalNot_:hse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fse(t,e){const n=z(t,"a","logicalOr","bool"),s=z(e,"b","logicalOr","bool");Ke(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(pm,r)}const Nx=q({logicalOr_:fse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dse(t,e){const n=z(t,"a","logicalXor","bool"),s=z(e,"b","logicalXor","bool");return Ke(n.shape,s.shape),Vr(Nx(t,e),eg(Vr(t,e)))}const $k=q({logicalXor_:dse});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K0=2147483648;function pse(t,e,n="left"){const s=z(t,"sortedSequence","searchSorted"),r=z(e,"values","searchSorted"),a=s.shape[s.shape.length-1],i=r.shape[r.shape.length-1],o=J(s,[-1,a]),l=J(r,[-1,i]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(de(l.shape)>=K0)throw new Error(`values tensor size must less than ${K0}`);if(o.shape[1]>=K0)throw new Error(`trailing dim_size must less than ${K0} for int32 output type, was ${o.shape[1]}`);const c={sortedSequence:o,values:l},f={side:n};return H.runKernel(Zb,c,f)}const kx=q({searchSorted_:pse});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QP(t,e){return kx(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mse(t,e,n,s,r){const a=z(t,"x","maxPool"),i=1;let o=a,l=!1;a.rank===3&&(l=!0,o=J(a,[1,a.shape[0],a.shape[1],a.shape[2]])),M(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),M(Kn(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),xs("maxPool",s,r);const c={x:o},f={filterSize:e,strides:n,pad:s,dimRoundingMode:r},d=H.runKernel(ym,c,f);return l?J(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const tg=q({maxPool_:mse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gse(t,e=[1,1,1],n,s,r,a="NDHWC"){const i=z(t,"x","maxPool3d");let o=i,l=!1;i.rank===4&&(l=!0,o=J(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),M(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),M(a==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),xs("maxPool3d",s,r);const c={x:o},f={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:a},d=H.runKernel(bm,c,f);return l?J(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Ik=q({maxPool3d_:gse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yse(t,e,n,s,r=!1){const i={x:z(t,"x","maxPoolWithArgmax")},o={filterSize:e,strides:n,pad:s,includeBatchInIndex:r},l=H.runKernel(Mb,i,o);return{result:l[0],indexes:l[1]}}const JP=q({maxPoolWithArgmax_:yse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bse(t,e){let n=z(t,"a","maximum"),s=z(e,"b","maximum");[n,s]=Ht(n,s),n.dtype==="bool"&&(n=Ne(n,"int32"),s=Ne(s,"int32")),Ke(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(Dh,r)}const Xa=q({maximum_:bse});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xse(t,e=null,n=!1){const r={x:z(t,"x","mean")},a={axis:e,keepDims:n};return H.runKernel(xm,r,a)}const Wt=q({mean_:xse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mn(t,e="float32"){if(Ys(t),e==="complex64"){const s=mn(t,"float32"),r=mn(t,"float32");return Oi(s,r)}const n=qn(de(t),e);return H.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $s(t,e="float32"){if(Ys(t),e==="complex64"){const s=$s(t,"float32"),r=mn(t,"float32");return Oi(s,r)}const n=ib(de(t),e);return H.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e6(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let s=z(t,"x","meshgrid",t instanceof gt?t.dtype:"float32");if(e===void 0)return[s];let r=z(e,"y","meshgrid",e instanceof gt?e.dtype:"float32");const a=de(s.shape),i=de(r.shape);return n==="xy"?(s=J(s,[1,-1]),r=J(r,[-1,1]),[tt($s([i,1],s.dtype),s),tt(r,$s([1,a],r.dtype))]):(s=J(s,[-1,1]),r=J(r,[1,-1]),[tt(s,$s([1,i],s.dtype)),tt($s([a,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vse(t,e){let n=z(t,"a","minimum"),s=z(e,"b","minimum");[n,s]=Ht(n,s),n.dtype==="bool"&&(n=Ne(n,"int32"),s=Ne(s,"int32")),Ke(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(Oh,r)}const Vo=q({minimum_:vse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wse(t,e,n){M(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=z(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");M(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let o=0;o<s.rank;o++)M(e[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),M(e[o][0]>=0&&e[o][0]<=s.shape[o]-r&&e[o][1]>=0&&e[o][1]<=s.shape[o]-r,()=>`Padding in dimension ${o} cannot be greater than or equal to ${s.shape[o]-r} or less than 0 for input of shape ${s.shape}`);const a={paddings:e,mode:n},i={x:s};return H.runKernel(wm,i,a)}const Ak=q({mirrorPad_:wse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sse(t,e){let n=z(t,"a","mod"),s=z(e,"b","mod");[n,s]=Ht(n,s);const r={a:n,b:s};return H.runKernel(_h,r)}const Rk=q({mod_:Sse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tse(t,e=null,n=!1){t=z(t,"x","moments");const s=nt(e,t.shape),r=Wt(t,s,n);let a=r.shape;n||(a=on(r.shape,s));const i=kt(Re(Ne(t,"float32"),J(r,a))),o=Wt(i,s,n);return{mean:r,variance:o}}const ng=q({moments_:Tse});function Cse(t,e,n,s){const r=z(e,"data","multiRNNCell"),a=yp(n,"c","multiRNNCell"),i=yp(s,"h","multiRNNCell");let o=r;const l=[];for(let d=0;d<t.length;d++){const p=t[d](o,a[d],i[d]);l.push(p[0]),l.push(p[1]),o=p[1]}const c=[],f=[];for(let d=0;d<l.length;d+=2)c.push(l[d]),f.push(l[d+1]);return[c,f]}const t6=q({multiRNNCell_:Cse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nse(t,e,n,s=!1){const r=z(t,"logits","multinomial"),a=r.size,i=r.rank;if(a<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${a}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);n=n||Math.random();const l={logits:i===1?J(r,[1,-1]):r},c={numSamples:e,seed:n,normalized:s},f=H.runKernel(zb,l,c);return i===1?J(f,[f.size]):f}const n6=q({multinomial_:Nse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kse(t,e){let n=z(t,"a","notEqual","string_or_numeric"),s=z(e,"b","notEqual","string_or_numeric");[n,s]=Ht(n,s),Ke(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(Tm,r)}const uu=q({notEqual_:kse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ese(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:z(t,"indices","oneHot","int32")},o={dtype:r,depth:e,onValue:n,offValue:s};return H.runKernel(Nm,i,o)}const Gc=q({oneHot_:Ese});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $se(t){const n={x:z(t,"x","onesLike")};return H.runKernel(Cm,n)}const Xs=q({onesLike_:$se});function Ise(t,e){const n=z(t,"v1","outerProduct"),s=z(e,"v2","outerProduct");M(n.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${s.rank}.`);const r=J(n,[-1,1]),a=J(s,[1,-1]);return tt(r,a)}const s6=q({outerProduct_:Ise});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ase(t,e,n=0){const s=z(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},a={x:s};return H.runKernel(Em,a,r)}const Gi=q({pad_:Ase});function Rse(t,e,n=0){return M(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Gi(t,[e],n)}const r6=q({pad1d_:Rse});function Dse(t,e,n=0){return M(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Gi(t,e,n)}const a6=q({pad2d_:Dse});function Ose(t,e,n=0){return M(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Gi(t,e,n)}const i6=q({pad3d_:Ose});function _se(t,e,n=0){return M(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Gi(t,e,n)}const o6=q({pad4d_:_se});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fse(t,e,n){const s=z(t,"x","spaceToBatchND");M(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),M(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),M(s.shape.reduce((i,o,l)=>l>0&&l<=e.length?i&&(o+n[l-1][0]+n[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},a={blockShape:e,paddings:n};return H.runKernel(Mm,r,a)}const sg=q({spaceToBatchND_:Fse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lse(t,e,n,s,r,a,i){r==null&&(r=[1,1]),a==null&&(a=1),s===0&&(s="valid");const o=z(t,"x","maxPool");let l=o,c=!1;o.rank===3&&(c=!0,l=J(o,[1,o.shape[0],o.shape[1],o.shape[2]])),M(Kn(a,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${r}'`);const f=Ur(l.shape,e,a,r,s),d=[f.dilationHeight,f.dilationWidth];let p;s==="same"?p=zse([f.filterHeight,f.filterWidth],d):p=[[0,0],[0,0]];const g=d[0]===1&&d[1]===1,[y,v]=Mse([f.inHeight,f.inWidth],d,p),x=g?s:"valid",w=g?l:sg(l,d,y),N=(n==="avg"?()=>qm(w,e,a,x,i):()=>tg(w,e,a,x,i))(),C=g?N:Xm(N,d,v);return c?J(C,[C.shape[1],C.shape[2],C.shape[3]]):C}function Mse(t,e,n){const s=n.map(f=>f[0]),r=n.map(f=>f[1]),a=t.concat(s,r),i=e.map((f,d)=>(f-a[d]%f)%f),o=r.map((f,d)=>f+i[d]),l=e.map((f,d)=>[s[d],o[d]]),c=e.map((f,d)=>[0,i[d]]);return[l,c]}function zse(t,e){const s=t.map((i,o)=>i+(i-1)*(e[o]-1)).map(i=>i-1),r=s.map(i=>Math.floor(i/2)),a=s.map((i,o)=>i-r[o]);return s.map((i,o)=>[r[o],a[o]])}const Dk=q({pool_:Lse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pse(t,e){const n=z(t,"x","prelu"),s=z(e,"alpha","prelu"),r={x:n,alpha:s};return H.runKernel($m,r)}const rg=q({prelu_:Pse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bse(t,e=null,n=!1){let s=z(t,"x","prod");s.dtype==="bool"&&(s=Ne(s,"int32"));const r={x:s},a={axis:e,keepDims:n};return H.runKernel(Im,r,a)}const Ok=q({prod_:Bse});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vse(t,e,n,s){const r=t.map((f,d)=>z(f,`tensors${d}`,"raggedGather","int32")),a=z(e,"paramsDenseValues","raggedGather"),i=z(n,"indices","raggedGather","int32"),o={paramsNestedSplits:r,paramsDenseValues:a,indices:i},l={outputRaggedRank:s},c=H.runKernel(Ub,o,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const l6=q({raggedGather_:Vse});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Use(t,e,n){const s=z(t,"starts","raggedRange"),r=z(e,"limits","raggedRange",s.dtype),a=z(n,"deltas","raggedRange",s.dtype),i={starts:s,limits:r,deltas:a},o=H.runKernel(jb,i);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}const u6=q({raggedRange_:Use});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jse(t,e,n,s,r){const a=z(t,"shape","raggedTensorToTensor","int32"),i=z(e,"values","raggedTensorToTensor"),o=z(n,"defaultValue","raggedTensorToTensor",i.dtype),l=s.map((d,p)=>z(d,`tensors${p}`,"raggedTensorToTensor","int32")),c={shape:a,values:i,defaultValue:o,rowPartitionTensors:l},f={rowPartitionTypes:r};return H.runKernel(Wb,c,f)}const c6=q({raggedTensorToTensor_:jse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wse(t,e,n){Ys(t);const s=de(t);let r=null;if(n==null||n==="float32")r=new Float32Array(s);else if(n==="int32")r=new Int32Array(s);else if(n==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${n}`);for(let a=0;a<s;a++)r[a]=e();return H.makeTensor(r,t,n)}const h6=q({rand_:Wse});var by={exports:{}},Gse=by.exports,Q_;function Hse(){return Q_||(Q_=1,function(t){(function(e,n,s){function r(l){var c=this,f=o();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=f(" "),c.s1=f(" "),c.s2=f(" "),c.s0-=f(l),c.s0<0&&(c.s0+=1),c.s1-=f(l),c.s1<0&&(c.s1+=1),c.s2-=f(l),c.s2<0&&(c.s2+=1),f=null}function a(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function i(l,c){var f=new r(l),d=c&&c.state,p=f.next;return p.int32=function(){return f.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,d&&(typeof d=="object"&&a(d,f),p.state=function(){return a(f,{})}),p}function o(){var l=4022871197,c=function(f){f=String(f);for(var d=0;d<f.length;d++){l+=f.charCodeAt(d);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=i:this.alea=i})(Gse,t)}(by)),by.exports}var xy={exports:{}},qse=xy.exports,J_;function Xse(){return J_||(J_=1,function(t){(function(e,n,s){function r(o){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},o===(o|0)?l.x=o:c+=o;for(var f=0;f<c.length+64;f++)l.x^=c.charCodeAt(f)|0,l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xor128=i})(qse,t)}(xy)),xy.exports}var vy={exports:{}},Kse=vy.exports,e4;function Yse(){return e4||(e4=1,function(t){(function(e,n,s){function r(o){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:c+=o;for(var f=0;f<c.length+64;f++)l.x^=c.charCodeAt(f)|0,f==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xorwow=i})(Kse,t)}(vy)),vy.exports}var wy={exports:{}},Zse=wy.exports,t4;function Qse(){return t4||(t4=1,function(t){(function(e,n,s){function r(o){var l=this;l.next=function(){var f=l.x,d=l.i,p,g;return p=f[d],p^=p>>>7,g=p^p<<24,p=f[d+1&7],g^=p^p>>>10,p=f[d+3&7],g^=p^p>>>3,p=f[d+4&7],g^=p^p<<7,p=f[d+7&7],p=p^p<<13,g^=p^p<<9,f[d]=g,l.i=d+1&7,g};function c(f,d){var p,g=[];if(d===(d|0))g[0]=d;else for(d=""+d,p=0;p<d.length;++p)g[p&7]=g[p&7]<<15^d.charCodeAt(p)+g[p+1&7]<<13;for(;g.length<8;)g.push(0);for(p=0;p<8&&g[p]===0;++p);for(p==8?g[7]=-1:g[p],f.x=g,f.i=0,p=256;p>0;--p)f.next()}c(l,o)}function a(o,l){return l.x=o.x.slice(),l.i=o.i,l}function i(o,l){o==null&&(o=+new Date);var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(f.x&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xorshift7=i})(Zse,t)}(wy)),wy.exports}var Sy={exports:{}},Jse=Sy.exports,n4;function ere(){return n4||(n4=1,function(t){(function(e,n,s){function r(o){var l=this;l.next=function(){var f=l.w,d=l.X,p=l.i,g,y;return l.w=f=f+1640531527|0,y=d[p+34&127],g=d[p=p+1&127],y^=y<<13,g^=g<<17,y^=y>>>15,g^=g>>>12,y=d[p]=y^g,l.i=p,y+(f^f>>>16)|0};function c(f,d){var p,g,y,v,x,w=[],T=128;for(d===(d|0)?(g=d,d=null):(d=d+"\0",g=0,T=Math.max(T,d.length)),y=0,v=-32;v<T;++v)d&&(g^=d.charCodeAt((v+32)%d.length)),v===0&&(x=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,v>=0&&(x=x+1640531527|0,p=w[v&127]^=g+x,y=p==0?y+1:0);for(y>=128&&(w[(d&&d.length||0)&127]=-1),y=127,v=4*128;v>0;--v)g=w[y+34&127],p=w[y=y+1&127],g^=g<<13,p^=p<<17,g^=g>>>15,p^=p>>>12,w[y]=g^p;f.w=x,f.X=w,f.i=y}c(l,o)}function a(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function i(o,l){o==null&&(o=+new Date);var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(f.X&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xor4096=i})(Jse,t)}(Sy)),Sy.exports}var Ty={exports:{}},tre=Ty.exports,s4;function nre(){return s4||(s4=1,function(t){(function(e,n,s){function r(o){var l=this,c="";l.next=function(){var d=l.b,p=l.c,g=l.d,y=l.a;return d=d<<25^d>>>7^p,p=p-g|0,g=g<<24^g>>>8^y,y=y-d|0,l.b=d=d<<20^d>>>12^p,l.c=p=p-g|0,l.d=g<<16^p>>>16^y,l.a=y-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):c+=o;for(var f=0;f<c.length+20;f++)l.b^=c.charCodeAt(f)|0,l.next()}function a(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.tychei=i})(tre,t)}(Ty)),Ty.exports}var Cy={exports:{}};const sre={},rre=Object.freeze(Object.defineProperty({__proto__:null,default:sre},Symbol.toStringTag,{value:"Module"})),Ex=DC(rre);var are=Cy.exports,r4;function ire(){return r4||(r4=1,function(t){(function(e,n,s){var r=256,a=6,i=52,o="random",l=s.pow(r,a),c=s.pow(2,i),f=c*2,d=r-1,p;function g(C,E,R){var $=[];E=E==!0?{entropy:!0}:E||{};var O=w(x(E.entropy?[C,N(n)]:C??T(),3),$),A=new y($),_=function(){for(var D=A.g(a),B=l,j=0;D<c;)D=(D+j)*r,B*=r,j=A.g(1);for(;D>=f;)D/=2,B/=2,j>>>=1;return(D+j)/B};return _.int32=function(){return A.g(4)|0},_.quick=function(){return A.g(4)/4294967296},_.double=_,w(N(A.S),n),(E.pass||R||function(D,B,j,W){return W&&(W.S&&v(W,A),D.state=function(){return v(A,{})}),j?(s[o]=D,B):D})(_,O,"global"in E?E.global:this==s,E.state)}function y(C){var E,R=C.length,$=this,O=0,A=$.i=$.j=0,_=$.S=[];for(R||(C=[R++]);O<r;)_[O]=O++;for(O=0;O<r;O++)_[O]=_[A=d&A+C[O%R]+(E=_[O])],_[A]=E;($.g=function(D){for(var B,j=0,W=$.i,X=$.j,U=$.S;D--;)B=U[W=d&W+1],j=j*r+U[d&(U[W]=U[X=d&X+B])+(U[X]=B)];return $.i=W,$.j=X,j})(r)}function v(C,E){return E.i=C.i,E.j=C.j,E.S=C.S.slice(),E}function x(C,E){var R=[],$=typeof C,O;if(E&&$=="object")for(O in C)try{R.push(x(C[O],E-1))}catch{}return R.length?R:$=="string"?C:C+"\0"}function w(C,E){for(var R=C+"",$,O=0;O<R.length;)E[d&O]=d&($^=E[d&O]*19)+R.charCodeAt(O++);return N(E)}function T(){try{var C;return p&&(C=p.randomBytes)?C=C(r):(C=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(C)),N(C)}catch{var E=e.navigator,R=E&&E.plugins;return[+new Date,e,R,e.screen,N(n)]}}function N(C){return String.fromCharCode.apply(0,C)}if(w(s.random(),n),t.exports){t.exports=g;try{p=Ex}catch{}}else s["seed"+o]=g})(typeof self<"u"?self:are,[],Math)}(Cy)),Cy.exports}var CS,a4;function ore(){if(a4)return CS;a4=1;var t=Hse(),e=Xse(),n=Yse(),s=Qse(),r=ere(),a=nre(),i=ire();return i.alea=t,i.xor128=e,i.xorwow=n,i.xorshift7=s,i.xor4096=r,i.tychei=a,CS=i,CS}var _k=ore();/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lre=.001,f6=.1;function ure(t,e,n){return n==null&&(n=Fk()),WT(t,e,(s,r)=>Lk(s,r,n))}function Fk(){return H.backend.floatPrecision()===32?lre:f6}function WT(t,e,n){let s=!0;if((Sn(t)||Sn(e))&&(s=!1),Sn(t)&&Sn(e)&&(s=!0),s){const i=t.constructor.name,o=e.constructor.name;if(i!==o)throw new Error(`Arrays are of different type. Actual: ${i}. Expected: ${o}`)}if(Array.isArray(t)&&Array.isArray(e)){const i=ja(t),o=ja(e);if(!at(i,o))throw new Error(`Arrays have different shapes. Actual: [${i}]. Expected: [${o}]`)}const r=Sn(t)?t:Ua(t),a=Sn(e)?e:Ua(e);if(r.length!==a.length)throw new Error(`Arrays have different lengths actual: ${r.length} vs expected: ${a.length}.
Actual:   ${r}.
Expected: ${a}.`);for(let i=0;i<a.length;++i){const o=r[i],l=a[i];if(!n(o,l))throw new Error(`Arrays differ: actual[${i}] = ${o}, expected[${i}] = ${l}.
Actual:   ${r}.
Expected: ${a}.`)}typeof expect<"u"&&expect().nothing()}function cre(t,e){t().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function hre(t,e){const n=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return Da(t)||Da(t[0])||Da(e)||Da(e[0])?WT(t,n,(s,r)=>s==r):WT(t,e,(s,r)=>Lk(s,r,0))}function fre(t,e,n){if(n==null&&(n=Fk()),!Lk(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function Lk(t,e,n){return!isFinite(t)&&!isFinite(e)?!0:!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function dre(t,e,n){for(let s=0;s<t.length;s++)if(t[s]<e||t[s]>n)throw new Error(`Value out of range:${t[s]} low: ${e}, high: ${n}`)}function pre(t,e){const n=new Float32Array(t),s=new Float32Array(e);if(n.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${n.length}`);for(let r=0;r<s.length;r++)if(n[r]!==s[r])throw new Error(`Expected ArrayBuffer value at ${r} to be ${s[r]} but got ${n[r]} instead`)}function d6(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?d6(n):t[e]=La(n)}return t}function mre(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise(n=>{e.addEventListener("loadeddata",s=>n(e)),e.load()})}async function gre(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise(e=>{t.requestVideoFrameCallback(e)})}const yre=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:f6,createVideoElement:mre,encodeStrings:d6,expectArrayBuffersEqual:pre,expectArraysClose:ure,expectArraysEqual:hre,expectNumbersClose:fre,expectPromiseToFail:cre,expectValuesInRange:dre,play:gre,testEpsilon:Fk},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mk{constructor(e,n,s,r,a){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=a||Math.random();this.random=_k.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,a,i;do r=2*this.random()-1,a=2*this.random()-1,i=r*r+a*a;while(i>=1||i===0);const o=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*r*o,n=this.mean+this.stdDev*a*o,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class bre{constructor(e,n,s,r){this.alpha=e,this.beta=1/n,this.dtype=s;const a=r||Math.random();this.randu=_k.alea(a.toString()),this.randn=new Mk(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,s,r,a,i;for(;;){do r=this.randn.nextValue(),i=1+this.c*r;while(i<=0);if(i*=i*i,e=r*r,n=1-.331*e*e,s=.5*e+this.d*(1-i+Math.log(i)),a=this.randu(),a<n||Math.log(a)<s)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class xre{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=_k.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vre(t,e,n=1,s="float32",r){if(Ys(t),n==null&&(n=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const a=new bre(e,n,s,r),i=Qe(t,s);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const p6=q({randomGamma_:vre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wre(t,e=0,n=1,s,r){if(Ys(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const a=new Mk(e,n,s,!1,r),i=Qe(t,s);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const $x=q({randomNormal_:wre});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sre(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return $x(t,0,1,e,n)}const m6=q({randomStandardNormal_:Sre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tre(t,e=0,n=1,s="float32",r){Ys(t);const a=Qe(t,s),i=new xre(e,n,null,r);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const el=q({randomUniform_:Tre});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cre(t,e,n,s){return el(t,e,n,"int32",s)}const g6=q({randomUniformInt_:Cre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cu(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return H.runKernel(Gb,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nre(t){const n={input:z(t,"input","real")};return H.runKernel(Hb,n)}const Hc=q({real_:Nre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kre(t){const n={x:z(t,"x","reciprocal")};return H.runKernel(Mh,n)}const zk=q({reciprocal_:kre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ere(t){const n={x:z(t,"x","relu")};return H.runKernel(zh,n)}const ma=q({relu_:Ere});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $re(t){const n={x:z(t,"x","relu6")};return H.runKernel(Ph,n)}const Ix=q({relu6_:$re});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ire(t,e){const s={x:z(t,"x","reverse")},r={dims:e};return H.runKernel(Om,s,r)}const yr=q({reverse_:Ire});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Are(t){const e=z(t,"x","reverse");return M(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),yr(e,0)}const y6=q({reverse1d_:Are});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rre(t,e){const n=z(t,"x","reverse");return M(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),yr(n,e)}const b6=q({reverse2d_:Rre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dre(t,e){const n=z(t,"x","reverse");return M(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),yr(n,e)}const x6=q({reverse3d_:Dre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ore(t,e){const n=z(t,"x","reverse");return M(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),yr(n,e)}const v6=q({reverse4d_:Ore});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _re(t){const n={x:z(t,"x","round")};return H.runKernel(Bh,n)}const Ax=q({round_:_re});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fre(t){const n={x:z(t,"x","rsqrt","float32")};return H.runKernel(Vh,n)}const Rx=q({rsqrt_:Fre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lre(t){const n={x:z(t,"x","selu")};return H.runKernel(Uh,n)}const Dx=q({selu_:Lre});function Mre(t,e,n,s,r,a=[1,1],i="NHWC"){const o=z(t,"x","separableConv2d"),l=z(e,"depthwiseFilter","separableConv2d"),c=z(n,"pointwiseFilter","separableConv2d");let f=o,d=!1;if(o.rank===3&&(d=!0,f=J(o,[1,o.shape[0],o.shape[1],o.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");M(f.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${f.rank}.`),M(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),M(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),M(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),M(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const p=l.shape[2],g=l.shape[3];M(c.shape[2]===p*g,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*g}, but got ${c.shape[2]}.`);const y=nf(f,l,s,r,i,a),x=_i(y,c,1,"valid",i);return d?J(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const Ox=q({separableConv2d_:Mre});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function zre(t,e){const n=z(t,"x","setdiff1d"),s=z(e,"y","setdiff1d");M(n.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${s.dtype}).`),M(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),M(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await n.data(),a=await s.data(),i=new Set(a);let o=0;for(let f=0;f<r.length;f++)i.has(r[f])||o++;const l=new yn([o],n.dtype),c=new yn([o],"int32");for(let f=0,d=0;f<r.length;f++)i.has(r[f])||(l.values[d]=r[f],c.values[d]=f,d++);return[l.toTensor(),c.toTensor()]}const w6=zre;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pre(t){const n={x:z(t,"x","sign")};return H.runKernel(Gh,n)}const Pk=q({sign_:Pre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bre(t){const n={x:z(t,"x","sin","float32")};return H.runKernel(jh,n)}const _x=q({sin_:Bre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vre(t){const n={x:z(t,"x","sinh")};return H.runKernel(Wh,n)}const Fx=q({sinh_:Vre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ure(t,e,n){const s=z(t,"x","slice1d");return M(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),ct(s,[e],[n])}const ag=q({slice1d_:Ure});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jre(t,e,n){const s=z(t,"x","slice2d");return M(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),ct(s,e,n)}const Lx=q({slice2d_:jre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wre(t,e,n){const s=z(t,"x","slice3d");return M(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),ct(s,e,n)}const ig=q({slice3d_:Wre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gre(t,e,n){const s=z(t,"x","slice4d");return M(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),ct(s,e,n)}const qc=q({slice4d_:Gre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hre(t,e=-1){const n=z(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return H.runKernel(Pm,s,r)}const og=q({softmax_:Hre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qre(t){M(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return H.runKernel(Eb,e)}const lg=q({fft_:qre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xre(t){M(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return H.runKernel(Rb,e)}const Xc=q({ifft_:Xre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kre(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=J(t,[n,e]);s=Xc(r)}else{const r=[n,2*(e-1)],a=J(Hc(t),[n,e]),i=J(Ym(t),[n,e]),o=yr(ct(a,[0,1],[n,e-2]),1),l=Z(yr(ct(i,[0,1],[n,e-2]),1),Pe(-1)),c=an([a,o],1),f=an([i,l],1),d=J(Oi(c,f),[r[0],r[1]]);s=Xc(d)}if(s=Hc(s),t.rank===3&&t.shape[0]!==0){const r=s,a=t.shape[0];s=J(s,[a,s.shape[0]/a,s.shape[1]]),r.dispose()}return s}const Mx=q({irfft_:Kre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yre(t,e,n=0){const r={x:z(t,"x","split")},a={numOrSizeSplits:e,axis:n};return H.runKernel(zm,r,a)}const Is=q({split_:Yre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zre(t,e){M(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const y=t.shape.map(x=>0),v=t.shape.map(x=>x);v[t.shape.length-1]=e,r=ct(t,y,v),n=e}else if(e!=null&&e>n){const y=t.shape.map(v=>v);y[t.shape.length-1]=e-n,r=an([t,mn(y)],t.shape.length-1),n=e}else r=t;const a=ht(r),i=J(Oi(r,a),[s,n]),o=lg(i),l=Math.floor(n/2)+1,c=Hc(o),f=Ym(o),d=Is(c,[l,n-l],c.shape.length-1),p=Is(f,[l,n-l],f.shape.length-1),g=r.shape.slice();return g[r.shape.length-1]=l,J(Oi(d[0],p[0]),g)}const ug=q({rfft_:Zre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qre(t,e){let n=z(t,"a","squaredDifference"),s=z(e,"b","squaredDifference");[n,s]=Ht(n,s),Ke(n.shape,s.shape);const r={a:n,b:s},a={};return H.runKernel(Kh,r,a)}const zx=q({squaredDifference_:Qre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jre(t,e){const n=z(t,"x","squeeze","string_or_numeric");return J(n,Bi(n.shape,e).newShape)}const tl=q({squeeze_:Jre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eae(t,e=0){const n=yp(t,"tensors","stack","string_or_numeric");M(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&M(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return H.runKernel(km,s,r)}const ys=q({stack_:eae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tae(t,e=0){const s={x:z(t,"x","step")},r={alpha:e};return H.runKernel(ef,s,r)}const Iu=q({step_:tae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nae(t,e,n,s,r=0,a=0,i=0,o=0,l=0){const f={x:z(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:s,beginMask:r,endMask:a,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};return H.runKernel(rx,f,d)}const Bk=q({stridedSlice_:nae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sae(t){const n={x:z(t,"x","tan","float32")};return H.runKernel(Zh,n)}const Vk=q({tan_:sae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hn(t,e){Tu(t);const n=ja(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Yo(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $o(t,e,n){if(Tu(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=ja(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Yo(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uk(t,e,n){if(Tu(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=ja(t,n);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Yo(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S6(t,e,n){if(Tu(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=ja(t,n);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Yo(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T6(t,e,n){if(Tu(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=ja(t,n);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Yo(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C6(t,e,n){if(Tu(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=ja(t,n);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,Yo(t,e,s,n)}function jk(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(a+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(a+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(a+` update.rank != ${r+t.length-s}`);for(let i=0;i<r;++i)if(n.shape[i]!==e.shape[i])throw new Error(a+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-r;++i)if(n.shape[i+r]!==t[i+s])throw new Error(a+` updates.shape[${i+r}] (${n.shape[i+r]}) != shape[${i+r}] (${t[i+r]})`)}function Px(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}jk(n,e,t)}function nl(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,a=n.length;let i=1;for(let d=r;d<a;++d)i*=n[d];const o=r<1?1:r,l=de(e.shape)/o,c=[...Be(n.slice(0,r)),1],f=de(n);return{sliceRank:r,numUpdates:l,sliceSize:i,strides:c,outputSize:f}}const rae=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:nl,validateInput:Px,validateUpdateShape:jk},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aae(t,e,n){const s=z(t,"tensor","tensorScatterupdate"),r=z(e,"indices","tensorScatterupdate","int32"),a=z(n,"updates","tensorScatterupdate");if(Px(a,r,s.shape),s.dtype!==a.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${a.dtype}.`);const i={tensor:s,indices:r,updates:a},o={};return H.runKernel(Yb,i,o)}const N6=q({tensorScatterUpdate_:aae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iae(t,e=1,n=!0){const s=z(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const a={x:s},i={k:e,sorted:n},[o,l]=H.runKernel(lx,a,i);return{values:o,indices:l}}const Wk=q({topk_:iae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oae(t,e=0,n=1,s,r){if(Ys(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const a=new Mk(e,n,s,!0,r),i=Qe(t,s);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const Bx=q({truncatedNormal_:oae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lae(t,e=0){const n=z(t,"x","unique","string_or_numeric");M(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[a,i]=H.runKernel(cx,s,r);return{values:a,indices:i}}const Gk=q({unique_:lae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uae(t,e,n){const s=z(t,"x","unsortedSegmentSum"),r=z(e,"segmentIds","unsortedSegmentSum","int32");M(nu(n),()=>"numSegments must be of dtype int");const a={x:s,segmentIds:r},i={numSegments:n};return H.runKernel(Um,a,i)}const Vx=q({unsortedSegmentSum_:uae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cae(t,e=0){const n=z(t,"x","unstack","string_or_numeric");M(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return H.runKernel(Vm,s,r)}const br=q({unstack_:cae});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k6(t,e){return kx(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hk(t,e=!0,n,s){return H.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ux(t,e){const n=[];for(let a=0;a<e.length;a++)e[a]&&n.push(a);const s=Qe(t,"int32"),r=Qe([n.length,t.length],"int32");for(let a=0;a<n.length;a++){const i=s.indexToLoc(n[a]),o=a*t.length;r.values.set(i,o)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hae(t){const e=z(t,"condition","whereAsync","bool"),n=await e.data(),s=Ux(e.shape,n);return t!==e&&e.dispose(),s}const qk=hae;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function fae(t,e,n){const s=z(t,"tensor","boolMask"),r=z(e,"mask","boolMask","bool"),a=n??0,i=r.rank,o=s.shape;M(i>0,()=>"mask cannot be scalar"),Xn(o.slice(a,a+i),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let v=a;v<a+i;v++)l*=o[v];const c=o.slice(0,a).concat([l],o.slice(a+i)),f=J(s,c),d=J(r,[-1]),p=await qk(d),g=tl(p,[1]),y=of(f,g,a);return t!==s&&s.dispose(),e!==r&&r.dispose(),g.dispose(),f.dispose(),d.dispose(),p.dispose(),y}const E6=fae;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dae(t,e,n){const s=z(t,"x","transpose");if(e==null&&(e=s.shape.map((i,o)=>o).reverse()),M(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(i=>{M(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},a={perm:e};return s.dtype==="complex64"?re(()=>{let i=Hc(s),o=Ym(s);return i=H.runKernel(Kl,{x:i},a),o=H.runKernel(Kl,{x:o},a),n&&(o=Ft(o)),Oi(i,o)}):H.runKernel(Kl,r,a)}const ot=q({transpose_:dae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pae(t,e,n,s,r=!0){const a=z(t,"v","movingAverage"),i=z(e,"x","movingAverage"),o=z(n,"decay","movingAverage");TP(a,i),M(at(a.shape,i.shape),()=>"Shape mismatch in v and x");const l=Pe(1),c=Re(l,o);let f=Z(Re(i,a),c);if(r){M(s!=null,()=>"When using zeroDebias: true, step is required.");const d=z(s,"step","movingAverage");f=Le(f,Re(l,Wa(o,d)))}return ve(a,f)}const $6=q({movingAverage_:pae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mae(t,e,n){Ys(n);const s=z(t,"indices","scatterND","int32"),r=z(e,"updates","scatterND");Px(r,s,n);const a={indices:s,updates:r},i={shape:n};return H.runKernel(Kb,a,i)}const I6=q({scatterND_:mae});function gae(t,e,n,s){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const r=t.rank>0?t.shape[0]:1,a=t.rank>1?t.shape[1]:1;if(n.length!==a)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${a}.`);const i=e.size;if(!(e.rank===0||e.rank===1&&i===r))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${r}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yae(t,e,n,s=0){Ys(n);const r=z(t,"sparseIndices","sparseToDense","int32"),a=z(e,"sparseValues","sparseToDense","string_or_numeric"),i=z(s,"defaultValue","sparseToDense",a.dtype);gae(r,a,n,i);const o={sparseIndices:r,sparseValues:a,defaultValue:i},l={outputShape:n};return H.runKernel(nx,o,l)}const A6=q({sparseToDense_:yae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bae(t,e){const n=z(e,"indices","gatherND","int32"),r={params:z(t,"x","gatherND","string_or_numeric"),indices:n};return H.runKernel(Ab,r)}const R6=q({gatherND_:bae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xae(t,e){if(e==null)return t.shape.slice();if(at(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vae(t,e,n,s){const r=z(t,"x","dropout");if(M(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),M(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof gt?r.clone():r;const a=xae(r,n),i=1-e,o=Le(af(ve(el(a,0,1,"float32",s),i)),i);return Z(r,o)}const Xk=q({dropout_:vae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kk(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function jx(t,e,n){const s=1-t%2,r=new Float32Array(t);for(let a=0;a<t;++a){const i=2*Math.PI*a/(t+s-1);r[a]=e-n*Math.cos(i)}return Hn(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function wae(t,e,n=1){const s=z(t,"predictions","inTopK"),r=z(e,"targets","inTopK");M(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),M(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),Xn(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=s.shape[s.shape.length-1];M(n>0&&n<=a,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${a}), but got ${n}`);const i=await s.data(),o=await r.data(),[l,c]=[i.length/a,a],f=On("bool",l);for(let d=0;d<l;d++){const p=d*c,g=i.subarray(p,p+c),y=[];for(let v=0;v<g.length;v++)y.push({value:g[v],index:v});y.sort((v,x)=>x.value-v.value),f[d]=0;for(let v=0;v<n;v++)if(y[v].index===o[d]){f[d]=1;break}}return t!==s&&s.dispose(),e!==r&&r.dispose(),Ws(f,r.shape,"bool")}const D6=wae;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sae(t,e,n,s,r,a="NHWC",i){let o=t;t.rank===3&&(o=J(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=J(e,[1,e.shape[0],e.shape[1],e.shape[2]])),M(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),M(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),M(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=a==="NHWC"?o.shape[3]:o.shape[1],f=a==="NHWC"?l.shape[3]:l.shape[1];M(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),M(f===n[3],()=>`Error in conv2dDerFilter: depth of dy (${f}) must match output depth for filter (${n[3]}).`),xs("conv2dDerFilter",r,i);const d={x:o,dy:l},p={strides:s,pad:r,dataFormat:a,dimRoundingMode:i,filterShape:n};return H.runKernel(pb,d,p)}const Yk=q({conv2DBackpropFilter_:Sae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wx(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return Z(t,Iu(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function Gx(t,e){let n=e;const s=bn(t.shape,e.shape);return s.length>0&&(n=Oe(n,s)),J(n,t.shape)}function Hx(t,e,n,s){if(e==="linear")return t;if(e==="relu")return ma(t);if(e==="elu")return sf(t);if(e==="relu6")return Ix(t);if(e==="prelu")return rg(t,n);if(e==="leakyrelu")return Zm(t,s);if(e==="sigmoid")return oa(t);throw new Error(`Unknown fused activation ${e}.`)}const qx=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tae({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:i,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:f}){if(l=l||"linear",qx(H.state.gradientDepth,l)===!1){M(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let R=_i(t,e,n,s,r,a,i);return o!=null&&(R=ve(R,o)),Hx(R,l,c,f)}const d=z(t,"x","conv2d","float32"),p=z(e,"filter","conv2d","float32");let g=d,y=!1;d.rank===3&&(y=!0,g=J(d,[1,d.shape[0],d.shape[1],d.shape[2]])),M(g.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${g.rank}.`),M(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),xs("fused conv2d",s,i);const v=r==="NHWC"?g.shape[3]:g.shape[1];M(p.shape[2]===v,()=>`Error in conv2d: depth of input (${v}) must match input depth for filter ${p.shape[2]}.`),M(Kn(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);const x=Ln(g.shape,p.shape,n,a,s,i);let w;o!=null&&(w=z(o,"bias","fused conv2d"),[w]=Ht(w,d),r==="NHWC"?Ke(x.outShape,w.shape):(M(w.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${w.shape.length}.`),M(w.shape.length===0||w.shape[0]===x.outChannels||w.shape[0]===1,()=>`Error in fused conv2d: bias shape (${w.shape}) is not compatible with the number of output channels (${x.outChannels})`)));let T;if(c!=null){const R=c.shape;if(M(R.length<=1||R.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${R.length}.`),R.length===1)M(R[0]===1||R[0]===x.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${R}) is not compatible with the number of output channels (${x.outChannels}).`);else if(R.length===3)try{Ke(R,x.outShape)}catch{const O=`Error in fused conv2d: PReLU activation weights (${R}) is not compatible with the output shape of the conv2d (${x.outShape}).`;throw Error(O)}T=z(c,"prelu weights","fused conv2d")}const N=(R,$)=>{M(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[O,A,_,D]=$,B=Wx(R,_,l);M(Po(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);const j=dk(A.shape,B,O,n,s),W=Yk(A,B,O.shape,n,s),X=[j,W];if(D!=null){const U=Gx(D,B);X.push(U)}return X},C={x:g,filter:p,bias:w,preluActivationWeights:T},E={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i,activation:l,leakyreluAlpha:f};return o==null?Ga(($,O,A)=>{let _=H.runKernel(fp,C,E);return A([O,$,_]),y&&(_=J(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:N}})(g,p):Ga(($,O,A,_)=>{let D=H.runKernel(fp,C,E);return _([O,$,D,A]),y&&(D=J(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:N}})(g,p,w)}const O6=q({fusedConv2d_:Tae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cae(t,e,n,s,r,a=[1,1],i){let o=t;t.rank===3&&(o=J(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=J(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:o,dy:l},f={strides:s,pad:r,dimRoundingMode:i,dilations:a,filterShape:n};return H.runKernel(wb,c,f)}const _6=q({depthwiseConv2dNativeBackpropFilter_:Cae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nae(t,e,n,s,r,a=[1,1],i){let o=e,l=!1;e.rank===3&&(l=!0,o=J(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:o,filter:n},f={strides:s,pad:r,dimRoundingMode:i,dilations:a,inputShape:t},d=H.runKernel(Sb,c,f);return l?J(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const F6=q({depthwiseConv2dNativeBackpropInput_:Nae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kae({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:i,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:f}){if(qx(H.state.gradientDepth,l)===!1){let E=nf(t,e,n,s,r,a,i);return o!=null&&(E=ve(E,o)),Hx(E,l,c,f)}const d=z(t,"x","depthwiseConv2d","float32"),p=z(e,"filter","depthwiseConv2d","float32");let g=d,y=!1;d.rank===3&&(y=!0,g=J(d,[1,d.shape[0],d.shape[1],d.shape[2]])),M(g.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${g.rank}.`),M(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),M(g.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${g.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),a==null&&(a=[1,1]),M(Kn(n,a),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),xs("fused depthwiseConv2d",s,i);const v=Ln(g.shape,p.shape,n,a,s,i,!0);let x;o!=null&&(x=z(o,"bias","fused conv2d"),[x]=Ht(x,d),Ke(v.outShape,x.shape));let w;c!=null&&(w=z(c,"prelu weights","fused depthwiseConv2d"));const T=(E,R)=>{M(Po(a),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[$,O,A,_]=R,D=Wx(E,A,l),B=F6(O.shape,D,$,n,s,a,i),j=_6(O,D,$.shape,n,s,a,i);if(_!=null){const W=Gx(x,D);return[B,j,W]}return[B,j]},N={x:g,filter:p,bias:x,preluActivationWeights:w},C={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i,activation:l,leakyreluAlpha:f};return o==null?Ga((R,$,O)=>{let A=H.runKernel(dp,N,C);return O([$,R,A]),y&&(A=J(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:T}})(g,p):Ga((R,$,O,A)=>{let _=H.runKernel(dp,N,C);return A([$,R,_,O]),y&&(_=J(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:T}})(g,p,x)}const Eae=q({fusedDepthwiseConv2d_:kae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ae({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:a="linear",preluActivationWeights:i,leakyreluAlpha:o=.2}){if(qx(H.state.gradientDepth,a)===!1){let D=tt(t,e,n,s);return r!=null&&(D=ve(D,r)),Hx(D,a,i,o)}let l=z(t,"a","fused matMul"),c=z(e,"b","fused matMul");[l,c]=Ht(l,c);const f=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=s?c.shape[c.rank-1]:c.shape[c.rank-2],p=n?l.shape[l.rank-1]:l.shape[l.rank-2],g=s?c.shape[c.rank-2]:c.shape[c.rank-1],y=l.shape.slice(0,-2),v=c.shape.slice(0,-2),x=de(y),w=de(v);M(f===d,()=>`Error in fused matMul: inner shapes (${f}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const N=Ke(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([p,g]),C=n?J(l,[x,f,p]):J(l,[x,p,f]),E=s?J(c,[w,g,d]):J(c,[w,d,g]);let R;r!=null&&(R=z(r,"bias","fused matMul"),[R]=Ht(R,l),Ke(N,R.shape));let $;i!=null&&($=z(i,"prelu weights","fused matMul"));const O=(D,B)=>{const[j,W,X,U]=B,Y=Wx(J(D,X.shape),X,a);let Q,ie;if(!n&&!s?(Q=tt(Y,W,!1,!0),ie=tt(j,Y,!0,!1)):!n&&s?(Q=tt(Y,W,!1,!1),ie=tt(Y,j,!0,!1)):n&&!s?(Q=tt(W,Y,!1,!0),ie=tt(j,Y,!1,!1)):(Q=tt(W,Y,!0,!0),ie=tt(Y,j,!0,!0)),r!=null){const V=Gx(U,Y);return[Q,ie,V]}else return[Q,ie]},A={a:C,b:E,bias:R,preluActivationWeights:$},_={transposeA:n,transposeB:s,activation:a,leakyreluAlpha:o};return r==null?Ga((B,j,W)=>{const X=H.runKernel(hp,A,_);return W([B,j,X]),{value:J(X,N),gradFunc:O}})(C,E):Ga((B,j,W,X)=>{const U=H.runKernel(hp,A,_);return X([B,j,U,W]),{value:J(U,N),gradFunc:O}})(C,E,R)}const GT=q({fusedMatMul_:$ae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L6=Object.freeze(Object.defineProperty({__proto__:null,conv2d:O6,depthwiseConv2d:Eae,matMul:GT},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iae(t){return jx(t,.54,.46)}const Aae=q({hammingWindow_:Iae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rae(t){return jx(t,.5,.5)}const M6=q({hannWindow_:Rae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dae(t,e,n,s=!1,r=0){let a=0;const i=[];for(;a+e<=t.size;)i.push(ct(t,a,e)),a+=n;if(s)for(;a<t.size;){const o=a+e-t.size,l=an([ct(t,a,e-o),Eu([o],r)]);i.push(l),a+=n}return i.length===0?$o([],[0,e]):J(an(i),[i.length,e])}const z6=q({frame_:Dae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oae(t,e,n,s,r=M6){s==null&&(s=Kk(e));const a=z6(t,e,n),i=Z(a,r(e));return ug(i,s)}const _ae=q({stft_:Oae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fae(t,e,n,s,r="bilinear",a=0){const i=z(t,"image","cropAndResize"),o=z(e,"boxes","cropAndResize","float32"),l=z(n,"boxInd","cropAndResize","int32"),c=o.shape[0];M(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),M(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${o.shape}.`),M(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${o.shape}.`),M(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),M(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),M(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const f={image:i,boxes:o,boxInd:l},d={method:r,extrapolationValue:a,cropSize:s};return H.runKernel(bb,f,d)}const Lae=q({cropAndResize_:Fae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mae(t){const e=z(t,"image","flipLeftRight","float32");M(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return H.runKernel(Ib,n,{})}const zae=q({flipLeftRight_:Mae});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pae(t){const e=z(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];M(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),M(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,cr(e,r)}const Bae=q({grayscaleToRGB_:Pae});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vae(t){const e=z(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];M(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),M(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,a=Ne(e,"float32"),i=Hn([.2989,.587,.114]);let o;switch(e.rank){case 2:o=Ml("ij,j->i",a,i);break;case 3:o=Ml("ijk,k->ij",a,i);break;case 4:o=Ml("ijkl,l->ijk",a,i);break;case 5:o=Ml("ijklm,m->ijkl",a,i);break;case 6:o=Ml("ijklmn,n->ijklm",a,i);break;default:throw new Error("Not a valid tensor rank.")}return o=jn(o,-1),Ne(o,r)}const Uae=q({rgbToGrayscale_:Vae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jae(t,e,n=0,s=.5){const r=z(t,"image","rotateWithOffset","float32");M(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const a={image:r},i={radians:e,fillValue:n,center:s};return H.runKernel(hx,a,i)}const Wae=q({rotateWithOffset_:jae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lf(t,e,n,s,r,a){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),a==null&&(a=0);const i=t.shape[0];return n=Math.min(n,i),M(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),M(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),M(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),M(e.rank===1,()=>"scores must be a 1D tensor"),M(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),M(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gae(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const a=z(t,"boxes","nonMaxSuppression","float32"),i=z(e,"scores","nonMaxSuppression","float32"),o=lf(a,i,n,s,r);n=o.maxOutputSize,s=o.iouThreshold,r=o.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return H.runKernel(Pb,{boxes:a,scores:i},l)}const Hae=q({nonMaxSuppression_:Gae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qae(t,e,n){const s=Xae(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function Xae(t,e,n){return Yae(t,e,n||Kae)}function Kae(t,e){return t>e?1:t<e?-1:0}function Yae(t,e,n){let s=0,r=t.length,a=0,i=!1;for(;s<r;){a=s+(r-s>>>1);const o=n(e,t[a]);o>0?s=a+1:(r=a,i=!o)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xx(t,e,n,s,r){return Zk(t,e,n,s,r,0)}function Kx(t,e,n,s,r,a){return Zk(t,e,n,s,r,0,!1,a,!0)}function Yx(t,e,n,s,r,a){return Zk(t,e,n,s,r,a,!0)}function Zk(t,e,n,s,r,a,i=!1,o=!1,l=!1){const c=[];for(let x=0;x<e.length;x++)e[x]>r&&c.push({score:e[x],boxIndex:x,suppressBeginIndex:0});c.sort(i4);const f=a>0?-.5/a:0,d=[],p=[];for(;d.length<n&&c.length>0;){const x=c.pop(),{score:w,boxIndex:T,suppressBeginIndex:N}=x;if(w<r)break;let C=!1;for(let E=d.length-1;E>=N;--E){const R=Zae(t,T,d[E]);if(R>=s){C=!0;break}if(x.score=x.score*Qae(s,f,R),x.score<=r)break}x.suppressBeginIndex=d.length,C||(x.score===w?(d.push(T),p.push(x.score)):x.score>r&&qae(c,x,i4))}const g=d.length,y=n-g;o&&y>0&&(d.push(...new Array(y).fill(0)),p.push(...new Array(y).fill(0)));const v={selectedIndices:d};return i&&(v.selectedScores=p),l&&(v.validOutputs=g),v}function Zae(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),a=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),o=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),f=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),p=Math.max(r[1],r[3]),g=(o-a)*(l-i),y=(d-c)*(p-f);if(g<=0||y<=0)return 0;const v=Math.max(a,c),x=Math.max(i,f),w=Math.min(o,d),T=Math.min(l,p),N=Math.max(w-v,0)*Math.max(T-x,0);return N/(g+y-N)}function Qae(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function i4(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Jae(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const a=z(t,"boxes","nonMaxSuppressionAsync"),i=z(e,"scores","nonMaxSuppressionAsync"),o=lf(a,i,n,s,r);n=o.maxOutputSize,s=o.iouThreshold,r=o.scoreThreshold;const l=await Promise.all([a.data(),i.data()]),c=l[0],f=l[1],{selectedIndices:d}=Xx(c,f,n,s,r);return a!==t&&a.dispose(),i!==e&&i.dispose(),Hn(d,"int32")}const eie=Jae;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tie(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const i=z(t,"boxes","nonMaxSuppression"),o=z(e,"scores","nonMaxSuppression"),l=lf(i,o,n,s,r,a);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,a=l.softNmsSigma;const c={boxes:i,scores:o},f={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:a},d=H.runKernel(Vb,c,f);return{selectedIndices:d[0],selectedScores:d[1]}}const nie=q({nonMaxSuppressionWithScore_:tie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function sie(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const i=z(t,"boxes","nonMaxSuppressionAsync"),o=z(e,"scores","nonMaxSuppressionAsync"),l=lf(i,o,n,s,r,a);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,a=l.softNmsSigma;const c=await Promise.all([i.data(),o.data()]),f=c[0],d=c[1],{selectedIndices:p,selectedScores:g}=Yx(f,d,n,s,r,a);return i!==t&&i.dispose(),o!==e&&o.dispose(),{selectedIndices:Hn(p,"int32"),selectedScores:Hn(g)}}const rie=sie;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aie(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const i=z(t,"boxes","nonMaxSuppression"),o=z(e,"scores","nonMaxSuppression"),l=lf(i,o,n,s,r,null),c=l.maxOutputSize,f=l.iouThreshold,d=l.scoreThreshold,p={boxes:i,scores:o},g={maxOutputSize:c,iouThreshold:f,scoreThreshold:d,padToMaxOutputSize:a},y=H.runKernel(Bb,p,g);return{selectedIndices:y[0],validOutputs:y[1]}}const iie=q({nonMaxSuppressionPadded_:aie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function oie(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const i=z(t,"boxes","nonMaxSuppressionAsync"),o=z(e,"scores","nonMaxSuppressionAsync"),l=lf(i,o,n,s,r,null),c=l.maxOutputSize,f=l.iouThreshold,d=l.scoreThreshold,[p,g]=await Promise.all([i.data(),o.data()]),{selectedIndices:y,validOutputs:v}=Kx(p,g,c,f,d,a);return i!==t&&i.dispose(),o!==e&&o.dispose(),{selectedIndices:Hn(y,"int32"),validOutputs:Pe(v,"int32")}}const lie=oie;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uie(t,e,n=!1,s=!1){const r=z(t,"images","resizeBilinear");M(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),M(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),M(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let a=r,i=!1;r.rank===3&&(i=!0,a=J(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const o={images:a},l={alignCorners:n,halfPixelCenters:s,size:e},c=H.runKernel(Dm,o,l);return i?J(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const P6=q({resizeBilinear_:uie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cie(t,e,n=!1,s=!1){const r=z(t,"images","resizeNearestNeighbor");M(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),M(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),M(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),M(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let a=r,i=!1;r.rank===3&&(i=!0,a=J(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const o={images:a},l={alignCorners:n,halfPixelCenters:s,size:e},c=H.runKernel(Rm,o,l);return i?J(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const B6=q({resizeNearestNeighbor_:cie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hie(t,e="binary",n=!1,s=.5){const r=z(t,"image","threshold"),a=.2989,i=.587,o=.114,l=r.shape[0]*r.shape[1];let c=Z(Hn([s]),255),f,d,p,g;if(M(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),M(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),M(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),M(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[f,d,p]=Is(r,[1,1,1],-1);const x=Z(f,a),w=Z(d,i),T=Z(p,o);g=ve(ve(x,w),T)}else g=t;if(e==="otsu"){const x=ok(Ne(Ax(g),"int32"),Ws([]),256);c=fie(x,l)}const y=n?Jo(g,c):vs(g,c);return Ne(Z(y,255),"int32")}function fie(t,e){let n=Hn([-1]),s=Hn([0]),r=Hn([0]),a,i,o,l,c,f;for(let d=0;d<t.size-1;d++){a=ct(t,0,d+1),i=ct(t,d+1),c=Le(Oe(a),e),f=Le(Oe(i),e);const p=Oe(Z(a,cu(0,a.size)));o=Le(p,Oe(a));const g=Eu(i.shape,a.size),y=ve(cu(0,i.size),g),v=Z(i,y);l=Le(Oe(v),Oe(i));const x=Re(o,l),w=Re(o,l),T=Z(c,f);r=Z(Z(T,x),w);const N=vs(r,s);s=Dn(N,r,s),n=Dn(N,Hn([d]),n)}return n}const die=q({threshold_:hie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pie(t,e,n="nearest",s="constant",r=0,a){const i=z(t,"image","transform","float32"),o=z(e,"transforms","transform","float32");M(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),M(o.rank===2&&(o.shape[0]===i.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),M(a==null||a.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`);const l={image:i,transforms:o},c={interpolation:n,fillMode:s,fillValue:r,outputShape:a};return H.runKernel(ux,l,c)}const mie=q({transform_:pie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gie(t,e,n){const s=z(t,"a","bandPart");M(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[a,i]=s.shape.slice(-2);let o,l;typeof e=="number"?(M(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),M(e<=a,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${a}).`),o=z(e<0?a:e,"numLower","bandPart")):(M(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=Dn(Wc(e,0),a,Vo(e,a))),typeof n=="number"?(M(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),M(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),l=z(n<0?i:n,"numUpper","bandPart")):(M(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Dn(Wc(n,0),i,Vo(n,i)));const c=J(cu(0,a,1,"int32"),[-1,1]),f=cu(0,i,1,"int32"),d=Re(c,f),p=Vr(Jo(d,o),Wi(d,Ft(l))),g=mn([a,i],s.dtype);return J(ys(br(J(s,[-1,a,i])).map(y=>Dn(p,y,g))),r)}const yie=q({bandPart_:gie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bie(t){let e;if(Array.isArray(t)){e=!1,M(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let a=1;a<t.length;++a)M(t[a].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[a].shape[0]} vs. ${r})`)}else e=!0,t=Is(t,t.shape[0],0).map(r=>tl(r,[0]));M(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(H.tidy(()=>{let a=s[r];if(r>0)for(let i=0;i<r;++i){const o=Z(Oe(Z(n[i],a)),n[i]);a=Re(a,o)}return Le(a,rf(a,"euclidean"))}));return e?ys(n,0):n}const xie=q({gramSchmidt_:bie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vie(t,e=!1){if(M(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return o4(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),s=br(J(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],a=[];s.forEach(l=>{const[c,f]=o4(l,e);r.push(c),a.push(f)});const i=J(ys(r,0),t.shape),o=J(ys(a,0),t.shape);return[i,o]}}function o4(t,e=!1){return H.tidy(()=>{M(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=Sx(n),a=Ma(t);const i=$o([[1]],[1,1]);let o=Ma(i);const l=n>=s?s:n;for(let c=0;c<l;++c){const f=a,d=o,p=r;[o,a,r]=H.tidy(()=>{const g=ct(a,[c,c],[n-c,1]),y=rf(g),v=ct(a,[c,c],[1,1]),x=Dn(vs(v,0),$o([[-1]]),$o([[1]])),w=Re(v,Z(x,y)),T=Le(g,w);T.shape[0]===1?o=Ma(i):o=an([i,ct(T,[1,0],[T.shape[0]-1,T.shape[1]])],0);const N=Ft(Le(tt(x,w),y)),C=ct(a,[c,0],[n-c,s]),E=Z(N,o),R=ot(o);if(c===0)a=Re(C,tt(E,tt(R,C)));else{const A=Re(C,tt(E,tt(R,C)));a=an([ct(a,[0,0],[c,s]),A],0)}const $=ot(E),O=ct(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=Re(O,tt(tt(O,o),$));else{const A=Re(O,tt(tt(O,o),$));r=an([ct(r,[0,0],[n,c]),A],1)}return[o,a,r]}),Xe([f,d,p])}return!e&&n>s&&(r=ct(r,[0,0],[n,s]),a=ct(a,[0,0],[s,s])),[r,a]})}const wie=q({qr_:vie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var fs;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(fs||(fs={}));function Sie(t,e,n=fs.SUM_BY_NONZERO_WEIGHTS){const s=z(t,"losses","computeWeightedLoss");let r=null;e!=null&&(r=z(e,"weights","computeWeightedLoss"));const a=r==null?s:Z(s,r);if(n===fs.NONE)return a;if(n===fs.SUM)return Oe(a);if(n===fs.MEAN){if(r==null)return Wt(a);{const i=s.size/r.size,o=Le(Oe(a),Oe(r));return i>1?Le(o,Pe(i)):o}}if(n===fs.SUM_BY_NONZERO_WEIGHTS){if(r==null)return Le(Oe(a),Pe(s.size));{const i=Z(r,$s(s.shape)),o=Ne(Oe(uu(i,Pe(0))),"float32");return Le(Oe(a),o)}}throw Error(`Unknown reduction: ${n}`)}const Hi=q({computeWeightedLoss_:Sie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tie(t,e,n,s=fs.SUM_BY_NONZERO_WEIGHTS){const r=z(t,"labels","absoluteDifference"),a=z(e,"predictions","absoluteDifference");let i=null;n!=null&&(i=z(n,"weights","absoluteDifference")),Xn(r.shape,a.shape,"Error in absoluteDifference: ");const o=pn(Re(r,a));return Hi(o,i,s)}const Cie=q({absoluteDifference_:Tie});function Nie(t,e,n,s,r=fs.SUM_BY_NONZERO_WEIGHTS){const a=z(t,"labels","cosineDistance"),i=z(e,"predictions","cosineDistance");let o=null;s!=null&&(o=z(s,"weights","cosineDistance")),Xn(a.shape,i.shape,"Error in cosineDistance: ");const l=Pe(1),c=Re(l,Oe(Z(a,i),n,!0));return Hi(c,o,r)}const kie=q({cosineDistance_:Nie});function Eie(t,e,n,s=fs.SUM_BY_NONZERO_WEIGHTS){let r=z(t,"labels","hingeLoss");const a=z(e,"predictions","hingeLoss");let i=null;n!=null&&(i=z(n,"weights","hingeLoss")),Xn(r.shape,a.shape,"Error in hingeLoss: ");const o=Pe(1);r=Re(Z(Pe(2),r),o);const l=ma(Re(o,Z(r,a)));return Hi(l,i,s)}const $ie=q({hingeLoss_:Eie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iie(t,e,n,s=1,r=fs.SUM_BY_NONZERO_WEIGHTS){const a=z(t,"labels","huberLoss"),i=z(e,"predictions","huberLoss");let o=null;n!=null&&(o=z(n,"weights","huberLoss")),Xn(a.shape,i.shape,"Error in huberLoss: ");const l=Pe(s),c=pn(Re(i,a)),f=Vo(c,l),d=Re(c,f),p=ve(Z(Pe(.5),kt(f)),Z(l,d));return Hi(p,o,r)}const Aie=q({huberLoss_:Iie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rie(t,e,n,s=1e-7,r=fs.SUM_BY_NONZERO_WEIGHTS){const a=z(t,"labels","logLoss"),i=z(e,"predictions","logLoss");let o=null;n!=null&&(o=z(n,"weights","logLoss")),Xn(a.shape,i.shape,"Error in logLoss: ");const l=Pe(1),c=Pe(s),f=Ft(Z(a,qs(ve(i,c)))),d=Z(Re(l,a),qs(ve(Re(l,i),c))),p=Re(f,d);return Hi(p,o,r)}const Die=q({logLoss_:Rie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oie(t,e,n,s=fs.SUM_BY_NONZERO_WEIGHTS){const r=z(t,"labels","meanSquaredError"),a=z(e,"predictions","meanSquaredError");let i=null;n!=null&&(i=z(n,"weights","meanSquaredError")),Xn(r.shape,a.shape,"Error in meanSquaredError: ");const o=zx(r,a);return Hi(o,i,s)}const _ie=q({meanSquaredError_:Oie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fie(t,e){const n=z(t,"labels","sigmoidCrossEntropyWithLogits"),s=z(e,"logits","sigmoidCrossEntropyWithLogits");Xn(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=ma(s),a=Z(s,n),i=Qm(Os(Ft(pn(s))));return ve(Re(r,a),i)}function Lie(t,e,n,s=0,r=fs.SUM_BY_NONZERO_WEIGHTS){let a=z(t,"multiClassLabels","sigmoidCrossEntropy");const i=z(e,"logits","sigmoidCrossEntropy");let o=null;if(n!=null&&(o=z(n,"weights","sigmoidCrossEntropy")),Xn(a.shape,i.shape,"Error in sigmoidCrossEntropy: "),s>0){const c=Pe(s),f=Pe(1),d=Pe(.5);a=ve(Z(a,Re(f,c)),Z(d,c))}const l=Fie(a,i);return Hi(l,o,r)}const Mie=q({sigmoidCrossEntropy_:Lie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zie(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Ga((r,a,i)=>{const l=Jm(a,[n],!0),c=Re(Ne(a,"float32"),l);i([r,c]);const f=Ft(Z(c,r));return{value:Oe(f,[n]),gradFunc:(g,y)=>{const[v,x]=y,w=on(g.shape,[n]);return[Z(J(g,w),Re(Ne(v,"float32"),Os(x))),Z(J(g,w),Re(Os(x),Ne(v,"float32")))]}}})(t,e)}function Pie(t,e,n,s=0,r=fs.SUM_BY_NONZERO_WEIGHTS){let a=z(t,"onehotLabels","softmaxCrossEntropy");const i=z(e,"logits","softmaxCrossEntropy");let o=null;if(n!=null&&(o=z(n,"weights","softmaxCrossEntropy")),Xn(a.shape,i.shape,"Error in softmaxCrossEntropy: "),s>0){const c=Pe(s),f=Pe(1),d=Pe(a.shape[1]);a=ve(Z(a,Re(f,c)),Le(c,d))}const l=zie(a,i);return Hi(l,o,r)}const Bie=q({softmaxCrossEntropy_:Pie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vie(t,e,n,s){const r=z(t,"indices","sparseFillEmptyRows","int32"),a=z(e,"values","sparseFillEmptyRows"),i=z(n,"denseShape","sparseFillEmptyRows","int32"),o=z(s,"defaultValue","sparseFillEmptyRows",a.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(a.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${a.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);const l={indices:r,values:a,denseShape:i,defaultValue:o},c=H.runKernel(Qb,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const Uie=q({sparseFillEmptyRows_:Vie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jie(t,e,n){const s=z(t,"inputIndices","sparseReshape","int32"),r=z(e,"inputShape","sparseReshape","int32"),a=z(n,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(a.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${a.shape}`);const i={inputIndices:s,inputShape:r,newShape:a},o=H.runKernel(Jb,i);return{outputIndices:o[0],outputShape:o[1]}}const Wie=q({sparseReshape_:jie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gie(t,e,n){const s=z(t,"data","sparseSegmentMean"),r=z(e,"indices","sparseSegmentMean","int32"),a=z(n,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${a.shape}`);const i={data:s,indices:r,segmentIds:a};return H.runKernel(ex,i)}const Hie=q({sparseSegmentMean_:Gie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qie(t,e,n){const s=z(t,"data","sparseSegmentSum"),r=z(e,"indices","sparseSegmentSum","int32"),a=z(n,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${a.shape}`);const i={data:s,indices:r,segmentIds:a};return H.runKernel(tx,i)}const Xie=q({sparseSegmentSum_:qie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kie(t,e,n,s,r,a,i,o){const l=z(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=z(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const f={separator:n,nGramWidths:s,leftPad:r,rightPad:a,padWidth:i,preserveShortSequences:o},d={data:l,dataSplits:c},p=H.runKernel(ax,d,f);return{nGrams:p[0],nGramsSplits:p[1]}}const Yie=q({stringNGrams_:Kie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zie(t,e,n=!0){const s=z(t,"input","stringSplit","string"),r=z(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const a={skipEmpty:n},i={input:s,delimiter:r},o=H.runKernel(ix,i,a);return{indices:o[0],values:o[1],shape:o[2]}}const Qie=q({stringSplit_:Zie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jie(t,e){const n=z(t,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const r={input:n};return H.runKernel(ox,r,s)}const eoe=q({stringToHashBucketFast_:Jie});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function toe(t,e,n,s=!0){const r=z(t,"input","staticRegexReplace","string"),a={pattern:e,rewrite:n,replaceGlobal:s};return H.runKernel(Bm,{x:r},a)}const noe=q({staticRegexReplace_:toe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V6={fft:lg,ifft:Xc,rfft:ug,irfft:Mx},U6={hammingWindow:Aae,hannWindow:M6,frame:z6,stft:_ae},Pr={flipLeftRight:zae,grayscaleToRGB:Bae,resizeNearestNeighbor:B6,resizeBilinear:P6,rgbToGrayscale:Uae,rotateWithOffset:Wae,cropAndResize:Lae,nonMaxSuppression:Hae,nonMaxSuppressionAsync:eie,nonMaxSuppressionWithScore:nie,nonMaxSuppressionWithScoreAsync:rie,nonMaxSuppressionPadded:iie,nonMaxSuppressionPaddedAsync:lie,threshold:die,transform:mie},Qk={bandPart:yie,gramSchmidt:xie,qr:wie},j6={absoluteDifference:Cie,computeWeightedLoss:Hi,cosineDistance:kie,hingeLoss:$ie,huberLoss:Aie,logLoss:Die,meanSquaredError:_ie,sigmoidCrossEntropy:Mie,softmaxCrossEntropy:Bie},W6={sparseFillEmptyRows:Uie,sparseReshape:Wie,sparseSegmentMean:Hie,sparseSegmentSum:Xie},G6={stringNGrams:Yie,stringSplit:Qie,stringToHashBucketFast:eoe,staticRegexReplace:noe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const soe=new Map,HT=new Map;class Au{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class ur{constructor(){this.classNameMap={}}static getMap(){return ur.instance==null&&(ur.instance=new ur),ur.instance}static register(e){ur.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Se(t,e,n){M(t.className!=null,()=>"Class being registered does not have the static className property defined."),M(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),M(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,r=e+">"+s;return ur.register(t),soe.set(r,t),HT.set(t,r),t}function roe(t){return HT.has(t)?HT.get(t):t.className}const aoe=Object.freeze(Object.defineProperty({__proto__:null,Serializable:Au,SerializationMap:ur,getRegisteredName:roe,registerClass:Se},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qi extends Au{minimize(e,n=!1,s){const{value:r,grads:a}=this.computeGradients(e,s);if(s!=null){const i=s.map(o=>({name:o.name,tensor:a[o.name]}));this.applyGradients(i)}else this.applyGradients(a);return Xe(a),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return ZP(e,n)}dispose(){this.iterations_!=null&&Xe(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Pe(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(qi,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jk extends qi{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=H.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=H.registeredVariables[s],i=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:re(()=>ht(a).variable(i))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:re(()=>ht(a).variable(i))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;re(()=>{const f=ve(Z(l,this.rho),Z(kt(o),1-this.rho)),d=Z(Le(_n(ve(c,this.epsilon)),_n(ve(l,this.epsilon))),o),p=ve(Z(c,this.rho),Z(kt(d),1-this.rho));l.assign(f),c.assign(p);const g=ve(Z(d,-this.learningRate),a);a.assign(g)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Xe(this.accumulatedGrads.map(e=>e.variable)),Xe(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eE extends qi{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=H.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:re(()=>Eu(a.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const o=this.accumulatedGrads[r].variable;re(()=>{const l=ve(o,kt(i));o.assign(l);const c=ve(Z(Le(i,_n(ve(l,H.backend.epsilon()))),-this.learningRate),a);a.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Xe(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tE extends qi{static get className(){return"Adam"}constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],re(()=>{this.accBeta1=Pe(n).variable(),this.accBeta2=Pe(s).variable()}),r==null&&(this.epsilon=H.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);re(()=>{const s=Re(1,this.accBeta1),r=Re(1,this.accBeta2);n.forEach((a,i)=>{const o=H.registeredVariables[a],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${a}/m`,variable:re(()=>ht(o).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${a}/v`,variable:re(()=>ht(o).variable(l))});const c=Array.isArray(e)?e[i].tensor:e[a];if(c==null)return;const f=this.accumulatedFirstMoment[i].variable,d=this.accumulatedSecondMoment[i].variable,p=ve(Z(f,this.beta1),Z(c,1-this.beta1)),g=ve(Z(d,this.beta2),Z(kt(c),1-this.beta2)),y=Le(p,s),v=Le(g,r);f.assign(p),d.assign(g);const x=ve(Z(Le(y,ve(_n(v),this.epsilon)),-this.learningRate),o);o.assign(x)}),this.accBeta1.assign(Z(this.accBeta1,this.beta1)),this.accBeta2.assign(Z(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Xe(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Xe(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),re(()=>{this.accBeta1.assign(Wa(this.beta1,this.iterations_+1)),this.accBeta2.assign(Wa(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nE extends qi{static get className(){return"Adamax"}constructor(e,n,s,r=null,a=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],re(()=>{this.iteration=Pe(0).variable(),this.accBeta1=Pe(n).variable()}),r==null&&(this.epsilon=H.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);re(()=>{const s=Re(1,this.accBeta1),r=Le(-this.learningRate,ve(Z(this.iteration,this.decay),1));n.forEach((a,i)=>{const o=H.registeredVariables[a],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${a}/m`,variable:ht(o).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${a}/v`,variable:ht(o).variable(l)});const c=Array.isArray(e)?e[i].tensor:e[a];if(c==null)return;const f=this.accumulatedFirstMoment[i].variable,d=this.accumulatedWeightedInfNorm[i].variable,p=ve(Z(f,this.beta1),Z(c,1-this.beta1)),g=Z(d,this.beta2),y=pn(c),v=Xa(g,y);f.assign(p),d.assign(v);const x=ve(Z(Le(r,s),Le(p,ve(v,this.epsilon))),o);o.assign(x)}),this.iteration.assign(ve(this.iteration,1)),this.accBeta1.assign(Z(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Xe(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Xe(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zx extends qi{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const i=H.registeredVariables[s];re(()=>{const o=ve(Z(this.c,a),i);i.assign(o)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Tn(Pe(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sE extends Zx{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=Pe(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=H.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:re(()=>ht(a).variable(!1))});const i=this.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[s];o!=null&&re(()=>{let l;const c=ve(Z(this.m,i),o);this.useNesterov?l=ve(Z(this.c,ve(o,Z(c,this.m))),a):l=ve(Z(this.c,c),a),i.assign(c),a.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Xe(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rE extends qi{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,r=null,a=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,r==null&&(this.epsilon=H.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=H.registeredVariables[s],i=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:re(()=>ht(a).variable(i))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:re(()=>ht(a).variable(i))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:re(()=>ht(a).variable(i))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;re(()=>{const f=ve(Z(l,this.decay),Z(kt(o),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[r].variable,p=ve(Z(d,this.decay),Z(o,1-this.decay)),g=Le(Z(o,this.learningRate),_n(Re(f,ve(kt(p),this.epsilon)))),y=ve(Z(c,this.momentum),g);l.assign(f),d.assign(p),c.assign(y);const v=Re(a,y);a.assign(v)}else{const d=ve(Z(l,this.decay),Z(kt(o),1-this.decay)),p=ve(Z(c,this.momentum),Le(Z(o,this.learningRate),_n(ve(d,this.epsilon))));l.assign(d),c.assign(p);const g=Re(a,p);a.assign(g)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Xe(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Xe(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Xe(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ioe=[Jk,eE,tE,nE,sE,rE,Zx];function ooe(){for(const t of ioe)Se(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const loe="model",uoe=".json",coe=".weights.bin";function l4(t){return new Promise(e=>setTimeout(e)).then(t)}class hu{constructor(e){if(!ae().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(hu.URL_SCHEME)&&(e=e.slice(hu.URL_SCHEME.length)),(e==null||e.length===0)&&(e=loe),this.modelJsonFileName=e+uoe,this.weightDataFileName=e+coe}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=pa.join(e.weightData),s=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],a=RP(e,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),o=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=i,await l4(()=>o.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=s,await l4(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Gm(e)}}}}hu.URL_SCHEME="downloads://";class hoe{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const s=new FileReader;s.onload=r=>{const a=JSON.parse(r.target.result),i=a.modelTopology;if(i==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(a.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}const l=HN(a,c=>this.loadWeights(c));e(l)},s.onerror=r=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const n=[],s=[];for(const i of e)n.push(...i.weights),s.push(...i.paths);const r=this.checkManifestAndWeightFiles(e),a=s.map(i=>this.loadWeightsFile(i,r[i]));return Promise.all(a).then(i=>[n,i])}loadWeightsFile(e,n){return new Promise((s,r)=>{const a=new FileReader;a.onload=i=>{const o=i.target.result;s(o)},a.onerror=i=>r(`Failed to weights data from file of path '${e}'.`),a.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],s=this.weightsFiles.map(a=>Z_(a.name)),r={};for(const a of e)a.paths.forEach(i=>{const o=Z_(i);if(n.indexOf(o)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${o}'`);if(n.push(o),s.indexOf(o)===-1)throw new Error(`Weight file with basename '${o}' is not provided.`);r[i]=this.weightsFiles[s.indexOf(o)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const foe=t=>ae().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(hu.URL_SCHEME)?doe(t.slice(hu.URL_SCHEME.length)):null;jt.registerSaveRouter(foe);function doe(t="model"){return new hu(t)}function poe(t){return new hoe(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u4(t,e,n,s){i(t),n=n??0,s=s??1,o(n,s);let r=0;const a=l=>(l.then(c=>{const f=n+ ++r/t.length*(s-n);return e(f),c}),l);function i(l){M(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,c){M(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),M(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),M(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(t.map(a))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function H6(t,e){e==null&&(e={});const n=e.fetchFunc==null?ae().platform.fetch:e.fetchFunc,s=t.map(d=>n(d,e.requestInit,{isBinary:!0})),o=(e.onProgress==null?await Promise.all(s):await u4(s,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(o):await u4(o,e.onProgress,.5,1)}function moe(t,e){var n;const s=e.fetchFunc==null?ae().platform.fetch:e.fetchFunc;let r=0,a;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async i=>{for(var o;r<t.length;){a||(a=(await s(t[r],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:c}=await a.read();if(l){r++,a=void 0,(o=e.onProgress)===null||o===void 0||o.call(e,r/t.length);continue}i.enqueue(c);return}i.close()}})}async function q6(t,e="",n,s){return X6(i=>H6(i,{requestInit:s}))(t,e,n)}function X6(t){return async(e,n="",s)=>{const r=e.map(()=>!1),a={},i=s!=null?s.map(()=>!1):[],o=[];if(e.forEach((g,y)=>{let v=0;g.weights.forEach(x=>{const w="quantization"in x?x.quantization.dtype:x.dtype,T=su[w]*de(x.shape),N=()=>{r[y]=!0,a[y]==null&&(a[y]=[]),a[y].push({manifestEntry:x,groupOffset:v,sizeBytes:T})};s!=null?s.forEach((C,E)=>{C===x.name&&(N(),i[E]=!0)}):N(),o.push(x.name),v+=T})}),!i.every(g=>g)){const g=s.filter((y,v)=>!i[v]);throw new Error(`Could not find weights in manifest with names: ${g.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}const l=r.reduce((g,y,v)=>(y&&g.push(v),g),[]),c=[];l.forEach(g=>{e[g].paths.forEach(y=>{const v=n+(n.endsWith("/")?"":"/")+y;c.push(v)})});const f=await t(c),d={};let p=0;return l.forEach(g=>{const y=e[g].paths.length,v=new pa(f.slice(p,p+y));a[g].forEach(w=>{const T=v.slice(w.groupOffset,w.groupOffset+w.sizeBytes),N=jN(T,[w.manifestEntry]);for(const C in N)d[C]=N[C]}),p+=y}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const goe="application/octet-stream",yoe="application/json";class aE{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(M(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=ae().platform.fetch,M(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&M(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=RP(e,s);if(n.body.append("model.json",new Blob([JSON.stringify(r)],{type:yoe}),"model.json"),e.weightData!=null){const i=pa.join(e.weightData);n.body.append("model.weights.bin",new Blob([i],{type:goe}),"model.weights.bin")}const a=await this.fetch(this.path,n);if(a.ok)return{modelArtifactsInfo:Gm(e),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const s=n.modelTopology,r=n.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return HN(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),s=w1(e.weightsManifest),r=()=>moe(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=boe(n),a=this.weightPathPrefix||s,i=[],o=[];for(const l of e)for(const c of l.paths)this.weightUrlConverter!=null?o.push(this.weightUrlConverter(c)):i.push(a+c+r);return this.weightUrlConverter&&i.push(...await Promise.all(o)),i}async loadWeights(e){const n=await this.getWeightUrls(e),s=w1(e),r=await H6(n,this.loadOptions);return[s,r]}}aE.URL_SCHEME_REGEX=/^https?:\/\//;function boe(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),s=t.substring(0,e),r=n>e?t.substring(n):"";return[s+"/",r]}function qT(t){return t.match(aE.URL_SCHEME_REGEX)!=null}const K6=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(s=>qT(s)):n=qT(t),n)return iE(t,e)}return null};jt.registerSaveRouter(K6);jt.registerLoadRouter(K6);function iE(t,e){return new aE(t,e)}function Y6(t,e){return iE(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NS{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class Z6{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class xoe{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function voe(t,e,n,s){const r=arguments;return new xoe(T1(...r))}function T1(t,e,n,s){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new NS(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new NS({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new NS({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:s}))}function woe(t){return new Z6(t)}function Soe(t){return new Z6(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oE=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:pa,browserFiles:poe,browserHTTPRequest:Y6,concatenateArrayBuffers:AP,copyModel:tte,decodeWeights:jN,decodeWeightsStream:IP,encodeWeights:PT,fromMemory:voe,fromMemorySync:T1,getLoadHandlers:OP,getModelArtifactsForJSON:HN,getModelArtifactsForJSONSync:GN,getModelArtifactsInfoForJSON:Gm,getSaveHandlers:DP,getWeightSpecs:w1,http:iE,isHTTPScheme:qT,listModels:Jee,loadWeights:q6,moveModel:nte,registerLoadRouter:Vee,registerSaveRouter:Bee,removeModel:ete,weightsLoaderFactory:X6,withSaveHandler:woe,withSaveHandlerSync:Soe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Toe(t,e,n){const s=z(t,"labels","confusionMatrix"),r=z(e,"predictions","confusionMatrix");M(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),M(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),M(r.rank===1,()=>`Expected the rank of predictions to be 1, but got ${r.rank}`),M(s.shape[0]===r.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${r.shape[0]}. Labels and predictions should have the same number of elements.`),M(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const a=Gc(Ne(s,"int32"),n),i=Gc(Ne(r,"int32"),n),o=ot(a),l=tt(o,i);return Ne(l,"int32")}const Coe=q({confusionMatrix_:Toe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Noe=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:Coe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Al,c4=!1;function Q6(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,s=!1,r=!1,a=!1,i=!1,o=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)a=!0;else if(t.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(mp(x1,H.backendName)!=null){const y={pixels:t},v={numChannels:e};return H.runKernel(x1,y,v)}const[c,f]=r?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(i)d=t.getContext("2d").getImageData(0,0,c,f).data;else if(s||n)d=t.data;else if(a||r||o){if(Al==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")Al=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else Al=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Al.canvas.width=c,Al.canvas.height=f,Al.drawImage(t,0,0,c,f),d=Al.getImageData(0,0,c,f).data}let p;if(e===4)p=new Int32Array(d);else{const y=c*f;p=new Int32Array(y*e);for(let v=0;v<y;v++)for(let x=0;x<e;++x)p[v*e+x]=d[v*4+x]}return Uk(p,[f,c,e],"int32")}function koe(t){return t!=null&&t.data instanceof Uint8Array}function Eoe(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function $oe(t){return t!=null&&t.width!==0&&t.height!==0}function Ioe(t){return Eoe()&&!(t instanceof ImageBitmap)&&$oe(t)&&!koe(t)}async function Aoe(t,e=3){let n=null;if(ae().getBool("WRAP_TO_IMAGEBITMAP")&&Ioe(t)){let s;try{s=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===t.width&&s.height===t.height?n=s:n=t}else n=t;return Q6(n,e)}function J6(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}function Roe(t){const e=(t==null?void 0:t.alpha)||1;if(e>1||e<0)throw new Error(`Alpha value ${e} is suppoed to be in range [0 - 1].`)}async function Doe(t,e){let n=z(t,"img","toPixels");if(!(t instanceof gt)){const c=n;n=Ne(c,"int32"),c.dispose()}J6(n);const[s,r]=n.shape.slice(0,2),a=n.rank===2?1:n.shape[2],i=await n.data(),o=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(r*s*4);for(let c=0;c<s*r;++c){const f=[0,0,0,255];for(let p=0;p<a;p++){const g=i[c*a+p];if(n.dtype==="float32"){if(g<0||g>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${g}.`)}else if(n.dtype==="int32"&&(g<0||g>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${g}.`);a===1?(f[0]=g*o,f[1]=g*o,f[2]=g*o):f[p]=g*o}const d=c*4;l[d+0]=Math.round(f[0]),l[d+1]=Math.round(f[1]),l[d+2]=Math.round(f[2]),l[d+3]=Math.round(f[3])}if(e!=null){c4||mp(Cb,H.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),c4=!0),e.width=r,e.height=s;const c=e.getContext("2d"),f=new ImageData(l,r,s);c.putImageData(f,0,0)}return n!==t&&n.dispose(),l}function Ooe(t,e,n){let s=z(t,"img","draw");if(!(t instanceof gt)){const i=s;s=Ne(i,"int32"),i.dispose()}J6(s),Roe(n==null?void 0:n.imageOptions);const r={image:s},a={canvas:e,options:n};H.runKernel(Cb,r,a)}const eB=q({fromPixels_:Q6}),_oe=Object.freeze(Object.defineProperty({__proto__:null,draw:Ooe,fromPixels:eB,fromPixelsAsync:Aoe,toPixels:Doe},Symbol.toStringTag,{value:"Module"}));function Qx(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(de(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,a=r[r.length-1];let i=1;for(let d=0;d<r.length-1;++d)i*=r[d];const o=t.shape,l=r.slice();l.pop();let c=1;for(let d=a;d<n;++d)c*=o[d],l.push(o[d]);const f=[...Be(t.shape).map(d=>d/c),1].slice(0,a);return[l,i,c,f]}const Foe=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:Qx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XT=-2,Loe=-1;function lE(t,e,n){const s=t.shape.length;M(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),M(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)M(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function Moe(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function uE(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function tB(t,e,n,s){const r=[...t];for(let a=r.length;a<s.length;a++)r.push(1);for(let a=0;a<n;a++)a===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function nB(t,e,n){return n<=t?n:n-(e-1)}function sB(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function zoe(t,e,n,s,r,a,i,o,l){const c=t.length;let f=new Array(c),d=new Array(c),p=new Array(c);if(e.length&&n>0){const g=e[0],y=n+1;f=rB(i,g,y,s,t),d=aB(o,g,y,r,t),p=tB(a,g,y,t)}else for(let g=0;g<c;g++)f[g]=oB(i,s,a,t,g,l),d[g]=lB(o,r,a,t,g,l),p[g]=iB(a,g,l);return{begin:f,end:d,strides:p}}function rB(t,e,n,s,r){const a=[...r],i=sB(n,e);for(let o=0;o<a.length;o++)if(i.indexOf(o)>-1)a[o]=0;else{const l=nB(e,n,o);let c=s[l];t&1<<l&&(c=0),a[o]=c}return a}function aB(t,e,n,s,r){const a=[...r],i=sB(n,e);for(let o=0;o<a.length;o++)if(i.indexOf(o)>-1)a[o]=Number.MAX_SAFE_INTEGER;else{const l=nB(e,n,o);let c=s[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),a[o]=c}for(let o=0;o<a.length;o++){const l=r[o];a[o]<0&&(a[o]+=l),a[o]=Lo(0,a[o],r[o])}return a}function iB(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function oB(t,e,n,s,r,a){let i=e[r];const o=n[r]||1;(t&1<<r||a&1<<r||i==null)&&(o>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),i=Lo(0,i,l-1),i}function lB(t,e,n,s,r,a){let i=e[r];const o=n[r]||1;(t&1<<r||a&1<<r||i==null)&&(o>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),o>0?i=Lo(0,i,l):i=Lo(-1,i,l-1),i}function cE(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function hE(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function Jx(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(i=>{M(i!==-1,()=>"slice() does not support negative begin indexing.")});let a;return n==null?a=new Array(r).fill(-1):typeof n=="number"?a=[n,...new Array(r-1).fill(-1)]:n.length<r?a=n.concat(new Array(r-n.length).fill(-1)):a=n,a=a.map((i,o)=>i>=0?i:(M(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${o}.`),t.shape[o]-s[o])),[s,a]}function fE(t,e,n,s,r,a,i,o,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,i!=null&&(i&i-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let f=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:a,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};for(let N=0;N<d.dims;N++)f&&(1<<N&o)!==0&&d.numAddAxisAfterEllipsis++,1<<N&i&&(f=!0);f||(d.ellipsisMask|=1<<d.dims,d.dims++);const p={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};Poe(d,p);let g=!0,y=!0,v=!0;const x=[],w=[];for(let N=0;N<t.length;++N){if(p.strides[N]===0)throw Error(`strides[${N}] must be non-zero`);const C=!!(p.shrinkAxisMask&1<<N),E=t[N];if(E===-1){x.push(C?1:-1);continue}const R=[p.beginMask&1<<N,p.endMask&1<<N],$=[p.strides[N]>0?0:-1,p.strides[N]>0?E:E-1];if(C&&p.strides[N]<=0)throw Error("only stride 1 allowed on non-range indexing.");v=v&&p.strides[N]===1;const O=!!(p.beginMask&1<<N&&p.endMask&1<<N);if(p.beginValid&&p.endValid){if(C){const B=p.begin[N]<0?E+p.begin[N]:p.begin[N];if(p.begin[N]=B,p.end[N]=p.begin[N]+1,B<0||B>=E)throw Error(`slice index ${p.begin[N]} of dimension ${N} out of bounds.`)}else p.begin[N]=h4(p.begin[N],0,p.strides[N],E,R,$),p.end[N]=h4(p.end[N],1,p.strides[N],E,R,$);const D=p.strides[N]===1&&p.begin[N]===0&&p.end[N]===E;g=g&&D,y=y&&(N===0&&p.strides[N]===1||D)}else g=g&&p.strides[N]===1&&O,y=y&&(N===0&&p.strides[N]===1||O);let A,_=!1;if(p.beginValid&&p.endValid?(A=p.end[N]-p.begin[N],_=!0):C?(A=1,_=!0):O&&E>=0&&(p.strides[N]<0?A=-E:A=E,_=!0),_){let D;A===0||A<0!=p.strides[N]<0?D=0:D=Math.trunc(A/p.strides[N])+(A%p.strides[N]!==0?1:0),x.push(D)}else x.push(-1)}for(let N=0;N<p.finalShapeGatherIndices.length;++N){const C=p.finalShapeGatherIndices[N];C>=0?w.push(x[C]):C===XT&&w.push(1)}return{finalShapeSparse:w.filter((N,C)=>p.finalShapeGatherIndices[C]!==XT),finalShape:w,isIdentity:g,sliceDim0:y,isSimpleSlice:v,begin:p.begin,end:p.end,strides:p.strides}}function Poe(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(XT),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(Loe),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function h4(t,e,n,s,r,a){if(r[e])return n>0?a[e]:a[e+1&1];{const i=t<0?s+t:t;return i<a[0]?a[0]:i>a[1]?a[1]:i}}const uB=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:lE,computeFlatOffset:hE,computeOutShape:uE,getNormalizedAxes:zoe,isSliceContinous:cE,maskToAxes:Moe,parseSliceParams:Jx,sliceInfo:fE,startForAxis:oB,startIndicesWithElidedDims:rB,stopForAxis:lB,stopIndicesWithElidedDims:aB,stridesForAxis:iB,stridesWithElidedDims:tB},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const cB="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hB{static sgd(e){return new Zx(e)}static momentum(e,n,s=!1){return new sE(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,a=!1){return new rE(e,n,s,r,a)}static adam(e=.001,n=.9,s=.999,r=null){return new tE(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new Jk(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,a=0){return new nE(e,n,s,r,a)}static adagrad(e,n=.1){return new eE(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fl=hB;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Boe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function dE(){return new Promise(t=>Boe(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pE(t,e){const n=t[0].length;t.forEach((r,a)=>{M(r.length===n,()=>`Error in concat${n}D: rank of tensors[${a}] must be the same as the rank of the rest (${n})`)}),M(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,a)=>{for(let i=0;i<n;i++)M(i===e||r[i]===s[i],()=>`Error in concat${n}D: Shape of tensors[${a}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${a}.`)})}function za(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var aa;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(aa||(aa={}));function fB(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const a=n[r],i=s[s.length-n.length+r],o=s[i];if(a>=0)if(o>=0){if(o!==a)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${a} but shape[${r+t}] = ${o}`)}else s[i]=a}return s}function dB(t){const e={FIRST_DIM_SIZE:aa.FIRST_DIM_SIZE,VALUE_ROWIDS:aa.VALUE_ROWIDS,ROW_LENGTHS:aa.ROW_LENGTHS,ROW_SPLITS:aa.ROW_SPLITS,ROW_LIMITS:aa.ROW_LIMITS,ROW_STARTS:aa.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function pB(t){return t.length===0?0:t[0]===aa.FIRST_DIM_SIZE?t.length-1:t.length}function mB(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const a=t[r],i=e[r+1];if(a>=0&&i>=0&&a!==1&&a!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${a} but ragged tensor input.flatValues.shape[${r-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mE=30;function ev(t){return t<=mE?t:g1(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gE(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cg(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const a=e.length;for(let i=0;i<a;++i)r=r.concat([t[i+1]/e[i],e[i]]);r=r.concat(t.slice(a+1))}return r}function hg(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],a=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?a.push(i):r.push(i);s.push(...r),s.push(0),s.push(...a)}return s}function fg(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let a=1;a<t.length;++a)a<=e.length?s?r.push(e[a-1]*t[a]):r.push(t[a]/e[a-1]):r.push(t[a]);return r}function yE(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function bE(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tv=1.7580993408473768,nv=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xE=.3275911,vE=.254829592,wE=-.284496736,SE=1.421413741,TE=-1.453152027,CE=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fi(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function gB(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function yB(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function bB(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function NE(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function xB(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function vB(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const a=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(a),s[r]=Math.sin(a)}return{real:n,imag:s}}function wB(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),a=Math.sin(s);return{real:r,imag:a}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kS="->",Voe=/->/g,f4=",",d4="...";function kE(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(Voe,"").length)/kS.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${kS}").`);const[s,r]=t.split(kS);M(s.indexOf(d4)===-1,()=>`The ellipsis notation ("${d4}") is not supported yet.`);const a=s.split(f4),i=a.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let p=0;p<r.length;++p){const g=r[p];if(!a.some(y=>y.indexOf(g)!==-1))throw new Error(`Output subscripts contain the label ${g} not present in the input subscripts.`);o.indexOf(g)===-1&&o.push(g)}for(let p=0;p<s.length;++p){const g=s[p];o.indexOf(g)===-1&&g!==f4&&o.push(g)}const l=new Array(a.length);for(let p=0;p<i;++p){if(new Set(a[p].split("")).size!==a[p].length)throw new Error(`Found duplicate axes in input component ${a[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let g=0;g<a[p].length;++g)l[p].push(o.indexOf(a[p][g]))}const c=o.length,f=r.length,d=[];for(let p=f;p<c;++p)d.push(p);return{allDims:o,summedDims:d,idDims:l}}function EE(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function $E(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const a=n[r].shape;for(let i=0;i<e[r].length;++i)s[e[r][i]]===void 0?s[e[r][i]]=a[i]:M(s[e[r][i]]===a[i],()=>`Expected dimension ${s[e[r][i]]} at axis ${i} of input shaped ${JSON.stringify(a)}, but got dimension ${a[i]}`)}}function IE(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let i=0;i<r;++i)s.push([]);const a=[];for(let i=0;i<n.length;++i){const o=n[i],l=Uoe(e,o);for(const c of l)a.indexOf(c)===-1&&(s[i].push(c),a.push(c))}return{path:n,steps:s}}function AE(t){return t.every((e,n)=>e===n)}function Uoe(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function RE(t,e,n=0){let s=[];if(typeof e=="number")M(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((i,o)=>(o===-1&&(i+=1),i),0);M(r<=1,()=>"There should be only one negative value in split array.");const a=e.indexOf(-1);if(a!==-1){const i=e.reduce((o,l)=>l>0?o+l:o);e[a]=t.shape[n]-i}M(t.shape[n]===e.reduce((i,o)=>i+o),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SB(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function TB(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function CB(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NB(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function kB(t,e){return`size ${t} must be non-negative, not ${e}`}function EB(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function $B(t,e){const n=de(t),s=de(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function IB(t,e){const n=de(t),s=de(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KT(){return"segment ids must be >= 0"}function AB(){return"segment ids are not increasing"}function RB(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function DB(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OB(t,e){let n=!1,s;for(t<=mE?(s=t,n=!0):s=g1(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=g1(t,s+1);return s}function _B(t,e,n){const s=[],r=t.length;for(let a=0;a<r;a++)a!==e?s.push(t[a]):s.push(n);return s}function DE(t,e,n,s){const r=e.shape.length,a=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>a)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${a}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let d=0;d<s;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const i=t.shape[n],o=[];let l=1,c=1,f=1;for(let d=0;d<s;++d)o.push(t.shape[d]),l*=t.shape[d];for(let d=s;d<n;d++)o.push(t.shape[d]),c*=t.shape[d];for(let d=s;d<r;d++)o.push(e.shape[d]);for(let d=n+1;d<a;d++)o.push(t.shape[d]),f*=t.shape[d];return{batchSize:l,sliceSize:f,outerSize:c,dimSize:i,outputShape:o}}const joe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:DE,computeOutShape:_B,segOpComputeOptimalWindowSize:OB},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Li(t){try{return t.map(e=>Ri(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function FB(t){return t.map(e=>La(e))}const LB=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:vE,ERF_A2:wE,ERF_A3:SE,ERF_A4:TE,ERF_A5:CE,ERF_P:xE,PARALLELIZE_THRESHOLD:mE,get RowPartitionType(){return aa},SELU_SCALE:nv,SELU_SCALEALPHA:tv,applyActivation:Hx,assertAndGetBroadcastShape:Ke,assertAxesAreInnerMostDims:Yn,assertParamsConsistent:pE,assignToTypedArray:xB,axesAreInnerMostDims:vk,calculateShapes:nl,checkEinsumDimSizes:$E,checkPadOnDimRoundingMode:xs,combineLocations:XP,combineRaggedTensorToTensorShapes:fB,complexWithEvenIndex:yB,complexWithOddIndex:bB,computeConv2DInfo:Ln,computeConv3DInfo:Zo,computeDefaultPad:nk,computeDilation2DInfo:Hm,computeOptimalWindowSize:ev,computeOutAndReduceShapes:Mn,computeOutShape:za,computePool2DInfo:Ur,computePool3DInfo:Ui,convertConv2DDataFormat:ji,decodeEinsumEquation:kE,eitherStridesOrDilationsAreOne:Kn,expandShapeToKeepDim:on,exponent:wB,exponents:vB,fromStringArrayToUint8:FB,fromUint8ToStringArray:Li,getAxesPermutation:qt,getBroadcastDims:lu,getComplexWithIndex:NE,getEinsumComputePath:IE,getEinsumPermutation:EE,getFusedBiasGradient:Gx,getFusedDyActivation:Wx,getImageCenter:gE,getInnerMostAxes:un,getPermuted:hg,getRaggedRank:pB,getReductionAxes:bn,getReshaped:cg,getReshapedPermuted:fg,getRowPartitionTypesHelper:dB,getSliceBeginCoords:yE,getSliceSize:bE,getSparseFillEmptyRowsIndicesDenseShapeMismatch:SB,getSparseFillEmptyRowsNegativeIndexErrorMessage:TB,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:CB,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:EB,getSparseReshapeInputOutputMismatchErrorMessage:IB,getSparseReshapeInputOutputMultipleErrorMessage:$B,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:NB,getSparseReshapeNegativeOutputDimErrorMessage:kB,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:DB,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:KT,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:AB,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:RB,getUndoAxesPermutation:Qo,isIdentityPermutation:AE,log:VJ,mergeRealAndImagArrays:Fi,prepareAndValidate:Qx,prepareSplitSize:RE,segment_util:joe,shouldFuse:qx,slice_util:uB,splitRealAndImagArrays:gB,stridesOrDilationsArePositive:ou,tupleValuesAreOne:Po,upcastType:As,validateDefaultValueShape:mB,validateInput:Px,validateUpdateShape:jk,warn:lr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Woe=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:Xx,nonMaxSuppressionV4Impl:Kx,nonMaxSuppressionV5Impl:Yx,whereImpl:Ux},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ooe();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MB={kernelName:Vp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Z(t,Iu(Ne(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Goe={kernelName:ih,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=kt(Ne(n,"float32")),r=_n(Re(Pe(1),s));return Ft(Le(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hoe={kernelName:oh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=_n(Re(kt(Ne(n,"float32")),1));return Le(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qoe={kernelName:ku,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ke(n.shape,s.shape);return{a:()=>{let o=t;const l=bn(n.shape,r);return l.length>0&&(o=Oe(o,l)),J(o,n.shape)},b:()=>{let o=t;const l=bn(s.shape,r);return l.length>0&&(o=Oe(o,l)),J(o,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xoe={kernelName:Up,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Koe={kernelName:jp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ht(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yoe={kernelName:Wp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ht(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zoe={kernelName:lh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,_n(Re(Pe(1),kt(Ne(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qoe={kernelName:uh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=_n(ve(Pe(1),kt(Ne(n,"float32"))));return Le(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Joe={kernelName:fh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ke(n.shape,s.shape);return{a:()=>{const o=ve(kt(n),kt(s));let l=Z(t,Le(s,o));const c=bn(n.shape,r);return c.length>0&&(l=Oe(l,c)),J(l,n.shape)},b:()=>{const o=ve(kt(n),kt(s));let l=Ft(Z(t,Le(n,o)));const c=bn(s.shape,r);return c.length>0&&(l=Oe(l,c)),J(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ele={kernelName:ch,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,ve(kt(Ne(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tle={kernelName:hh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,Re(Pe(1),kt(Ne(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nle(t,e,n,s,r,a){const i=z(t,"dy","avgPool3dGrad"),o=z(e,"input","avgPool3dGrad");let l=i,c=o,f=!1;o.rank===4&&(f=!0,l=J(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),c=J(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),M(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),M(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),xs("avgPool3dGrad",r,a);const d={dy:l,input:c},p={filterSize:n,strides:s,pad:r,dimRoundingMode:a},g=H.runKernel(cb,d,p);return f?J(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const sle=q({avgPool3dGrad_:nle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rle={kernelName:Hp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:a,pad:i,dimRoundingMode:o}=n;return{x:()=>sle(t,s,r,a,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ale(t,e,n,s,r){const a=z(t,"dy","avgPoolGrad"),i=z(e,"input","avgPoolGrad");M(i.rank===a.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${a.rank})`);let o=i,l=a,c=!1;i.rank===3&&(c=!0,o=J(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=J(a,[1,a.shape[0],a.shape[1],a.shape[2]])),M(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),M(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);const f={dy:l,input:o},d={filterSize:n,strides:s,pad:r},p=H.runKernel(ub,f,d);return c?J(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const ile=q({avgPoolGrad_:ale});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ole={kernelName:Gp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:a,pad:i}=n;return{x:()=>ile(t,s,r,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lle={kernelName:qp,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:a,transposeB:i}=n;return!a&&!i?{a:()=>tt(t,r,!1,!0),b:()=>tt(s,t,!0,!1)}:!a&&i?{a:()=>tt(t,r,!1,!1),b:()=>tt(t,s,!0,!1)}:a&&!i?{a:()=>tt(r,t,!1,!0),b:()=>tt(s,t,!1,!1)}:{a:()=>tt(r,t,!0,!0),b:()=>tt(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ule={kernelName:Xp,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>sg(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cle={kernelName:cP,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,a=s.shape,i=Array.from(a);for(let l=r.length-1;l>=0;l--)if(r[l]===a[l])i[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${a}].`);const o=[];for(let l=0;l<i.length;l++)i[l]>1&&o.push(l);return{x:()=>Oe(t,o,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hle={kernelName:dh,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fle={kernelName:ph,gradFunc:t=>({x:()=>ht(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dle={kernelName:mh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:a}=n;return{x:()=>Dn(Vr(Wi(s,r),Jo(s,a)),t,ht(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ple={kernelName:Yp,inputsToSave:["x"],gradFunc:MB.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mle={kernelName:Zp,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:r}=n,a=nt(r,e[0].shape)[0],i=s.map(l=>l[a]);return Is(t,i,a).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gle={kernelName:Qp,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:a,strides:i,pad:o,dataFormat:l}=n;return M(Po(a),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`),{x:()=>dk(s.shape,t,r,i,o,l),filter:()=>Yk(s,t,r.shape,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yle={kernelName:Jp,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:a,pad:i,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>_i(t,r,a,i,o,1,l),filter:()=>Yk(t,s,r.shape,a,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ble(t,e,n,s,r){let a=t;t.rank===4&&(a=J(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let i=e;i.rank===4&&(i=J(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),M(a.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`),M(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),M(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),M(a.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${n[3]}.`),M(i.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`);const o={x:a,dy:i},l={strides:s,pad:r,filterShape:n};return H.runKernel(mb,o,l)}const xle=q({conv3DBackpropFilter_:ble});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vle={kernelName:em,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:a}=n;M(Po(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,o]=e;return{x:()=>GP(i.shape,t,o,r,a),filter:()=>xle(i,t,o.shape,r,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wle={kernelName:gh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Z(Ft(_x(Ne(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sle={kernelName:yh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Z(Fx(Ne(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tle={kernelName:tm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:a,reverse:i}=n;return{x:()=>{const o=qt([r],s.rank);let l=vx(t,r,a,!i);return o!=null&&(l=ot(l,o)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cle={kernelName:nm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:a,dimRoundingMode:i}=n,o=s??[1,1];M(Po(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[l,c]=e;return M(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),M(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),M(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),M(Kn(r,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${o}'.`),xs("depthwiseConv2d",a,i),{x:()=>F6(l.shape,t,c,r,a,o,i),filter:()=>_6(l,t,c.shape,r,a,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nle={kernelName:sm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,a={x:s,filter:r,dy:t},i={x:s,filter:r,dy:t};return{x:()=>H.runKernel(y1,a,n),filter:()=>H.runKernel(b1,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kle={kernelName:xh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>H.runKernel(kb,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ele={kernelName:vh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=Z(Os(Ft(kt(n))),2/Math.sqrt(Math.PI));return{x:()=>Z(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $le={kernelName:wh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Z(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ile={kernelName:am,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>J(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ale={kernelName:Sh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Z(t,Os(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rle={kernelName:Th,gradFunc:t=>({x:()=>ht(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dle={kernelName:Ch,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ke(n.shape,s.shape);return{a:()=>{const o=Le(t,Ne(s,"float32")),l=bn(n.shape,r);return l.length>0?J(Oe(o,l),n.shape):o},b:()=>{let o=Z(t,Ne(n,"float32"));const l=bn(s.shape,r);l.length>0&&(o=J(Oe(o,l),s.shape));const c=kt(s);return Ft(Le(o,Ne(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ole={kernelName:im,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,a,i,o]=e,l=o??Pe(1),c=bn(a.shape,r.shape),f=[];if(a.rank===1){for(let C=0;C<r.shape.length-1;++C)f.push(r.shape[C]);f.push(1)}const d=Re(r,a),p=Z(t,l),g=Rx(ve(i,Pe(s))),y=Z(Z(Z(g,g),g),Pe(-.5));return{x:()=>a.rank===1?J(Z(Z(t,cr(J(g,[1,1,1,a.shape[0]]),f)),l),r.shape):J(Z(Z(t,g),l),r.shape),mean:()=>{let C=Z(Z(g,Pe(-1)),p);return a.rank===1&&(C=Oe(C,c)),J(C,a.shape)},variance:()=>{let C=Z(Z(y,d),p);return a.rank===1&&(C=Oe(C,c)),J(C,a.shape)},scale:()=>{const C=Z(d,g);let E=Z(t,C);return a.rank===1&&(E=Oe(E,c)),J(E,a.shape)},offset:()=>{let C=t;return a.rank===1&&(C=Oe(C,c)),J(C,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _le={kernelName:om,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:a,batchDims:i}=n,o=nt(a,s.shape)[0],l=(c,f,d)=>()=>{const p=c.shape,g=f.size,y=p.slice(0,o),v=y.length,x=p.slice(a,p.length).slice(1),w=x.length,T=p4(0,v),N=p4(v+1,v+1+w),C=m4([y,[g],x]),E=J(d,C),R=J(f,[g]),$=m4([[v],T,N]),O=ot(E,$);let A=Vx(O,R,c.shape[o]);const _=Qo($);return A=ot(A,_),A};if(i===1){const c=s.shape[0],f=s.split(c,0);return{x:()=>ys(f.map((g,y)=>l(g,r.slice(y,1),t.slice(y,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,t),indices:()=>r}}};function p4(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function m4(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fle={kernelName:Nh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>ht(n),b:()=>ht(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lle={kernelName:kh,gradFunc:t=>({x:()=>Ne(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mle={kernelName:Eh,gradFunc:t=>({x:()=>ht(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zle={kernelName:$h,gradFunc:t=>({x:()=>ht(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ple={kernelName:Ih,gradFunc:t=>({x:()=>ht(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ble={kernelName:um,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,a=vs(s,0);return{x:()=>Dn(a,t,Z(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vle={kernelName:Rh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,ve(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ule={kernelName:Ah,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,Ne(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jle={kernelName:hP,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const i=Os(s);return Re(t,Z(Oe(t,r,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wle(t,e,n,s=5,r=1,a=1,i=.5){const o={x:t,y:e,dy:n},l={depthRadius:s,bias:r,alpha:a,beta:i};return H.runKernel(_b,o,l)}const Gle=q({localResponseNormalizationBackprop_:Wle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hle={kernelName:mm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:a,bias:i,alpha:o,beta:l}=n;return{x:()=>Gle(s,r,t,a,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zB(t,e,n,s){return e.rank<n.rank&&(e=J(e,on(e.shape,s))),t.rank<n.rank&&(t=J(t,on(t.shape,s))),{x:()=>Z(t,Ne(Hs(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g4={kernelName:gm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,a=e[0],i=e[1],o=nt(r,a.shape),l=zB(t,i,a,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qle={kernelName:Dh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>Z(t,Ne(Wi(n,s),"float32")),b:()=>Z(t,Ne(Wc(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xle(t,e,n,s,r,a,i){const o=z(t,"dy","maxPool3dGrad"),l=z(e,"input","maxPool3dGrad"),c=z(n,"output","maxPool3dGrad");let f=o,d=l,p=c,g=!1;l.rank===4&&(g=!0,f=J(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=J(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=J(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),M(f.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${f.rank}.`),M(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),M(p.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),xs("maxPool3dGrad",a,i);const y={dy:f,input:d,output:p},v={filterSize:s,strides:r,pad:a,dimRoundingMode:i},x=H.runKernel(Lb,y,v);return g?J(x,[x.shape[1],x.shape[2],x.shape[3],x.shape[4]]):x}const Kle=q({maxPool3dGrad_:Xle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yle={kernelName:bm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=n;return{x:()=>Kle(t,s,r,a,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zle(t,e,n,s,r,a,i){const o=z(t,"dy","maxPoolGrad"),l=z(e,"input","maxPoolGrad"),c=z(n,"output","maxPoolGrad");M(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),M(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),M(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),xs("maxPoolGrad",a,i);const f={dy:o,input:l,output:c},d={filterSize:s,strides:r,pad:a,dimRoundingMode:i};return H.runKernel(Fb,f,d)}const Qle=q({maxPoolGrad_:Zle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jle={kernelName:ym,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:a,strides:i,pad:o}=n;return{x:()=>Qle(t,s,r,a,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eue={kernelName:xm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,a=nt(r,s.shape),o=Mn(s.shape,a)[1],l=de(o);return{x:()=>{const f=s.shape.slice();a.forEach(g=>{f[g]=1});const d=J(t,f);return Le(Z(d,$s(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tue={kernelName:vm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[a,i]=e,o=nt(r,a.shape),l=zB(t,i,a,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nue={kernelName:Oh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>Z(t,Ne(Jo(n,s),"float32")),b:()=>Z(t,Ne(vs(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sue={kernelName:wm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,a=r.map(i=>i[0]);return{x:()=>ct(t,a,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rue={kernelName:_h,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ke(n.shape,s.shape);return{a:()=>{const o=bn(n.shape,r);return o.length>0?J(Oe(t,o),n.shape):t},b:()=>{const o=Z(t,Ft(af(Le(n,s)))),l=bn(s.shape,r);return l.length>0?J(Oe(o,l),s.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aue={kernelName:Fh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ke(n.shape,s.shape);return{a:()=>{const o=Z(t,Ne(s,"float32")),l=bn(n.shape,r);return l.length>0?J(Oe(o,l),n.shape):o},b:()=>{const o=Z(t,Ne(n,"float32")),l=bn(s.shape,r);return l.length>0?J(Oe(o,l),s.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iue={kernelName:Sm,gradFunc:t=>({x:()=>Ft(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oue={kernelName:Nm,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>mn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lue={kernelName:Cm,gradFunc:t=>({x:()=>ht(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uue={kernelName:km,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return br(t,s).map(a=>()=>a)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y4={kernelName:Em,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,a=r.map(i=>i[0]);return{x:()=>ct(t,a,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cue={kernelName:Lh,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,a=n,i=s,o=Ke(a.shape,i.shape);return{a:()=>{const f=Ne(i,"float32");let d=Z(t,Z(f,Wa(a,Re(f,Pe(1)))));const p=bn(a.shape,o);return p.length>0&&(d=Oe(d,p)),J(d,a.shape)},b:()=>{const f=vs(a,0),d=Dn(f,qs(a),ht(a));let p=Z(t,Z(r,d));const g=bn(i.shape,o);return g.length>0&&(p=Oe(p,g)),J(p,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hue={kernelName:$m,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=vs(n,0);return{x:()=>Dn(r,t,Z(t,s)),alpha:()=>{let a=Dn(r,ht(t),Z(t,n));const i=bn(s.shape,t.shape);return i.length>0&&(a=Oe(a,i)),J(a,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fue(t,e,n){const s=t.shape.slice();s[n]=1;const r=J(e,s),a=wp(t,n,!0,!1),i=wp(t,n,!0,!0),o=Z(a,i);return Z(r,o)}function due(t,e,n){const s=t.shape.length,r=s-n.length,a=qt(n,s);let i=t;a!=null&&(i=ot(t,a));const o=i.shape.slice(),c=o.splice(s-n.length,n.length).reduce((p,g)=>p*g,1);o.push(c);const f=i.reshape(o);let d=fue(f,e,r);if(d=d.reshape(i.shape),a!=null){const p=Qo(a);d=ot(d,p)}return d}const pue={kernelName:Im,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let a=[];return r==null?a=s.shape.map((i,o)=>o):typeof r=="number"?a=[r]:a=r,{x:()=>due(s,t,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mue={kernelName:bh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ke(n.shape,s.shape);return{a:()=>{const o=Le(t,Ne(s,"float32")),l=bn(n.shape,r);return l.length>0?J(Oe(o,l),n.shape):o},b:()=>{let o=Z(t,Ne(n,"float32"));const l=bn(s.shape,r);l.length>0&&(o=J(Oe(o,l),s.shape));const c=kt(s);return Ft(Le(o,Ne(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gue={kernelName:Mh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,Ft(kt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yue={kernelName:Ph,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=Z(Jo(n,6),Iu(n));return{x:()=>Z(t,Ne(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bue={kernelName:zh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Z(t,Ne(Iu(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xue={kernelName:Am,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>J(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vue={kernelName:Dm,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>H.runKernel(Xb,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wue={kernelName:Rm,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>H.runKernel(qb,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sue={kernelName:Om,gradFunc:(t,e,n)=>{const{dims:s}=n,r=nt(s,t.shape);return{x:()=>yr(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tue={kernelName:Bh,gradFunc:t=>({x:()=>ht(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cue={kernelName:Vh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ft(Le(t,Z(Wa(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nue={kernelName:_m,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>Ne(ht(n),"float32"),t:()=>Z(t,Ne(n,t.dtype)),e:()=>Z(t,Ne(eg(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kue={kernelName:Uh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=vs(n,Pe(0)),r=Pe(tv),a=Pe(nv),i=Z(t,a),o=Z(Z(t,r),Os(Ne(n,"float32")));return Dn(s,i,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eue={kernelName:Hh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Z(t,Z(n,Re(Pe(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ue={kernelName:Gh,gradFunc:t=>({x:()=>ht(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iue={kernelName:jh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Z(Km(Ne(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aue={kernelName:Wh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Z(xx(Ne(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rue={kernelName:Fm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:a}=n,i=s.shape,[o,l]=Jx(s,r,a),c=[];for(let f=0;f<t.rank;f++)c.push([o[f],i[f]-o[f]-l[f]]);return{x:()=>Gi(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Due={kernelName:Pm,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,a=!0,i=Z(t,s);return{logits:()=>Re(i,Z(Oe(i,[r],a),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oue={kernelName:qh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Z(t,oa(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b4={kernelName:Mm,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>Xm(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x4={kernelName:zm,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>an(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ue={kernelName:Xh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,Z(_n(Ne(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fue={kernelName:sx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Z(t,Z(Ne(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lue={kernelName:Kh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Pe(2);return{a:()=>Z(t,Z(r,Re(n,s))),b:()=>Z(t,Z(r,Re(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mue={kernelName:ef,gradFunc:t=>({x:()=>ht(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zue={kernelName:Yh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ke(n.shape,s.shape);return{a:()=>{let o=t;const l=bn(n.shape,r);return l.length>0&&(o=Oe(o,l)),J(o,n.shape)},b:()=>{let o=t;const l=bn(s.shape,r);return l.length>0&&(o=Oe(o,l)),J(Ft(o),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pue={kernelName:Lm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:a}=n;nt(a,s.shape).forEach(c=>{r[c]=1});const o=J(t,r),l=Z(o,$s(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bue={kernelName:Zh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Le(t,kt(Km(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vue={kernelName:Qh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Z(Re(Pe(1),kt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uue={kernelName:Jh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let i=ht(s);if(s.rank===1)for(let o=0;o<r[0];++o)i=ve(i,ct(t,[o*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)i=ve(i,ct(t,[o*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)i=ve(i,ct(t,[o*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let o=0;o<r[0];++o)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let f=0;f<r[3];++f)i=ve(i,ct(t,[o*s.shape[0],l*s.shape[1],c*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jue={kernelName:Kl,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,a=Qo(r);return{x:()=>ot(t,a)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wue={kernelName:Vm,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>ys(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gue={kernelName:Um,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Hue(t,n)}}};function Hue(t,e){const n=Xa(e,ht(e)),s=of(t,n);let r=Wi(e,Pe(0,"int32"));const a=s.rank-r.rank;for(let o=0;o<a;++o)r=jn(r,o+1);r=Vr(r,$s(s.shape,"bool"));const i=ht(s);return Dn(r,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const que={kernelName:jm,gradFunc:t=>({x:()=>ht(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xue=[MB,Goe,Hoe,qoe,Xoe,Koe,Yoe,Zoe,Qoe,Joe,ele,tle,rle,ole,lle,ule,cle,hle,fle,dle,ple,mle,yle,gle,vle,wle,Sle,Tle,Cle,Nle,mue,kle,Ele,$le,Ile,Ale,Dle,Rle,Ole,_le,Fle,Lle,Mle,zle,Ple,Ble,Vle,Ule,jle,Hle,g4,g4,qle,Yle,Jle,eue,tue,nue,sue,rue,aue,iue,oue,lue,uue,y4,y4,cue,hue,pue,gue,yue,bue,xue,vue,wue,Sue,Tue,Cue,Nue,kue,Eue,$ue,Iue,Aue,Rue,Due,Oue,b4,b4,x4,x4,_ue,Lue,Fue,Mue,zue,Pue,Bue,Vue,Uue,jue,Wue,Gue,que];for(const t of Xue)fP(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.abs=function(){return this.throwIfDisposed(),pn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.acos=function(){return this.throwIfDisposed(),XN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.acosh=function(){return this.throwIfDisposed(),KN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.add=function(t){return this.throwIfDisposed(),ve(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.all=function(t,e){return this.throwIfDisposed(),gx(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.any=function(t,e){return this.throwIfDisposed(),bp(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.argMax=function(t){return this.throwIfDisposed(),iu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.argMin=function(t){return this.throwIfDisposed(),YN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.asScalar=function(){return this.throwIfDisposed(),M(this.size===1,()=>"The array must have only 1 element."),J(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.asType=function(t){return this.throwIfDisposed(),Ne(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.as1D=function(){return this.throwIfDisposed(),J(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.as2D=function(t,e){return this.throwIfDisposed(),J(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),J(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),J(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),J(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.asin=function(){return this.throwIfDisposed(),ZN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.asinh=function(){return this.throwIfDisposed(),QN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.atan=function(){return this.throwIfDisposed(),JN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.atan2=function(t){return this.throwIfDisposed(),ek(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.atanh=function(){return this.throwIfDisposed(),tk(this)};pe().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),qm(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Xm(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),tf(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Yl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.cast=function(t){return this.throwIfDisposed(),Ne(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.ceil=function(){return this.throwIfDisposed(),lk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Ds(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof gt&&(t=[t]),an([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.conv1d=function(t,e,n,s,r,a){return this.throwIfDisposed(),yx(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),bx(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.conv2d=function(t,e,n,s,r,a){return this.throwIfDisposed(),_i(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.cos=function(){return this.throwIfDisposed(),Km(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.cosh=function(){return this.throwIfDisposed(),xx(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),wp(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),vx(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),gk(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.depthwiseConv2d=function(t,e,n,s,r,a){return this.throwIfDisposed(),nf(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),yk(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.divNoNan=function(t){return this.throwIfDisposed(),bk(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.div=function(t){return this.throwIfDisposed(),Le(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.dot=function(t){return this.throwIfDisposed(),xk(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.elu=function(){return this.throwIfDisposed(),sf(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.equal=function(t){return this.throwIfDisposed(),Hs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.erf=function(){return this.throwIfDisposed(),wx(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),wk(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.exp=function(){return this.throwIfDisposed(),Os(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.expandDims=function(t){return this.throwIfDisposed(),jn(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.expm1=function(){return this.throwIfDisposed(),Sk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.fft=function(){return this.throwIfDisposed(),lg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.flatten=function(){return this.throwIfDisposed(),J(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.floor=function(){return this.throwIfDisposed(),af(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.floorDiv=function(t){return this.throwIfDisposed(),mx(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.gather=function(t,e,n){return this.throwIfDisposed(),of(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Wi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.greater=function(t){return this.throwIfDisposed(),vs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.ifft=function(){return this.throwIfDisposed(),Xc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.irfft=function(){return this.throwIfDisposed(),Mx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.isFinite=function(){return this.throwIfDisposed(),Tk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.isInf=function(){return this.throwIfDisposed(),Ck(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.isNaN=function(){return this.throwIfDisposed(),Nk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.leakyRelu=function(t){return this.throwIfDisposed(),Zm(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.lessEqual=function(t){return this.throwIfDisposed(),Jo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.less=function(t){return this.throwIfDisposed(),Wc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),kk(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.logSigmoid=function(){return this.throwIfDisposed(),Ek(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.logSoftmax=function(t){return this.throwIfDisposed(),Cx(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),Jm(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.log=function(){return this.throwIfDisposed(),qs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.log1p=function(){return this.throwIfDisposed(),Qm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.logicalAnd=function(t){return this.throwIfDisposed(),Vr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.logicalNot=function(){return this.throwIfDisposed(),eg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.logicalOr=function(t){return this.throwIfDisposed(),Nx(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.logicalXor=function(t){return this.throwIfDisposed(),$k(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),tt(this,t,e,n)};pe().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),tg(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.max=function(t,e){return this.throwIfDisposed(),mr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.maximum=function(t){return this.throwIfDisposed(),Xa(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.mean=function(t,e){return this.throwIfDisposed(),Wt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.min=function(t,e){return this.throwIfDisposed(),jc(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.minimum=function(t){return this.throwIfDisposed(),Vo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),Ak(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.mod=function(t){return this.throwIfDisposed(),Rk(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.mul=function(t){return this.throwIfDisposed(),Z(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.neg=function(){return this.throwIfDisposed(),Ft(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.norm=function(t,e,n){return this.throwIfDisposed(),rf(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.notEqual=function(t){return this.throwIfDisposed(),uu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),Gc(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.onesLike=function(){return this.throwIfDisposed(),Xs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.pad=function(t,e){return this.throwIfDisposed(),Gi(this,t,e)};pe().prototype.pool=function(t,e,n,s,r,a){return this.throwIfDisposed(),Dk(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.pow=function(t){return this.throwIfDisposed(),Wa(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.prelu=function(t){return this.throwIfDisposed(),rg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.prod=function(t,e){return this.throwIfDisposed(),Ok(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.reciprocal=function(){return this.throwIfDisposed(),zk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.relu=function(){return this.throwIfDisposed(),ma(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.relu6=function(){return this.throwIfDisposed(),Ix(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.reshapeAs=function(t){return this.throwIfDisposed(),J(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.reshape=function(t){return this.throwIfDisposed(),J(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),P6(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),B6(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.reverse=function(t){return this.throwIfDisposed(),yr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.rfft=function(){return this.throwIfDisposed(),ug(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.round=function(){return this.throwIfDisposed(),Ax(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.rsqrt=function(){return this.throwIfDisposed(),Rx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.selu=function(){return this.throwIfDisposed(),Dx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.separableConv2d=function(t,e,n,s,r,a){return this.throwIfDisposed(),Ox(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.sigmoid=function(){return this.throwIfDisposed(),oa(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.sign=function(){return this.throwIfDisposed(),Pk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.sin=function(){return this.throwIfDisposed(),_x(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.sinh=function(){return this.throwIfDisposed(),Fx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.slice=function(t,e){return this.throwIfDisposed(),ct(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.softmax=function(t){return this.throwIfDisposed(),og(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.softplus=function(){return this.throwIfDisposed(),$u(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),sg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.split=function(t,e){return this.throwIfDisposed(),Is(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.sqrt=function(){return this.throwIfDisposed(),_n(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.square=function(){return this.throwIfDisposed(),kt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.squaredDifference=function(t){return this.throwIfDisposed(),zx(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.squeeze=function(t){return this.throwIfDisposed(),tl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof gt?[this,t]:[this,...t];return ys(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.step=function(t){return this.throwIfDisposed(),Iu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.stridedSlice=function(t,e,n,s,r,a,i,o){return this.throwIfDisposed(),Bk(this,t,e,n,s,r,a,i,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.sub=function(t){return this.throwIfDisposed(),Re(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.sum=function(t,e){return this.throwIfDisposed(),Oe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.tan=function(){return this.throwIfDisposed(),Vk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.tanh=function(){return this.throwIfDisposed(),Bo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.tile=function(t){return this.throwIfDisposed(),cr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.toBool=function(){return this.throwIfDisposed(),Ne(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.toFloat=function(){return this.throwIfDisposed(),Ne(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.toInt=function(){return this.throwIfDisposed(),Ne(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.topk=function(t,e){return this.throwIfDisposed(),Wk(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.transpose=function(t){return this.throwIfDisposed(),ot(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.unique=function(t){return this.throwIfDisposed(),Gk(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),Vx(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.unstack=function(t){return this.throwIfDisposed(),br(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.where=function(t,e){return this.throwIfDisposed(),Dn(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pe().prototype.zerosLike=function(){return this.throwIfDisposed(),ht(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ea extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ea.prototype)}}class Br extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Br.prototype)}}class te extends Error{constructor(e){super(e),Object.setPrototypeOf(this,te.prototype)}}class Ze extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ze.prototype)}}class OE extends Error{constructor(e){super(e),Object.setPrototypeOf(this,OE.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class PB{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function fu(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function $a(t,e){if(!t)throw new OE(e)}function v4(t,e){let n=0;for(const s of t)s===e&&n++;return n}function ks(t){return t.length===1?t[0]:t}function Ct(t){return Array.isArray(t)?t:[t]}function gi(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function zl(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let Fr={};function _E(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function YT(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>YT(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:YT(s))}}}function dg(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const a=t;let i;if(a in n)i=n[a];else if(a in Fr)i=Fr[a];else if(i=e[a],i==null)throw new te(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const a=t;if(a.className==null||a.config==null)throw new te(`${s}: Improper config format: ${JSON.stringify(a)}.
'className' and 'config' must set.`);const i=a.className;let o,l;if(i in n?[o,l]=n[i]:i in Fr?[o,l]=Fr.className:i in e&&([o,l]=e[i]),o==null)throw new te(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const g of Object.keys(Fr))c[g]=Fr[g];for(const g of Object.keys(n))c[g]=n[g];const f=a.config;f.customObjects=c;const d=Object.assign({},Fr);for(const g of Object.keys(n))Fr[g]=n[g];YT(a.config);const p=l(o,a.config,n,r);return Fr=Object.assign({},d),p}else{const c=Object.assign({},Fr);for(const d of Object.keys(n))Fr[d]=n[d];const f=new o(a.config);return Fr=Object.assign({},c),f}}}function Kue(t,e){return t<e?-1:t>e?1:0}function Y0(t,e){return-1*Kue(t,e)}function Io(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function Yue(t){if(t==null)throw new te(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Ru(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new te(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function FE(t,e,n=0,s=1/0){return $a(n>=0),$a(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function Rn(t,e){Array.isArray(t)?(M(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>Rn(n,`element ${s+1} of ${e}`))):M(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${BB(t)}.`)}function BB(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>BB(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function Zue(t,e,n){let s=n!=null?n():Un(),r;return(...i)=>{const o=n!=null?n():Un();return o-s<e||(s=o,r=t(...i)),r}}function VB(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Que=0;function UB(){return Que++}const Z0={};function sv(t=""){return t in Z0||(Z0[t]=0),Z0[t]+=1,t+Z0[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Jue=["channelsFirst","channelsLast"],ece=["nearest","bilinear"],tce=["valid","same","causal"],nce=["max","avg"],sce=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const vc=new Map;function cn(t){Ru(Jue,"DataFormat",t)}function rce(t){Ru(ece,"InterpolationFormat",t)}function vr(t){Ru(tce,"PaddingMode",t)}function jB(t){Ru(nce,"PoolMode",t)}const Jd=[],w4="/";function Zl(t,e){Jd.push(t);try{const n=e();return Jd.pop(),n}catch(n){throw Jd.pop(),n}}function ace(){return Jd.length===0?"":Jd.join(w4)+w4}function WB(t){if(!HB(t))throw new Error("Not a valid tensor name: '"+t+"'");return ace()+t}function GB(t){if(!HB(t))throw new Error("Not a valid tensor name: '"+t+"'");vc.has(t)||vc.set(t,0);const e=vc.get(t);if(vc.set(t,vc.get(t)+1),e>0){const n=`${t}_${e}`;return vc.set(n,1),n}else return t}const ice=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function HB(t){return!!t.match(ice)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oce(t){return t===parseInt(t.toString(),10)}function Ao(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function Kc(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function Uo(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function ca(t,e){if(e<t)throw new te(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let ES;function Cn(){return ES==null&&(ES=UN().epsilon()),ES}function ha(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Pa(t,e){return Ne(t,e)}function pg(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),J(t,n)}function lce(t,e){return re(()=>{if(t.shape.length!==2)throw new te(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=pg(t,1);return ZT(n,[1,e,1])})}function uce(t){const e=[Ao(t.shape)];return J(t,e)}function cce(t){if(t.rank<=1)throw new te(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Ao(t.shape,1)];return J(t,e)}function Ql(t,e,n){return re(()=>{switch(t.rank){case 1:return ag(t,e,n);case 2:return Lx(t,[e,0],[n,t.shape[1]]);case 3:return ig(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return qc(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return ct(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return ct(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new te(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function $S(t,e,n){return re(()=>{switch(t.rank){case 1:return ag(t,e,n);case 2:return Lx(t,[0,e],[t.shape[0],n]);case 3:return ig(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return qc(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new te(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Q0(t,e,n,s){return re(()=>{switch(t.rank){case 1:return ag(t,e,n);case 2:switch(s){case 1:return Ql(t,e,n);case 2:return $S(t,e,n);default:throw new te(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return Ql(t,e,n);case 2:return ig(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return $S(t,e,n);default:throw new te(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return Ql(t,e,n);case 2:return qc(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return qc(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return $S(t,e,n);default:throw new te(`The axis is not within the rank of the tensor ${s}`)}default:throw new te(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function LE(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),an(t,e)}function S4(t,e){switch(t.rank){case 1:return uk([t,e]);case 2:return ck([t,e],0);case 3:return hk([t,e],0);case 4:return fk([t,e],0);default:throw new te(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function ZT(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new te(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return cr(t,e)}function rv(t,e=0,n=1,s,r){return $x(t,e,n,s,r)}function Ba(t,e,n,s){if(t.rank<2||e.rank<2)throw new Ze(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],a=e.shape.slice(-2)[0];if(r!==a)throw new Ze(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return GT({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?QT(t.rank,s,ha()):null,activation:n});{const r=t.shape.slice(),a=r.pop();t=J(t,[-1,a]);const i=e.shape.slice(),o=i.pop(),l=i.pop(),c=[...i,o],f=Array.from({length:e.rank},(y,v)=>v===0?e.rank-2:v<=e.rank-2?v-1:v);e=J(ot(e,f),[l,-1]);const d=[...r,...c];return J(GT({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?QT(t.rank,s,ha()):null,activation:n}),d)}}function qB(t,e,n){return re(()=>(Array.isArray(e)?e=Hn(e,"int32"):e=Ne(e,"int32"),of(t,e,n)))}function mg(t){return Z(t,t)}function QT(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new te(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?J(e,[1,s[0],1,1,1]):J(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?J(e,[1,1,1,1,s[0]]):J(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?J(e,[1,s[0],1,1]):J(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?J(e,[1,1,1,s[0]]):J(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?J(e,[1,s[0],1]):J(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?J(e,[1,1,s[0]]):J(e,[1].concat(s))}else if(t<3)return e;throw new te(`Unsupported input rank by biasAdd: ${e.rank}`)}function ga(t,e,n){return re(()=>(n==null&&(n=ha()),cn(n),ve(t,QT(t.rank,e,n))))}function hce(t,e=1){if(e!==1)throw new Ze(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return sf(t)}function fce(t){return re(()=>Le(t,ve(pn(t),1)))}function XB(t,e,n,s){return re(()=>Xk(t,e,n,s))}function dce(t){return re(()=>{const e=ve(.5,Z(.2,t));return Ds(e,0,1)})}function gg(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const pce=["fanIn","fanOut","fanAvg"],mce=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gce(t){Ru(pce,"FanMode",t)}function yce(t){Ru(mce,"Distribution",t)}class jr extends Au{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class ME extends jr{apply(e,n){return mn(e,n)}}ME.className="Zeros";Se(ME);class av extends jr{apply(e,n){return $s(e,n)}}av.className="Ones";Se(av);class zE extends jr{constructor(e){if(super(),typeof e!="object")throw new te(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new te(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return re(()=>Z(Pe(this.value),$s(e,n)))}getConfig(){return{value:this.value}}}zE.className="Constant";Se(zE);class PE extends jr{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return el(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}PE.className="RandomUniform";Se(PE);class BE extends jr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ze(`randomNormal does not support dType ${n}.`);return rv(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}BE.className="RandomNormal";Se(BE);class VE extends jr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ze(`truncatedNormal does not support dType ${n}.`);return Bx(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}VE.className="TruncatedNormal";Se(VE);class UE extends jr{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return re(()=>{if(e.length!==2||e[0]!==e[1])throw new te("Identity matrix initializer can only be used for 2D square matrices.");return Z(this.gain,Sx(e[0]))})}getConfig(){return{gain:this.gain}}}UE.className="Identity";Se(UE);function bce(t,e="channelsLast"){let n,s;if(cn(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=Ao(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=Ao(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=Ao(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class _s extends jr{constructor(e){if(super(),e.scale<0)throw new te(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,gce(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,yce(this.distribution),this.seed=e.seed}apply(e,n){const s=bce(e),r=s[0],a=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,r):this.mode==="fanOut"?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),this.distribution==="normal"){const o=Math.sqrt(i);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ze(`${this.getClassName()} does not support dType ${n}.`);return Bx(e,0,o,n,this.seed)}else{const o=Math.sqrt(3*i);return el(e,-o,o,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}_s.className="VarianceScaling";Se(_s);class iv extends _s{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return _s.className}}iv.className="GlorotUniform";Se(iv);class ov extends _s{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return _s.className}}ov.className="GlorotNormal";Se(ov);class lv extends _s{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return _s.className}}lv.className="HeNormal";Se(lv);class uv extends _s{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return _s.className}}uv.className="HeUniform";Se(uv);class cv extends _s{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return _s.className}}cv.className="LeCunNormal";Se(cv);class hv extends _s{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return _s.className}}hv.className="LeCunUniform";Se(hv);class jE extends jr{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return re(()=>{if(e.length<2)throw new Ze("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=de(e.slice(0,-1)),r=e[e.length-1],a=s*r;a>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${a}) elements: Slowness may result.`);const i=[Math.max(r,s),Math.min(r,s)],o=rv(i,0,1,n,this.seed),l=Qk.qr(o,!1);let c=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=Z(c,d.sign()),s<r&&(c=c.transpose()),Z(Pe(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}jE.className="Orthogonal";Se(jE);const T4={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function C4(t,e={}){return dg(t,ur.getMap().classNameMap,e,"initializer")}function Gt(t){return _E(t)}function Vt(t){if(typeof t=="string"){const e=t in T4?T4[t]:t;if(e==="GlorotNormal")return new ov;if(e==="GlorotUniform")return new iv;if(e==="HeNormal")return new lv;if(e==="HeUniform")return new uv;if(e==="LeCunNormal")return new cv;if(e==="LeCunUniform")return new hv;{const n={};return n.className=e,n.config={},C4(n)}}else return t instanceof jr?t:C4(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function JT(t){return Array.isArray(t)&&Array.isArray(t[0])}function C1(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function qe(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new te(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function xt(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new te(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function N1(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const N4="Variable";class KB{constructor(e,n="float32",s=N4,r=!0,a=null){this.dtype=n??"float32",this.shape=e.shape,this.id=UB(),s=s??N4,this.originalName=WB(s),this.name=GB(this.originalName),this.trainable_=r,this.constraint=a,this.val=Hk(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),xce(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function xce(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function eC(t){return t.map(e=>e.read())}function WE(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class gn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class fa{constructor(e,n,s,r,a,i,o){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=a,this.outputTensorIndex=o,this.id=UB(),i!=null&&(this.originalName=WB(i),this.name=GB(this.originalName)),this.rank=n.length}}let vce=0,fv=class{constructor(e,n){this.callArgs=n,this.id=vce++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},wce=0;class st extends Au{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=wce++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=gi(s)+"_"+sv(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let a=null;e.batchSize!=null&&(a=e.batchSize),s=[a].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Br(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new te(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return ks(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return ks(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Ea(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Ea(`Layer ${this.name} is not connected, no input to return.`);return ks(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Ea(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Ea(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return ks(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=Ct(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Ct(this.inputSpec);if(n.length!==s.length)throw new te(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let r=0;r<n.length;r++){const a=n[r],i=s[r];if(i==null)continue;const o=a.rank;if(i.ndim!=null&&o!==i.ndim)throw new te(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${o}`);if(i.maxNDim!=null&&o>i.maxNDim)throw new te(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${o}`);if(i.minNDim!=null&&o<i.minNDim)throw new te(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${o}.`);if(i.dtype!=null&&a.dtype!==i.dtype)throw new te(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${a.dtype}.`);if(i.axes){const l=a.shape;for(const c in i.axes){const f=Number(c),d=i.axes[c],p=f>=0?l[f]:l[l.length+f];if(d!=null&&[d,null].indexOf(p)===-1)throw new te(`Input ${r} is incompatible with layer ${this.name}: expected axis ${f} of input shape to have value ${d} but got shape ${l}.`)}}if(i.shape!=null)for(let l=0;l<i.shape.length;++l){const c=i.shape[l],f=a.shape[l];if(c!=null&&f!=null&&c!==f)throw new te(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${a.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=Ct(e),r=Cce(e),a=Nce(e);if(r===a)throw new te("Arguments to apply() must be all SymbolicTensors or all Tensors");return Zl(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const o of Ct(e))i.push(o.shape);this.build(ks(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&a&&(this._refCount=1)}if(this.assertInputCompatibility(e),a){let i=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,i);const o=Ct(i),l=[];for(let c of o)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(i=ks(l),this.activityRegularizer!=null)throw new Ze("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=Sce(e),o=this.computeOutputShape(i);let l;const c=Tce(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),o!=null&&o.length>0&&Array.isArray(o[0])?l=o.map((f,d)=>new fa(c,f,this,Ct(e),n,this.name,d)):l=new fa(c,o,this,Ct(e),n,this.name),this.addInboundNode(e,l,null,null,i,o,n),this._refCount++,this.activityRegularizer!=null)throw new Ze("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Ea(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new Ea(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Br(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return N1(this.weights)}build(e){this.built=!0}getWeights(e=!1){return eC(e?this.trainableWeights:this.weights)}setWeights(e){re(()=>{const n=this.weights;if(n.length!==e.length)throw new te(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=eC(n);for(let a=0;a<r.length;++a){const i=r[a],o=n[a],l=e[a];if(!at(i.shape,l.shape))throw new te(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);s.push([o,l])}WE(s)})}addWeight(e,n,s,r,a,i,o,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new te(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():Vt("zeros"));const c=r.apply(n,s),f=new KB(c,s,e,i,o);return c.dispose(),a!=null&&this.addLoss(()=>a.apply(f.read())),i==null&&(i=!0),i?this._trainableWeights.push(f):this._nonTrainableWeights.push(f),f}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Ct(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),a=Ct(n),i=Ct(r);if(a.length!==i.length)throw new Error(`${this.name} outputs ${a.length} tensors but ${a.length} masks for those tensors`);for(let o=0;o<a.length;o++)a[o].kerasMask=i[o]}addInboundNode(e,n,s,r,a,i,o=null){const l=Ct(e);n=Ct(n),s=Ct(s),r=Ct(r),a=C1(a),i=C1(i);const c=[],f=[],d=[];for(const p of l)c.push(p.sourceLayer),f.push(p.nodeIndex),d.push(p.tensorIndex);new fv({outboundLayer:this,inboundLayers:c,nodeIndices:f,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:a,outputShapes:i},o);for(let p=0;p<n.length;p++)n[p].sourceLayer=this,n[p].nodeIndex=this.inboundNodes.length-1,n[p].tensorIndex=p}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function Sce(t){t=Ct(t);const e=[];for(const n of t)e.push(n.shape);return ks(e)}function Tce(t){return"float32"}function YB(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let a=0;a<s.inboundLayers.length;a++){const i=s.inputTensors[a],o=s.inboundLayers[a],l=s.nodeIndices[a],c=YB(i,o,l);for(const f of c)r.indexOf(f)===-1&&r.push(f)}return r}}}function Cce(t){let e=!0;for(const n of Ct(t))if(!(n instanceof fa)){e=!1;break}return e}function Nce(t){let e=!0;for(const n of Ct(t))if(n instanceof fa){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class uf extends st{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:sv("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new te("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new te("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new te("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new fa(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new fv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new te(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}uf.className="InputLayer";Se(uf);function ZB(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new te("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new uf({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kce(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return Ne(e,t.dtype)}catch{throw new te(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Co{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Co)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=kce(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new te(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof fa){if(this.id2Value[e.id]==null)throw new te(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new te(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof fa){if(this.id2Value[e.id]==null)throw new te(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new te(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Xe(this.id2Mask)}}const k1=new PB,E1=new PB;function Ece(t){k1!=null&&k1.setMaxEntries(t),E1!=null&&E1.setMaxEntries(t)}function Pd(t,e,n,s){const r=n==null?!1:n.training,a=Array.isArray(t),i=a?t:[t],o=i.map(y=>y.name),l=[],c=e.names();for(const y of o)c.indexOf(y)!==-1?l.push(e.getValue(y)):l.push(null);const f=o.join(",")+"|"+e.names().sort().join(",");let d=k1.get(f),p;if(d==null){const y=$ce(i,e);d=y.sorted,p=y.recipientCounts,k1.put(f,d),E1.put(f,p)}p={},r||Object.assign(p,E1.get(f));const g=new Co(e);for(let y=0;y<d.length;++y){const v=d[y],x=v.sourceLayer;if(x instanceof uf)continue;const w=[],T=[],N=[];let C=!1;for(const A of v.inputs){const _=g.getValue(A),D=g.getMask(A);w.push(_),T.push(D),D!=null&&(C=!0),r||(p[A.name]--,p[A.name]===0&&!e.hasKey(A)&&o.indexOf(A.name)===-1&&!_.isDisposed&&A.sourceLayer.stateful!==!0&&N.push(_))}C&&(n=n||{},n.mask=T[0]);const E=Ct(x.apply(w,n));let R=null;x.supportsMasking&&(R=x.computeMask(w,T));const $=Ace(v),O=Array.isArray($)?$:[$];for(let A=0;A<O.length;++A){g.hasKey(O[A])||g.add(O[A],E[A],Array.isArray(R)?R[0]:R);const _=o.indexOf(O[A].name);_!==-1&&(l[_]=E[A])}r||Xe(N)}return g.disposeMasks(),a?l:l[0]}function $ce(t,e){M(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=k4(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const a of t){const{sorted:i,recipientMap:o}=k4(a,e);for(const l of i)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in o)s[l]==null&&(s[l]=new Set),o[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:Ice(s)}}function Ice(t){const e={};for(const n in t)e[n]=t[n].size;return e}function k4(t,e){const n=new Set,s=[],r={};for(const o of e.names())n.add(o);const a=[],i=[];for(a.push(t);a.length>0;){const o=a[a.length-1];if(n.has(o.name)){a.pop();continue}const l=i[i.length-1]===a.length-1;if(o.inputs.length===0||l)a.pop(),s.push(o),n.add(o.name),l&&i.pop();else{i.push(a.length-1);for(const c of o.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(o.name),!n.has(c.name)&&a.push(c)}}return{sorted:s,recipientMap:r}}function Ace(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rce=ae();Rce.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,Ece);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function GE(t,e){return re(()=>_n(Oe(Z(t,t),e,!0)))}class yg extends Au{getConfig(){return{}}}class HE extends yg{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return re(()=>{const n=GE(e,this.axis),s=Ds(n,0,this.maxValue);return Z(e,Le(s,ve(Cn(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}HE.className="MaxNorm";Se(HE);class qE extends yg{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return re(()=>Le(e,ve(Cn(),GE(e,this.axis))))}getConfig(){return{axis:this.axis}}}qE.className="UnitNorm";Se(qE);class XE extends yg{apply(e){return ma(e)}}XE.className="NonNeg";Se(XE);class KE extends yg{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return re(()=>{const n=GE(e,this.axis),s=ve(Z(this.rate,Ds(n,this.minValue,this.maxValue)),Z(1-this.rate,n));return Z(e,Le(s,ve(Cn(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}KE.className="MinMaxNorm";Se(KE);const E4={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Nn(t){return _E(t)}function $4(t,e={}){return dg(t,ur.getMap().classNameMap,e,"constraint")}function kn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in E4?E4[t]:t,config:{}};return $4(n)}else return t instanceof yg?t:$4(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dce(t){return new HE(t)}function Oce(t){return new qE(t)}function _ce(){return new XE}function Fce(t){return new KE(t)}const Lce=Object.freeze(Object.defineProperty({__proto__:null,maxNorm:Dce,minMaxNorm:Fce,nonNeg:_ce,unitNorm:Oce},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Mce(){return new ME}function zce(){return new av}function Pce(t){return new zE(t)}function Bce(t){return new PE(t)}function Vce(t){return new BE(t)}function Uce(t){return new VE(t)}function jce(t){return new UE(t)}function Wce(t){return new _s(t)}function Gce(t){return new iv(t)}function Hce(t){return new ov(t)}function qce(t){return new lv(t)}function Xce(t){return new uv(t)}function Kce(t){return new cv(t)}function Yce(t){return new hv(t)}function Zce(t){return new jE(t)}const Qce=Object.freeze(Object.defineProperty({__proto__:null,constant:Pce,glorotNormal:Hce,glorotUniform:Gce,heNormal:qce,heUniform:Xce,identity:jce,leCunNormal:Kce,leCunUniform:Yce,ones:zce,orthogonal:Zce,randomNormal:Vce,randomUniform:Bce,truncatedNormal:Uce,varianceScaling:Wce,zeros:Mce},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function wo(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const a=t[r];if(typeof a!="number"){const i=a;e.push(i.data()),n.push(r),s.push(i)}}if(e.length>0){const r=await Promise.all(e);for(let a=0;a<r.length;++a)t[n[a]]=r[a][0];Xe(s)}}function QB(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var I4;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(I4||(I4={}));const Jce=125;class Yc{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class JB{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class ehe extends Yc{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const a=n[r];if(typeof a=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+a*s;else{let i;r in this.totals?i=this.totals[r]:this.totals[r]=0;const o=re(()=>ve(this.totals[r],Z(a,s)));this.totals[r]=o,i!=null&&i.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:re(()=>{const r=Z(Le(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),Tn(n[s])}))}}class eV extends Yc{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const a in this.history){const i=this.history[a];for(let o=0;o<i.length;++o)if(typeof i[o]!="number"){const l=i[o];e.push(l.data()),n.push(a),s.push(o)}}const r=await Promise.all(e);for(let a=0;a<r.length;++a)this.history[n[a]][s[a]].dispose(),this.history[n[a]][s[a]]=r[a][0]}}class tV extends Yc{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||dE,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Jce),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");m1(this.yieldEvery)&&(this.maybeWait=Zue(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await wo(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await wo(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await wo(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await wo(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await wo(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):m1(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await wo(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await wo(e),await this.trainEnd(e))}}function nV(t,e){return t==null&&(t={}),t instanceof Yc?[t]:Array.isArray(t)&&t[0]instanceof Yc?t:Ct(t).map(s=>new tV(s,e))}class or{constructor(){}static registerCallbackConstructor(e,n){M(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),or.checkForDuplicate(n),or.constructors[e]==null&&(or.constructors[e]=[]),or.constructors[e].push(n)}static checkForDuplicate(e){for(const n in or.constructors)or.constructors[+n].forEach(r=>{if(r===e)throw new te("Duplicate callback constructor.")})}static clear(){or.constructors={}}static createCallbacks(e){const n=[];for(const s in or.constructors){const r=+s;e>=r&&n.push(...or.constructors[r])}return n.map(s=>new s)}}or.constructors={};function sV(t,e,n,s,r,a,i,o,l){const c=new eV,f=[new ehe,...or.createCallbacks(e)];t!=null&&f.push(...t),f.push(c);const d=new JB(f);return d.setParams({epochs:n,initialEpoch:s,samples:r,steps:a,batchSize:i,verbose:e,doValidation:o,metrics:l}),{callbackList:d,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function la(t,e={},n=!1){return dg(t,ur.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $1(t,e){return re(()=>{t.dtype!=="float32"&&(t=Ne(t,"float32"));const n=Oe(mg(t),e,!0),s=Eu(n.shape,Cn()),r=_n(Xa(n,s));return Le(t,r)})}function Du(t,e){return re(()=>Wt(mg(Re(e,t)),-1))}function dv(t,e){return re(()=>Wt(pn(Re(e,t)),-1))}function cf(t,e){return re(()=>{const n=Re(t,e),s=Ds(pn(t),Cn(),Number.MAX_VALUE),r=pn(Le(n,s));return Z(100,Wt(r,-1))})}function the(t,e){return re(()=>{const n=Ds(e,Cn(),Number.MAX_VALUE),s=qs(ve(1,n)),r=Ds(t,Cn(),Number.MAX_VALUE),a=qs(ve(1,r));return Wt(mg(Re(s,a)),-1)})}function nhe(t,e){return re(()=>{const n=Xa(0,Re(1,Z(t,e)));return Wt(mg(n),-1)})}function she(t,e){return re(()=>{const n=Xa(0,Re(1,Z(t,e)));return Wt(n,-1)})}function rhe(t,e){return re(()=>{const n=Oe(Z(t,e),-1),s=mr(Z(Re(1,t),e),-1);return Xa(0,ve(1,Re(s,n)))})}function ahe(t,e){return re(()=>{const n=Math.log(2),s=Re(e,t),r=Re(ve(s,$u(Z(-2,s))),n);return Wt(r,-1)})}function Sp(t,e,n=!1){return re(()=>{if(n)e=og(e);else{const s=Oe(e,e.shape.length-1,!0);e=Le(e,s)}return e=Ds(e,Cn(),1-Cn()),Ft(Oe(Z(Ne(t,"float32"),qs(e)),e.shape.length-1))})}function I1(t,e,n=!1){return re(()=>{const s=Ne(af(uce(t)),"int32");e=Ds(e,Cn(),1-Cn());const r=e.shape,a=J(Gc(s,r[r.length-1]),r);return Sp(a,e,n)})}function ihe(t,e){if(!at(t.shape,e.shape))throw new te(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return re(()=>{const n=ma(e),s=Ft(pn(e));return ve(Re(n,Z(e,t)),Qm(Os(s)))})}function pv(t,e){return re(()=>{let n;return n=Ds(e,Cn(),1-Cn()),n=qs(Le(n,Re(1,n))),Wt(ihe(t,n),-1)})}function ohe(t,e){return re(()=>{const n=Ds(t,Cn(),1),s=Ds(e,Cn(),1);return Oe(Z(t,qs(Le(n,s))),-1)})}function lhe(t,e){return re(()=>{const n=qs(ve(Cn(),e));return Wt(Re(e,Z(t,n)),-1)})}function YE(t,e){return re(()=>{const n=$1(t,-1),s=$1(e,-1),r=Z(n,s);return Ft(Oe(r,-1))})}const A1={meanSquaredError:Du,meanAbsoluteError:dv,meanAbsolutePercentageError:cf,meanSquaredLogarithmicError:the,squaredHinge:nhe,hinge:she,categoricalHinge:rhe,logcosh:ahe,categoricalCrossentropy:Sp,sparseCategoricalCrossentropy:I1,binaryCrossentropy:pv,kullbackLeiblerDivergence:ohe,poisson:lhe,cosineProximity:YE};function IS(t){if(typeof t=="string"){if(t in A1)return A1[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new te(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ZE(t,e){return re(()=>{const n=Z(.5,Xs(e)),s=Pa(vs(e,n),t.dtype);return Wt(Hs(t,s),-1)})}function QE(t,e){return re(()=>Pa(Hs(iu(t,-1),iu(e,-1)),"float32"))}function rV(t,e){return re(()=>Ne(Oe(Vr(Hs(t,1),Hs(e,1))),"float32"))}function uhe(t,e){return re(()=>Ne(Oe(Vr(Hs(t,1),Hs(e,0))),"float32"))}function che(t,e){return re(()=>Ne(Oe(Vr(Hs(t,0),Hs(e,1))),"float32"))}function aV(t,e){return re(()=>{const n=rV(t,e),s=che(t,e),r=ve(n,s);return Ne(Dn(vs(r,0),Le(n,r),0),"float32")})}function hhe(t,e){return re(()=>{const n=rV(t,e),s=uhe(t,e),r=ve(n,s);return Ne(Dn(vs(r,0),Le(n,r),0),"float32")})}function iV(t,e){return pv(t,e)}function oV(t,e){return t.rank===e.rank&&(t=tl(t,[t.rank-1])),e=iu(e,-1),e.dtype!==t.dtype&&(e=Ne(e,t.dtype)),Ne(Hs(t,e),"float32")}function fhe(t,e){return re(()=>{const n=t.sub(e).square().sum(),s=t.sub(t.mean()).square().sum();return Pe(1).sub(n.div(s))})}const dhe=Du,phe=Du,mhe=dv,ghe=dv,yhe=cf,bhe=cf,JE=Sp,xhe=YE,lV=I1,R1={binaryAccuracy:ZE,categoricalAccuracy:QE,precision:aV,categoricalCrossentropy:JE,sparseCategoricalCrossentropy:lV,mse:dhe,MSE:phe,mae:mhe,MAE:ghe,mape:yhe,MAPE:bhe,cosine:xhe};function vhe(t){if(typeof t=="string"&&t in R1)return R1[t];if(typeof t!="string"&&t!=null)return t;throw new te(`Unknown metric ${t}`)}function J0(t){if($a(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(A1))if(A1[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(R1))if(R1[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function whe(t){const e={Adagrad:()=>Fl.adagrad(.01),Adadelta:()=>Fl.adadelta(1,.95,Cn()),Adam:()=>Fl.adam(.001,.9,.999,Cn()),Adamax:()=>Fl.adamax(.002,.9,.999,Cn(),0),RMSProp:()=>Fl.rmsprop(.001,.9,0,Cn()),SGD:()=>Fl.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new te(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const A4=1*1024*1024;function R4(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!tC(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>A4&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${A4}.`)}}function tC(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!tC(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!tC(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function She(t,e,n,s=console.log){const r=Che(t),a=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(f=>Math.floor(e*f)));let i;if(!r){a.push("Receives inputs"),i=[];for(const f in t.nodesByDepth)i.push(...t.nodesByDepth[f])}s("_".repeat(e)),D1(a,n,s),s("=".repeat(e));const o=t.layers;for(let f=0;f<o.length;++f)r?Nhe(o[f],n,s):khe(o[f],n,i,s),s((f===o.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=The(t),c=N1(t.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function The(t){let e;return t.collectedTrainableWeights!=null?e=N1(t.collectedTrainableWeights):e=N1(t.trainableWeights),e}function Che(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let a=!1;for(const i of r.inboundNodes)if(s.indexOf(i)!==-1)if(a){e=!1;break}else a=!0;if(!e)break}return e}function D1(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function Nhe(t,e,n){let s,r;try{r=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const a=t.name,i=t.getClassName(),o=[`${a} (${i})`,r,s,t.countParams().toString()];D1(o,e,n)}function khe(t,e,n,s){let r,a;try{a=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{a="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const i=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let p=0;p<d.inboundLayers.length;++p){const g=d.inboundLayers[p].name,y=d.nodeIndices[p],v=d.tensorIndices[p];i.push(`${g}[${y}][${v}]`)}const o=t.name,l=t.getClassName(),c=i.length===0?"":i[0],f=[`${o} (${l})`,a,r,t.countParams().toString(),c];D1(f,e,s);for(let d=1;d<i.length;++d)D1(["","","","",i[d]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function uV(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function Tp(t,e){if(t===null)return null;if(typeof t=="string")return zl(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const a=t[r];uV(e,r,a)?n.push(a):n.push(Tp(a,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const a=zl(s);n[a]=Tp(r,a)}}return n}}function nC(t,e){if(t==null)return null;if(typeof t=="string")return gi(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const a=t[r];uV(e,r,a)?n.push(a):n.push(nC(a,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],a=gi(s);(s==="name"||s==="className")&&typeof r=="string"?n[a]=r:n[a]=nC(r,s)}return n}}/** @license See the LICENSE file. */const mv="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Ehe=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class na extends st{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const T=this.getClassName().toLowerCase();this.name=sv(T)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Io(this.inputs).length!==this.inputs.length)throw new te(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(T=>T.name)}`);Io(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(T=>T.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const T of this.outputs){const N=T.sourceLayer,C=T.nodeIndex,E=T.tensorIndex;this.outputLayers.push(N),this.outputLayersNodeIndices.push(C),this.outputLayersTensorIndices.push(E)}for(const T of this.inputs){const N=T.sourceLayer,C=T.nodeIndex,E=T.tensorIndex;$a(C===0,"input layer has >1 nodes"),$a(E===0,"input layer has >1 tensors"),this.inputLayers.push(N),this.inputLayersNodeIndices.push(C),this.inputLayersTensorIndices.push(E)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let T=0;T<this.inputLayers.length;T++){const N=this.inputLayers[T];if(!(N instanceof uf))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${T} (0-based) originates from layer type ${N.getClassName()}.`);this.inputNames.push(N.name),this.feedInputShapes.push(N.batchInputShape),this.feedInputNames.push(N.name)}for(const T of this.outputLayers)this.outputNames.push(T.name);this.internalInputShapes=this.inputs.map(T=>T.shape),this.internalOutputShapes=this.outputs.map(T=>T.shape);const n={},s={},r={},a={},i={},o=[],l=(T,N,C,E,R,$)=>{(E==null||R==null||$==null)&&(E=T.sourceLayer,R=T.nodeIndex,$=T.tensorIndex);const O=E.inboundNodes[R];if(C.indexOf(O)!==-1)throw new Br(`The tensor ${T.name} at layer "${E.name}" is part of a cycle.`);if(N.indexOf(O)!==-1)return;this.containerNodes.add(na.nodeKey(E,R)),E.id in i||(i[E.id]=Object.keys(i).length),C.indexOf(O)===-1&&C.push(O);const A=O.inboundLayers.length;for(let _=0;_<A;_++){const D=O.inputTensors[_],B=O.inboundLayers[_],j=O.nodeIndices[_],W=O.tensorIndices[_];l(D,N,C,B,j,W)}for(N.push(O);C.indexOf(O)>=0;)C.splice(C.indexOf(O),1);o.push(O)},c=[],f=[];for(const T of this.outputs)l(T,c,f);const d=o.slice().reverse();for(const T of d){s[T.id]=T,T.id in n||(n[T.id]=0);let N=n[T.id];const C=r[T.outboundLayer.id]==null?0:r[T.outboundLayer.id];N=Math.max(N,C),r[T.outboundLayer.id]=N,a[T.outboundLayer.id]=T.outboundLayer,n[T.id]=N;for(let E=0;E<T.inboundLayers.length;E++){const R=T.inboundLayers[E],$=T.nodeIndices[E],O=R.inboundNodes[$],A=n[O.id]==null?0:n[O.id];n[O.id]=Math.max(N+1,A),s[O.id]=O}}const p={};for(const T in n){const N=n[T];N in p||(p[N]=[]),p[N].push(s[T])}const g={};for(const T in r){const N=r[T];N in g||(g[N]=[]),g[N].push(a[T])}let y=Object.keys(g).map(T=>parseInt(T,10)).sort(Y0);this.layers=[];for(const T of y){const N=g[T];N.sort((C,E)=>{const R=i[C.id],$=i[E.id];return R<$?-1:R>$?1:0});for(const C of N)C instanceof na&&this.internalContainerRefs.push(C),this.layers.push(C)}this.layersByDepth=g,y=Object.keys(p).map(T=>parseInt(T,10)).sort(Y0);const v=this.inputs.slice(),x=[];for(const T of y)for(const N of p[T]){const C=N.outboundLayer;if(C!=null){for(const E of N.inputTensors)if(v.indexOf(E)===-1)throw new Br(`Graph disconnected: cannot obtain value for tensor ${E} at layer "${C.name}". The following previous layers were accessed without issue: ${x}`);for(const E of N.outputTensors)v.push(E);x.push(C.name)}}this.nodesByDepth=p;const w=this.layers.map(T=>T.name);for(const T of w){const N=w.filter(C=>C===T).length;if(N!==1)throw new Br(`The name "${T}" is used ${N} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(w))}this.outboundNodes=[],this.inboundNodes=[],new fv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(T=>null),outputMasks:this.outputs.map(T=>null),inputShapes:this.inputs.map(T=>T.shape),outputShapes:this.outputs.map(T=>T.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new te("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;const a=Ehe(e);a&&this.parseWeights(e);for(const o of this.layers)for(const[l,c]of o.weights.entries()){const f=a?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[f]!=null)throw new te(`Duplicate weight name: ${f}`);s[f]=c,r++}const i=[];for(const o in e){let l=o;if(s[o]==null){const c=o.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)i.push([s[l],e[o]]);else if(n)throw new te(`Provided weight data has no target variable: ${o}`);delete s[l]}if(n){const o=[];for(const l in s)o.push(l);if(o.length>0)throw new te(`${o.length} of ${r} weights are not set: ${o}`)}WE(i)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],a=s.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!r.includes(i)).join("/");a!==n&&(e[a]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${mv}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=nC(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return re(()=>{e=Ct(e);const s=new Co;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return Pd(this.outputs,s,n)})}computeMask(e,n){return re(()=>{e=Ct(e);let s;return n==null?s=fu(null,e.length):s=Ct(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=C1(e);if(n.length!==this.inputLayers.length)throw new te(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let o=0;o<n.length;o++){const l=this.inputLayers[o],c=n[o],f=l.name+"_0_0";s[f]=c}const r=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(Y0);if(r.length>1)for(const o of r){const l=this.nodesByDepth[o];for(const c of l){const f=c.outboundLayer;if(this.inputLayers.map(v=>v.id).indexOf(f.id)!==-1)continue;const d=[];for(let v=0;v<c.inboundLayers.length;v++){const x=c.inboundLayers[v],w=c.nodeIndices[v],T=c.tensorIndices[v],N=`${x.name}_${w}_${T}`,C=s[N];d.push(C)}const p=f.computeOutputShape(ks(d)),g=C1(p),y=f.inboundNodes.indexOf(c);for(let v=0;v<g.length;v++){const x=`${f.name}_${y}_${v}`;s[x]=g[v]}}}const a=[],i=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],c=this.outputLayersNodeIndices[o],f=this.outputLayersTensorIndices[o],d=`${l.name}_${c}_${f}`;i.push(d)}for(let o=0;o<i.length;o++){const l=i[o];$a(l in s),a.push(s[l])}return ks(a)}runInternalGraph(e,n){n==null&&(n=fu(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],f=e[l],d=n[l];s[c.id]=[f,d]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Y0);for(const l of r){const c=this.nodesByDepth[l];for(const f of c){const d=f.outboundLayer,p=f.inputTensors,g=f.outputTensors,y=new Array;for(const v of p)v.id in s&&y.push(s[v.id]);if(y.length===p.length){let v={},x,w,T,N;if(f.callArgs!=null&&(v=f.callArgs),y.length===1){const[C,E]=y[0];v.mask==null&&(v.mask=E),T=Ct(d.call(C,v)),N=Ct(d.computeMask(C,E)),x=[C],w=[E]}else x=y.map(C=>C[0]),w=y.map(C=>C[1]),v.mask==null&&(v.mask=w),T=Ct(d.call(x,v)),N=Ct(d.computeMask(x,w));if(d.activityRegularizer)throw new Ze("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let C=0;C<g.length;++C){const E=g[C],R=T[C],$=N[C];s[E.id]=[R,$]}}}}const a=[],i=[],o=[];for(const l of this.outputs){$a(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,f]=s[l.id];o.push(c.shape),a.push(c),i.push(f)}return[a,i,o]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof na?1:0;for(let a=0;a<r.inboundNodes.length;a++){const i=na.nodeKey(r,a);this.containerNodes.has(i)&&(n[i]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new te("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new te(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new te(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return re(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=na.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const o=i.getClassName(),l=i.getConfig(),c=[];for(let d=0;d<i.inboundNodes.length;d++){const p=i.inboundNodes[d],g=na.nodeKey(i,d);let y={};if(this.containerNodes.has(g)){if(p.callArgs)try{JSON.stringify(p.callArgs),y=p.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${p.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),y={}}if(p.inboundLayers.length>0){const v=[];for(let x=0;x<p.inboundLayers.length;x++){const w=p.inboundLayers[x],T=p.nodeIndices[x],N=p.tensorIndices[x],C=na.nodeKey(w,T);let E=n[C];E==null&&(E=0),v.push([w.name,E,N,y])}c.push(v)}}}const f={};f.name=i.name,f.className=o,f.config=l,f.inboundNodes=c,s.push(f)}e.layers=s;const r=[];for(let i=0;i<this.inputLayers.length;i++){const o=this.inputLayers[i],l=this.inputLayersNodeIndices[i],c=na.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let f=n[c];f==null&&(f=0);const d=this.inputLayersTensorIndices[i];r.push([o.name,f,d])}e.inputLayers=r;const a=[];for(let i=0;i<this.outputLayers.length;i++){const o=this.outputLayers[i],l=this.outputLayersNodeIndices[i],c=na.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let f=n[c];f==null&&(f=0);const d=this.outputLayersTensorIndices[i];a.push([o.name,f,d])}return e.outputLayers=a,e}static fromConfig(e,n,s={},r=!1){const a={},i={};function o(x,w){x.name in i?i[x.name].push(w):i[x.name]=[w]}function l(x,w){const T=[];let N;for(const C of w){const E=C[0],R=C[1],$=C[2];if(N=C[3]==null?{}:C[3],!(E in a)){o(x,w);return}const O=a[E];if(O.inboundNodes.length<=R){o(x,w);return}const A=O.inboundNodes[R];T.push(A.outputTensors[$])}T.length>0&&x.apply(ks(T),N)}function c(x){const w=x.name,T=la(x,n.customObjects!=null?n.customObjects:{});T.setFastWeightInitDuringBuild(r),a[w]=T,x.inboundNodes.forEach(C=>{if(!(C instanceof Array))throw new te(`Corrupted configuration, expected array for nodeData: ${C}`);o(T,C)})}const f=n.name,d=n.layers;for(const x of d)c(x);for(;!Yue(i);)for(const x of d){const w=a[x.name];if(w.name in i){const T=i[w.name];delete i[w.name];for(const N of T)l(w,N)}}const p=[],g=[],y=n.inputLayers;for(const x of y){const w=x[0],T=x[1],N=x[2];$a(w in a);const E=a[w].inboundNodes[T].outputTensors;p.push(E[N])}const v=n.outputLayers;for(const x of v){const w=x[0],T=x[1],N=x[2];$a(w in a);const E=a[w].inboundNodes[T].outputTensors;g.push(E[N])}return new e({inputs:p,outputs:g,name:f})}get stateful(){if(this._stateful)throw new te("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){re(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $he(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(a=>{a in t?r.push(t[a]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function cV(t,e){return $he(t,e,"classWeight")}async function hV(t,e,n,s){if(n!=null){const r=re(()=>{if(t.shape.length===1)return Ma(t);if(t.shape.length===2){if(t.shape[1]>1)return iu(t,1);if(t.shape[1]===1)return J(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),a=Array.from(await r.data());Xe(r);const i=[];return a.forEach(o=>{if(n[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);i.push(n[o])}),Hn(i,"float32")}else return null}function Ihe(t,e){return Z(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Ahe=32;function fV(t,e){let n,s;const r=e;n=r.xs,s=r.ys,M(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const a=D4("input",t.inputNames,n),i=D4("output",t.outputNames,s),o=a[0].shape[0];M(a.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${a.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),M(i.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<a.length;l++)M(a[l].shape[0]===o,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${a[l].shape[0]}; expected  ${o} based on input ${t.inputNames[0]}.`);for(let l=0;l<i.length;l++)M(i[l].shape[0]===o,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${i[l].shape[0]}; expected  ${o} based on input ${t.inputNames[0]}.`);return{xs:a,ys:i}}function D4(t,e,n){if(n instanceof gt)return[n];if(Array.isArray(n))return M(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new te(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function Rhe(t){if(t.length===3)throw new Ze("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function Dhe(t,e,n){const s=n.batchesPerEpoch!=null;if(M(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),M(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),M(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),M(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),M(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let a,i;if(r)if(O4(n.validationData))M(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const x=Rhe(n.validationData);a=x.xs,i=x.ys}const o=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(x=>"val_"+x)):c=l.slice();const f=nV(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:p,history:g}=sV(f,d,n.epochs,null,null,Ohe(e,n),null,r,c);p.setModel(t),t.history=g,await p.onTrainBegin(),t.stopTraining_=!1;let y=n.initialEpoch==null?0:n.initialEpoch,v=await e.iterator();for(;y<n.epochs;){const x={};await p.onEpochBegin(y);let w=0,T=0;for(s||(v=await e.iterator());!s||w<n.batchesPerEpoch;){const N=await v.next();if(s&&N.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${w} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(N.value!=null){const{xs:C,ys:E}=fV(t,N.value),R={};R.batch=T,R.size=C[0].shape[0],await p.onBatchBegin(T,R);const $=[];if(n.classWeight!=null){const _=cV(n.classWeight,t.outputNames);for(let D=0;D<_.length;++D)$.push(await hV(E[D],null,_[D]))}const O=C.concat(E).concat($),A=o(O);Xe(O);for(let _=0;_<l.length;++_){const D=l[_],B=A[_];R[D]=B,Tn(B)}await p.onBatchEnd(T,R),QB(R),T++,w++}if(s?w>=n.batchesPerEpoch:N.done){if(r){let C;O4(n.validationData)?C=Ct(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):C=Ct(t.evaluate(a,i,{batchSize:n.validationBatchSize==null?Ahe:n.validationBatchSize,verbose:0}));for(let E=0;E<t.metricsNames.length;++E)x[`val_${t.metricsNames[E]}`]=C[E]}break}if(t.stopTraining_)break}if(await p.onEpochEnd(y,x),y++,t.stopTraining_)break}return await p.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function Ohe(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function O4(t){return typeof t.iterator=="function"}function _he(t){return typeof t.next=="function"}async function Fhe(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let a=[];if(n.verbose>0)throw new Ze("Verbose mode is not implemented yet.");M(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const i=_he(e)?e:await e.iterator();let o=0,l=0;for(;!s||l<n.batches;){const c=await i.next();if(a=re(()=>{if(c.value){const{xs:f,ys:d}=fV(t,c.value),p=f.concat(d),g=re(()=>r(p));if(Xe(p),l===0)for(let v=0;v<g.length;++v)a.push(Pe(0));const y=p[0].shape[0];for(let v=0;v<g.length;++v){const x=g[v],w=a[v];a[v]=re(()=>ve(a[v],Z(y,x))),l>0&&Xe(w)}Xe(g),o+=y,++l}return a}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<a.length;++c){const f=a[c];a[c]=Le(a[c],o),Xe(f)}return ks(a)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function AS(t){M(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function $d(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>Ql(s,e,n-e)):Ql(t,e,n-e)}function sC(t,e){return re(()=>t==null?null:Array.isArray(t)?t.map(n=>sC(n,e)):qB(t,e.dtype==="int32"?e:Ne(e,"int32")))}function RS(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}function dV(t){const e=[];t instanceof gt&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(pg(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Qr(t,e){if(t==null)return;const n=[];if(e instanceof gt)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const a=e[r];n.push(a.id)}const s=[];if(t instanceof gt)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const a=t[r];n.indexOf(a.id)===-1&&s.push(a)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lhe(t){return t instanceof gt}function rC(t){return Array.isArray(t)}function _4(t){return!Lhe(t)&&!rC(t)}function F4(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let i=!1;if(rC(t)&&t.length>0)i=!0;else if(_4(t)){for(const o in t)if(t.hasOwnProperty(o)){i=!0;break}}else i=!0;if(i)throw new te(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(i=>null);let a;if(_4(t)){t=t,a=[];for(const i of e){if(t[i]==null)throw new te(`No data provided for "${i}". Need data for each key in: ${e}`);a.push(t[i])}}else if(rC(t)){if(t=t,t.length!==e.length)throw new te(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);a=t}else{if(t=t,e.length>1)throw new te(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);a=[t]}if(a=dV(a),n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const o=a[i];if(o.shape.length!==n[i].length)throw new te(`Error when checking ${r}: expected ${e[i]} to have ${n[i].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const c=o.shape[l],f=n[i][l];if(f!=null&&f>=0&&c!==f)throw new te(`${r} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${r} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return a}function Mhe(t,e,n){const s=Io(t.map(a=>a.shape[0]));s.sort();const r=Io(e.map(a=>a.shape[0]));if(r.sort(),s.length>1)throw new te(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(a=>a.shape))}`);if(r.length>1)throw new te(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(a=>a.shape))}`);if(s.length>0&&r.length>0&&!at(s,r))throw new te(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function zhe(t,e,n){const s=[Du,pv,Sp];for(let r=0;r<t.length;++r){const a=t[r],i=e[r],o=n[r];if(i!=null){if(i===Sp&&a.shape[a.shape.length-1]===1)throw new te(`You are passing a target array of shape ${a.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const l=a.shape.slice(1),c=o.slice(1);for(let f=0;f<l.length;++f){const d=l[f],p=c[f];if(p!=null&&d!==p)throw new te(`A target Tensor with shape ${a.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function L4(t,e,n,s=!0,r=""){let a;if(Array.isArray(t)){if(t.length!==e.length)throw new te(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);a=t}else{if(e.length>1)throw new te(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);a=[t]}if(n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const o=a[i];if(o.shape.length!==n[i].length)throw new te(`Error when checking ${r}: expected ${e[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const c=o.shape[l],f=n[i][l];if(f!=null&&f!==c)throw new te(`Error when checking ${r}: expected ${e[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function Phe(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let a=n.hasOwnProperty(r)?n[r]:[];Array.isArray(a)||(a=[a]),s.push(a)}return s}}const Bhe="layers-model";class Ni extends na{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new te("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");She(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=whe(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof qi))throw new te("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new te(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),n.push(IS(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new te(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(o=>IS(o))}else{const i=IS(e.loss);this.outputs.forEach(o=>{n.push(i)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const o=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(o),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Zl("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const o=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([o,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const r=Phe(e.metrics,this.outputNames),a=(i,o,l)=>{this.outputNames.length>1&&(o=this.outputNames[i]+"_"+o),this.metricsNames.push(o),this.metricsTensors.push([l,i])};Zl("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const o=r[i];(c=>{const f="";let d,p,g;for(const y of c){if(typeof y=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(y)!==-1){const x=this.internalOutputShapes[i];x[x.length-1]===1||this.lossFunctions[i]===pv?["accuracy","acc"].indexOf(y)!==-1?p=ZE:["crossentropy","ce"].indexOf(y)!==-1&&(p=iV):this.lossFunctions[i]===I1?["accuracy","acc"].indexOf(y)!==-1?p=oV:["crossentropy","ce"].indexOf(y)!==-1&&(p=lV):["accuracy","acc"].indexOf(y)!==-1?p=QE:["crossentropy","ce"].indexOf(y)!==-1&&(p=JE);let w;["accuracy","acc"].indexOf(y)!==-1?w="acc":["crossentropy","ce"].indexOf(y)!==-1&&(w="ce"),g=p,d=f+w}else g=vhe(y),d=f+J0(y);let v;Zl(d,()=>{v=g}),a(i,d,v)}})(o)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;AS(r);const i=this.standardizeUserDataXY(e,n,!0,r);try{const o=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,o,r,s.verbose,s.steps);return ks(c)}finally{Qr(i[0],e),Qr(i[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),Fhe(this,e,n)}checkNumSamples(e,n,s,r="steps"){let a;if(s!=null){if(a=null,n!=null)throw new te(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?a=e[0].shape[0]:a=e.shape[0];else throw new te(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return a}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new te("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],a=this.retrieveSymbolicTensors(r),i=new Co;if(e instanceof gt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new te(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new te(`No value is provided for the model's input ${l.name}`);i.add(l,c)}const o=Pd(a,i);return s?o:o[0]}retrieveSymbolicTensors(e){const n=fu(null,e.length);let s=e.length;for(const r of this.layers){const a=Array.isArray(r.output)?r.output:[r.output],i=a.map(o=>o.name);for(let o=0;o<e.length;++o){const l=i.indexOf(e[o]);if(l!==-1&&(n[o]=a[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((a,i)=>{a==null&&r.push(e[i])}),new te(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return re(()=>{const r=this.checkNumSamples(e);if(s)throw new Ze("Verbose predictLoop() is not implemented yet.");const a=RS(r,n),i=this.outputs.map(o=>[]);for(let o=0;o<a.length;++o)re(()=>{const c=a[o][0],f=a[o][1],d=$d(e,c,f),p=[];if(Array.isArray(d))for(let y=0;y<d.length;++y)p.push({key:this.inputs[y],value:d[y]});else p.push({key:this.inputs[0],value:d});const g=new Co(p);return Pd(this.outputs,g)}).forEach((c,f)=>i[f].push(c));return ks(i.map(o=>an(o,0)))})}predict(e,n={}){const s=dV(e);L4(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return AS(r),this.predictLoop(s,r)}finally{Qr(s,e)}}predictOnBatch(e){L4(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new Br("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const a=[];for(let i=0;i<this.feedOutputShapes.length;++i){const o=this.feedOutputShapes[i];this.feedLossFns[i]===I1?a.push(o.slice(0,o.length-1).concat([1])):a.push(o)}if(e=F4(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=F4(n,this.feedOutputNames,a,!1,"target"),Mhe(e,n),zhe(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new te(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,a=!0,i){const[o,l]=this.standardizeUserDataXY(e,n,a,i);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const f=cV(r,this.outputNames);c=[];for(let d=0;d<f.length;++d)c.push(await hV(l[d],null,f[d]))}return[o,l,c]}testLoop(e,n,s,r=0,a){return re(()=>{const i=this.checkNumSamples(n,s,a,"steps"),o=[];if(r>0)throw new Ze("Verbose mode is not implemented yet.");if(a!=null)throw new Ze("steps mode in testLoop() is not implemented yet");{const l=RS(i,s),c=Hn(ca(0,i));for(let f=0;f<l.length;++f){const d=l[f][0],p=l[f][1],g=Ql(c,d,p-d),y=sC(n,g),v=e(y);if(f===0)for(let x=0;x<v.length;++x)o.push(Pe(0));for(let x=0;x<v.length;++x){const w=v[x];o[x]=ve(o[x],Z(p-d,w))}}for(let f=0;f<o.length;++f)o[f]=Le(o[f],i)}return o})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let a=r;if(v4(e,r)>1){const i=v4(e.slice(0,s),r);a+=`_${i}`}n.push(a)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],o=()=>{const d=[];for(let v=0;v<this.inputs.length;++v)d.push({key:this.inputs[v],value:s[v]});const p=new Co(d),g=Pd(this.outputs,p,{training:!0});let y;for(let v=0;v<this.lossFunctions.length;++v){const x=this.lossFunctions[v];let w=x(r[v],g[v]);a[v]!=null&&(w=Ihe(w,a[v]));const T=Wt(w);n.push(T),v===0?y=w:y=ve(y,w)}for(let v=0;v<this.metricsTensors.length;++v){let x;if(this.outputs.length>1&&v<this.outputs.length)x=n[v];else{const w=this.metricsTensors[v][0],T=this.metricsTensors[v][1];x=Wt(w(r[T],g[T]))}Tn(x),i.push(x)}return y=Wt(y),this.calculateLosses().forEach(v=>{y=ve(y,v)}),y},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(o,!0,l)].concat(i)}}makeTestFunction(){this.testFunction=e=>re(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let c=0;c<this.inputs.length;++c)i.push({key:this.inputs[c],value:r[c]});const o=new Co(i),l=Pd(this.outputs,o);for(let c=0;c<this.lossFunctions.length;++c){const f=this.lossFunctions[c],d=Wt(f(a[c],l[c]));c===0?s=d:s=ve(s,d),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const f=this.metricsTensors[c][0],d=this.metricsTensors[c][1],p=Wt(f(a[d],l[d]));n.push(p)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,a,i,o,l,c,f,d,p;try{const g=s.batchSize==null?32:s.batchSize;AS(g);const v=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,!1,g);r=v[0],a=v[1],p=v[2];let x=!1,w;if(s.validationData!=null&&s.validationData.length>0){if(x=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new Ze("validationData including sample weights is not supported yet."):new te(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const _=await this.standardizeUserData(l,c,null,null,!0,g);f=_[0],d=_[1],w=f.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){x=!0;const A=Math.floor(r[0].shape[0]*(1-s.validationSplit)),_=r[0].shape[0];f=$d(r,A,_),i=r,r=$d(r,0,A),d=$d(a,A,_),o=a,a=$d(a,0,A),w=f.concat(d)}else s.validationSteps!=null&&(x=!0);const T=r.concat(a).concat(p);this.checkTrainableWeightsConsistency();const N=this.makeTrainFunction(),C=this.getDedupedMetricsNames();let E,R;x?(this.makeTestFunction(),E=this.testFunction,R=C.slice().concat(C.map(A=>"val_"+A))):(E=null,w=[],R=C.slice());const $=nV(s.callbacks,s.yieldEvery);return await this.fitLoop(N,T,C,g,s.epochs,s.verbose,$,E,w,s.shuffle,R,s.initialEpoch,null,null)}finally{this.isTraining=!1,Qr(r,e),Qr(a,n),Qr(i,e),Qr(o,n),Qr(f,l),Qr(d,c),p!=null&&Xe(p)}}async fitLoop(e,n,s,r,a,i,o,l,c,f,d,p,g,y){r==null&&(r=32),a==null&&(a=1),f==null&&(f=!0),p==null&&(p=0);let v=!1;if(l!=null&&c!=null&&(v=!0),y!=null&&(v=!0,g==null))throw new te("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const x=this.checkNumSamples(n,r,g,"steps_per_epoch");let w;x!=null&&(w=ca(0,x)),i==null&&(i=1);const{callbackList:T,history:N}=sV(o,i,a,p,x,g,r,v,d);T.setModel(this),this.history=N,await T.onTrainBegin(),this.stopTraining_=!1;for(let C=p;C<a;++C){await T.onEpochBegin(C);const E={};if(g!=null)throw new Ze("stepsPerEpoch mode is not implemented yet.");{if(f==="batch")throw new Ze("batch shuffling is not implemneted yet");f&&RN(w);const R=Hn(w),$=RS(x,r);for(let O=0;O<$.length;++O){const A={};if(await T.onBatchBegin(O,A),re(()=>{const _=$[O][0],D=$[O][1],B=Ql(R,_,D-_);A.batch=O,A.size=D-_;const j=sC(n,B),W=e(j);for(let X=0;X<s.length;++X){const U=s[X],Y=W[X];A[U]=Y,Tn(Y)}if(O===$.length-1&&v){const X=this.testLoop(l,c,r);for(let U=0;U<s.length;++U){const Y=s[U],Q=X[U];Tn(Q),E["val_"+Y]=Q}}}),await T.onBatchEnd(O,A),QB(A),this.stopTraining_)break}R.dispose()}if(await T.onEpochEnd(C,E),this.stopTraining_)break}return await T.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return Dhe(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],a=s[1],o=this.makeTrainFunction()(r.concat(a)),l=[];for(const c of o){const f=await c.data();l.push(f[0])}return Xe(o),Qr(s[0],e),Qr(s[1],n),ks(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,a=this.getWeights(s);for(let i=0;i<r.length;++i)s&&!r[i].trainable||n.push({name:r[i].originalName,tensor:a[i]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=zT().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-zT().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=gi(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>gi(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=gi(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[gi(J0(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>gi(J0(e)));{const e={};for(const n in this.metrics)e[n]=gi(J0(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=Tp(e.optimizer_config),s=la(n);let r;if(typeof e.loss=="string")r=zl(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(i=>zl(i));else if(e.loss!=null){r={};for(const i in e.loss)r[i]=zl(e.loss[i])}let a;if(Array.isArray(e.metrics))a=e.metrics.map(i=>zl(i));else if(e.metrics!=null){a={};for(const i in e.metrics)a[i]=zl(e.metrics[i])}this.compile({loss:r,metrics:a,optimizer:s})}async save(e,n){if(typeof e=="string"){const c=DP(e);if(c.length===0)throw new te(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new te(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new te("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await PT(this.getNamedWeights(n)),o={modelTopology:this.toJSON(null,!1),format:Bhe,generatedBy:`TensorFlow.js tfjs-layers v${mv}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){o.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:f,specs:d}=await PT(await this.optimizer.getWeights(),c);s.specs.push(...d),s.data=AP([s.data,f])}return this.userDefinedMetadata!=null&&(R4(this.userDefinedMetadata,this.name,!0),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=s.data,o.weightSpecs=s.specs,e.save(o)}setUserDefinedMetadata(e){R4(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Ni.className="Model";Se(Ni);class pV extends Ni{}pV.className="Functional";Se(pV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Vhe(t,e){"modelTopology"in t||(t={modelTopology:t}),t=t;let n=t.modelTopology;n.model_config!=null&&(n=n.model_config);const s=Tp(n),r=la(s,e);if(t.weightsManifest!=null){const a=await q6(t.weightsManifest,t.pathPrefix,r.weights.map(o=>o.originalName)),i={};for(const o of r.weights)i[o.originalName]=a[o.originalName];r.loadWeights(i),Xe(a)}return r}async function Uhe(t,e){if(e==null&&(e={}),typeof t=="string"){const n=OP(t,e);if(n.length===0)n.push(Y6(t,e));else if(n.length>1)throw new te(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return jhe(t,void 0,e)}async function jhe(t,e,n){if(n==null&&(n={}),t.load==null)throw new te("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const s=await t.load();let r=s.modelTopology;r.model_config!=null&&(r=r.model_config);const a=n.strict==null?!0:n.strict,i=s.weightData!=null&&s.weightSpecs!=null&&a,o=la(Tp(r),e,i),l=s.trainingConfig;if(l!=null&&o.loadTrainingConfig(l),s.userDefinedMetadata!=null&&o.setUserDefinedMetadata(s.userDefinedMetadata),s.weightData!=null){if(s.weightSpecs==null)throw new te("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:c,optimizerWeights:f}=Whe(s.weightData,s.weightSpecs);o.loadWeights(c,a),o.optimizer!=null&&f.length>0&&await o.optimizer.setWeights(f),Xe(c),Xe(f.map(d=>d.tensor))}return o}function Whe(t,e){const n=jN(t,e),s={},r=[];return e.forEach(a=>{a.group==="optimizer"?r.push({name:a.name,tensor:n[a.name]}):s[a.name]=n[a.name]}),{modelWeights:s,optimizerWeights:r}}class du extends Ni{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:sv("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new te(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof du||e instanceof Ni;let s;if(n){if(s=e,s.outputs.length!==1)throw new te("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new te("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new te("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=ZB({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new te(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new te("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=YB(this.outputs[0])}this.inboundNodes=[],new fv({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:fu(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(xt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Ni({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new Br("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new Br("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new Br("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new Br("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let a,i={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new te("Legacy serialization format not supported yet.");a=n}else M(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=n.layers,delete n.layers,i=n;const o=new e(i);if(!(o instanceof du))throw new Ze(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const l of a){const f=la(l,void 0,r);r&&f.setFastWeightInitDuringBuild(!0),o.add(f)}return o}set stopTraining(e){if(this.model==null)throw new te("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new te("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}du.className="Sequential";Se(du);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ghe(t){return new Ni(t)}function Hhe(t){return new du(t)}function mV(t){return ZB(t)}function qhe(t,e){or.registerCallbackConstructor(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let rs=class extends Au{getConfig(){return{}}};class gV extends rs{apply(e,n=1){return hce(e,n)}}gV.className="elu";Se(gV);class yV extends rs{apply(e){return Dx(e)}}yV.className="selu";Se(yV);class bV extends rs{apply(e){return ma(e)}}bV.className="relu";Se(bV);class xV extends rs{apply(e){return re(()=>Vo(6,ma(e)))}}xV.className="relu6";Se(xV);class vV extends rs{apply(e){return e}}vV.className="linear";Se(vV);class wV extends rs{apply(e){return oa(e)}}wV.className="sigmoid";Se(wV);class SV extends rs{apply(e){return dce(e)}}SV.className="hardSigmoid";Se(SV);class TV extends rs{apply(e){return $u(e)}}TV.className="softplus";Se(TV);class CV extends rs{apply(e){return fce(e)}}CV.className="softsign";Se(CV);class NV extends rs{apply(e){return Bo(e)}}NV.className="tanh";Se(NV);let e$=class extends rs{apply(e,n=-1){return og(e,n)}};e$.className="softmax";Se(e$);class kV extends rs{apply(e,n=-1){return Cx(e,n)}}kV.className="logSoftmax";Se(kV);class EV extends rs{apply(e){return re(()=>re(()=>{const n=Math.sqrt(2),s=Z(.5,ve(1,wx(Le(e,n))));return Z(e,s)}))}}EV.className="gelu";Se(EV);class $V extends rs{apply(e){return re(()=>Z(.5,Z(e,ve(1,Bo(Z(_n(Le(2,Math.PI)),ve(e,Z(.044715,Wa(e,3)))))))))}}$V.className="gelu_new";Se($V);class IV extends rs{apply(e){return re(()=>Z(e,Bo($u(e))))}}IV.className="mish";Se(IV);class AV extends rs{apply(e,n=1){return re(()=>Z(oa(Z(e,n)),e))}}AV.className="swish";Se(AV);function jo(t){return t.getClassName()}function DS(t,e={}){return dg(t,ur.getMap().classNameMap,e,"activation")}function Wo(t){if(t==null){const e={};return e.className="linear",e.config={},DS(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},DS(e)}else return t instanceof rs?t:DS(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function t$(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class RV extends Au{}class bg extends RV{constructor(e){super(),t$(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return re(()=>{let n=mn([1]);return this.hasL1&&(n=ve(n,Oe(Z(this.l1,pn(e))))),this.hasL2&&(n=ve(n,Oe(Z(this.l2,mg(e))))),J(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}bg.className="L1L2";Se(bg);function Xhe(t){return t$(t),new bg({l1:t!=null?t.l1:null,l2:0})}function Khe(t){return t$(t),new bg({l2:t!=null?t.l2:null,l1:0})}const M4={l1l2:"L1L2"};function Dt(t){return _E(t)}function z4(t,e={}){return dg(t,ur.getMap().classNameMap,e,"regularizer")}function Ut(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in M4?M4[t]:t,config:{}};return z4(n)}else return t instanceof RV?t:z4(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class n$ extends st{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=qe(e);let s=ma(e);return this.maxValue!=null&&(s=Ds(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}n$.className="ReLU";Se(n$);class s$ extends st{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=qe(e);return Zm(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}s$.className="LeakyReLU";Se(s$);class r$ extends st{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Vt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Ut(e.alphaRegularizer),this.alphaConstraint=kn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new te(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=xt(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new gn({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=qe(e),rg(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Gt(this.alphaInitializer),alphaRegularizer:Dt(this.alphaRegularizer),alphaConstraint:Nn(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}r$.className="PReLU";Se(r$);let a$=class extends st{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Ze(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=qe(e);return sf(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};a$.className="ELU";Se(a$);class i$ extends st{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=qe(e);return Z(s,Ne(vs(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}i$.className="ThresholdedReLU";Se(i$);class o$ extends st{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new e$().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return re(()=>{let s=qe(e);const r=n.mask;if(r!=null){const a=Z(Re($s(s.shape),Ne(r,s.dtype)),Pe(-1e9));s=ve(s,a)}return this.axis instanceof Array?this.axis.length>1?Os(Re(s,Jm(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}o$.className="Softmax";Se(o$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lc(t,e,n){if(typeof t=="number")return fu(t,e);if(t.length!==e)throw new te(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!oce(r))throw new te(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function ua(t,e,n,s,r=1){if(t==null)return t;const a=e+(e-1)*(r-1);let i;return n==="same"?i=t:i=t-a+1,Math.floor((i+s-1)/s)}function Ia(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+Uo([n-e,0]);else if(s==="same")t=t*e;else throw new te(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function l$(t,e){return re(()=>(cn(e),e==="channelsFirst"?ot(t,[0,2,3,1]):t))}function DV(t,e){return re(()=>(cn(e),e==="channelsFirst"?ot(t,[0,2,3,4,1]):t))}function Yhe(t,e,n,s=1,r="valid",a,i=1){return re(()=>{if(a==null&&(a=ha()),cn(a),t.shape.length!==3)throw new te(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new te(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new te(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(a==="channelsFirst"&&(t=ot(t,[0,2,1])),r==="causal")throw new Ze("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=yx(t,e,s,r==="same"?"same":"valid","NWC",i);return n!=null&&(o=ga(o,n)),o})}function P4(t,e,n,s=[1,1],r="valid",a,i,o=null){return re(()=>{if(a==null&&(a=ha()),cn(a),t.rank!==3&&t.rank!==4)throw new te(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new te(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=l$(t,a);if(r==="causal")throw new Ze("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=O6({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:o}),a==="channelsFirst"&&(l=ot(l,[0,3,1,2])),l})}function Zhe(t,e,n,s=[1,1,1],r="valid",a,i){return re(()=>{if(a==null&&(a=ha()),cn(a),t.rank!==4&&t.rank!==5)throw new te(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new te(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let o=DV(t,a);if(r==="causal")throw new Ze("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=pk(o,e,s,r==="same"?"same":"valid","NDHWC",i),n!=null&&(o=ga(o,n)),a==="channelsFirst"&&(o=ot(o,[0,4,1,2,3])),o})}class gv extends st{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",gv.verifyArgs(n),this.rank=e,Rn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Ze(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Lc(n.kernelSize,e,"kernelSize"),this.strides=Lc(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,vr(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,cn(this.dataFormat),this.activation=Wo(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=Vt(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=kn(n.biasConstraint),this.biasRegularizer=Ut(n.biasRegularizer),this.activityRegularizer=Ut(n.activityRegularizer),this.dilationRate=Lc(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new te(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new te(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new te(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if($a("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!FE(e.kernelSize,"number",1,3))throw new te(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:jo(this.activation),useBias:this.useBias,biasInitializer:Gt(this.biasInitializer),biasRegularizer:Dt(this.biasRegularizer),activityRegularizer:Dt(this.activityRegularizer),biasConstraint:Nn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class hf extends gv{constructor(e,n){super(e,n),this.kernel=null,hf.verifyArgs(n),this.filters=n.filters,Rn(this.filters,"filters"),this.kernelInitializer=Vt(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=kn(n.kernelConstraint),this.kernelRegularizer=Ut(n.kernelRegularizer)}build(e){e=xt(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new te(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return re(()=>{e=qe(e);let s;const r=this.bias==null?null:this.bias.read(),a=VB(this.activation.getClassName());if(a!=null&&this.rank===2)s=P4(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(this.rank===1)s=Yhe(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=P4(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=Zhe(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Ze("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=xt(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let a=0;a<s.length;++a){const i=ua(s[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);n.push(i)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:Gt(this.kernelInitializer),kernelRegularizer:Dt(this.kernelRegularizer),kernelConstraint:Nn(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new te(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class ff extends hf{constructor(e){super(2,e),ff.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!FE(e.kernelSize,"number",1,2))throw new te(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}ff.className="Conv2D";Se(ff);class df extends hf{constructor(e){super(3,e),df.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new te(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}df.className="Conv3D";Se(df);class u$ extends ff{constructor(e){if(super(e),this.inputSpec=[new gn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new te(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=xt(e),e.length!==4)throw new te("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new te("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new gn({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return re(()=>{let s=qe(e);if(s.shape.length!==4)throw new te(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,a=r[0];let i,o;this.dataFormat==="channelsFirst"?(i=2,o=3):(i=1,o=2);const l=r[i],c=r[o],f=this.kernelSize[0],d=this.kernelSize[1],p=this.strides[0],g=this.strides[1],y=Ia(l,p,f,this.padding),v=Ia(c,g,d,this.padding),x=[a,y,v,this.filters];this.dataFormat!=="channelsLast"&&(s=ot(s,[0,2,3,1]));let w=bx(s,this.kernel.read(),x,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(w=ot(w,[0,3,1,2])),this.bias!=null&&(w=ga(w,this.bias.read(),this.dataFormat)),this.activation!=null&&(w=this.activation.apply(w)),w})}computeOutputShape(e){e=xt(e);const n=e.slice();let s,r,a;this.dataFormat==="channelsFirst"?(s=1,r=2,a=3):(s=3,r=1,a=2);const i=this.kernelSize[0],o=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[r]=Ia(n[r],l,i,this.padding),n[a]=Ia(n[a],c,o,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}u$.className="Conv2DTranspose";Se(u$);class c$ extends df{constructor(e){if(super(e),this.inputSpec=[new gn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new te(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=xt(e),e.length!==5)throw new te("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new te("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new gn({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return re(()=>{let s=qe(e);if(s.shape.length!==5)throw new te(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,a=r[0];let i,o,l;this.dataFormat==="channelsFirst"?(l=2,i=3,o=4):(l=1,i=2,o=3);const c=r[l],f=r[i],d=r[o],p=this.kernelSize[0],g=this.kernelSize[1],y=this.kernelSize[2],v=this.strides[0],x=this.strides[1],w=this.strides[2],T=Ia(c,v,p,this.padding),N=Ia(f,x,g,this.padding),C=Ia(d,w,y,this.padding),E=[a,T,N,C,this.filters];this.dataFormat!=="channelsLast"&&(s=ot(s,[0,2,3,4,1]));let R=mk(s,this.kernel.read(),E,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(R=ot(R,[0,4,1,2,3])),this.bias!==null&&(R=ga(R,this.bias.read(),this.dataFormat)),this.activation!==null&&(R=this.activation.apply(R)),R})}computeOutputShape(e){e=xt(e);const n=e.slice();let s,r,a,i;this.dataFormat==="channelsFirst"?(s=1,r=2,a=3,i=4):(s=4,r=1,a=2,i=3);const o=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],f=this.strides[0],d=this.strides[1],p=this.strides[2];return n[s]=this.filters,n[r]=Ia(n[r],f,o,this.padding),n[a]=Ia(n[a],d,l,this.padding),n[i]=Ia(n[i],p,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}c$.className="Conv3DTranspose";Se(c$);class OV extends hf{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new te("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new te("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new te(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=Vt(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Ut(n.depthwiseRegularizer),this.depthwiseConstraint=kn(n.depthwiseConstraint),this.pointwiseInitializer=Vt(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Ut(n.pointwiseRegularizer),this.pointwiseConstraint=kn(n.pointwiseConstraint)}build(e){if(e=xt(e),e.length<this.rank+2)throw new te(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new te(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),a=[];for(let o=0;o<this.rank;++o)a.push(1);a.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new gn({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return re(()=>{e=qe(e);let s;if(this.rank===1)throw new Ze("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=ot(e,[0,2,3,1])),s=Ox(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=ga(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=ot(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Gt(this.depthwiseInitializer),e.pointwiseInitializer=Gt(this.pointwiseInitializer),e.depthwiseRegularizer=Dt(this.depthwiseRegularizer),e.pointwiseRegularizer=Dt(this.pointwiseRegularizer),e.depthwiseConstraint=Nn(this.depthwiseConstraint),e.pointwiseConstraint=Nn(this.pointwiseConstraint),e}}OV.className="SeparableConv";class h$ extends OV{constructor(e){super(2,e)}}h$.className="SeparableConv2D";Se(h$);class xg extends hf{constructor(e){super(1,e),xg.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!FE(e.kernelSize,"number",1,1))throw new te(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}xg.className="Conv1D";Se(xg);class f$ extends st{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return re(()=>{if(e=qe(e),this.dataFormat==="channelsLast"){const s=Q0(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Q0(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=Q0(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Q0(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}f$.className="Cropping2D";Se(f$);class d$ extends st{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,cn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,rce(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return re(()=>{let s=qe(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=ot(s,[0,2,3,1]);const a=this.size[0]*r[2],i=this.size[1]*r[3],o=this.interpolation==="nearest"?Pr.resizeNearestNeighbor(s,[a,i]):Pr.resizeBilinear(s,[a,i]);return ot(o,[0,3,1,2])}else{const a=this.size[0]*r[1],i=this.size[1]*r[2];return this.interpolation==="nearest"?Pr.resizeNearestNeighbor(s,[a,i]):Pr.resizeBilinear(s,[a,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}d$.className="UpSampling2D";Se(d$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Qhe(t,e,n=[1,1],s="valid",r,a){return re(()=>{r==null&&(r=ha()),cn(r);let i=l$(t,r);if(t.rank!==4)throw new te(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new te(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=nf(i,e,n,s==="same"?"same":"valid","NHWC",a),r==="channelsFirst"&&(i=ot(i,[0,3,1,2])),i})}class p$ extends gv{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Vt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=kn(e.depthwiseConstraint),this.depthwiseRegularizer=Ut(e.depthwiseRegularizer)}build(e){if(e=xt(e),e.length<4)throw new te(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new te(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return re(()=>{e=qe(e);let s=Qhe(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=ga(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=xt(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=ua(n,this.kernelSize[0],this.padding,this.strides[0]),i=ua(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,a,i]:[e[0],a,i,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Gt(this.depthwiseInitializer),e.depthwiseRegularizer=Dt(this.depthwiseRegularizer),e.depthwiseConstraint=Nn(this.depthwiseRegularizer),e}}p$.className="DepthwiseConv2D";Se(p$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _V(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new te("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(a){return a==null||Array.isArray(a)?a:[a]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function FV(t,e,n,s=!1,r,a,i=!1,o=!1){return re(()=>{const l=e.shape.length;if(l<3)throw new te(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(ca(2,l));e=ot(e,c),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=Ne(Ne(r,"bool"),"float32"),r.rank===l-1&&(r=jn(r,-1)),r=ot(r,c)),s&&(e=yr(e,0),r!=null&&(r=yr(r,0)));const f=[];let d,p=n;const g=e.shape[0],y=br(e);let v;r!=null&&(v=br(r));for(let w=0;w<g;++w){const T=y[w],N=re(()=>t(T,p));if(r==null)d=N[0],p=N[1];else{const C=re(()=>{const E=v[w],R=Re(Xs(E),E),$=ve(Z(N[0],E),Z(p[0],R)),O=p.map((A,_)=>ve(Z(N[1][_],E),Z(A,R)));return{output:$,newStates:O}});d=C.output,p=C.newStates}o&&f.push(d)}let x;return o&&(x=ys(f,1)),[d,x,p]})}class ya extends st{constructor(e){super(e);let n;if(e.cell==null)throw new te("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new xv({cells:e.cell}):n=e.cell,n.stateSize==null)throw new te("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new gn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return ca(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){JT(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const a=[];for(const i of n)a.push([e[0],i]);return[r].concat(a)}else return r}computeMask(e,n){return re(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(a=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Ze("Constants support is not implemented in RNN yet.");JT(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new gn({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!at(this.stateSpec.map(i=>i.shape[i.shape.length-1]),a))throw new te(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(i=>new gn({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){re(()=>{if(!this.stateful)throw new Ea("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new te("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>mn([s,r])):this.states_=[mn([s,this.cell.stateSize])];else if(e==null)Xe(this.states_),this.keptStates!=null&&(Xe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>mn([s,r])):this.states_[0]=mn([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new te(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Xe(this.states_);for(let r=0;r<this.states_.length;++r){const a=e[r],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,o=[s,i];if(!at(a.shape,o))throw new te(`State ${r} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${a.shape}`);this.states_[r]=a}}this.states_=this.states_.map(r=>Tn(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const a=_V(e,s,r,this.numConstants);e=a.inputs,s=a.initialState,r=a.constants;let i=[],o=[];if(s!=null){n.initialState=s,i=i.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new gn({shape:c.shape}));o=o.concat(this.stateSpec)}if(r!=null&&(n.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof fa){const c=[e].concat(i),f=this.inputSpec.concat(o),d=this.inputSpec;this.inputSpec=f;const p=super.apply(c,n);return this.inputSpec=d,p}else return super.apply(e,n)}call(e,n){return re(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let a=n==null?null:n.initialState;e=qe(e),a==null&&(this.stateful?a=this.states_:a=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==i)throw new te(`RNN Layer has ${i} state(s) but was passed ${a.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:r},c=FV((y,v)=>{const x=this.cell.call([y].concat(v),o);return[x[0],x.slice(1)]},e,a,this.goBackwards,s,null,this.unroll,this.returnSequences),f=c[0],d=c[1],p=c[2];this.stateful&&this.resetStates(p,r);const g=this.returnSequences?d:f;return this.returnState?[g].concat(p):g})}getInitialState(e){return re(()=>{let n=mn(e.shape);return n=Oe(n,[1,2]),n=pg(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?ZT(n,[1,s]):n):this.cell.stateSize>1?[ZT(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===ya.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const r=n.cell,a=la(r,s);return new e(Object.assign(n,{cell:a}))}}ya.className="RNN";Se(ya);class vg extends st{}class yv extends vg{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Rn(this.units,"units"),this.activation=Wo(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Vt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Vt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Vt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Ut(e.kernelRegularizer),this.recurrentRegularizer=Ut(e.recurrentRegularizer),this.biasRegularizer=Ut(e.biasRegularizer),this.kernelConstraint=kn(e.kernelConstraint),this.recurrentConstraint=kn(e.recurrentConstraint),this.biasConstraint=kn(e.biasConstraint),this.dropout=Kc([1,Uo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Kc([1,Uo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=xt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return re(()=>{if(e=e,e.length!==2)throw new te(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Go({ones:()=>Xs(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Go({ones:()=>Xs(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let a;const i=this.dropoutMask,o=this.recurrentDropoutMask;i!=null?a=Ba(Z(e,i),this.kernel.read()):a=Ba(e,this.kernel.read()),this.bias!=null&&(a=ga(a,this.bias.read())),o!=null&&(s=Z(s,o));let l=ve(a,Ba(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:jo(this.activation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),kernelRegularizer:Dt(this.kernelRegularizer),recurrentRegularizer:Dt(this.recurrentRegularizer),biasRegularizer:Dt(this.biasRegularizer),activityRegularizer:Dt(this.activityRegularizer),kernelConstraint:Nn(this.kernelConstraint),recurrentConstraint:Nn(this.recurrentConstraint),biasConstraint:Nn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}yv.className="SimpleRNNCell";Se(yv);class m$ extends ya{constructor(e){e.cell=new yv(e),super(e)}call(e,n){return re(()=>{this.cell.dropoutMask!=null&&(Xe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Xe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,n){return new e(n)}}m$.className="SimpleRNN";Se(m$);class bv extends vg{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new te("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Rn(this.units,"units"),this.activation=Wo(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Wo(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Vt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Vt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Vt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Ut(e.kernelRegularizer),this.recurrentRegularizer=Ut(e.recurrentRegularizer),this.biasRegularizer=Ut(e.biasRegularizer),this.kernelConstraint=kn(e.kernelConstraint),this.recurrentConstraint=kn(e.recurrentConstraint),this.biasConstraint=kn(e.biasConstraint),this.dropout=Kc([1,Uo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Kc([1,Uo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=xt(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return re(()=>{if(e=e,e.length!==2)throw new te(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Go({ones:()=>Xs(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Go({ones:()=>Xs(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,i=this.recurrentDropoutMask;let o,l,c;0<this.dropout&&this.dropout<1&&(e=Z(e,a[0]));let f=Ba(e,this.kernel.read());this.useBias&&(f=ga(f,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=Z(r,i[0]));const d=this.recurrentKernel.read(),[p,g]=Is(d,[2*this.units,this.units],d.rank-1),y=Ba(r,p),[v,x,w]=Is(f,3,f.rank-1),[T,N]=Is(y,2,y.rank-1);o=this.recurrentActivation.apply(ve(v,T)),l=this.recurrentActivation.apply(ve(x,N));const C=Ba(Z(l,r),g);c=this.activation.apply(ve(w,C));const E=ve(Z(o,r),Z(ve(1,Ft(o)),c));return[E,E]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:jo(this.activation),recurrentActivation:jo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),kernelRegularizer:Dt(this.kernelRegularizer),recurrentRegularizer:Dt(this.recurrentRegularizer),biasRegularizer:Dt(this.biasRegularizer),activityRegularizer:Dt(this.activityRegularizer),kernelConstraint:Nn(this.kernelConstraint),recurrentConstraint:Nn(this.recurrentConstraint),biasConstraint:Nn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}bv.className="GRUCell";Se(bv);class g$ extends ya{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new bv(e),super(e)}call(e,n){return re(()=>{this.cell.dropoutMask!=null&&(Xe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Xe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}g$.className="GRU";Se(g$);class wg extends vg{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Rn(this.units,"units"),this.activation=Wo(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Wo(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Vt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Vt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Vt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Ut(e.kernelRegularizer),this.recurrentRegularizer=Ut(e.recurrentRegularizer),this.biasRegularizer=Ut(e.biasRegularizer),this.kernelConstraint=kn(e.kernelConstraint),this.recurrentConstraint=kn(e.recurrentConstraint),this.biasConstraint=kn(e.biasConstraint),this.dropout=Kc([1,Uo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Kc([1,Uo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=xt(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const a=this.biasInitializer,i=this.units;r=new(n=class extends jr{apply(l,c){const f=a.apply([i]),d=new av().apply([i]),p=a.apply([i*2]);return S4(S4(f,d),p)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return re(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new te(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const a=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Go({ones:()=>Xs(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Go({ones:()=>Xs(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let l,c,f,d;0<this.dropout&&this.dropout<1&&(e=Z(e,i[0]));let p=Ba(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=Z(r,o[0])),p=ve(p,Ba(r,this.recurrentKernel.read())),this.useBias&&(p=ga(p,this.bias.read()));const[g,y,v,x]=Is(p,4,p.rank-1);l=this.recurrentActivation.apply(g),c=this.recurrentActivation.apply(y),f=ve(Z(c,a),Z(l,this.activation.apply(v))),d=this.recurrentActivation.apply(x);const w=Z(d,this.activation.apply(f));return[w,w,f]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:jo(this.activation),recurrentActivation:jo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Dt(this.kernelRegularizer),recurrentRegularizer:Dt(this.recurrentRegularizer),biasRegularizer:Dt(this.biasRegularizer),activityRegularizer:Dt(this.activityRegularizer),kernelConstraint:Nn(this.kernelConstraint),recurrentConstraint:Nn(this.recurrentConstraint),biasConstraint:Nn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}wg.className="LSTMCell";Se(wg);class y$ extends ya{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new wg(e),super(e)}call(e,n){return re(()=>{this.cell.dropoutMask!=null&&(Xe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Xe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}y$.className="LSTM";Se(y$);class xv extends vg{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return re(()=>{e=e;let s=e.slice(1);const r=[];for(const o of this.cells.slice().reverse())Array.isArray(o.stateSize)?r.push(s.splice(0,o.stateSize.length)):r.push(s.splice(0,1));r.reverse();const a=[];let i;for(let o=0;o<this.cells.length;++o){const l=this.cells[o];s=r[o],o===0?i=[e[0]].concat(s):i=[i[0]].concat(s),i=l.call(i,n),a.push(i.slice(1))}s=[];for(const o of a.slice().reverse())s.push(...o);return[i[0]].concat(s)})}build(e){JT(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{Zl(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=a=>({className:a.getClassName(),config:a.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,n,s={}){const r=[];for(const a of n.cells)r.push(la(a,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return eC(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,a=e.splice(r);for(let i=0;i<s.weights.length;++i)n.push([s.weights[i],a[i]])}WE(n)}}xv.className="StackedRNNCells";Se(xv);function Go(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:a}=t,i=()=>a!=null?a(e(),n):XB(e(),n),o=()=>gg(i,e,s);return!r||r<=1?Tn(o().clone()):Array(r).fill(void 0).map(o).map(c=>Tn(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Jhe=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class LV extends ya{constructor(e){if(e.unroll)throw new Ze("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Ze("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new gn({ndim:5})]}call(e,n){return re(()=>{if(this.cell.dropoutMask!=null&&(Xe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Xe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new te("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return re(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),a=[r[0],...r.slice(2)],i=mn(a);return Array.isArray(n)?Array(n.length).fill(i):[i]})}resetStates(e,n=!1){re(()=>{if(!this.stateful)throw new Ea("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),a=[r[0],...r.slice(2)];if(s[0]==null)throw new te("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>mn(a)):this.states_=[mn(a)];else if(e==null)Xe(this.states_),this.keptStates!=null&&(Xe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>mn(a)):this.states_[0]=mn(a);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new te(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Xe(this.states_);for(let o=0;o<this.states_.length;++o){const l=e[o],c=a;if(!at(l.shape,c))throw new te(`State ${o} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[o]=l}}this.states_=this.states_.map(o=>Tn(o.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:a,strides:i,dilationRate:o}=this.cell,l=n==="channelsFirst",c=e[l?3:2],f=e[l?4:3],d=ua(c,r[0],a,i[0],o[0]),p=ua(f,r[1],a,i[1],o[1]);return[...e.slice(0,2),...l?[s,d,p]:[d,p,s]]}}LV.className="ConvRNN2D";class vv extends wg{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:a,dataFormat:i,dilationRate:o}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,Rn(this.filters,"filters"),this.kernelSize=Lc(s,2,"kernelSize"),this.kernelSize.forEach(l=>Rn(l,"kernelSize")),this.strides=Lc(r||1,2,"strides"),this.strides.forEach(l=>Rn(l,"strides")),this.padding=a||"valid",vr(this.padding),this.dataFormat=i||"channelsLast",cn(this.dataFormat),this.dilationRate=Lc(o||1,2,"dilationRate"),this.dilationRate.forEach(l=>Rn(l,"dilationRate"))}build(e){var n;e=xt(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new te(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],a=4,i=this.kernelSize.concat([r,this.filters*a]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,this.filters*a]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,f=this.filters;l=new(n=class extends jr{apply(p,g){const y=c.apply([f]),v=$s([f]),x=c.apply([f*2]);return LE([y,v,x])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*a],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return re(()=>{if(e.length!==3)throw new te(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],a=e[1],i=e[2],o=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Go({ones:()=>Xs(r),rate:this.dropout,training:s,count:o,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(V,ee,ce)=>!ee||!ee[ce]?V:Z(ee[ce],V);let f=c(r,l,0),d=c(r,l,1),p=c(r,l,2),g=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Go({ones:()=>Xs(a),rate:this.recurrentDropout,training:s,count:o,dropoutFunc:this.dropoutFunc}));const y=this.recurrentDropoutMask;let v=c(a,y,0),x=c(a,y,1),w=c(a,y,2),T=c(a,y,3);const N=3,[C,E,R,$]=Is(this.kernel.read(),o,N),[O,A,_,D]=this.useBias?Is(this.bias.read(),o):[null,null,null,null];f=this.inputConv(f,C,O,this.padding),d=this.inputConv(d,E,A,this.padding),p=this.inputConv(p,R,_,this.padding),g=this.inputConv(g,$,D,this.padding);const[B,j,W,X]=Is(this.recurrentKernel.read(),o,N);v=this.recurrentConv(v,B),x=this.recurrentConv(x,j),w=this.recurrentConv(w,W),T=this.recurrentConv(T,X);const U=this.recurrentActivation.apply(ve(f,v)),Y=this.recurrentActivation.apply(ve(d,x)),Q=ve(Z(Y,i),Z(U,this.activation.apply(ve(p,w)))),ie=Z(this.recurrentActivation.apply(ve(g,T)),this.activation.apply(Q));return[ie,ie,Q]})}getConfig(){const e=super.getConfig(),{units:n}=e,s=Jhe(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},s),r)}inputConv(e,n,s,r){const a=_i(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?ga(a,s,this.dataFormat):a}recurrentConv(e,n){return _i(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}vv.className="ConvLSTM2DCell";Se(vv);class b$ extends LV{constructor(e){const n=new vv(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}b$.className="ConvLSTM2D";Se(b$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class wv extends st{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=qe(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,a=this.getNoiseShape(s);return gg(()=>XB(s,this.rate,a,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}wv.className="Dropout";Se(wv);class x$ extends wv{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}x$.className="SpatialDropout1D";Se(x$);class v$ extends st{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,Rn(this.units,"units"),this.activation=Wo(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Vt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Vt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=kn(e.kernelConstraint),this.biasConstraint=kn(e.biasConstraint),this.kernelRegularizer=Ut(e.kernelRegularizer),this.biasRegularizer=Ut(e.biasRegularizer),this.activityRegularizer=Ut(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=xt(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=xt(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=qe(e),r=VB(this.activation.getClassName());let a;return r!=null?a=Ba(s,this.kernel.read(),r,this.bias?this.bias.read():null):(a=Ba(s,this.kernel.read()),this.bias!=null&&(a=ga(a,this.bias.read())),this.activation!=null&&(a=this.activation.apply(a))),a})}getConfig(){const e={units:this.units,activation:jo(this.activation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),biasInitializer:Gt(this.biasInitializer),kernelRegularizer:Dt(this.kernelRegularizer),biasRegularizer:Dt(this.biasRegularizer),activityRegularizer:Dt(this.activityRegularizer),kernelConstraint:Nn(this.kernelConstraint),biasConstraint:Nn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}v$.className="Dense";Se(v$);class w$ extends st{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=xt(e);for(const n of e.slice(1))if(n==null)throw new te(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Ao(e,1)]}call(e,n){return re(()=>{this.invokeCallHook(e,n);let s=qe(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let a=2;a<s.rank;++a)r.push(a);r.push(1),s=ot(s,r)}return cce(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}w$.className="Flatten";Se(w$);class S$ extends st{constructor(e){super(e),this.supportsMasking=!0,this.activation=Wo(e.activation)}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=qe(e);return this.activation.apply(s)})}getConfig(){const e={activation:jo(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}S$.className="Activation";Se(S$);class T$ extends st{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return re(()=>(e=qe(e),lce(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}T$.className="RepeatVector";Se(T$);class C$ extends st{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let a=1,i=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(i===null)i=l;else throw new te("Can only specifiy one unknown dimension.");else a*=c}const o=Ao(e);if(i!==null){if(a===0||o%a!==0)throw new te(s);r[i]=o/a}else if(o!==a)throw new te(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=qe(e),r=s.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return J(s,a)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}C$.className="Reshape";Se(C$);class N$ extends st{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=ca(1,e.dims.length+1);if(!at(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new gn({ndim:this.dims.length+1})]}computeOutputShape(e){e=xt(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return ot(qe(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}N$.className="Permute";Se(N$);class k$ extends st{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=qe(e);return bp(uu(s,this.maskValue),-1)}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=qe(e),i=bp(uu(s,this.maskValue),-1,!0);return Z(s,Ne(i,s.dtype))})}}k$.className="Masking";Se(k$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class E$ extends st{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Ct(e.inputLength))}this.inputDim=e.inputDim,Rn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Rn(this.outputDim,"outputDim"),this.embeddingsInitializer=Vt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Ut(e.embeddingsRegularizer),this.activityRegularizer=Ut(e.activityRegularizer),this.embeddingsConstraint=kn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return re(()=>this.maskZero?(e=qe(e),uu(e,ht(e))):null)}computeOutputShape(e){if(e=xt(e),this.inputLength==null)return[...e,this.outputDim];const n=Ct(this.inputLength);if(n.length!==e.length-1)throw new te(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const a=n[r],i=e[r+1];if(a!=null&&i!=null&&a!==i)throw new te(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);a==null&&(n[s]=i),s++}}return[e[0],...n,this.outputDim]}call(e,n){return re(()=>{this.invokeCallHook(e,n);let s=qe(e);s.dtype!=="int32"&&(s=Pa(s,"int32"));const r=qB(this.embeddings.read(),J(s,[s.size]));return J(r,xt(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Gt(this.embeddingsInitializer),embeddingsRegularizer:Dt(this.embeddingsRegularizer),activityRegularizer:Dt(this.activityRegularizer),embeddingsConstraint:Nn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}E$.className="Embedding";Se(E$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ou extends st{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Ze}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const a=e[e.length-n.length+r],i=n[r];if(a==null||i==null||a<0||i<0)s.push(null);else if(a===1)s.push(i);else if(i===1)s.push(a);else{if(a!==i)throw new te("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(a)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[xt(e)]),e=e,e.length<2)throw new te(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const a of e)a!=null&&a[0]!==null&&n.push(a[0]);if(n=Io(n),n.length>1)throw new te(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let a=1;a<e.length;++a){const i=e[a]==null?null:e[a].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const r=e.map(a=>a.length);e.indexOf(null)===-1&&Io(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return re(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(a=>a.rank);if(r.indexOf(null)===-1){const a=Uo(r);for(let i of e){const o=i.rank;for(let l=0;l<a-o;++l)i=pg(i,1);s.push(i)}return this.mergeFunction(s)}else{let a=!1;for(const l of e){const c=l.rank;if(c==null){const f=l.shape,d=f[0],p=f.slice(1).concat([d]);let g=J(l,[d].concat(Ao(f.slice(1))));g=ot(g,[1,0]),g=J(g,p),s.push(g),a=!0}else if(c>1){const f=ca(1,c).concat([0]);s.push(ot(l,f)),a=!0}else s.push(l)}let i=this.mergeFunction(s);const o=i.rank;if(a){if(o==null){const l=i.shape,c=l.length,f=l[c-1],d=[f].concat(l.slice(0,l.length-1));i=J(ot(J(i,[-1,f]),[1,0]),d)}else if(o>1){const l=[o-1].concat(ca(0,o-1));i=ot(i,l)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const a=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,a)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=Io(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return re(()=>{if(n==null)return null;if(!Array.isArray(n))throw new te("`mask` should be an Array");if(!Array.isArray(e))throw new te("`inputs` should be an Array");if(n.length!==e.length)throw new te(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:jn(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=Vr(s,n[r]);return s})}}class $$ extends Ou{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ve(n,e[s]);return n})}}$$.className="Add";Se($$);class I$ extends Ou{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=Z(n,e[s]);return n})}}I$.className="Multiply";Se(I$);class A$ extends Ou{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ve(n,e[s]);return Z(1/e.length,n)})}}A$.className="Average";Se(A$);class R$ extends Ou{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Xa(n,e[s]);return n})}}R$.className="Maximum";Se(R$);class D$ extends Ou{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Vo(n,e[s]);return n})}}D$.className="Minimum";Se(D$);class O$ extends Ou{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new te("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const a=e[r].slice();a.splice(this.axis,1);let i=!1;for(const o of s)if(at(o,a)){i=!0;break}i||s.push(a)}if(s.length>1)throw new te("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return re(()=>LE(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new te("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const a of n.slice(1)){if(s[r]==null||a[r]==null){s[r]=null;break}s[r]+=a[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new te("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new te("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new te(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return re(()=>{let s=!0;if(n.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const r=[];for(let i=0;i<e.length;++i)n[i]==null?r.push(Ne(Xs(e[i]),"bool")):n[i].rank<e[i].rank?r.push(jn(n[i],-1)):r.push(n[i]);const a=an(r,this.axis);return gx(a,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}O$.className="Concatenate";Se(O$);function Id(t,e){for(;t<0;)t+=e;return t}function efe(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Ze("batchDot is not implemented for tensors of 4D or higher rank yet");if(M(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),M(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Ze("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const a=n;return re(()=>{let i;if(s>r){i=s-r;const l=[];for(let c=0;c<i;++c)l.push(1);e=J(e,e.shape.concat(l))}else if(r>s){i=r-s;const l=[];for(let c=0;c<i;++c)l.push(1);t=J(t,t.shape.concat(l))}else i=0;let o;if(t.shape.length===2&&e.shape.length===2)a[0]===a[1]?o=Oe(Z(t,e),a[0]):o=Oe(Z(ot(t,[1,0]),e),a[1]);else{const l=a[0]!==t.shape.length-1,c=a[1]===e.shape.length-1;o=tt(t,e,l,c)}if(i>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let f=l;f<l+i;++f)c.push(f);o=tl(o,c)}return o.shape.length===1&&(o=jn(o,1)),o})}class _$ extends Ou{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){M(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new Ze("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new te(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new te(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((a,i)=>Id(a,e[i].shape.length)):r=[Id(this.axes,n.shape.length),Id(this.axes,s.shape.length)],this.normalize&&(n=$1(n,r[0]),s=$1(s,r[1])),efe(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[Id(this.axes,e.length),Id(this.axes,n.length)],s}computeOutputShape(e){M(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new Ze("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const a=n.concat(s);return a.length===1&&a.push(1),a}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}_$.className="Dot";Se(_$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class F$ extends st{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=qe(e);return gg(()=>ve(rv(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}F$.className="GaussianNoise";Se(F$);class L$ extends st{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=qe(e);return this.rate>0&&this.rate<1?gg(()=>{const a=Math.sqrt(this.rate/(1-this.rate));return Z(s,rv(s.shape,1,a))},()=>s,n.training||!1):s})}}L$.className="GaussianDropout";Se(L$);class M$ extends st{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||qe(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return re(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return gg(()=>{const a=qe(e),o=-1.6732632423543772*1.0507009873554805;let l=Wi(el(s),this.rate);l=Pa(l,"float32");const c=((1-this.rate)*(1+this.rate*o**2))**-.5,f=-c*o*this.rate,d=ve(Z(a,l),Z(ve(l,-1),o));return ve(Z(d,c),f)},()=>qe(e),n.training||!1)}return e})}}M$.className="AlphaDropout";Se(M$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Cp(t,e,n,s,r,a=.001){let i;if(t.rank===2)i=rk(t,e,n,s,r,a);else if(t.rank===3)i=ak(t,e,n,s,r,a);else if(t.rank===4)i=ik(t,e,n,s,r,a);else throw new Ze(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return i}function tfe(t,e,n,s,r=.001){return re(()=>{const a=ng(t,s),i=a.mean,o=a.variance;return[Cp(t,i,o,n,e,r),i,o]})}function nfe(t,e,n,s,r=.001){return re(()=>{const a=ng(t,s),i=a.mean,o=a.variance,l=[];for(const y of ca(0,t.rank))s.indexOf(y)!==-1?l.push(1):l.push(t.shape[y]);const c=J(i,l),f=J(o,l),d=e==null?null:J(e,l),p=n==null?null:J(n,l);return[Cp(t,c,f,p,d,r),i,o]})}function sfe(t,e,n,s,r=.001){return at(s.slice().sort(),ca(0,t.rank-1))?tfe(t,e,n,s,r):nfe(t,e,n,s,r)}class z$ extends st{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Vt(e.betaInitializer||"zeros"),this.gammaInitializer=Vt(e.gammaInitializer||"ones"),this.movingMeanInitializer=Vt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Vt(e.movingVarianceInitializer||"ones"),this.betaConstraint=kn(e.betaConstraint),this.gammaConstraint=kn(e.gammaConstraint),this.betaRegularizer=Ut(e.betaRegularizer),this.gammaRegularizer=Ut(e.gammaRegularizer)}build(e){e=xt(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new te(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new gn({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return re(()=>{const s=n.training==null?!1:n.training,r=qe(e),a=r.shape,i=a.length,o=ca(0,i),l=this.axis>=0?this.axis:this.axis+i;o.splice(l,1);const c=fu(1,i);c[l]=a[l];const f=o.slice();f.sort();const d=!at(f,ca(0,i).slice(0,i-1)),p=()=>{if(d){const T=J(this.movingMean.read(),c),N=J(this.movingVariance.read(),c),C=this.center?J(this.beta.read(),c):null,E=this.scale?J(this.gamma.read(),c):null;return Cp(r,T,N,C,E,this.epsilon)}else return Cp(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return p();const[g,y,v]=sfe(r,this.gamma.read(),this.beta.read(),o,this.epsilon),x=(T,N,C)=>{re(()=>{const E=1-C,R=T.read(),$=Z(Re(R,N),E);T.write(Re(R,$))})};return(()=>{x(this.movingMean,y,this.momentum),x(this.movingVariance,v,this.momentum)})(),g})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Gt(this.betaInitializer),gammaInitializer:Gt(this.gammaInitializer),movingMeanInitializer:Gt(this.movingMeanInitializer),movingVarianceInitializer:Gt(this.movingVarianceInitializer),betaRegularizer:Dt(this.betaRegularizer),gammaRegularizer:Dt(this.gammaRegularizer),betaConstraint:Nn(this.betaConstraint),gammaConstraint:Nn(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}z$.className="BatchNormalization";Se(z$);class P$ extends st{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Vt(e.betaInitializer||"zeros"),this.gammaInitializer=Vt(e.gammaInitializer||"ones"),this.betaRegularizer=Ut(e.betaRegularizer),this.gammaRegularizer=Ut(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=xt(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=n);for(const a of this.axis)if(a<0||a>=n)throw new Error(`Invalid axis: ${a}`);if(this.axis.length!==Io(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(a=>e[a]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=qe(e),r=s.shape,a=r.length;return re(()=>{let{mean:o,variance:l}=ng(s,this.axis,!0);const c=fu(1,a);for(const v of this.axis)c[v]=r[v];const f=v=>v!=null&&v.shape.length!==a?J(v,c):v;let d=this.scale?f(this.gamma.read()):null,p=this.center?f(this.beta.read()):null;const g=[],y=[];for(let v=0;v<a;++v)this.axis.indexOf(v)!==-1?(g.push(r[v]),y.push(1)):(g.push(1),y.push(r[v]));return o=cr(o,g),l=cr(l,g),d!=null&&(d=cr(d,y)),p!=null&&(p=cr(p,y)),Cp(s,o,l,p,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Gt(this.betaInitializer),gammaInitializer:Gt(this.gammaInitializer),betaRegularizer:Dt(this.betaRegularizer),gammaRegularizer:Dt(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}P$.className="LayerNormalization";Se(P$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rfe(t,e,n){return re(()=>{if(t.rank!==4)throw new te(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new te("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=ha()),n!=="channelsLast"&&n!=="channelsFirst")throw new te(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],Gi(t,s)})}class B$ extends st{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?ha():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new te(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new te(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new te(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new gn({ndim:4})]}computeOutputShape(e){e=xt(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return re(()=>rfe(qe(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}B$.className="ZeroPadding2D";Se(B$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Sv(t,e,n,s,r,a){return re(()=>{cn(r),jB(a),vr(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=ha()),a==null&&(a="max"),t=l$(t,r);let i;const o=s==="same"?"same":"valid";return a==="max"?i=tg(t,e,n,o):i=qm(t,e,n,o),r==="channelsFirst"&&(i=ot(i,[0,3,1,2])),i})}function MV(t,e,n,s,r,a){return re(()=>{cn(r),jB(a),vr(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=ha()),a==null&&(a="max"),t=DV(t,r);let i;const o=s==="same"?"same":"valid";return a==="max"?i=Ik(t,e,n,o):i=sk(t,e,n,o),r==="channelsFirst"&&(i=ot(i,[0,4,1,2,3])),i})}class zV extends st{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new te(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Rn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new te(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Rn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,vr(this.padding),this.inputSpec=[new gn({ndim:3})]}computeOutputShape(e){e=xt(e);const n=ua(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return re(()=>{this.invokeCallHook(e,n),e=pg(qe(e),2);const s=this.poolingFunction(qe(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return tl(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class V$ extends zV{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return cn(a),vr(r),Sv(e,n,s,r,a,"max")}}V$.className="MaxPooling1D";Se(V$);class U$ extends zV{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return cn(a),vr(r),Sv(e,n,s,r,a,"avg")}}U$.className="AveragePooling1D";Se(U$);class PV extends st{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new te(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Rn(this.poolSize,"poolSize"),Rn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,cn(this.dataFormat),vr(this.padding),this.inputSpec=[new gn({ndim:4})]}computeOutputShape(e){e=xt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=ua(n,this.poolSize[0],this.padding,this.strides[0]),s=ua(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return re(()=>(this.invokeCallHook(e,n),this.poolingFunction(qe(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class j$ extends PV{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return cn(a),vr(r),Sv(e,n,s,r,a,"max")}}j$.className="MaxPooling2D";Se(j$);class W$ extends PV{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return cn(a),vr(r),Sv(e,n,s,r,a,"avg")}}W$.className="AveragePooling2D";Se(W$);class BV extends st{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new te(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Rn(this.poolSize,"poolSize"),Rn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,cn(this.dataFormat),vr(this.padding),this.inputSpec=[new gn({ndim:5})]}computeOutputShape(e){e=xt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=ua(n,this.poolSize[0],this.padding,this.strides[0]),s=ua(s,this.poolSize[1],this.padding,this.strides[1]),r=ua(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return re(()=>(this.invokeCallHook(e,n),this.poolingFunction(qe(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class G$ extends BV{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return cn(a),vr(r),MV(e,n,s,r,a,"max")}}G$.className="MaxPooling3D";Se(G$);class H$ extends BV{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return cn(a),vr(r),MV(e,n,s,r,a,"avg")}}H$.className="AveragePooling3D";Se(H$);class VV extends st{constructor(e){super(e),this.inputSpec=[new gn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Ze}}class q$ extends VV{constructor(e){super(e||{})}call(e,n){return re(()=>{const s=qe(e);return Wt(s,1)})}}q$.className="GlobalAveragePooling1D";Se(q$);class X$ extends VV{constructor(e){super(e||{})}call(e,n){return re(()=>{const s=qe(e);return mr(s,1)})}}X$.className="GlobalMaxPooling1D";Se(X$);class UV extends st{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,cn(this.dataFormat),this.inputSpec=[new gn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Ze}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class K$ extends UV{call(e,n){return re(()=>{const s=qe(e);return this.dataFormat==="channelsLast"?Wt(s,[1,2]):Wt(s,[2,3])})}}K$.className="GlobalAveragePooling2D";Se(K$);class Y$ extends UV{call(e,n){return re(()=>{const s=qe(e);return this.dataFormat==="channelsLast"?mr(s,[1,2]):mr(s,[2,3])})}}Y$.className="GlobalMaxPooling2D";Se(Y$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class jV extends st{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,a=la(r,s);delete n.layer;const i={layer:a};return Object.assign(i,n),new e(i)}}class Z$ extends jV{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=xt(e),e.length<3)throw new te(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=xt(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return re(()=>(e=qe(e),FV((i,o)=>[qe(this.layer.call(i,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}Z$.className="TimeDistributed";Se(Z$);function afe(t){Ru(sce,"BidirectionalMergeMode",t)}const ife="concat";class Q$ extends jV{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=la(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=la(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?ife:e.mergeMode,afe(this.mergeMode),e.weights)throw new Ze("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,a;return this.returnState&&(a=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(a).concat(a.slice()):[s].concat(a).concat(a.slice()):ks(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const a=_V(e,s,r,this.numConstants);if(e=a.inputs,s=a.initialState,r=a.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const i=[],o=[];if(s!=null){const c=s.length;if(c%2>0)throw new te("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,i.push(...s);const f=s.map(d=>new gn({shape:d.shape}));this.forwardLayer.stateSpec=f.slice(0,c/2),this.backwardLayer.stateSpec=f.slice(c/2),o.push(...f)}if(r!=null)throw new Ze("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof fa;for(const c of i)if(c instanceof fa!==l)throw new te("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(i),f=this.inputSpec.concat(o),d=this.inputSpec;this.inputSpec=f;const p=super.apply(c,n);return this.inputSpec=d,p}else return super.apply(e,n)}call(e,n){return re(()=>{const s=n.initialState;let r,a;if(s==null)r=this.forwardLayer.call(e,n),a=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),a=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let i;this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),this.returnSequences&&(a=yr(a,1));let o;return this.mergeMode==="concat"?o=LE([r,a]):this.mergeMode==="sum"?o=ve(r,a):this.mergeMode==="ave"?o=Z(.5,ve(r,a)):this.mergeMode==="mul"?o=Z(r,a):this.mergeMode==null&&(o=[r,a]),this.returnState?this.mergeMode==null?o.concat(i):[o].concat(i):o})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Zl(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Zl(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const a=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(a).concat(a):[s].concat(a).concat(a)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=la(n.layer);if(delete n.layer,n.numConstants!=null)throw new Ze("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}Q$.className="Bidirectional";Se(Q$);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class J$ extends st{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return re(()=>(e=qe(e),e.dtype!=="float32"&&(e=Pa(e,"float32")),ve(Z(e,this.scale),this.offset)))}}J$.className="Rescaling";Se(J$);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:ofe,cropAndResize:lfe}=Pr;class eI extends st{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,r,a,i,o,l){return re(()=>{let c,f=!1;const d=n/i,p=s/o,g=(r+n)/i,y=(a+s)/o,v=[d,p,g,y],x=[];e.rank===3?(f=!0,c=ys([e])):c=e;for(let E=0;E<c.shape[0];E++)x.push(v);const w=Ws(x,[x.length,4]),T=cu(0,x.length,1,"int32"),C=lfe(c,w,T,[r,a],"nearest");return Pa(f?qe(br(C)):C,l)})}upsize(e,n,s,r){return re(()=>{const a=ofe(e,[n,s]);return Pa(a,r)})}call(e,n){return re(()=>{const s=qe(e),r=s.dtype,a=s.shape,i=a[a.length-3],o=a[a.length-2];let l=0;i!==this.height&&(l=Math.floor((i-this.height)/2));let c=0;return o!==this.width&&(c=Math.floor((o-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,i,o,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=xt(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}eI.className="CenterCrop";Se(eI);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ufe(t,e,n,s){let r=qe(t);if(r.dtype!=="int32"&&(r=Pa(r,"int32")),e==="int")return r;const a=r.shape;if(r.rank===0&&(r=jn(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=jn(r,-1)),r.rank>2)throw new te(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${a} which would result in output rank ${r.rank}.`);const i=["multiHot","oneHot"].includes(e),o=r;let l;if(typeof s<"u"&&e==="count"?l=S1(o,s,n,i):l=S1(o,[],n,i),e!=="tfIdf")return l;if(s)return Z(l,s);throw new te("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class tI extends st{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=xt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return re(()=>{e=qe(e),e.dtype!=="int32"&&(e=Pa(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new te(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=qe(n.countWeights)}const r=mr(e),a=jc(e),i=vs(this.numTokens,r).bufferSync().get(0),o=Wi(a,0).bufferSync().get(0);if(!(i&&o))throw new te(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return ufe(e,this.outputMode,this.numTokens,s)})}}tI.className="CategoryEncoding";Se(tI);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const cfe=["bilinear","nearest"],B4=new Set(cfe);class nI extends st{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(B4.has(e.interpolation))this.interpolation=e.interpolation;else throw new te(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=xt(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return re(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Pr.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Pr.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...B4]} are supported`)})}}nI.className="Resizing";Se(nI);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class WV{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}WV.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class GV extends st{constructor(e){super(e),this.randomGenerator=new WV(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}GV.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const hfe=["bilinear","nearest"],V4=new Set(hfe);class sI extends GV{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new te(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new te(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new te(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(V4.has(s))this.interpolation=s;else throw new te(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=xt(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return re(()=>{const s=qe(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=el([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*r;a=Math.round(a);const i=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return Pr.resizeBilinear(e,i);case"nearest":return Pr.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...V4]} are supported`)}})}}sI.className="RandomWidth";Se(sI);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ffe(t){return new uf(t)}function dfe(t){return new a$(t)}function pfe(t){return new n$(t)}function mfe(t){return new s$(t)}function gfe(t){return new r$(t)}function yfe(t){return new o$(t)}function bfe(t){return new i$(t)}function xfe(t){return new xg(t)}function vfe(t){return new ff(t)}function wfe(t){return new u$(t)}function Sfe(t){return new df(t)}function Tfe(t){return new c$(t)}function Cfe(t){return new h$(t)}function Nfe(t){return new f$(t)}function kfe(t){return new d$(t)}function Efe(t){return new p$(t)}function $fe(t){return new S$(t)}function Ife(t){return new v$(t)}function Afe(t){return new wv(t)}function Rfe(t){return new x$(t)}function Dfe(t){return new w$(t)}function Ofe(t){return new T$(t)}function _fe(t){return new C$(t)}function Ffe(t){return new N$(t)}function Lfe(t){return new E$(t)}function Mfe(t){return new $$(t)}function zfe(t){return new A$(t)}function Pfe(t){return new O$(t)}function Bfe(t){return new R$(t)}function Vfe(t){return new D$(t)}function Ufe(t){return new I$(t)}function jfe(t){return new _$(t)}function Wfe(t){return new z$(t)}function Gfe(t){return new P$(t)}function Hfe(t){return new B$(t)}function rI(t){return new U$(t)}function qfe(t){return rI(t)}function Xfe(t){return rI(t)}function aI(t){return new W$(t)}function Kfe(t){return aI(t)}function Yfe(t){return aI(t)}function iI(t){return new H$(t)}function Zfe(t){return iI(t)}function Qfe(t){return iI(t)}function Jfe(t){return new q$(t)}function ede(t){return new K$(t)}function HV(t){return new X$(t)}function qV(t){return new Y$(t)}function XV(t){return new V$(t)}function KV(t){return new j$(t)}function tde(t){return new G$(t)}function nde(t){return new g$(t)}function sde(t){return new bv(t)}function rde(t){return new y$(t)}function ade(t){return new wg(t)}function ide(t){return new m$(t)}function ode(t){return new yv(t)}function lde(t){return new b$(t)}function ude(t){return new vv(t)}function cde(t){return new ya(t)}function hde(t){return new xv(t)}function fde(t){return new Q$(t)}function dde(t){return new Z$(t)}const pde=HV,mde=qV,gde=XV,yde=KV;function bde(t){return new F$(t)}function xde(t){return new L$(t)}function vde(t){return new M$(t)}function wde(t){return new k$(t)}function Sde(t){return new J$(t)}function Tde(t){return new eI(t)}function Cde(t){return new nI(t)}function Nde(t){return new tI(t)}function kde(t){return new sI(t)}const Ede=Object.freeze(Object.defineProperty({__proto__:null,Layer:st,RNN:ya,RNNCell:vg,activation:$fe,add:Mfe,alphaDropout:vde,average:zfe,averagePooling1d:rI,averagePooling2d:aI,averagePooling3d:iI,avgPool1d:qfe,avgPool2d:Kfe,avgPool3d:Zfe,avgPooling1d:Xfe,avgPooling2d:Yfe,avgPooling3d:Qfe,batchNormalization:Wfe,bidirectional:fde,categoryEncoding:Nde,centerCrop:Tde,concatenate:Pfe,conv1d:xfe,conv2d:vfe,conv2dTranspose:wfe,conv3d:Sfe,conv3dTranspose:Tfe,convLstm2d:lde,convLstm2dCell:ude,cropping2D:Nfe,dense:Ife,depthwiseConv2d:Efe,dot:jfe,dropout:Afe,elu:dfe,embedding:Lfe,flatten:Dfe,gaussianDropout:xde,gaussianNoise:bde,globalAveragePooling1d:Jfe,globalAveragePooling2d:ede,globalMaxPool1d:pde,globalMaxPool2d:mde,globalMaxPooling1d:HV,globalMaxPooling2d:qV,gru:nde,gruCell:sde,input:mV,inputLayer:ffe,layerNormalization:Gfe,leakyReLU:mfe,lstm:rde,lstmCell:ade,masking:wde,maxPool1d:gde,maxPool2d:yde,maxPooling1d:XV,maxPooling2d:KV,maxPooling3d:tde,maximum:Bfe,minimum:Vfe,multiply:Ufe,permute:Ffe,prelu:gfe,randomWidth:kde,reLU:pfe,repeatVector:Ofe,rescaling:Sde,reshape:_fe,resizing:Cde,rnn:cde,separableConv2d:Cfe,simpleRNN:ide,simpleRNNCell:ode,softmax:yfe,spatialDropout1d:Rfe,stackedRNNCells:hde,thresholdedReLU:bfe,timeDistributed:dde,upSampling2d:kfe,zeroPadding2d:Hfe},Symbol.toStringTag,{value:"Module"}));function $de(t,e){return ZE(t,e)}function Ide(t,e){return iV(t,e)}function Ade(t,e){return oV(t,e)}function Rde(t,e){return QE(t,e)}function Dde(t,e){return JE(t,e)}function Ode(t,e){return aV(t,e)}function _de(t,e){return hhe(t,e)}function Fde(t,e){return YE(t,e)}function Lde(t,e){return dv(t,e)}function Mde(t,e){return cf(t,e)}function zde(t,e){return cf(t,e)}function Pde(t,e){return cf(t,e)}function Bde(t,e){return Du(t,e)}function Vde(t,e){return Du(t,e)}function Ude(t,e){return Du(t,e)}function jde(t,e){return fhe(t,e)}const Wde=Object.freeze(Object.defineProperty({__proto__:null,MAPE:zde,MSE:Vde,binaryAccuracy:$de,binaryCrossentropy:Ide,categoricalAccuracy:Rde,categoricalCrossentropy:Dde,cosineProximity:Fde,mape:Pde,meanAbsoluteError:Lde,meanAbsolutePercentageError:Mde,meanSquaredError:Bde,mse:Ude,precision:Ode,r2Score:jde,recall:_de,sparseCategoricalAccuracy:Ade},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Gde=Object.freeze(Object.defineProperty({__proto__:null,modelFromJSON:Vhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Hde(t){return new bg(t)}function qde(t){return Xhe(t)}function Xde(t){return Khe(t)}const Kde=Object.freeze(Object.defineProperty({__proto__:null,l1:qde,l1l2:Hde,l2:Xde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class YV extends Yc{constructor(){super(...arguments),this.model=null}setModel(e){if(!(e instanceof Ni))throw new Error("model must be a LayersModel, not some other Container");this.model=e}}function ey(t,e){return t<e}function U4(t,e){return t>e}class ZV extends YV{constructor(e){if(super(),e==null&&(e={}),e.restoreBestWeights)throw new Ze("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=e.monitor||"val_loss",this.minDelta=Math.abs(e.minDelta||0),this.patience=e.patience||0,this.verbose=e.verbose||0,this.mode=e.mode||"auto",this.baseline=e.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=ey:this.mode==="max"?this.monitorFunc=U4:this.monitor.indexOf("acc")!==-1?this.monitorFunc=U4:this.monitorFunc=ey,this.monitorFunc===ey&&(this.minDelta*=-1)}async onTrainBegin(e){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===ey?1/0:-1/0}async onEpochEnd(e,n){await wo(n);const s=this.getMonitorValue(n);s!=null&&(this.monitorFunc(s-this.minDelta,this.best)?(this.best=s,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)))}async onTrainEnd(e){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(e){e==null&&(e={});const n=e[this.monitor];return n==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(e)}`),n}}function Yde(t){return new ZV(t)}const Zde={earlyStopping:Yde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qde=ae();Qde.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Bs;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(Bs||(Bs={}));var j4;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(j4||(j4={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oI={};function Jde(t,e){const n={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e};oI[t]=n}function QV(t){return oI[t]}function epe(t){delete oI[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I(t,e,n,s,r){const a=e.inputParams[t];if(a&&a.inputIndexStart!==void 0){const o=a.inputIndexStart,l=a.inputIndexEnd===0?void 0:a.inputIndexEnd===void 0?o+1:a.inputIndexEnd,c=o<0?e.inputNames.length+o:o;if(a.type==="tensor")return Wn(e.inputNames[c],n,s,r);if(a.type==="tensors"){const p=e.inputs.slice(o,l);return e.inputNames.slice(o,l).filter((y,v)=>{var x;return((x=p[v])===null||x===void 0?void 0:x.op)!=="NoOp"}).map(y=>Wn(y,n,s,r))}const f=Wn(e.inputNames[c],n,s,r),d=f.dataSync();return a.type==="number"?d[0]:pr(f.shape,d)}const i=e.attrParams[t];return i&&i.value}function Wn(t,e,n,s){const[r,a]=Us(t,n);if(s!=null){const o=s.getHashTableHandleByName(r);if(o!=null)return o}const i=n.currentContextIds.find(o=>!!e[O1(r,o)]);return i!==void 0?e[O1(r,i)][a]:void 0}function W4(t,e,n){return e[O1(t,n.currentContextId)]}function yi(t,e){const[n,s,r]=Us(t,e);return[O1(n,e&&e.currentContextId),s,r]}function O1(t,e){return e?`${t}-${e}`:t}function Us(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const a=e.parseNodeNameCache.get(t);if(a!=null)return a}const s=t.split(":");let r;if(s.length===1)r=[t,0,void 0];else{const a=s[0],i=s.length===3?s[1]:void 0,o=Number(s[s.length-1]);r=[a,o,i]}return n&&e.parseNodeNameCache.set(t,r),r}function Ny(t,e,n){let s=I("pad",t,e,n);if(s==="explicit"){s=I("explicitPaddings",t,e,n);const r=[[0,0],[0,0],[0,0],[0,0]];for(let a=0;a<4;a++)r[a][0]=s[a*2],r[a][1]=s[a*2+1];return r}return s}function bi(t){return t.kept?t:Ma(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tpe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],npe=Object.freeze(Object.defineProperty({__proto__:null,json:tpe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const spe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],rpe=Object.freeze(Object.defineProperty({__proto__:null,json:spe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ape=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],ipe=Object.freeze(Object.defineProperty({__proto__:null,json:ape},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ope=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],lpe=Object.freeze(Object.defineProperty({__proto__:null,json:ope},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const upe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],cpe=Object.freeze(Object.defineProperty({__proto__:null,json:upe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hpe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],fpe=Object.freeze(Object.defineProperty({__proto__:null,json:hpe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dpe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],ppe=Object.freeze(Object.defineProperty({__proto__:null,json:dpe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mpe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],gpe=Object.freeze(Object.defineProperty({__proto__:null,json:mpe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ype=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],bpe=Object.freeze(Object.defineProperty({__proto__:null,json:ype},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xpe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],vpe=Object.freeze(Object.defineProperty({__proto__:null,json:xpe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wpe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],Spe=Object.freeze(Object.defineProperty({__proto__:null,json:wpe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tpe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Cpe=Object.freeze(Object.defineProperty({__proto__:null,json:Tpe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Npe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],kpe=Object.freeze(Object.defineProperty({__proto__:null,json:Npe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Epe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],$pe=Object.freeze(Object.defineProperty({__proto__:null,json:Epe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ipe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Ape=Object.freeze(Object.defineProperty({__proto__:null,json:Ipe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rpe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],Dpe=Object.freeze(Object.defineProperty({__proto__:null,json:Rpe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ope=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],_pe=Object.freeze(Object.defineProperty({__proto__:null,json:Ope},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fpe=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Lpe=Object.freeze(Object.defineProperty({__proto__:null,json:Fpe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mpe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],zpe=Object.freeze(Object.defineProperty({__proto__:null,json:Mpe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class G4{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[npe,rpe,ipe,lpe,cpe,fpe,ppe,gpe,bpe,vpe,Spe,Cpe,kpe,$pe,Ape,Dpe,_pe,Lpe,zpe],n=[].concat(...e.map(s=>s.json));this.opMappers=n.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(e,n={}){const s=e.node,r=[],a=[],i=[],o=s.reduce((v,x)=>(v[x.name]=this.mapNode(x),x.op.startsWith("Placeholder")?r.push(v[x.name]):x.op==="Const"?a.push(v[x.name]):(x.input==null||x.input.length===0)&&i.push(v[x.name]),v),{});let l=[];const c=[];let f={},d={};n!=null&&(f=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const p=Object.keys(o);p.forEach(v=>{const x=o[v];x.inputNames.forEach((w,T)=>{const[N,,C]=yi(w),E=o[N];if(E.outputs!=null){const R=E.outputs.indexOf(C);if(R!==-1){const $=`${N}:${R}`;x.inputNames[T]=$}}x.inputs.push(E),E.children.push(x)})}),Object.keys(d).length===0?p.forEach(v=>{const x=o[v];x.children.length===0&&c.push(x)}):Object.keys(d).forEach(v=>{const[x]=yi(v),w=o[x];w!=null&&(w.signatureKey=d[v],c.push(w))}),Object.keys(f).length>0?Object.keys(f).forEach(v=>{const[x]=yi(v),w=o[x];w&&(w.signatureKey=f[v],l.push(w))}):l=r;let g={};e.library!=null&&e.library.function!=null&&(g=e.library.function.reduce((v,x)=>(v[x.signature.name]=this.mapFunction(x),v),{}));const y={nodes:o,inputs:l,outputs:c,weights:a,placeholders:r,signature:n,functions:g};return i.length>0&&(y.initNodes=i),y}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,s)=>(n[e[s].name]=s,n),{})}mapNode(e){const n=QV(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(s.inputParams=n.inputs.reduce((r,a)=>(r[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},r),{})),n.attrs!=null&&(s.attrParams=n.attrs.reduce((r,a)=>{const i=a.type;let o;switch(a.type){case"string":o=aC(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=aC(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":o=fC(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=fC(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":o=oC(e.attr,a.tfName,a.defaultValue||0),o===void 0&&a.tfDeprecatedName&&(o=oC(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":o=hC(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=hC(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":o=iC(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=iC(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":o=pC(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=pC(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":o=cC(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=cC(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":o=dC(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=dC(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":o=lC(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=lC(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":o=uC(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=uC(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":o=H4(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=H4(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${a.type} for op: ${e.op}`)}return r[a.name]={value:o,type:i},r},{})),s}mapFunction(e){const n=e.nodeDef,s=[],r=[];let a={};n!=null&&(a=n.reduce((d,p)=>(d[p.name]=this.mapNode(p),p.op==="Const"&&r.push(d[p.name]),d),{}));const i=[],o=[];e.signature.inputArg.forEach(d=>{const[p]=yi(d.name),g={name:p,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:lI(d.type),type:"dtype"}},children:[]};g.signatureKey=d.name,i.push(g),a[p]=g}),Object.keys(a).forEach(d=>{const p=a[d];p.inputNames.forEach((g,y)=>{const[v,,x]=yi(g),w=a[v];if(w.outputs!=null){const T=w.outputs.indexOf(x);if(T!==-1){const N=`${v}:${T}`;p.inputNames[y]=N}}p.inputs.push(w),w.children.push(p)})});const c=e.ret;e.signature.outputArg.forEach(d=>{const[p,g]=yi(c[d.name]),y=a[p];y!=null&&(y.defaultOutput=g,o.push(y))});const f=this.mapArgsToSignature(e);return{nodes:a,inputs:i,outputs:o,weights:r,placeholders:s,signature:f}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s),n),{}),outputs:e.signature.outputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s,e.ret),n),{})}}mapArgToTensorInfo(e,n){let s=e.name;return n!=null&&(s=n[s]),{name:s,dtype:e.type}}}function Ppe(t){const e=ae().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function JV(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):Ppe(t);return e?n:n.toLowerCase()}function aC(t,e,n,s=!1){const r=t[e];return r!=null?JV(r.s,s):n}function iC(t,e,n){const s=t[e];return s?s.b:n}function oC(t,e,n){const s=t[e]||{},r=s.i!=null?s.i:s.f!=null?s.f:n;return typeof r=="number"?r:parseInt(r,10)}function lI(t){switch(typeof t=="string"&&(t=Bs[t]),t){case Bs.DT_FLOAT:case Bs.DT_HALF:return"float32";case Bs.DT_INT32:case Bs.DT_INT64:case Bs.DT_INT8:case Bs.DT_UINT8:return"int32";case Bs.DT_BOOL:return"bool";case Bs.DT_DOUBLE:return"float32";case Bs.DT_STRING:return"string";case Bs.DT_COMPLEX64:case Bs.DT_COMPLEX128:return"complex64";default:return null}}function H4(t,e,n){const s=t[e];return s&&s.func?s.func.name:n}function lC(t,e,n){const s=t[e];return s&&s.type?lI(s.type):n}function uC(t,e,n){const s=t[e];return s&&s.list&&s.list.type?s.list.type.map(r=>lI(r)):n}function e5(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function cC(t,e,n){const s=t[e];return s&&s.shape?e5(s.shape):n}function hC(t,e,n){const s=t[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):n}function fC(t,e,n,s=!1){const r=t[e];return r&&r.list&&r.list.s?r.list.s.map(a=>JV(a,s)):n}function dC(t,e,n){const s=t[e];return s&&s.list&&s.list.shape?s.list.shape.map(r=>e5(r)):n}function pC(t,e,n){const s=t[e];return s&&s.list&&s.list.b?s.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bpe{constructor(e,n,s){this.node=e,this.tensorMap=n,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,a)=>(r[a]=this.getAttr(a),r),{}))}getInput(e){return Wn(e,this.tensorMap,this.context)}getAttr(e,n){const s=this.node.rawAttrs[e];if(s.tensor!=null)return Wn(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return oC(this.node.rawAttrs,e,n);if(s.s!=null)return aC(this.node.rawAttrs,e,n);if(s.b!=null)return iC(this.node.rawAttrs,e,n);if(s.shape!=null)return cC(this.node.rawAttrs,e,n);if(s.type!=null)return lC(this.node.rawAttrs,e,n);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return hC(this.node.rawAttrs,e,n);if(s.list.s!=null)return fC(this.node.rawAttrs,e,n);if(s.list.shape!=null)return dC(this.node.rawAttrs,e,n);if(s.list.b!=null)return pC(this.node.rawAttrs,e,n);if(s.list.type!=null)return uC(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zn=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:BN,abs:pn,acos:XN,acosh:KN,add:ve,addN:VP,all:gx,any:bp,argMax:iu,argMin:YN,asin:ZN,asinh:QN,atan:JN,atan2:ek,atanh:tk,avgPool:qm,avgPool3d:sk,basicLSTMCell:UP,batchNorm:tf,batchNorm2d:rk,batchNorm3d:ak,batchNorm4d:ik,batchToSpaceND:Xm,bincount:ok,bitwiseAnd:jP,booleanMaskAsync:E6,broadcastArgs:WP,broadcastTo:Yl,buffer:Qe,cast:Ne,ceil:lk,clipByValue:Ds,clone:Ma,complex:Oi,concat:an,concat1d:uk,concat2d:ck,concat3d:hk,concat4d:fk,conv1d:yx,conv2d:_i,conv2dTranspose:bx,conv3d:pk,conv3dTranspose:mk,cos:Km,cosh:xx,cosineWindow:jx,cumprod:wp,cumsum:vx,denseBincount:S1,depthToSpace:gk,depthwiseConv2d:nf,diag:HP,dilation2d:yk,div:Le,divNoNan:bk,dot:xk,dropout:Xk,einsum:Ml,elu:sf,enclosingPowerOfTwo:Kk,ensureShape:qP,equal:Hs,erf:wx,euclideanNorm:wk,exp:Os,expandDims:jn,expm1:Sk,eye:Sx,fft:lg,fill:Eu,floor:af,floorDiv:mx,fused:L6,gather:of,gatherND:R6,greater:vs,greaterEqual:Wi,ifft:Xc,imag:Ym,image:Pr,inTopKAsync:D6,irfft:Mx,isFinite:Tk,isInf:Ck,isNaN:Nk,leakyRelu:Zm,less:Wc,lessEqual:Jo,linalg:Qk,linspace:YP,localResponseNormalization:kk,log:qs,log1p:Qm,logSigmoid:Ek,logSoftmax:Cx,logSumExp:Jm,logicalAnd:Vr,logicalNot:eg,logicalOr:Nx,logicalXor:$k,losses:j6,lowerBound:QP,matMul:tt,max:mr,maxPool:tg,maxPool3d:Ik,maxPoolWithArgmax:JP,maximum:Xa,mean:Wt,meshgrid:e6,min:jc,minimum:Vo,mirrorPad:Ak,mod:Rk,moments:ng,movingAverage:$6,mul:Z,multiRNNCell:t6,multinomial:n6,neg:Ft,norm:rf,notEqual:uu,oneHot:Gc,ones:$s,onesLike:Xs,op:q,outerProduct:s6,pad:Gi,pad1d:r6,pad2d:a6,pad3d:i6,pad4d:o6,pool:Dk,pow:Wa,prelu:rg,print:qN,prod:Ok,raggedGather:l6,raggedRange:u6,raggedTensorToTensor:c6,rand:h6,randomGamma:p6,randomNormal:$x,randomStandardNormal:m6,randomUniform:el,randomUniformInt:g6,range:cu,real:Hc,reciprocal:zk,relu:ma,relu6:Ix,reshape:J,reverse:yr,reverse1d:y6,reverse2d:b6,reverse3d:x6,reverse4d:v6,rfft:ug,round:Ax,rsqrt:Rx,scalar:Pe,scatterND:I6,searchSorted:kx,selu:Dx,separableConv2d:Ox,setdiff1dAsync:w6,sigmoid:oa,sign:Pk,signal:U6,sin:_x,sinh:Fx,slice:ct,slice1d:ag,slice2d:Lx,slice3d:ig,slice4d:qc,softmax:og,softplus:$u,spaceToBatchND:sg,sparse:W6,sparseToDense:A6,spectral:V6,split:Is,sqrt:_n,square:kt,squaredDifference:zx,squeeze:tl,stack:ys,step:Iu,stridedSlice:Bk,string:G6,sub:Re,sum:Oe,tan:Vk,tanh:Bo,tensor:Ws,tensor1d:Hn,tensor2d:$o,tensor3d:Uk,tensor4d:S6,tensor5d:T6,tensor6d:C6,tensorScatterUpdate:N6,tile:cr,topk:Wk,transpose:ot,truncatedNormal:Bx,unique:Gk,unsortedSegmentSum:Vx,unstack:br,upperBound:k6,variable:Hk,where:Dn,whereAsync:qk,zeros:mn,zerosLike:ht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vpe=(t,e,n,s=Zn)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(I("a",t,e,n),I("b",t,e,n))];case"AddN":return[s.addN(I("tensors",t,e,n))];case"FloorMod":case"Mod":return[s.mod(I("a",t,e,n),I("b",t,e,n))];case"Mul":return[s.mul(I("a",t,e,n),I("b",t,e,n))];case"RealDiv":case"Div":return[s.div(I("a",t,e,n),I("b",t,e,n))];case"DivNoNan":return[s.divNoNan(I("a",t,e,n),I("b",t,e,n))];case"FloorDiv":return[s.floorDiv(I("a",t,e,n),I("b",t,e,n))];case"Sub":return[s.sub(I("a",t,e,n),I("b",t,e,n))];case"Minimum":return[s.minimum(I("a",t,e,n),I("b",t,e,n))];case"Maximum":return[s.maximum(I("a",t,e,n),I("b",t,e,n))];case"Pow":return[s.pow(I("a",t,e,n),I("b",t,e,n))];case"SquaredDifference":return[s.squaredDifference(I("a",t,e,n),I("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Upe=(t,e,n,s=Zn)=>{switch(t.op){case"Abs":case"ComplexAbs":return[s.abs(I("x",t,e,n))];case"Acos":return[s.acos(I("x",t,e,n))];case"Acosh":return[s.acosh(I("x",t,e,n))];case"Asin":return[s.asin(I("x",t,e,n))];case"Asinh":return[s.asinh(I("x",t,e,n))];case"Atan":return[s.atan(I("x",t,e,n))];case"Atan2":return[s.atan2(I("x",t,e,n),I("y",t,e,n))];case"Atanh":return[s.atanh(I("x",t,e,n))];case"Ceil":return[s.ceil(I("x",t,e,n))];case"Complex":return[s.complex(I("real",t,e,n),I("imag",t,e,n))];case"Cos":return[s.cos(I("x",t,e,n))];case"Cosh":return[s.cosh(I("x",t,e,n))];case"Elu":return[s.elu(I("x",t,e,n))];case"Erf":return[s.erf(I("x",t,e,n))];case"Exp":return[s.exp(I("x",t,e,n))];case"Expm1":return[s.expm1(I("x",t,e,n))];case"Floor":return[s.floor(I("x",t,e,n))];case"Log":return[s.log(I("x",t,e,n))];case"Log1p":return[s.log1p(I("x",t,e,n))];case"Imag":return[s.imag(I("x",t,e,n))];case"Neg":return[s.neg(I("x",t,e,n))];case"Reciprocal":return[s.reciprocal(I("x",t,e,n))];case"Real":return[s.real(I("x",t,e,n))];case"Relu":return[s.relu(I("x",t,e,n))];case"Round":return[s.round(I("x",t,e,n))];case"Selu":return[s.selu(I("x",t,e,n))];case"Sigmoid":return[s.sigmoid(I("x",t,e,n))];case"Sin":return[s.sin(I("x",t,e,n))];case"Sign":return[s.sign(I("x",t,e,n))];case"Sinh":return[s.sinh(I("x",t,e,n))];case"Softplus":return[s.softplus(I("x",t,e,n))];case"Sqrt":return[s.sqrt(I("x",t,e,n))];case"Square":return[s.square(I("x",t,e,n))];case"Tanh":return[s.tanh(I("x",t,e,n))];case"Tan":return[s.tan(I("x",t,e,n))];case"ClipByValue":return[s.clipByValue(I("x",t,e,n),I("clipValueMin",t,e,n),I("clipValueMax",t,e,n))];case"Relu6":return[s.relu6(I("x",t,e,n))];case"Rsqrt":return[s.rsqrt(Wn(t.inputNames[0],e,n))];case"LeakyRelu":return[s.leakyRelu(I("x",t,e,n),I("alpha",t,e,n))];case"Prelu":return[s.prelu(I("x",t,e,n),I("alpha",t,e,n))];case"IsNan":return[s.isNaN(Wn(t.inputNames[0],e,n))];case"IsInf":return[s.isInf(Wn(t.inputNames[0],e,n))];case"IsFinite":return[s.isFinite(Wn(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zr(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){M(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let s=0;s<t.length;s++){const r=t[s],a=e[s];M(r<0||a<0||r===a,()=>n+` Shapes ${t} and ${e} must match`)}}}function q4(t){return!(typeof t=="number"||t.some(e=>e<0))}function Ad(t,e,n){let s=mC(t,n);const r=!q4(s);if(r&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&e.forEach(a=>{s=mC(a.shape,s)}),!q4(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function mC(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let s=0;s<t.length;++s){const r=t[s],a=e[s];if(r>=0&&a>=0&&r!==a)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[s]=r>=0?r:a}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jpe{constructor(e,n,s,r,a,i,o){this.name=e,this.dtype=n,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=i,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=Pe(0),Tn(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),zr(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=n,Tn(n),s.written=!0,this.tensors[e]=s}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((s,r)=>this.write(s,n[r]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return Ws([],[0].concat(this.elementShape));const s=this.readMany(e);return zr(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),ys(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Ws([],[0].concat(this.elementShape));const n=[];for(let r=0;r<this.size();r++)n.push(r);const s=this.readMany(n);return zr(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),an(s,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,br(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let s=0;const r=e.map(l=>(s+=l,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const a=s===0?0:n.size/s,i=[];re(()=>{n=J(n,[1,s,a]);for(let l=0;l<e.length;++l){const f=[0,l===0?0:r[l-1],0],d=[1,e[l],a];i[l]=J(ct(n,f,d),this.elementShape)}return i});const o=[];for(let l=0;l<e.length;l++)o[l]=l;this.writeMany(o,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pu{get id(){return this.idTensor.id}constructor(e,n,s,r=-1){this.tensors=e,this.elementShape=n,this.elementDtype=s,e!=null&&e.forEach(a=>{if(s!==a.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${a.dtype}`);zr(n,a.shape,"TensorList shape mismatch: "),Tn(a)}),this.idTensor=Pe(0),this.maxNumElements=r,Tn(this.idTensor)}copy(){return new pu([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,s=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);zr(e,this.elementShape,"TensorList shape mismatch: ");const r=Ad(this.elementShape,this.tensors,e);return re(()=>{const a=this.tensors.map(i=>J(i,r));return ys(a,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=Ad(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,zr(r.shape,e,"TensorList shape mismatch: "),J(r,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(zr(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Tn(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new pu([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)n.tensors[s]=this.tensors[s];return n}getItem(e,n,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);zr(this.tensors[e].shape,n,"TensorList shape mismatch: ");const r=Ad(this.elementShape,this.tensors,n);return J(this.tensors[e],r)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);zr(this.elementShape,n.shape,"TensorList shape mismatch: "),Tn(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,s){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);zr(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=Ad(this.elementShape,this.tensors,s);return e.length===0?Ws([],[0].concat(r)):re(()=>{const a=e.map(i=>J(this.tensors[i],r));return ys(a,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);zr(this.elementShape,n,"TensorList shape mismatch: ");const s=Ad(this.elementShape,this.tensors,n);return this.size()===0?Ws([],[0].concat(s)):re(()=>{const r=this.tensors.map(a=>J(a,s));return an(r,0)})}}function Wpe(t,e,n){const s=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const r=t.shape.slice(1);zr(r,e,"TensorList shape mismatch: ");const a=br(t);return new pu(a,e,s)}function Gpe(t,e,n,s){return new pu([],t,e,s)}function Hpe(t,e,n,s){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const r=Math.max(...e);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const a=new pu([],n,t.dtype,s),i=br(t,0);return e.forEach((o,l)=>{a.setItem(o,i[l])}),a}function qpe(t,e,n){let s=0;const r=e.map(f=>(s+=f,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);const a=t.shape.slice(1),i=mC(a,n),o=s===0?0:t.size/s,l=re(()=>{const f=[];t=J(t,[1,s,o]);for(let d=0;d<e.length;++d){const g=[0,d===0?0:r[d-1],0],y=[1,e[d],o];f[d]=J(ct(t,g,y),i)}return t.dispose(),f}),c=new pu([],n,t.dtype,e.length);for(let f=0;f<l.length;f++)c.setItem(f,l[f]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xpe=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const s=I("thenBranch",t,e,n),r=I("elseBranch",t,e,n),a=I("cond",t,e,n),i=I("args",t,e,n);return(await a.data())[0]?n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap):n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const s=I("body",t,e,n),r=I("cond",t,e,n),a=I("args",t,e,n),i=await n.functionMap[r].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap),o=a.map(f=>f.id);let l=await i[0].data();i.forEach(f=>{!f.kept&&o.indexOf(f.id)===-1&&f.dispose()});let c=a;for(;l[0];){const f=c;c=await n.functionMap[s].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const d=c.map(g=>g.id);f.forEach(g=>{!g.kept&&o.indexOf(g.id)===-1&&d.indexOf(g.id)===-1&&g.dispose()});const p=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);l=await p[0].data(),p.forEach(g=>{!g.kept&&o.indexOf(g.id)===-1&&d.indexOf(g.id)===-1&&g.dispose()})}return c}case"LoopCond":{const s=I("pred",t,e,n);return[bi(s)]}case"Switch":{const s=I("pred",t,e,n);let r=I("data",t,e,n);return r.kept||(r=bi(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=t.inputNames.find(r=>Wn(r,e,n)!==void 0);if(s){const r=Wn(s,e,n);return[bi(r)]}return}case"Enter":{const s=I("frameName",t,e,n),r=I("tensor",t,e,n);return n.enterFrame(s),[bi(r)]}case"Exit":{const s=I("tensor",t,e,n);return n.exitFrame(),[bi(s)]}case"NextIteration":{const s=I("tensor",t,e,n);return n.nextIteration(),[bi(s)]}case"TensorArrayV3":{const s=I("size",t,e,n),r=I("dtype",t,e,n),a=I("elementShape",t,e,n),i=I("dynamicSize",t,e,n),o=I("clearAfterRead",t,e,n),l=I("identicalElementShapes",t,e,n),c=I("name",t,e,n),f=new jpe(c,r,s,a,l,i,o);return n.addTensorArray(f),[f.idTensor,Pe(1)]}case"TensorArrayWriteV3":{const s=I("tensorArrayId",t,e,n),r=I("index",t,e,n),a=I("tensor",t,e,n),i=n.getTensorArray(s.id);return i.write(r,a),[i.idTensor]}case"TensorArrayReadV3":{const s=I("tensorArrayId",t,e,n),r=I("index",t,e,n);return[n.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=I("tensorArrayId",t,e,n),r=I("indices",t,e,n),a=I("dtype",t,e,n);return[n.getTensorArray(s.id).gather(r,a)]}case"TensorArrayScatterV3":{const s=I("tensorArrayId",t,e,n),r=I("indices",t,e,n),a=I("tensor",t,e,n),i=n.getTensorArray(s.id);return i.scatter(r,a),[i.idTensor]}case"TensorArrayConcatV3":{const s=I("tensorArrayId",t,e,n),r=n.getTensorArray(s.id),a=I("dtype",t,e,n);return[r.concat(a)]}case"TensorArraySplitV3":{const s=I("tensorArrayId",t,e,n),r=I("tensor",t,e,n),a=I("lengths",t,e,n),i=n.getTensorArray(s.id);return i.split(a,r),[i.idTensor]}case"TensorArraySizeV3":{const s=I("tensorArrayId",t,e,n),r=n.getTensorArray(s.id);return[Pe(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=I("tensorArrayId",t,e,n),r=n.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=I("tensorListId",t,e,n),r=I("index",t,e,n),a=I("tensor",t,e,n),i=n.getTensorList(s.id);return i.setItem(r,a),[i.idTensor]}case"TensorListGetItem":{const s=I("tensorListId",t,e,n),r=I("index",t,e,n),a=I("elementShape",t,e,n),i=I("elementDType",t,e,n);return[n.getTensorList(s.id).getItem(r,a,i)]}case"TensorListScatterV2":case"TensorListScatter":{const s=I("indices",t,e,n),r=I("tensor",t,e,n),a=I("elementShape",t,e,n),i=I("numElements",t,e,n),o=Hpe(r,s,a,i);return n.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=I("elementShape",t,e,n),r=I("elementDType",t,e,n);let a;t.op==="TensorListReserve"?a="numElements":a="maxNumElements";const i=I(a,t,e,n),o=t.op==="TensorListReserve"?-1:i,l=Gpe(s,r,i,o);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=I("tensorListId",t,e,n),r=I("indices",t,e,n),a=I("elementShape",t,e,n),i=I("elementDType",t,e,n);return[n.getTensorList(s.id).gather(r,i,a)]}case"TensorListStack":{const s=I("tensorListId",t,e,n),r=I("elementShape",t,e,n),a=I("elementDType",t,e,n),i=I("numElements",t,e,n);return[n.getTensorList(s.id).stack(r,a,i)]}case"TensorListFromTensor":{const s=I("tensor",t,e,n),r=I("elementShape",t,e,n),a=I("elementDType",t,e,n),i=Wpe(s,r,a);return n.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=I("tensorListId",t,e,n),r=n.getTensorList(s.id),a=I("dtype",t,e,n),i=I("elementShape",t,e,n);return[r.concat(a,i)]}case"TensorListPushBack":{const s=I("tensorListId",t,e,n),r=I("tensor",t,e,n),a=n.getTensorList(s.id);return a.pushBack(r),[a.idTensor]}case"TensorListPopBack":{const s=I("tensorListId",t,e,n),r=I("elementShape",t,e,n),a=I("elementDType",t,e,n);return[n.getTensorList(s.id).popBack(r,a)]}case"TensorListSplit":{const s=I("tensor",t,e,n),r=I("elementShape",t,e,n),a=I("lengths",t,e,n),i=qpe(s,a,r);return n.addTensorList(i),[i.idTensor]}case"TensorListLength":{const s=I("tensorListId",t,e,n),r=n.getTensorList(s.id);return[Pe(r.size(),"int32")]}case"TensorListResize":{const s=I("tensorListId",t,e,n),r=I("size",t,e,n),i=n.getTensorList(s.id).resize(r);return n.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X4(t,e,n){const[s,r]=I("fusedOps",t,e,n),a=s==="biasadd",i=!a,o=r==="prelu",l=s==="fusedbatchnorm",c=I("numArgs",t,e,n);if(a){if(o&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&a&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const f=I("strides",t,e,n),d=Ny(t,e,n),p=I("dataFormat",t,e,n).toUpperCase(),g=I("dilations",t,e,n);let[y,v]=I("args",t,e,n);i&&(v=y,y=void 0);const x=I("leakyreluAlpha",t,e,n);return{stride:f,pad:d,dataFormat:p,dilations:g,biasArg:y,preluArg:v,activationFunc:r,leakyreluAlpha:x}}const Kpe=(t,e,n,s=Zn)=>{switch(t.op){case"Conv1D":{const r=I("stride",t,e,n),a=I("pad",t,e,n),i=I("dataFormat",t,e,n).toUpperCase(),o=I("dilation",t,e,n);return[s.conv1d(I("x",t,e,n),I("filter",t,e,n),r,a,i,o)]}case"Conv2D":{const r=I("strides",t,e,n),a=Ny(t,e,n),i=I("dataFormat",t,e,n).toUpperCase(),o=I("dilations",t,e,n);return[s.conv2d(I("x",t,e,n),I("filter",t,e,n),[r[1],r[2]],a,i,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:r,pad:a,dataFormat:i,dilations:o,biasArg:l,preluArg:c,activationFunc:f,leakyreluAlpha:d}=X4(t,e,n);return[s.fused.conv2d({x:I("x",t,e,n),filter:I("filter",t,e,n),strides:[r[1],r[2]],pad:a,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:f,preluActivationWeights:c,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:a,dataFormat:i,dilations:o,biasArg:l,preluArg:c,activationFunc:f,leakyreluAlpha:d}=X4(t,e,n);return[s.fused.depthwiseConv2d({x:I("x",t,e,n),filter:I("filter",t,e,n),strides:[r[1],r[2]],pad:a,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:f,preluActivationWeights:c,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=I("outputShape",t,e,n),a=I("strides",t,e,n),i=Ny(t,e,n);return[s.conv2dTranspose(I("x",t,e,n),I("filter",t,e,n),r,[a[1],a[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=I("strides",t,e,n),a=Ny(t,e,n),i=I("dilations",t,e,n),o=I("dataFormat",t,e,n).toUpperCase();return[s.depthwiseConv2d(I("input",t,e,n),I("filter",t,e,n),[r[1],r[2]],a,o,[i[1],i[2]])]}case"Conv3D":{const r=I("strides",t,e,n),a=I("pad",t,e,n),i=I("dataFormat",t,e,n).toUpperCase(),o=I("dilations",t,e,n);return[s.conv3d(I("x",t,e,n),I("filter",t,e,n),[r[1],r[2],r[3]],a,i,[o[1],o[2],o[3]])]}case"AvgPool":{const r=I("strides",t,e,n),a=I("pad",t,e,n),i=I("kernelSize",t,e,n);return[s.avgPool(I("x",t,e,n),[i[1],i[2]],[r[1],r[2]],a)]}case"MaxPool":{const r=I("strides",t,e,n),a=I("pad",t,e,n),i=I("kernelSize",t,e,n);return[s.maxPool(I("x",t,e,n),[i[1],i[2]],[r[1],r[2]],a)]}case"MaxPoolWithArgmax":{const r=I("strides",t,e,n),a=I("pad",t,e,n),i=I("kernelSize",t,e,n),o=I("includeBatchInIndex",t,e,n),{result:l,indexes:c}=s.maxPoolWithArgmax(I("x",t,e,n),[i[1],i[2]],[r[1],r[2]],a,o);return[l,c]}case"AvgPool3D":{const r=I("strides",t,e,n),a=I("pad",t,e,n),i=I("kernelSize",t,e,n);return[s.avgPool3d(I("x",t,e,n),[i[1],i[2],i[3]],[r[1],r[2],r[3]],a)]}case"MaxPool3D":{const r=I("strides",t,e,n),a=I("pad",t,e,n),i=I("kernelSize",t,e,n);return[s.maxPool3d(I("x",t,e,n),[i[1],i[2],i[3]],[r[1],r[2],r[3]],a)]}case"Dilation2D":{const r=I("strides",t,e,n),a=I("pad",t,e,n),i=I("dilations",t,e,n),o=r[1],l=r[2],c=i[1],f=i[2];return[s.dilation2d(I("x",t,e,n),I("filter",t,e,n),[o,l],a,[c,f],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ype=(t,e,n,s=Zn)=>{switch(t.op){case"Fill":{const r=I("shape",t,e,n),a=I("dtype",t,e,n),i=I("value",t,e,n);return[s.fill(r,i,a)]}case"LinSpace":{const r=I("start",t,e,n),a=I("stop",t,e,n),i=I("num",t,e,n);return[s.linspace(r,a,i)]}case"Multinomial":{const r=I("logits",t,e,n),a=I("numSamples",t,e,n),i=I("seed",t,e,n);return[s.multinomial(r,a,i)]}case"OneHot":{const r=I("indices",t,e,n),a=I("depth",t,e,n),i=I("onValue",t,e,n),o=I("offValue",t,e,n),l=I("dtype",t,e,n);return[s.oneHot(r,a,i,o,l)]}case"Ones":return[s.ones(I("shape",t,e,n),I("dtype",t,e,n))];case"OnesLike":return[s.onesLike(I("x",t,e,n))];case"RandomStandardNormal":return[s.randomStandardNormal(I("shape",t,e,n),I("dtype",t,e,n),I("seed",t,e,n))];case"RandomUniform":return[s.randomUniform(I("shape",t,e,n),I("minval",t,e,n),I("maxval",t,e,n),I("dtype",t,e,n))];case"RandomUniformInt":return[s.randomUniformInt(I("shape",t,e,n),I("minval",t,e,n),I("maxval",t,e,n),I("seed",t,e,n))];case"Range":{const r=I("start",t,e,n),a=I("stop",t,e,n),i=I("step",t,e,n);return[s.range(r,a,i,I("dtype",t,e,n))]}case"TruncatedNormal":{const r=I("shape",t,e,n),a=I("mean",t,e,n),i=I("stdDev",t,e,n),o=I("seed",t,e,n);return[s.truncatedNormal(r,a,i,I("dtype",t,e,n),o)]}case"Zeros":return[s.zeros(I("shape",t,e,n),I("dtype",t,e,n))];case"ZerosLike":return[s.zerosLike(I("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OS(t,e,n){const s=I("boxes",t,e,n),r=I("scores",t,e,n),a=I("maxOutputSize",t,e,n),i=I("iouThreshold",t,e,n),o=I("scoreThreshold",t,e,n),l=I("softNmsSigma",t,e,n);return{boxes:s,scores:r,maxOutputSize:a,iouThreshold:i,scoreThreshold:o,softNmsSigma:l}}const Zpe=async(t,e,n,s,r=Zn)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:a,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:f}=OS(t,e,n),d=await r.image.nonMaxSuppressionWithScoreAsync(a,i,o,l,c,f);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:a,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=OS(t,e,n),f=I("padToMaxOutputSize",t,e,n),d=await r.image.nonMaxSuppressionPaddedAsync(a,i,o,l,c,f);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:a,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=OS(t,e,n);return[await r.image.nonMaxSuppressionAsync(a,i,o,l,c)]}case"Where":{const a=r.cast(I("condition",t,e,n),"bool"),i=[await r.whereAsync(a)];return a.dispose(),i}case"ListDiff":return r.setdiff1dAsync(I("x",t,e,n),I("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qpe=(t,e,n,s=Zn)=>{switch(t.op){case"LowerBound":{const r=I("sortedSequence",t,e,n),a=I("values",t,e,n);return[s.lowerBound(r,a)]}case"TopKV2":{const r=I("x",t,e,n),a=I("k",t,e,n),i=I("sorted",t,e,n),o=s.topk(r,a,i);return[o.values,o.indices]}case"UpperBound":{const r=I("sortedSequence",t,e,n),a=I("values",t,e,n);return[s.upperBound(r,a)]}case"Unique":{const r=I("x",t,e,n),a=s.unique(r);return[a.values,a.indices]}case"UniqueV2":{const r=I("x",t,e,n),a=I("axis",t,e,n),i=s.unique(r,a);return[i.values,i.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jpe=(t,e,n,s=Zn)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const r=I("default",t,e,n);return[Wn(t.name,e,n)||r];case"Placeholder":return[Wn(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const f=I("x",t,e,n);return[bi(f)]}case"IdentityN":return I("x",t,e,n).map(f=>bi(f));case"Snapshot":const a=I("x",t,e,n);return[bi(a)];case"Shape":return[s.tensor1d(I("x",t,e,n).shape,"int32")];case"ShapeN":return I("x",t,e,n).map(f=>s.tensor1d(f.shape));case"Size":return[s.scalar(I("x",t,e,n).size,"int32")];case"Rank":return[s.scalar(I("x",t,e,n).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const i=I("x",t,e,n),o=I("data",t,e,n),l=I("message",t,e,n),c=I("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let f=0;f<o.length;f++)console.log(Array.prototype.slice.call(o[f].dataSync()).slice(0,c));return[i];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eme{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=Pe(0),this.tensorMap=new Map,Tn(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Pe(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),re(()=>{const r=br(n),a=s.length,i=r.length;M(a===i,()=>`The number of elements doesn't match, keys has ${a} elements, the values has ${i} elements.`);for(let o=0;o<a;o++){const l=s[o],c=r[o];Tn(c),this.tensorMap.set(l,c)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return re(()=>{const r=[];for(let a=0;a<s.length;a++){const i=s[a],o=this.findWithDefault(i,n);r.push(o)}return ys(r)})}findWithDefault(e,n){const s=this.tensorMap.get(e);return s??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tme=async(t,e,n,s)=>{switch(t.op){case"HashTable":case"HashTableV2":{const r=s.getHashTableHandleByName(t.name);if(r!=null)return[r];{const a=I("keyDType",t,e,n),i=I("valueDType",t,e,n),o=new eme(a,i);return s.addHashTable(t.name,o),[o.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const r=I("tableHandle",t,e,n,s),a=I("keys",t,e,n),i=I("values",t,e,n);return[await s.getHashTableById(r.id).import(a,i)]}case"LookupTableFind":case"LookupTableFindV2":{const r=I("tableHandle",t,e,n,s),a=I("keys",t,e,n),i=I("defaultValue",t,e,n);return[await s.getHashTableById(r.id).find(a,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=I("tableHandle",t,e,n,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nme=(t,e,n,s=Zn)=>{switch(t.op){case"ResizeBilinear":{const r=I("images",t,e,n),a=I("size",t,e,n),i=I("alignCorners",t,e,n),o=I("halfPixelCenters",t,e,n);return[s.image.resizeBilinear(r,[a[0],a[1]],i,o)]}case"ResizeNearestNeighbor":{const r=I("images",t,e,n),a=I("size",t,e,n),i=I("alignCorners",t,e,n),o=I("halfPixelCenters",t,e,n);return[s.image.resizeNearestNeighbor(r,[a[0],a[1]],i,o)]}case"CropAndResize":{const r=I("image",t,e,n),a=I("boxes",t,e,n),i=I("boxInd",t,e,n),o=I("cropSize",t,e,n),l=I("method",t,e,n),c=I("extrapolationValue",t,e,n);return[s.image.cropAndResize(r,a,i,o,l,c)]}case"ImageProjectiveTransformV3":{const r=I("images",t,e,n),a=I("transforms",t,e,n),i=I("outputShape",t,e,n),o=I("fillValue",t,e,n),l=I("interpolation",t,e,n),c=I("fillMode",t,e,n);return[s.image.transform(r,a,l.toLowerCase(),c.toLowerCase(),o,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sme=(t,e,n,s=Zn)=>{switch(t.op){case"Equal":return[s.equal(I("a",t,e,n),I("b",t,e,n))];case"NotEqual":return[s.notEqual(I("a",t,e,n),I("b",t,e,n))];case"Greater":return[s.greater(I("a",t,e,n),I("b",t,e,n))];case"GreaterEqual":return[s.greaterEqual(I("a",t,e,n),I("b",t,e,n))];case"Less":return[s.less(I("a",t,e,n),I("b",t,e,n))];case"LessEqual":return[s.lessEqual(I("a",t,e,n),I("b",t,e,n))];case"LogicalAnd":return[s.logicalAnd(I("a",t,e,n),I("b",t,e,n))];case"LogicalNot":return[s.logicalNot(I("a",t,e,n))];case"LogicalOr":return[s.logicalOr(I("a",t,e,n),I("b",t,e,n))];case"Select":case"SelectV2":return[s.where(I("condition",t,e,n),I("a",t,e,n),I("b",t,e,n))];case"BitwiseAnd":return[s.bitwiseAnd(I("a",t,e,n),I("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rme=(t,e,n,s=Zn)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(I("a",t,e,n),I("b",t,e,n),I("transposeA",t,e,n),I("transposeB",t,e,n))];case"Einsum":return[s.einsum(I("equation",t,e,n),...I("tensors",t,e,n))];case"Transpose":return[s.transpose(I("x",t,e,n),I("perm",t,e,n))];case"_FusedMatMul":const[r,a]=I("fusedOps",t,e,n),i=r==="biasadd",o=a==="prelu",l=I("numArgs",t,e,n),c=I("leakyreluAlpha",t,e,n);if(i){if(o&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[f,d]=I("args",t,e,n);return[s.fused.matMul({a:I("a",t,e,n),b:I("b",t,e,n),transposeA:I("transposeA",t,e,n),transposeB:I("transposeB",t,e,n),bias:f,activation:a,preluActivationWeights:d,leakyreluAlpha:c})];case"MatrixBandPart":return[s.linalg.bandPart(I("a",t,e,n),I("numLower",t,e,n),I("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ame=(t,e,n,s=Zn)=>{switch(t.op){case"EuclideanNorm":return[s.euclideanNorm(I("x",t,e,n),I("axis",t,e,n),I("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(I("x",t,e,n),I("mean",t,e,n),I("variance",t,e,n),I("offset",t,e,n),I("scale",t,e,n),I("epsilon",t,e,n))];case"FusedBatchNormV3":return[s.batchNorm(I("x",t,e,n),I("mean",t,e,n),I("variance",t,e,n),I("offset",t,e,n),I("scale",t,e,n),I("epsilon",t,e,n))];case"LRN":return[s.localResponseNormalization(I("x",t,e,n),I("radius",t,e,n),I("bias",t,e,n),I("alpha",t,e,n),I("beta",t,e,n))];case"Softmax":return[s.softmax(I("x",t,e,n))];case"LogSoftmax":return[s.logSoftmax(I("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ime=(t,e,n,s=Zn)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:r,outputDenseValues:a}=s.raggedGather(I("paramsNestedSplits",t,e,n),I("paramsDenseValues",t,e,n),I("indices",t,e,n),I("outputRaggedRank",t,e,n));return r.concat(a)}case"RaggedRange":{const{rtNestedSplits:r,rtDenseValues:a}=s.raggedRange(I("starts",t,e,n),I("limits",t,e,n),I("splits",t,e,n));return[r,a]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(I("shape",t,e,n),I("values",t,e,n),I("defaultValue",t,e,n),I("rowPartitionTensors",t,e,n),I("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ome=(t,e,n,s=Zn)=>{switch(t.op){case"Max":{const o=I("axis",t,e,n),l=I("keepDims",t,e,n);return[s.max(I("x",t,e,n),o,l)]}case"Mean":{const o=I("axis",t,e,n),l=I("keepDims",t,e,n);return[s.mean(I("x",t,e,n),o,l)]}case"Min":{const o=I("axis",t,e,n),l=I("keepDims",t,e,n);return[s.min(I("x",t,e,n),o,l)]}case"Sum":{const o=I("axis",t,e,n),l=I("keepDims",t,e,n);return[s.sum(I("x",t,e,n),o,l)]}case"All":{const o=I("axis",t,e,n),l=I("keepDims",t,e,n);return[s.all(I("x",t,e,n),o,l)]}case"Any":{const o=I("axis",t,e,n),l=I("keepDims",t,e,n);return[s.any(I("x",t,e,n),o,l)]}case"ArgMax":{const o=I("axis",t,e,n);return[s.argMax(I("x",t,e,n),o)]}case"ArgMin":{const o=I("axis",t,e,n);return[s.argMin(I("x",t,e,n),o)]}case"Prod":{const o=I("axis",t,e,n),l=I("keepDims",t,e,n);return[s.prod(I("x",t,e,n),o,l)]}case"Cumprod":{const o=I("axis",t,e,n),l=I("exclusive",t,e,n),c=I("reverse",t,e,n);return[s.cumprod(I("x",t,e,n),o,l,c)]}case"Cumsum":{const o=I("axis",t,e,n),l=I("exclusive",t,e,n),c=I("reverse",t,e,n);return[s.cumsum(I("x",t,e,n),o,l,c)]}case"Bincount":const r=I("x",t,e,n),a=I("weights",t,e,n),i=I("size",t,e,n);return[s.bincount(r,a,i)];case"DenseBincount":{const o=I("x",t,e,n),l=I("weights",t,e,n),c=I("size",t,e,n),f=I("binaryOutput",t,e,n);return[s.denseBincount(o,l,c,f)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lme=(t,e,n,s=Zn)=>{switch(t.op){case"ConcatV2":case"Concat":{const r=I("n",t,e,n),a=I("axis",t,e,n);let i=I("tensors",t,e,n);return i=i.slice(0,r),[s.concat(i,a)]}case"Gather":{const r=I("x",t,e,n),a=I("indices",t,e,n);return[s.gather(r,s.cast(a,"int32"),0)]}case"GatherV2":{const r=I("axis",t,e,n),a=I("batchDims",t,e,n),i=I("x",t,e,n),o=I("indices",t,e,n);return[s.gather(i,s.cast(o,"int32"),r,a)]}case"Reverse":{const r=I("dims",t,e,n),a=[];for(let o=0;o<r.length;o++)r[o]&&a.push(o);const i=I("x",t,e,n);return[s.reverse(i,a)]}case"ReverseV2":{const r=I("axis",t,e,n),a=I("x",t,e,n);return[s.reverse(a,r)]}case"Slice":{const r=I("begin",t,e,n),a=I("size",t,e,n);return[s.slice(I("x",t,e,n),r,a)]}case"StridedSlice":{const r=I("begin",t,e,n),a=I("end",t,e,n),i=I("strides",t,e,n),o=I("beginMask",t,e,n),l=I("endMask",t,e,n),c=I("ellipsisMask",t,e,n),f=I("newAxisMask",t,e,n),d=I("shrinkAxisMask",t,e,n),p=I("x",t,e,n);return[s.stridedSlice(p,r,a,i,o,l,c,f,d)]}case"Pack":return re(()=>{const r=I("axis",t,e,n),a=I("tensors",t,e,n),i=a[0].shape,o=s.squeeze(a[0]).shape,l=a.map(c=>{const f=at(c.shape,i);if(!f&&!at(s.squeeze(c).shape,o))throw new Error("the input tensors shape does not match");return f?c:s.reshape(c,i)});return[s.stack(l,r)]});case"Unpack":{const r=I("axis",t,e,n),a=I("tensor",t,e,n);return s.unstack(a,r)}case"Tile":{const r=I("reps",t,e,n);return[s.tile(I("x",t,e,n),r)]}case"Split":case"SplitV":{const r=I("axis",t,e,n),a=I("numOrSizeSplits",t,e,n),i=I("x",t,e,n);return s.split(i,a,r)}case"ScatterNd":{const r=I("indices",t,e,n),a=I("values",t,e,n),i=I("shape",t,e,n);return[s.scatterND(r,a,i)]}case"GatherNd":{const r=I("x",t,e,n),a=I("indices",t,e,n);return[s.gatherND(r,a)]}case"SparseToDense":{const r=I("sparseIndices",t,e,n),a=I("outputShape",t,e,n),i=I("sparseValues",t,e,n),o=I("defaultValue",t,e,n);return[s.sparseToDense(r,i,a,i.dtype===o.dtype?o:s.cast(o,i.dtype))]}case"TensorScatterUpdate":{const r=I("indices",t,e,n),a=I("values",t,e,n),i=I("tensor",t,e,n);return[s.tensorScatterUpdate(i,r,a)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ume=(t,e,n,s=Zn)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:a,emptyRowIndicator:i,reverseIndexMap:o}=s.sparse.sparseFillEmptyRows(I("indices",t,e,n),I("values",t,e,n),I("denseShape",t,e,n),I("defaultValue",t,e,n));return[r,a,i,o]}case"SparseReshape":{const{outputIndices:r,outputShape:a}=s.sparse.sparseReshape(I("inputIndices",t,e,n),I("inputShape",t,e,n),I("newShape",t,e,n));return[r,a]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(I("data",t,e,n),I("indices",t,e,n),I("segmentIds",t,e,n))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(I("data",t,e,n),I("indices",t,e,n),I("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cme=(t,e,n,s=Zn)=>{switch(t.op){case"FFT":return[s.fft(I("x",t,e,n))];case"IFFT":return[s.ifft(I("x",t,e,n))];case"RFFT":return[s.rfft(I("x",t,e,n))];case"IRFFT":return[s.irfft(I("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hme=(t,e,n,s=Zn)=>{switch(t.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(I("input",t,e,n),I("pattern",t,e,n),I("rewrite",t,e,n),I("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:r,nGramsSplits:a}=s.string.stringNGrams(I("data",t,e,n),I("dataSplits",t,e,n),I("separator",t,e,n),I("nGramWidths",t,e,n),I("leftPad",t,e,n),I("rightPad",t,e,n),I("padWidth",t,e,n),I("preserveShortSequences",t,e,n));return[r,a]}case"StringSplit":{const{indices:r,values:a,shape:i}=s.string.stringSplit(I("input",t,e,n),I("delimiter",t,e,n),I("skipEmpty",t,e,n));return[r,a,i]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(I("input",t,e,n),I("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fme=(t,e,n,s=Zn)=>{switch(t.op){case"Cast":return[s.cast(I("x",t,e,n),I("dtype",t,e,n))];case"ExpandDims":{const r=I("axis",t,e,n);return[s.expandDims(I("x",t,e,n),r)]}case"Squeeze":{const r=I("axis",t,e,n);return[s.squeeze(I("x",t,e,n),r)]}case"Reshape":return[s.reshape(I("x",t,e,n),I("shape",t,e,n))];case"EnsureShape":return[s.ensureShape(I("x",t,e,n),I("shape",t,e,n))];case"MirrorPad":return[s.mirrorPad(I("x",t,e,n),I("padding",t,e,n),I("mode",t,e,n))];case"PadV2":case"Pad":return[s.pad(I("x",t,e,n),I("padding",t,e,n),I("constantValue",t,e,n))];case"SpaceToBatchND":{const r=I("blockShape",t,e,n),a=I("paddings",t,e,n);return[s.spaceToBatchND(I("x",t,e,n),r,a)]}case"BatchToSpaceND":{const r=I("blockShape",t,e,n),a=I("crops",t,e,n);return[s.batchToSpaceND(I("x",t,e,n),r,a)]}case"DepthToSpace":{const r=I("blockSize",t,e,n),a=I("dataFormat",t,e,n).toUpperCase();return[s.depthToSpace(I("x",t,e,n),r,a)]}case"BroadcastTo":return[s.broadcastTo(I("x",t,e,n),I("shape",t,e,n))];case"BroadcastArgs":return[s.broadcastArgs(I("s0",t,e,n),I("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K4(t,e,n,s,r=re){const a=((i,o,l)=>{switch(i.category){case"arithmetic":return r(()=>Vpe(i,o,l));case"basic_math":return r(()=>Upe(i,o,l));case"control":return Xpe(i,o,l);case"convolution":return r(()=>Kpe(i,o,l));case"creation":return r(()=>Ype(i,o,l));case"dynamic":return Zpe(i,o,l);case"evaluation":return r(()=>Qpe(i,o,l));case"image":return r(()=>nme(i,o,l));case"graph":return r(()=>Jpe(i,o,l));case"logical":return r(()=>sme(i,o,l));case"matrices":return r(()=>rme(i,o,l));case"normalization":return r(()=>ame(i,o,l));case"ragged":return r(()=>ime(i,o,l));case"reduction":return r(()=>ome(i,o,l));case"slice_join":return r(()=>lme(i,o,l));case"sparse":return r(()=>ume(i,o,l));case"spectral":return r(()=>cme(i,o,l));case"string":return r(()=>hme(i,o,l));case"transformation":return r(()=>fme(i,o,l));case"hash_table":return tme(i,o,l,s);case"custom":const c=QV(i.op);if(c&&c.customExecutor)return c.customExecutor(new Bpe(i,o,l));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return Ai(a)?a.then(i=>[].concat(i)):[].concat(a)}class Y4{constructor(e={},n={},s={},r={},a){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=s,this.functionMap=r,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const s=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z4(t,e,n,s){const r=new Set,a=[];let i=null,o=null;const l=new Set,c=new Set(Object.keys(t).map(p=>Us(p)[0]));s=s||[];const f=new Set(s.map(p=>Us(p.name)[0])),d=[...e];for(;d.length>0;){const p=d.pop();if((Pl(p)||vme(p)||wme(p))&&i==null&&(i=p,o=i.children.map(g=>g.name).filter(g=>r.has(g))),r.add(p.name),n[p.name]==null&&!c.has(p.name)&&!f.has(p.name)){if(p.inputs.length===0){a.push(p.name);continue}p.inputs.forEach(g=>{l.has(g.name)||(l.add(g.name),d.push(g))})}}return{inputs:t,outputs:e,usedNodes:r,missingInputs:a,dynamicNode:i,syncInputs:o}}function dme(t,e){const{usedNodes:n,inputs:s}=e,r=Object.keys(s).map(x=>Us(x)[0]).map(x=>t.nodes[x]),a=t.initNodes||[],i=x=>n.has(typeof x=="string"?x:x.name);function o(x){return[...new Map(x.map(w=>[w.name,w])).values()]}const l=o([...r,...t.weights,...a]).filter(i),c=o([...l,...Object.values(t.nodes)]).filter(i),f=new Map(c.map(x=>[x.name,x])),d={};for(const x of c){d[x.name]=d[x.name]||0;for(const w of x.children)i(w)||(d[w.name]=Number.POSITIVE_INFINITY),d[w.name]=(d[w.name]||0)+1}const p=Object.entries(d).filter(([,x])=>x===0).map(([x])=>x),g=[...p];for(;p.length>0;){const x=p.pop(),w=f.get(x);for(const T of w.children.filter(i))--d[T.name]===0&&(g.push(T.name),p.push(T.name))}const y=g.map(x=>f.get(x)),v=pme(y,l);return mme(v,l),v}function pme(t,e){const n=new Map(t.map(i=>[i.name,i])),s=e.map(i=>i.name),r=new Set(s);for(;s.length>0;){const i=s.pop(),o=n.get(i);for(const l of o.children)!n.has(l.name)||r.has(l.name)||(r.add(l.name),s.push(l.name))}return t.filter(i=>r.has(i.name))}class ty extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function mme(t,e){const n=new Map(t.map((o,l)=>[o.name,l])),s=new Set(e.map(o=>o.name)),r=o=>s.has(typeof o=="string"?o:o.name),a=new Set(t.map(o=>o.name)),i=o=>a.has(typeof o=="string"?o:o.name);for(const o of t){for(const l of o.children.filter(i)){if(!n.has(l.name))throw new ty(`Child ${l.name} of node ${o.name} is unreachable.`);if(n.get(o.name)>n.get(l.name))throw new ty(`Node ${o.name} is scheduled to run after its child ${l.name}.`)}if(!r(o))for(const l of o.inputs){if(!n.has(l.name))throw new ty(`Input ${l.name} of node ${o.name} is unreachable.`);if(n.get(l.name)>n.get(o.name))throw new ty(`Node ${o.name} is scheduled to run before its input ${l.name}.`)}}}function gme(t){const e=new Map(t.map((o,l)=>[o.name,l])),n=Number.MAX_SAFE_INTEGER,s=t.map((o,l)=>Pl(o)?n:l),r=o=>{const l=s[e.get(o.name)];return l??-1},a=t.map((o,l)=>o.children.map(r).reduce((c,f)=>Math.max(c,f),s[l])),i=new Map;for(let o=0;o<t.length;++o){const l=a[o];if(l===n)continue;const c=t[o],f=t[l];i.has(f.name)||i.set(f.name,[]),i.get(f.name).push(c)}return i}const yme=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),bme=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),xme=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Pl(t){return yme.has(t.op)}function vme(t){return bme.has(t.op)}function wme(t){return xme.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _1{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(s=>e[s].map(r=>r.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new _1(e.functions[s],this)})}getCompilationKey(e,n){const s=e.map(a=>a.name).sort(),r=n.map(a=>a.name).sort();return s.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,n){const s=Z4(e,n,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:i}=s;if(a!=null)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(r.length>0){const c=n.map(d=>d.name),f=Object.keys(e);throw new Error(`Cannot compute the outputs [${c}] from the provided inputs [${f}]. Missing the following inputs: [${r}]`)}const o=dme(this.graph,s),l=gme(o);return{orderedNodes:o,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return Tn(n),n}cloneTensorList(e){return e?e.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,s])=>[n,this.cloneTensorList(s)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const r=s.map(p=>this.graph.nodes[Us(p)[0]]),a=n.map(p=>Us(p)[0]),i=new Set(a);let o=a.map(p=>this.graph.nodes[p]);o.length===0&&(o=this._outputs);const l=this.getCompilationKey(r,o);let c=this.compiledMap.get(l);c==null&&(c=this.compile(e,o),this.compiledMap.set(l,c));try{this.keepIntermediateTensors=ae().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}const f={},d={};return re(()=>{const p=new Y4(this.weightMap,f,d,this.functionExecutorMap,this.parseNodeNameCache),g=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(w=>{const[T,N]=Us(w,p),C=[];C[N]=e[w],g[T]=C,this.keepIntermediateTensors&&(this.clonedTensorsMap[T]=this.cloneTensorList(C))});const y=this.getFrozenTensorIds(g),{orderedNodes:v,nodeLiveUntilMap:x}=c;for(const w of v){if(g[w.name])continue;const T=K4(w,g,p,this._resourceManager);if(Ai(T))throw new Error(`The execution of the op '${w.op}' returned a promise. Please use model.executeAsync() instead.`);g[w.name]=T,this.keepIntermediateTensors&&(this.clonedTensorsMap[w.name]=this.cloneTensorList(T)),this.checkTensorForDisposalWithNodeLiveUntilInfo(w,g,p,y,i,x.get(w.name))}return this.parent==null&&p.dispose(y),n.map(w=>Wn(w,g,p))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(r=>r.id)));return new Set(n)}checkTensorForDisposal(e,n,s,r,a,i,o){if(!(Pl(n)||i.has(e))){for(const l of s[e])l!=null&&(o[l.id]=(o[l.id]||0)+n.children.length);for(const l of n.inputs){if(Pl(l))continue;const c=W4(l.name,s,r);if(c!=null)for(const f of c){if(!f||f.kept||a.has(f.id))continue;const d=o[f.id];d===1?(f.dispose(),delete o[f.id]):d!=null&&o[f.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,s,r,a,i){function o(l){return Pl(l)||a.has(l.name)}if(!(Pl(e)||i==null))for(const l of i){if(o(l))continue;const c=W4(l.name,n,s);for(const f of c)!f||f.kept||r.has(f.id)||f.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,s=!1,r={},a={}){this.disposeIntermediateTensors(),s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=ae().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}const i=new Y4(this.weightMap,r,a,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const o=await this.executeWithControlFlow(e,i,n,s),l=n.map(p=>Wn(p,o,i)),c=l.map(p=>p.id),f=Object.keys(e).map(p=>e[p].id),d=new Set([...c,...f,...this.weightIds]);return Object.values(o).forEach(p=>{p.forEach(g=>{g&&!g.isDisposed&&!d.has(g.id)&&g.dispose()})}),this.parent==null&&i.dispose(d),l}async executeFunctionAsync(e,n,s){const r=e.reduce((a,i,o)=>(a[this.inputs[o].name]=i,a),{});return this._executeAsync(r,this.outputNodes,!0,n,s)}async executeWithControlFlow(e,n,s,r){const a=Object.keys(e),i=a.map(C=>this.graph.nodes[Us(C)[0]]),o=s.map(C=>Us(C)[0]),l=new Set(o);let c=o.map(C=>this.graph.nodes[C]);c.length===0&&(c=this._outputs);const{usedNodes:f,missingInputs:d,dynamicNode:p,syncInputs:g}=Z4(e,c,this.weightMap,this._initNodes),y=[...i,...this.graph.weights,...this._initNodes||[]].map(C=>({node:C,contexts:n.currentContext})),v=Object.assign({},this.weightMap);Object.keys(e).forEach(C=>{const[E,R]=Us(C),$=[];$[R]=e[C],v[E]=$});const x={},w=this.getFrozenTensorIds(v),T={};for(;y.length>0;){const C=this.processStack(i,y,n,v,T,w,l,x,f);await Promise.all(C)}p==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const N=c.filter(C=>!Pl(C)&&!Wn(C.name,v,n)).map(C=>C.name);if(N.length>0){let C="";throw p!=null&&(C=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${g}]`),new Error(`Cannot compute the outputs [${N}] from the provided inputs [${a}]. Consider providing the following inputs: [${d}]. ${C}`)}return v}processStack(e,n,s,r,a,i,o,l,c){const f=[];for(;n.length>0;){const d=n.pop();s.currentContext=d.contexts;let p="";if(d.node.op==="Enter"&&I("isConstant",d.node,r,s)&&([p]=yi(d.node.name,s)),r[d.node.name]==null){const g=K4(d.node,r,s,this._resourceManager);p||([p]=yi(d.node.name,s));const y=s.currentContext;Ai(g)?f.push(g.then(v=>(r[p]=v,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(v)),s.currentContext=y,this.checkTensorForDisposal(p,d.node,r,s,i,o,l),this.processChildNodes(d.node,n,s,r,a,c),v))):(r[p]=g,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(g)),this.checkTensorForDisposal(p,d.node,r,s,i,o,l),this.processChildNodes(d.node,n,s,r,a,c))}else this.processChildNodes(d.node,n,s,r,a,c)}return f}processChildNodes(e,n,s,r,a,i){e.children.forEach(o=>{const[l]=yi(o.name,s);a[l]||!i.has(o.name)||(o.op==="Merge"?o.inputNames.some(c=>!!Wn(c,r,s))&&(a[l]=!0,n.push({contexts:s.currentContext,node:o})):o.inputNames.every(c=>!!Wn(c,r,s))&&(a[l]=!0,n.push({contexts:s.currentContext,node:o})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const s=e[n],[r]=Us(n),a=this.graph.nodes[r];if(a.attrParams.shape&&a.attrParams.shape.value){const i=a.attrParams.shape.value,o=i.length===s.shape.length&&s.shape.every((l,c)=>i[c]===-1||i[c]===l);M(o,()=>`The shape of dict['${a.name}'] provided in model.execute(dict) must be [${i}], but was [${s.shape}]`)}a.attrParams.dtype&&a.attrParams.dtype.value&&M(s.dtype===a.attrParams.dtype.value,()=>`The dtype of dict['${a.name}'] provided in model.execute(dict) must be ${a.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){var n,s;const r={};for(const a in e){const i=(s=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||s===void 0?void 0:s[a];i!=null?r[i.name]=e[a]:r[a]=e[a]}return r}checkInputs(e){const n=Object.keys(e).filter(s=>{const[r]=Us(s);return this.graph.nodes[r]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var s,r;const a=(r=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||r===void 0?void 0:r[n];return a!=null?a.name:n},{})}checkOutputs(e){e.forEach(n=>{const[s]=Us(n);if(!this.graph.nodes[s])throw new Error(`The output '${n}' is not found in the graph`)})}}class Sme{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tme="?tfjs-format=file",Cme="model.json";class uI{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},s=oE){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=s,n==null&&(this.loadOptions={}),this.resourceManager=new Sme}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Ai(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await IP(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const s=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const a=this.artifacts.userDefinedMetadata;a.signature!=null&&(r=a.signature),a.structuredOutputKeys!=null&&(this.structuredOutputKeys=a.structuredOutputKeys)}if(this.signature=r,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new _1(G4.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const a=G4.Instance.transformGraph(e.modelInitializer);this.initializer=new _1(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof gt?[e]:e,s={};return n.forEach((r,a)=>s[this.structuredOutputKeys[a]]=r),s}return e}predict(e,n){const s=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(e,n){const s=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(e){var n;if(!(e instanceof gt)&&!Array.isArray(e)){const a=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(a!=null)for(const i in a){const o=a[i];o.resourceId!=null&&(e[i]=this.resourceIdToCapturedInput[o.resourceId])}return e}e=Array.isArray(e)?e:[e];const s=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((a,i)=>{var o,l,c;const f=(c=(l=(o=this.signature)===null||o===void 0?void 0:o.inputs)===null||l===void 0?void 0:l[i])===null||c===void 0?void 0:c.resourceId;return f!=null?a[i]=this.resourceIdToCapturedInput[f]:a[i]=e[r++],a},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,s=Object.keys(n);for(let r=0;r<s.length;r++){const a=s[r],i=n[a];this.resourceIdToCapturedInput[i.resourceId]=e[r]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=this.executor.execute(e,n);return s.length>1?s:s[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=await this.executor.executeAsync(e,n);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,s)=>(n[s]=[e[s]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Xe(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function Nme(t,e={},n=oE){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=Eme(t));const s=new uI(t,e,n);return await s.load(),s}function kme(t){if(t==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let e;if(t instanceof Array){const[s,r]=t;if(!s)throw new Error("modelJSON must be the first element of the array");if(!r||!(r instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in s))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in s))throw new Error("Model JSON is missing 'weightsManifest'");const a=w1(s.weightsManifest),i=GN(s,a,r);e=T1(i)}else if("load"in t)e=t;else if("modelTopology"in t&&"weightSpecs"in t&&"weightData"in t)e=T1(t);else throw new Error("Unknown model format");const n=new uI(e);return n.load(),n}function Eme(t){return t.endsWith("/")||(t=t+"/"),`${t}${Cme}${Tme}`}/** @license See the LICENSE file. */const t5="4.22.0";var ky={exports:{}},$me=ky.exports,Q4;function Ime(){return Q4||(Q4=1,function(t){(function(e,n,s){function r(l){var c=this,f=o();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=f(" "),c.s1=f(" "),c.s2=f(" "),c.s0-=f(l),c.s0<0&&(c.s0+=1),c.s1-=f(l),c.s1<0&&(c.s1+=1),c.s2-=f(l),c.s2<0&&(c.s2+=1),f=null}function a(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function i(l,c){var f=new r(l),d=c&&c.state,p=f.next;return p.int32=function(){return f.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,d&&(typeof d=="object"&&a(d,f),p.state=function(){return a(f,{})}),p}function o(){var l=4022871197,c=function(f){f=String(f);for(var d=0;d<f.length;d++){l+=f.charCodeAt(d);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=i:this.alea=i})($me,t)}(ky)),ky.exports}var Ey={exports:{}},Ame=Ey.exports,J4;function Rme(){return J4||(J4=1,function(t){(function(e,n,s){function r(o){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},o===(o|0)?l.x=o:c+=o;for(var f=0;f<c.length+64;f++)l.x^=c.charCodeAt(f)|0,l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xor128=i})(Ame,t)}(Ey)),Ey.exports}var $y={exports:{}},Dme=$y.exports,eF;function Ome(){return eF||(eF=1,function(t){(function(e,n,s){function r(o){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:c+=o;for(var f=0;f<c.length+64;f++)l.x^=c.charCodeAt(f)|0,f==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xorwow=i})(Dme,t)}($y)),$y.exports}var Iy={exports:{}},_me=Iy.exports,tF;function Fme(){return tF||(tF=1,function(t){(function(e,n,s){function r(o){var l=this;l.next=function(){var f=l.x,d=l.i,p,g;return p=f[d],p^=p>>>7,g=p^p<<24,p=f[d+1&7],g^=p^p>>>10,p=f[d+3&7],g^=p^p>>>3,p=f[d+4&7],g^=p^p<<7,p=f[d+7&7],p=p^p<<13,g^=p^p<<9,f[d]=g,l.i=d+1&7,g};function c(f,d){var p,g=[];if(d===(d|0))g[0]=d;else for(d=""+d,p=0;p<d.length;++p)g[p&7]=g[p&7]<<15^d.charCodeAt(p)+g[p+1&7]<<13;for(;g.length<8;)g.push(0);for(p=0;p<8&&g[p]===0;++p);for(p==8?g[7]=-1:g[p],f.x=g,f.i=0,p=256;p>0;--p)f.next()}c(l,o)}function a(o,l){return l.x=o.x.slice(),l.i=o.i,l}function i(o,l){o==null&&(o=+new Date);var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(f.x&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xorshift7=i})(_me,t)}(Iy)),Iy.exports}var Ay={exports:{}},Lme=Ay.exports,nF;function Mme(){return nF||(nF=1,function(t){(function(e,n,s){function r(o){var l=this;l.next=function(){var f=l.w,d=l.X,p=l.i,g,y;return l.w=f=f+1640531527|0,y=d[p+34&127],g=d[p=p+1&127],y^=y<<13,g^=g<<17,y^=y>>>15,g^=g>>>12,y=d[p]=y^g,l.i=p,y+(f^f>>>16)|0};function c(f,d){var p,g,y,v,x,w=[],T=128;for(d===(d|0)?(g=d,d=null):(d=d+"\0",g=0,T=Math.max(T,d.length)),y=0,v=-32;v<T;++v)d&&(g^=d.charCodeAt((v+32)%d.length)),v===0&&(x=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,v>=0&&(x=x+1640531527|0,p=w[v&127]^=g+x,y=p==0?y+1:0);for(y>=128&&(w[(d&&d.length||0)&127]=-1),y=127,v=4*128;v>0;--v)g=w[y+34&127],p=w[y=y+1&127],g^=g<<13,p^=p<<17,g^=g>>>15,p^=p>>>12,w[y]=g^p;f.w=x,f.X=w,f.i=y}c(l,o)}function a(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function i(o,l){o==null&&(o=+new Date);var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(f.X&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xor4096=i})(Lme,t)}(Ay)),Ay.exports}var Ry={exports:{}},zme=Ry.exports,sF;function Pme(){return sF||(sF=1,function(t){(function(e,n,s){function r(o){var l=this,c="";l.next=function(){var d=l.b,p=l.c,g=l.d,y=l.a;return d=d<<25^d>>>7^p,p=p-g|0,g=g<<24^g>>>8^y,y=y-d|0,l.b=d=d<<20^d>>>12^p,l.c=p=p-g|0,l.d=g<<16^p>>>16^y,l.a=y-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):c+=o;for(var f=0;f<c.length+20;f++)l.b^=c.charCodeAt(f)|0,l.next()}function a(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.tychei=i})(zme,t)}(Ry)),Ry.exports}var Dy={exports:{}},Bme=Dy.exports,rF;function Vme(){return rF||(rF=1,function(t){(function(e,n,s){var r=256,a=6,i=52,o="random",l=s.pow(r,a),c=s.pow(2,i),f=c*2,d=r-1,p;function g(C,E,R){var $=[];E=E==!0?{entropy:!0}:E||{};var O=w(x(E.entropy?[C,N(n)]:C??T(),3),$),A=new y($),_=function(){for(var D=A.g(a),B=l,j=0;D<c;)D=(D+j)*r,B*=r,j=A.g(1);for(;D>=f;)D/=2,B/=2,j>>>=1;return(D+j)/B};return _.int32=function(){return A.g(4)|0},_.quick=function(){return A.g(4)/4294967296},_.double=_,w(N(A.S),n),(E.pass||R||function(D,B,j,W){return W&&(W.S&&v(W,A),D.state=function(){return v(A,{})}),j?(s[o]=D,B):D})(_,O,"global"in E?E.global:this==s,E.state)}function y(C){var E,R=C.length,$=this,O=0,A=$.i=$.j=0,_=$.S=[];for(R||(C=[R++]);O<r;)_[O]=O++;for(O=0;O<r;O++)_[O]=_[A=d&A+C[O%R]+(E=_[O])],_[A]=E;($.g=function(D){for(var B,j=0,W=$.i,X=$.j,U=$.S;D--;)B=U[W=d&W+1],j=j*r+U[d&(U[W]=U[X=d&X+B])+(U[X]=B)];return $.i=W,$.j=X,j})(r)}function v(C,E){return E.i=C.i,E.j=C.j,E.S=C.S.slice(),E}function x(C,E){var R=[],$=typeof C,O;if(E&&$=="object")for(O in C)try{R.push(x(C[O],E-1))}catch{}return R.length?R:$=="string"?C:C+"\0"}function w(C,E){for(var R=C+"",$,O=0;O<R.length;)E[d&O]=d&($^=E[d&O]*19)+R.charCodeAt(O++);return N(E)}function T(){try{var C;return p&&(C=p.randomBytes)?C=C(r):(C=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(C)),N(C)}catch{var E=e.navigator,R=E&&E.plugins;return[+new Date,e,R,e.screen,N(n)]}}function N(C){return String.fromCharCode.apply(0,C)}if(w(s.random(),n),t.exports){t.exports=g;try{p=Ex}catch{}}else s["seed"+o]=g})(typeof self<"u"?self:Bme,[],Math)}(Dy)),Dy.exports}var _S,aF;function Ume(){if(aF)return _S;aF=1;var t=Ime(),e=Rme(),n=Ome(),s=Fme(),r=Mme(),a=Pme(),i=Vme();return i.alea=t,i.xor128=e,i.xorwow=n,i.xorshift7=s,i.xor4096=r,i.tychei=a,_S=i,_S}var n5=Ume();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function jme(t,e){return F1(t,e)}function F1(t,e,n=new Map,s=new Set){if(t==null)return null;if(typeof Blob=="function"&&t instanceof Blob)return t.slice();if(s.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);const r=e(t);if(r.recurse&&r.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(r.recurse)if(Zc(t)){const a=Array.isArray(t)?[]:{};s.add(t);for(const i in t){const o=t[i],l=F1(o,e,n,s);a[i]=l}return s.delete(t),t.__proto__&&(a.__proto__=t.__proto__),a}else throw new Error(`Can't recurse into non-iterable type: ${t}`);else return n.set(t,r.value),r.value}function Wme(t,e=r5){return s5(t,e)}function s5(t,e,n=new Set){const s=t[0];if(n.has(s))throw new Error("Circular references are not supported.");const r=e(t);if(r.recurse&&r.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(r.recurse)if(Zc(s)){const a=Array.isArray(s)?[]:{};n.add(s);for(const i in s){const o=t.map(c=>c[i]),l=s5(o,e,n);a[i]=l}return n.delete(s),a}else throw new Error(`Can't recurse into non-iterable type: ${s}`);else return r.value}function r5(t){return t===null?null:Zc(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}async function a5(t,e){const n=new Map;F1(t,e,n);for(const r of Array.from(n.keys())){const a=n.get(r);if(Ai(a)){const i=await a;n.set(r,i)}}return F1(t,e,n)}function Zc(t){let e=!1;if(ae().get("IS_BROWSER"))e=t instanceof TextDecoder;else{const{StringDecoder:n}=require("string_decoder");e=t instanceof n}return t!=null&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||typeof t=="object"&&!(t instanceof gt)&&!(t instanceof Promise)&&!e)}function Gme(t){return t==null||Hme(t)||Array.isArray(t)||typeof t=="object"&&t instanceof gt||Sn(t)}function Hme(t){return t===null||typeof t!="object"&&typeof t!="function"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function qme(t){return jme(t,Xme)}function Xme(t){return t instanceof gt?{value:t.clone(),recurse:!1}:Zc(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class i5{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,e==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,n){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=n}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(const n of e)this.push(n)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const n=this.wrap(this.begin+e),s=this.get(n);return this.set(n,this.pop()),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class Tv extends i5{constructor(){super(Tv.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){const e=this.capacity*2,n=new Array(e),s=this.length();for(let r=0;r<s;r++)n[r]=this.get(this.wrap(this.begin+r));this.data=n,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=s}}Tv.INITIAL_CAPACITY=32;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function o5(t){return new Zme(t)}function cI(t){return new Qme(t)}function Kme(t,e){return new l5(t,e)}function Yme(t,e=No.FAIL){return new oge(t,e)}class Fn{async toArray(){const e=[];let n=await this.next();for(;!n.done;)e.push(n.value),n=await this.next();return e}async toArrayForTest(){const e=this.prefetch(100),n=[];let s=await e.next();for(;!s.done;)n.push(s.value),s=await e.next();return n}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let n=await this.next(),s=e(n.value);for(;!n.done&&s;)n=await this.next(),s=e(n.value)}handleErrors(e){return new age(this,e)}filter(e){return new sge(this,e)}map(e){return new rge(this,e)}mapAsync(e){return new iF(this,e)}serialMapAsync(e){return new iF(this,e).serial()}flatmap(e){return new ige(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(n=>n===!0)}rowMajorBatch(e,n=!0){return new nge(this,e,n)}columnMajorBatch(e,n=!0,s=r5){return this.rowMajorBatch(e,n).map(a=>Wme(a,s))}concatenate(e,n){return new l5(o5([this,e]),n)}take(e){return e<0||e==null?this:new tge(this,e)}skip(e){return e<0||e==null?this:new ege(this,e)}prefetch(e){return new u5(this,e)}shuffle(e,n){return new lge(this,e,n)}serial(){return new Jme(this)}}class Zme extends Fn{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const e=this.items[this.trav];return this.trav++,{value:qme(e),done:!1}}}class Qme extends Fn{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(e){throw e.message=`Error thrown while iterating through a dataset: ${e.message}`,e}}}class Jme extends Fn{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class ege extends Fn{constructor(e,n){super(),this.upstream=e,this.maxCount=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const e=await this.upstream.next();if(e.done)return e;Xe(e.value)}return this.upstream.next()}}class tge extends Fn{constructor(e,n){super(),this.upstream=e,this.maxCount=n,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class nge extends Fn{constructor(e,n,s=!0){super(),this.upstream=e,this.batchSize=n,this.enableSmallLastBatch=s,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const e=[];for(;e.length<this.batchSize;){const n=await this.upstream.next();if(n.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(n.value)}return{value:e,done:!1}}}class sge extends Fn{constructor(e,n){super(),this.upstream=e,this.predicate=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;Xe(e.value)}}}class rge extends Fn{constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> Map`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const n=Di(e.value),s=this.transform(e.value),r=Di(s);for(const a of n)px(a,r)||a.dispose();return{value:s,done:!1}}}class age extends Fn{constructor(e,n){super(),this.upstream=e,this.handler=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}}class iF extends Fn{constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const n=Di(e.value),s=await this.transform(e.value),r=Di(s);for(const a of n)px(a,r)||a.dispose();return{value:s,done:!1}}}class hI extends Fn{constructor(){super(),this.outputQueue=new Tv,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class ige extends hI{constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const e=await this.upstream.next();if(e.done)return!1;const n=Di(e.value),s=this.transform(e.value),r=Di(s);this.outputQueue.pushAll(s);for(const a of n)px(a,r)||a.dispose();return!0}}class l5 extends Fn{constructor(e,n){super(),this.baseErrorHandler=n,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,this.iterator==null){const s=await this.moreIterators.next();if(s.done)return{value:null,done:!0};this.iterator=s.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const n=await this.iterator.next();return n.done?(this.iterator=null,this.readFromChain(e)):n}}var No;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(No||(No={}));class oge extends Fn{constructor(e,n=No.FAIL){super(),this.iterators=e,this.mismatchMode=n,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let n=0,s=0;function r(i){return i instanceof Fn?{value:i.next().then(l=>(n++,l.done&&s++,l.value)),recurse:!1}:{value:null,recurse:!0}}const a=await a5(this.iterators,r);if(n===s)return{value:null,done:!0};if(s>0)switch(this.mismatchMode){case No.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case No.SHORTEST:return{value:null,done:!0};case No.LONGEST:}return this.count++,{value:a,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}}class u5 extends Fn{constructor(e,n){super(),this.upstream=e,this.bufferSize=n,this.buffer=new i5(n)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}}class lge extends u5{constructor(e,n,s){super(e,n),this.upstream=e,this.windowSize=n,this.upstreamExhausted=!1,this.random=n5.alea(s||Un().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const e=this.chooseIndex(),n=await this.buffer.shuffleExcise(e);if(n.done)this.upstreamExhausted=!0;else return this.refill(),n}return{value:null,done:!0}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class pf{constructor(){this.size=null}batch(e,n=!0){const s=this;M(e>0,()=>`batchSize needs to be positive, but it is
      ${e}`);let r;return this.size===1/0||this.size==null?r=this.size:n?r=Math.ceil(this.size/e):r=Math.floor(this.size/e),Vs(async()=>(await s.iterator()).columnMajorBatch(e,n,hge),r)}concatenate(e){const n=this;let s;return this.size===1/0||e.size===1/0?s=1/0:this.size!=null&&e.size!=null?s=this.size+e.size:s=null,Vs(async()=>(await n.iterator()).concatenate(await e.iterator()),s)}filter(e){const n=this;let s;return this.size===1/0?s=1/0:s=null,Vs(async()=>(await n.iterator()).filter(r=>re(()=>e(r))),s)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){const n=this;return Vs(async()=>(await n.iterator()).map(s=>re(()=>e(s))),this.size)}mapAsync(e){const n=this;return Vs(async()=>(await n.iterator()).mapAsync(e),this.size)}prefetch(e){if(e==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const n=this;return Vs(async()=>(await n.iterator()).prefetch(e),this.size)}repeat(e){const n=this;let s;return this.size!=null&&e>0?s=this.size*e:e===0?s=0:this.size!=null&&(e===void 0||e<0)?s=1/0:s=null,Vs(async()=>{const r=cI(async()=>({value:await n.iterator(),done:!1}));return Kme(r.take(e))},s)}skip(e){const n=this;let s;return this.size!=null&&e>=0&&this.size>=e?s=this.size-e:this.size!=null&&(this.size<e||e===void 0||e<0)?s=0:s=null,Vs(async()=>(await n.iterator()).skip(e),s)}shuffle(e,n,s=!0){if(e==null||e<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const r=this,a=n5.alea(n||Un().toString());return Vs(async()=>{let i=a.int32();return s&&(i+=a.int32()),(await r.iterator()).shuffle(e,i.toString())},this.size)}take(e){const n=this;let s;return this.size!=null&&this.size>e?s=e:this.size!=null&&this.size<=e?s=this.size:s=null,Vs(async()=>(await n.iterator()).take(e),s)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}pf.MAX_BUFFER_SIZE=1e4;function Vs(t,e=null){return new class extends pf{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function uge(t){return Vs(async()=>o5(t),t.length)}function cge(t){if(!Zc(t))throw new Error("The argument to zip() must be an object or array.");let e;if(Array.isArray(t))for(let n=0;n<t.length;n++)e=e==null?t[n].size:Math.min(e,t[n].size);else if(t instanceof Object)for(const n in t)e=e==null?t[n].size:Math.min(e,t[n].size);return Vs(async()=>{const n=await a5(t,s=>{if(s instanceof pf)return{value:s.iterator(),recurse:!1};if(Zc(s))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return Yme(n,No.SHORTEST)},e)}function hge(t){if(t===null)return null;const e=t[0];return Gme(e)?{value:fge(t),recurse:!1}:{value:null,recurse:!0}}function fge(t){if(t.length===0)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof gt?ys(t):Ws(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class c5 extends pf{constructor(e){super(),this.input=e}async iterator(){return(await this.input.iterator()).decodeUTF8().split(`
`).map(r=>(r.endsWith("\r")&&(r=r.slice(0,-1)),r))}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */const ny='"',Rd=Symbol("out"),oF=Symbol("field"),sy=Symbol("quote"),FS=Symbol("quoteafterquote"),lF=Symbol("quoteinquote");class h5 extends pf{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){const e=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&e&&M(e.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=e);const n=this.fullColumnNames.reduce((r,a)=>(r[a]=r[a]+1||1,r),{}),s=Object.keys(n).filter(r=>n[r]>1);if(M(s.length===0,()=>"Duplicate column names found: "+s.toString()),this.columnConfigs){for(const r of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(r)===-1)throw new Error('The key "'+r+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){const n=await(await this.base.iterator()).next();if(n.done)throw new Error("No data was found for CSV parsing.");const s=n.value;return this.parseRow(s,!1)}else return null}constructor(e,n){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new c5(e),n||(n={}),this.hasHeader=n.hasHeader!==!1,this.fullColumnNames=n.columnNames,this.columnConfigs=n.columnConfigs,this.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(M(n.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=n.delimiter?n.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map(n=>this.makeDataElement(n))}makeDataElement(e){const n=this.parseRow(e),s={},r={};for(let a=0;a<this.fullColumnNames.length;a++){const i=this.fullColumnNames[a],o=this.columnConfigs?this.columnConfigs[i]:null;if(!(this.configuredColumnsOnly&&!o)){const l=n[a];let c=null;if(l==="")if(o&&o.default!==void 0)c=o.default;else{if(o&&(o.required||o.isLabel))throw new Error(`Required column ${i} is empty in this line: ${e}`);c=void 0}else{const f=Number(l);if(isNaN(f))o&&o.dtype==="bool"?c=this.getBoolean(l):c=l;else if(!o||!o.dtype)c=f;else switch(o.dtype){case"float32":c=f;break;case"int32":c=Math.floor(f);break;case"bool":c=this.getBoolean(l);break;default:c=f}}o&&o.isLabel?r[i]=c:s[i]=c}}return Object.keys(r).length===0?s:{xs:s,ys:r}}getBoolean(e){return e==="1"||e.toLowerCase()==="true"?1:0}parseRow(e,n=!0){const s=[];let r=0;const a=e.length;let i=Rd;for(let o=0;o<a;o++)switch(i){case Rd:switch(e.charAt(o)){case ny:r=o+1,i=sy;break;case this.delimiter:if(r=o+1,this.delimiter===" "&&this.delimWhitespace)break;s.push(""),i=Rd;break;default:i=oF,r=o;break}break;case oF:switch(e.charAt(o)){case this.delimiter:s.push(e.substring(r,o)),i=Rd,r=o+1;break}break;case sy:switch(e.charAt(o)){case ny:i=FS;break}break;case FS:switch(e.charAt(o)){case this.delimiter:s.push(e.substring(r,o-1)),i=Rd,r=o+1;break;case ny:i=sy;break;default:i=lF;break}break;case lF:switch(e.charAt(o)){case ny:i=sy;break}break}if(i===FS?s.push(e.substring(r,a-1)):s.push(e.substring(r)),n&&s.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${s}`);return s}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class fI extends Fn{constructor(e){super(),this.microphoneConfig=e,this.isClosed=!1,this.fftSize=e.fftSize||1024;const n=Math.log2(this.fftSize);if(this.fftSize<0||n<4||n>14||!Number.isInteger(n))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=e.numFramesPerSpectrogram||43,this.sampleRateHz=e.sampleRateHz,this.columnTruncateLength=e.columnTruncateLength||this.fftSize,this.audioTrackConstraints=e.audioTrackConstraints,this.smoothingTimeConstant=e.smoothingTimeConstant||0,this.includeSpectrogram=e.includeSpectrogram!==!1,this.includeWaveform=e.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(e={}){if(!ae().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");const n=new fI(e);return await n.start(),n}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(s){throw new Error(`Error thrown while initializing video stream: ${s.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const e=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new e,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`);const n=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,n.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let e,n;const s=await this.getAudioData();if(this.includeSpectrogram){const r=this.flattenQueue(s.freqDataQueue);e=this.getTensorFromAudioDataArray(r,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const r=this.flattenQueue(s.timeDataQueue);n=this.getTensorFromAudioDataArray(r,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:e,waveform:n},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){const e=[],n=[];let s=0;return new Promise(r=>{const a=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&r({freqDataQueue:e,timeDataQueue:n}),e.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),n.push(this.timeData.slice())),++s===this.numFrames&&(clearInterval(a),r({freqDataQueue:e,timeDataQueue:n}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(e){const n=e[0].length,s=new Float32Array(e.length*n);return e.forEach((r,a)=>s.set(r,a*n)),s}getTensorFromAudioDataArray(e,n){const s=new Float32Array(de(n));return s.set(e,s.length-e.length),Ws(s,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class dI extends Fn{constructor(e,n){if(super(),this.webcamVideoElement=e,this.webcamConfig=n,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=Hn([0],"int32"),this.webcamConfig.centerCrop){const s=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,r=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,a=(1-s)/2,i=(1-r)/2,o=a+s,l=r+i;this.cropBox=$o([i,a,l,o],[1,4])}else this.cropBox=$o([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(e,n={}){if(!ae().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!e){if(e=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");e.width=n.resizeWidth,e.height=n.resizeHeight}const s=new dI(e,n);return await s.start(),s}async start(){this.webcamConfig.facingMode&&M(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(e){throw e.message=`Error thrown while initializing video stream: ${e.message}`,e}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(e=>{this.webcamVideoElement.onloadedmetadata=()=>{e()}})}async next(){if(this.isClosed)return{value:null,done:!0};let e;try{e=eB(this.webcamVideoElement)}catch(n){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(n)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(e),done:!1}}catch(n){throw new Error(`Error thrown cropping the video: ${n.message}`)}finally{e.dispose()}else return{value:e,done:!1}}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(e){return re(()=>{const n=jn(Ne(e,"float32"),0);let s;s=Pr.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const r=s.shape;return J(s,r.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(n=>n.stop());try{this.webcamVideoElement.srcObject=null}catch(n){console.log(n),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class f5{}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class d5 extends Fn{split(e){return new dge(this,e)}}class dge extends d5{constructor(e,n){super(),this.upstream=e,this.impl=new pge(e,n)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class pge extends hI{constructor(e,n){super(),this.upstream=e,this.separator=n,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){const e=await this.upstream.next();if(e.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);const n=e.value.split(this.separator);n[0]=this.carryover+n[0];for(const s of n.slice(0,-1))this.outputQueue.push(s);return this.carryover=n[n.length-1],!0}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class mge extends Fn{decodeUTF8(){return new gge(this)}}class gge extends d5{constructor(e){super(),this.upstream=e,this.impl=new yge(e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class yge extends hI{constructor(e){if(super(),this.upstream=e,ae().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:n}=require("string_decoder");this.decoder=new n("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}async pump(){const e=await this.upstream.next();let n;if(e.done)return!1;n=e.value;let s;return ae().get("IS_BROWSER")?s=this.decoder.decode(n,{stream:!0}):s=this.decoder.write(Buffer.from(n.buffer)),this.outputQueue.push(s),!0}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class p5 extends mge{constructor(e,n={}){super(),this.file=e,this.options=n,M(e instanceof Uint8Array||(ae().get("IS_BROWSER")?e instanceof File||e instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=n.offset||0,this.chunkSize=n.chunkSize||1024*1024}summary(){return`FileChunks ${this.file}`}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise((n,s)=>{const r=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)n(new Uint8Array(this.file.slice(this.offset,r)));else{const a=new FileReader;a.onload=o=>{let l=a.result;if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),!(l instanceof Uint8Array))return s(new TypeError("FileReader returned unknown type."));n(l)},a.onabort=o=>s(new Error("Aborted")),a.onerror=o=>s(new Error(o.type));const i=this.file.slice(this.offset,r);a.readAsArrayBuffer(i)}this.offset=r}),done:!1}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */async function bge(t,e={},n){let s,r;typeof t=="string"?s=t:(s=t.url,r=xge(t));const a=await xP(s,r);if(a.ok){const i=new Uint8Array(await a.arrayBuffer());return new p5(i,e)}else throw new Error(a.statusText)}const xge=t=>({method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function m5(t){return typeof t=="string"&&t.slice(0,7)==="file://"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class g5 extends f5{constructor(e,n={}){super(),this.input=e,this.options=n}async iterator(){if(m5(this.input)&&ae().get("IS_NODE")){const e=require("fs");this.input=e.readFileSync(this.input.slice(7))}return new p5(this.input,this.options)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class y5 extends f5{constructor(e,n={}){super(),this.url=e,this.fileOptions=n}async iterator(){return m5(this.url)?new g5(this.url,this.fileOptions).iterator():bge(this.url,this.fileOptions)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function vge(t,e={}){return new h5(new y5(t),e)}function wge(t){const e=cI(t);return Vs(async()=>e)}function Sge(t){return Vs(async()=>{const e=await t();return cI(()=>e.next())})}async function Tge(t,e){return dI.create(t,e)}async function Cge(t){return fI.create(t)}/** @license See the LICENSE file. */const b5="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nge=Object.freeze(Object.defineProperty({__proto__:null,CSVDataset:h5,Dataset:pf,FileDataSource:g5,TextLineDataset:c5,URLDataSource:y5,array:uge,csv:vge,func:wge,generator:Sge,microphone:Cge,version_data:b5,webcam:Tge,zip:cge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _e(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&M(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kge=Ux;class Sg extends rb{nextDataId(){return Sg.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new AN(this,sa())}write(e,n,s){this.firstUse&&(this.firstUse=!1,ae().get("IS_NODE")&&lr(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&Da(s[0])){const a=s.map(i=>La(i));r=this.write(a,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,a){this.data.set(e,{values:n,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),a=this.readSync(s.imag.dataId);return Fi(r,a)}return oP(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>Ri(r));return Qe(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Qe(e.shape,e.dtype,n)}makeOutput(e,n,s){return sa().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=Un();return e(),{kernelMs:Un()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){_e([e],"where");const n=this.readSync(e.dataId);return kge(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Sg.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x5(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const Ege=t=>{const{x:e}=t.inputs,n=t.backend;_e(e,"abs");let s=new Float32Array(de(e.shape));const r=n.data.get(e.dataId).values;return s=x5(r),n.makeOutput(s,e.shape,e.dtype)},$ge={kernelName:Vp,backendName:"cpu",kernelFunc:Ege};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hn(t){return(e,n,s,r,a)=>{const i=Ke(e,n),o=i.length,l=Be(i),c=de(i),f=On(a,c),d=e.length,p=n.length,g=Be(e),y=Be(n),v=lu(e,i),x=lu(n,i);if(v.length+x.length===0)for(let w=0;w<f.length;++w)f[w]=t(s[w%s.length],r[w%r.length]);else for(let w=0;w<f.length;++w){const T=Nu(w,o,l),N=T.slice(-d);v.forEach($=>N[$]=0);const C=ia(N,d,g),E=T.slice(-p);x.forEach($=>E[$]=0);const R=ia(E,p,y);f[w]=t(s[C],r[R])}return[f,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function js(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,a=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,o=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(o.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",a),imag:n.makeTensorInfo(r.shape,"float32",i)},o}const Ige={kernelName:db,backendName:"cpu",kernelFunc:js};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L1(t,e,n="float32"){if(n==="complex64"){const r=L1(t,e,"float32"),a=L1(t,e,"float32");return js({inputs:{real:r,imag:a},backend:t})}const s=qn(de(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ha(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Age={kernelName:kh,backendName:"cpu",kernelFunc:Ha};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mu(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,a=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,a)}const Rge={kernelName:Hb,backendName:"cpu",kernelFunc:mu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v5(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=Ko([0],n),[a,i]=hn((o,l)=>o!==l?1:0)(e,[],t,r,"bool");return[i,"bool",a]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function Ho(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return Ha({inputs:{x:r},backend:n});const f=L1(n,r.shape,r.dtype),d=Ho({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),p=js({inputs:{real:d,imag:f},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),p}if(r.dtype==="complex64"){const f=mu({inputs:{input:r},backend:n}),d=Ho({inputs:{x:f},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(f),d}if(!ON(r.dtype,a)){const f=Ha({inputs:{x:r},backend:n});return{dataId:f.dataId,shape:f.shape,dtype:a}}const i=n.data.get(r.dataId).values,[o,l,c]=v5(i,r.shape,r.dtype,a);return n.makeTensorInfo(o,l,c)}const Dge={kernelName:dh,backendName:"cpu",kernelFunc:Ho};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function En(t,e,n,s){return n==null?({inputs:r,backend:a})=>{const{a:i,b:o}=r,l=a;_e([i,o],t);const c=l.data.get(i.dataId).values,f=l.data.get(o.dataId).values,d=i.dtype==="string"?Li(c):c,p=i.dtype==="string"?Li(f):f,g=s||i.dtype,[y,v]=e(i.shape,o.shape,d,p,g);return l.makeTensorInfo(v,g,y)}:({inputs:r,backend:a})=>{const{a:i,b:o}=r,l=a;if(i.dtype==="complex64"||o.dtype==="complex64"){const c=Ho({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),f=l.data.get(c.dataId),d=f.complexTensorInfos.real,p=f.complexTensorInfos.imag,g=l.data.get(d.dataId).values,y=l.data.get(p.dataId).values,v=Ho({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),x=l.data.get(v.dataId),w=x.complexTensorInfos.real,T=x.complexTensorInfos.imag,N=l.data.get(w.dataId).values,C=l.data.get(T.dataId).values,[E,R,$]=n(i.shape,o.shape,g,y,N,C),O=l.makeTensorInfo($,"float32",E),A=l.makeTensorInfo($,"float32",R),_=js({inputs:{real:O,imag:A},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(v),l.disposeIntermediateTensorInfo(O),l.disposeIntermediateTensorInfo(A),_}else{const c=l.data.get(i.dataId).values,f=l.data.get(o.dataId).values,d=s||i.dtype,[p,g]=e(i.shape,o.shape,c,f,d);return l.makeTensorInfo(g,d,p)}}}function pI(t){return(e,n,s,r,a,i)=>{const o=Ke(e,n),l=de(o),c=o.length,f=Be(o),d=On("float32",l),p=On("float32",l),g=lu(e,o),y=lu(n,o),v=Fi(s,r),x=Fi(a,i),w=e.length,T=Be(e),N=n.length,C=Be(n);if(g.length+y.length===0)for(let E=0;E<d.length;E++){const R=E%v.length,$=E%x.length,O=t(v[R*2],v[R*2+1],x[$*2],x[$*2+1]);d[E]=O.real,p[E]=O.imag}else for(let E=0;E<d.length;E++){const R=Nu(E,c,f),$=R.slice(-w);g.forEach(B=>$[B]=0);const O=ia($,w,T),A=R.slice(-N);y.forEach(B=>A[B]=0);const _=ia(A,N,C),D=t(v[O*2],v[O*2+1],x[_*2],x[_*2+1]);d[E]=D.real,p[E]=D.imag}return[d,p,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w5=hn((t,e)=>t+e),Oge=pI((t,e,n,s)=>({real:t+n,imag:e+s})),Qc=En(ku,w5,Oge),_ge={kernelName:ku,backendName:"cpu",kernelFunc:Qc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mI(t,e,n,s,r){const a=de(s),i=qn(r,n);for(let o=0;o<t.length;o++){const l=t[o];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(a>0?i[l]+=e[o]:i[l]+=1)}return i}function S5(t,e,n,s=!1){const r=t.shape[0],a=t.shape[1],i=Qe([r,n],e.dtype);for(let o=0;o<r;o++)for(let l=0;l<a;l++){const c=t.get(o,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?i.set(1,o,c):e.size>0?i.set(i.get(o,c)+e.get(o,l),o,c):i.set(i.get(o,c)+1,o,c))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T5=hn((t,e)=>t&e),Fge=En(Kp,T5),Lge={kernelName:Kp,backendName:"cpu",kernelFunc:Fge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ka(t){return(e,n,s)=>{const r=Zt(n,e.length);for(let a=0;a<e.length;++a)r[a]=t(e[a],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nt(t,e,n){const s=Ka(e);return sl(t,s,n)}function sl(t,e,n){return({inputs:s,attrs:r,backend:a})=>{const{x:i}=s;_e(i,t);const o=a,l=o.data.get(i.dataId).values;let c;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=Li(l)}else c=l;const f=n||i.dtype,d=e(c,f,r);return o.makeTensorInfo(i.shape,f,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C5=Ka(t=>Math.ceil(t)),Mge=sl(ph,C5),zge={kernelName:ph,backendName:"cpu",kernelFunc:Mge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N5(t,e,n,s){const r=Zt(n,de(e));if(s&&n!=="string"){let a=0;t.forEach(i=>{const o=de(i.shape);r.set(i.vals,a),a+=o})}else{let a=0;t.forEach(i=>{const o=n==="string"?Li(i.vals):i.vals;let l=0;for(let c=0;c<i.shape[0];++c){const f=c*e[1]+a;for(let d=0;d<i.shape[1];++d)r[f+d]=o[l++]}a+=i.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k5=hn((t,e)=>t===e?1:0),E5=En(rm,k5,null,"bool"),Pge={kernelName:rm,backendName:"cpu",kernelFunc:E5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $5=Ka(t=>Math.exp(t)),I5=sl(wh,$5,"float32"),Bge={kernelName:wh,backendName:"cpu",kernelFunc:I5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A5=Ka(t=>Math.expm1(t)),Vge=sl(Sh,A5),Uge={kernelName:Sh,backendName:"cpu",kernelFunc:Vge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R5=Ka(t=>Math.floor(t)),jge=sl(Th,R5),Wge={kernelName:Th,backendName:"cpu",kernelFunc:jge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D5=hn((t,e)=>Math.floor(t/e)),Gge=En(Ch,D5,null,"int32"),Hge={kernelName:Ch,backendName:"cpu",kernelFunc:Gge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O5(t,e,n,s,r,a,i,o,l){const c=Qe([s,a],n);for(let f=0;f<s;f++){const d=[];let p=0;for(let g=0;g<r;g++){const y=t[f*r+g];p+=y*i[g],d.push(y)}if(p<0||p>=l/a)throw new Error(`Invalid indices: ${d} does not index into ${o}`);for(let g=0;g<a;g++)c.values[f*a+g]=e.get(...e.indexToLoc(p*a+g))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _5(t,e,n){const s=Qe(n,t.dtype);for(let r=0;r<s.size;++r){const i=s.indexToLoc(r).slice(),o=i[0],l=i[2],c=e.locToIndex([o,l]);i[2]=e.values[c];const f=t.locToIndex(i);0<=f&&f<t.values.length&&(s.values[r]=t.values[f])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F5=hn((t,e)=>t>e?1:0),qge=En(lm,F5,null,"bool"),Xge={kernelName:lm,backendName:"cpu",kernelFunc:qge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L5=hn((t,e)=>t>=e?1:0),Kge=En(Nh,L5,null,"bool"),Yge={kernelName:Nh,backendName:"cpu",kernelFunc:Kge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M5=hn((t,e)=>t<e?1:0),Zge=En(cm,M5,null,"bool"),Qge={kernelName:cm,backendName:"cpu",kernelFunc:Zge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z5=hn((t,e)=>t<=e?1:0),Jge=En(hm,z5,null,"bool"),e0e={kernelName:hm,backendName:"cpu",kernelFunc:Jge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P5(t,e,n){const s=(e-t)/(n-1),r=qn(n,"float32");r[0]=t;for(let a=1;a<r.length;a++)r[a]=r[a-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B5=Ka(t=>Math.log(t)),t0e=sl(Ah,B5),n0e={kernelName:Ah,backendName:"cpu",kernelFunc:t0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V5(t,e,n,s){const r=On(s,de(n));for(let a=0;a<r.length;++a){const i=a*e;let o=t[i];for(let l=0;l<e;++l){const c=t[i+l];(Number.isNaN(c)||c>o)&&(o=c)}r[a]=o}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U5=hn((t,e)=>Math.max(t,e)),s0e=En(Dh,U5),r0e={kernelName:Dh,backendName:"cpu",kernelFunc:s0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j5=hn((t,e)=>Math.min(t,e)),a0e=En(Oh,j5),i0e={kernelName:Oh,backendName:"cpu",kernelFunc:a0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gI=hn((t,e)=>t*e),o0e=pI((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),Cv=En(Fh,gI,o0e),l0e={kernelName:Fh,backendName:"cpu",kernelFunc:Cv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W5(t,e,n){const s=Vi(-1,n);return gI([],e,s,t,n)}function u0e(t){const{inputs:e,backend:n}=t,{x:s}=e;_e(s,"neg");const r=n.data.get(s.dataId).values,[a,i]=W5(r,s.shape,s.dtype);return n.makeTensorInfo(i,s.dtype,a)}const c0e={kernelName:Sm,backendName:"cpu",kernelFunc:u0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G5=hn((t,e)=>t!==e?1:0),h0e=En(Tm,G5,null,"bool"),f0e={kernelName:Tm,backendName:"cpu",kernelFunc:h0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yI(t,e,n,s,r){const a=e.length,i=de(e),o=Be(e),l=Be(r),c=On(n,de(r));for(let f=0;f<i;++f){const d=Nu(f,a,o),p=new Array(d.length);for(let y=0;y<p.length;y++)p[y]=d[s[y]];const g=ia(p,a,l);c[g]=t[f]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fs(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:a}=n;_e(r,"transpose");const i=r.shape.length,o=new Array(i);for(let d=0;d<o.length;d++)o[d]=r.shape[a[d]];const l=s.data.get(r.dataId).values,c=yI(l,r.shape,r.dtype,a,o);return{dataId:s.write(c,o,r.dtype),shape:o,dtype:r.dtype}}const d0e={kernelName:Kl,backendName:"cpu",kernelFunc:Fs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H5(t,e,n,s){const[r,a]=Mn(t,s),i=As(e,"int32"),o=qn(de(r),i),l=de(a);for(let c=0;c<o.length;++c){const f=c*l;let d=1;for(let p=0;p<l;++p)d*=n[f+p];o[c]=d}return{outVals:o,outShape:r,outDtype:i}}function p0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s;_e(r,"prod");const o=r.shape.length,l=nt(a,r.shape),c=qt(l,o);let f=l,d=r;const p=[];c!=null&&(d=Fs({inputs:{x:r},backend:n,attrs:{perm:c}}),p.push(d),f=un(f.length,o));const g=n.data.get(d.dataId).values,{outVals:y,outShape:v,outDtype:x}=H5(d.shape,d.dtype,g,f);let w=v;return i&&(w=on(v,l)),p.forEach(T=>n.disposeIntermediateTensorInfo(T)),n.makeTensorInfo(w,x,y)}const m0e={kernelName:Im,backendName:"cpu",kernelFunc:p0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g0e(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const a=Nu(r,e.length,Be(e)).join(",");throw new Error(`indices[${a}] = ${s} is not in [0, ${n})`)}})}function y0e(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let a=1;a<s.length;++a)if(s[a-1]>s[a])throw new Error("Ragged splits must be sorted in ascending order")}}function b0e(t,e,n,s){const r=[];let a=0;const i=e.length-1+n.length,o=new Array(i).fill(null).map(()=>[0]);y0e(n,s);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const f=e[c+1];for(let d=1;d<l+1;++d)o[c].push(d*f)}for(let c=0;c<t.length;++c){let f=t[c],d=t[c]+1;for(let p=0;p<n.length;++p){const g=n[p],y=p+e.length-1;if(y>=0){const v=o[y],x=v[v.length-1]-g[f];for(let w=f;w<d;++w)o[y].push(g[w+1]+x)}f=g[f],d=g[d]}d!==f&&(r.push([f,d]),a+=d-f)}return{outSplits:o,valueSlices:r,numValues:a}}function x0e(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=Zt("int32",s);e.push(r),t[n].forEach((a,i)=>r[i]=a)}return e}function uF(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function v0e(t,e,n,s,r,a){const i=uF(e,2)[1],o=uF(a,2)[1];let l=0;for(const c of n)for(let f=c[0];f<c[1];++f){for(let d=0;d<s;++d)r[l*o+d]=t[f*i+d];++l}}function w0e(t,e,n,s,r){const a=e.slice();a[0]=r;const i=Zt(n,de(a)),o=t.length,l=o===0?0:o/e[0];return v0e(t,e,s,l,i,a),[i,a]}function q5(t,e,n,s,r,a,i,o){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(g0e(a,i,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:f,valueSlices:d,numValues:p}=b0e(a,i,t,c),g=x0e(f),y=w0e(n,s,r,d,p);return[g,y[0],y[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cF=2147483647;function X5(t,e,n,s,r,a,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const o=e.length===0,l=r.length===0,c=i.length===0,f=[];o||f.push(e[0]),l||f.push(r[0]),c||f.push(i[0]);for(let x=1;x<f.length;++x)if(f[x]!==f[x-1])throw new Error("starts, limits, and deltas must have the same shape");const d=f.length===0?1:f[0],p=Zt("int32",d+1);p[0]=0;for(let x=0;x<d;++x){const w=o?t[0]:t[x],T=l?s[0]:s[x],N=c?a[0]:a[x];if(N===0)throw new Error("Requires delta != 0");let C;if(N>0&&T<w||N<0&&T>w)C=0;else if(C=Math.ceil(Math.abs((T-w)/N)),C>cF)throw new Error(`Requires ((limit - start) / delta) <= ${cF}`);p[x+1]=p[x]+C}const g=p[d],y=Zt(n,g);let v=0;for(let x=0;x<d;++x){const w=p[x+1]-p[x];let T=o?t[0]:t[x];const N=c?a[0]:a[x];for(let C=0;C<w;++C)y[v++]=T,T+=N}return[p,y]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Lr=aa;class M1{constructor(e,n,s,r,a,i,o,l,c,f){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=a,this.defaultValue=i,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=dB(f),this.raggedRank=pB(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Lr.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Lr.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Lr.VALUE_ROWIDS:return M1.getMaxWidthValueRowID(n);case Lr.ROW_SPLITS:return M1.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Lr[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const a=e[r+1]-e[r];a>s&&(s=a)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],a=0;for(let i=1;i<n;++i){const o=e[i];o!==r&&(r=o,a=Math.max(i-s,a),s=i)}return Math.max(n-s,a)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return fF(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;mB(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=fB(this.raggedRank,r,n);i[0]<0&&(i[0]=e);for(let o=1;o<=this.raggedRank;++o)i[o]<0&&(i[o]=this.getMaxWidth(o));return i}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),a=[];let i=0;for(let o=0;o<r;++o,i+=n)a.push(i);for(let o=r;o<e;++o)a.push(-1);return M(a.length===e,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(e,n,s,r){const a=e.length,i=[];for(let o=0;o<a-1;++o){const l=e[o+1]-e[o];let c=Math.min(r,l),f=n[o];f===-1&&(c=0);for(let d=0;d<c;++d)i.push(f),f+=s;for(let d=0;d<l-c;++d)i.push(-1)}if(a>0&&i.length!==e[a-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,s,r){const a=e.length,i=[];if(a===0)return[];let o=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];i.push(c);for(let f=1;f<a;++f){const d=e[f];if(d===l)c>=0&&(++o,o<r?c+=s:c=-1);else{if(o=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);c=n[d]}i.push(c)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,s,r){const a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case Lr.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,n,s,r);case Lr.ROW_SPLITS:if(a.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(a,n,s,r);default:throw new Error(`Unsupported partition type: ${Lr[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Lr.FIRST_DIM_SIZE:return e[0];case Lr.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Lr.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Lr[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const a=fF(s,!1),i=Zt(this.valuesDType,de(a));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,i,a)}return[a,i]}setOutput(e,n,s,r){if(s.length===0)return;const a=this.values,i=s;let o=r.slice();o=o.slice(e+1);const l=de(o),c=n.length;let f=this.defaultValue;if(f.length!==l&&f.length!==1){const y=this.defaultValueShape;re(()=>{const v=J(f,y);f=Yl(v,o).dataSync()})}let d=0,p=0,g=0;for(let y=0;y<=c;++y){let v=y<c?n[y]:-1;if(v===g){++g;continue}if(p<g){const x=a.subarray(d*l),w=i.subarray(p*l),T=(g-p)*l;hF(w,x,T)}if(y>=c){const x=s.length;v=Math.floor(x/l)}if(v>g)if(this.defaultValue.length===1)i.subarray(g*l,v*l).fill(this.defaultValue[0]),g=v;else for(;v>g;){const x=i.slice(g*l);hF(x,f,l),++g}v<0?(d=y+1,p=g):(d=y,p=g,g=p+1)}}}function hF(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function fF(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function K5(t,e,n,s,r,a,i,o,l,c){return new M1(t,e,n,s,r,a,i,o,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y5(t,e,n,s){const r=t===e,a=t<e&&n<0,i=e<t&&n>1;if(r||a||i)return qn(0,s);const o=Math.abs(Math.ceil((e-t)/n)),l=qn(o,s);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z5=Ka(t=>1/Math.sqrt(t)),S0e=sl(Vh,Z5),T0e={kernelName:Vh,backendName:"cpu",kernelFunc:S0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gl(t,e,n,s,r,a,i,o,l,c){const f=[s/r,r],d=t.values,p=e.values;if(s===0)return Qe(n,e.dtype);const g=l instanceof yn?l:Qe(f,e.dtype);typeof l=="string"||typeof l=="number"?g.values.fill(l):typeof l=="boolean"&&g.values.fill(+l);for(let y=0;y<a;y++){const v=[];let x=0;for(let w=0;w<i;w++){const T=d[y*i+w];v.push(T),x+=T*o[w]}if(x<0||x>=s/r)throw new Error(`Invalid indices: ${v} does not index into ${n}`);for(let w=0;w<r;w++)c?g.values[x*r+w]+=p[y*r+w]:g.values[x*r+w]=e.rank===0?p[0]:p[y*r+w]}return g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C0e=Ka(t=>1/(1+Math.exp(-t))),Q5=Nt(Hh,t=>1/(1+Math.exp(-t))),N0e={kernelName:Hh,backendName:"cpu",kernelFunc:Q5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J5(t,e,n,s,r){const a=cE(s,e,n),i=de(n),o=Be(s);if(a){const d=hE(e,o);return r==="string"?t.slice(d,d+i):t.subarray(d,d+i)}const l=r==="string"?Li(t):t,c=Qe(s,r,l),f=Qe(n,r);for(let d=0;d<f.size;++d){const p=f.indexToLoc(d),g=p.map((y,v)=>y+e[v]);f.set(c.get(...g),...p)}return r==="string"?FB(f.values):f.values}function gu(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:a,size:i}=s;_e(r,"slice");const[o,l]=Jx(r,a,i);lE(r,o,l);const c=n.data.get(r.dataId).values,f=J5(c,o,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,f)}const k0e={kernelName:Fm,backendName:"cpu",kernelFunc:gu};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eU(t,e,n,s,r,a,i){const o=e[0],l=a[0],c=new Array(l),f=new Array(o),d=e[1];if(l===0){if(o!==0)throw new Error(SB(o));const x=Zt(n,0),w=Zt(r,0);return[x,[0,d],w,c,f]}let p=!0,g=0;const y=new Array(l).fill(0);for(let x=0;x<o;++x){const w=t[x*d];if(w<0)throw new Error(TB(x,w));if(w>=l)throw new Error(CB(x,w,l));++y[w],p=p&&w>=g,g=w}let v=!0;for(let x=0;x<l;++x){const w=y[x]===0;c[x]=w,v=v&&!w,y[x]=Math.max(y[x],1),x>0&&(y[x]+=y[x-1])}if(v&&p){const x=t,w=s;for(let T=0;T<o;++T)f[T]=T;return[x,[o,d],w,c,f]}else{const x=y[l-1],w=Zt(n,x*d),T=Zt(r,x),N=new Array(l).fill(0);for(let C=0;C<o;++C){const E=t[C*d],R=N[E],$=(E===0?0:y[E-1])+R;N[E]++;for(let O=0;O<d;++O)w[$*d+O]=t[C*d+O];T[$]=s[C],f[C]=$}for(let C=0;C<l;++C)if(N[C]===0){const R=C===0?0:y[C-1];w[R*d+0]=C;for(let $=1;$<d;++$)w[R*d+$]=0;T[R]=i}return[w,[x,d],T,c,f]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tU(t,e,n,s,r){const a=de(s),i=e[0],o=r.length,l=[];let c=1,f=-1;for(let x=0;x<o;++x){const w=r[x];if(w===-1){if(f!==-1)throw new Error(NB(f,x));f=x,l.push(1)}else{if(w<0)throw new Error(kB(x,w));c*=w,l.push(w)}}if(f!==-1){if(c<=0)throw new Error(EB());const x=Math.trunc(a/c);if(c*x!==a)throw new Error($B(s,l));l[f]=x}if(de(l)!==a)throw new Error(IB(s,l));const p=s.length,g=[];if(p>0){g[p-1]=1;for(let x=p-2;x>=0;--x)g[x]=g[x+1]*s[x+1]}const y=[];if(o>0){y[o-1]=1;for(let x=o-2;x>=0;--x)y[x]=y[x+1]*l[x+1]}const v=Zt(n,i*o);for(let x=0;x<i;++x){let w=0;for(let T=0;T<p;++T)w+=t[x*p+T]*g[T];for(let T=0;T<o;++T)v[x*o+T]=Math.trunc(w/y[T]),w%=y[T]}return[v,[i,o],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bI(t,e,n,s,r,a=!1,i=0){const o=s.length,l=[e[0],t.length/e[0]],c=l[1],d=o>0?r[o-1]+1:0;if(d<0)throw new Error(KT());const p=e.slice();p[0]=d;const g=p.reduce((N,C)=>N*C,1),y=Zt(n,g);if(o===0)return d>0&&y.fill(i),[y,p];if(d<=0)throw new Error(KT());let v=0,x=1,w=0,T=r[v];for(;;){let N=0;if(x<o){if(N=r[x],T===N){++x;continue}if(T>=N)throw new Error(AB())}if(T<0||T>=d)throw new Error(RB(T,d));T>w&&y.fill(i,w*c,T*c);for(let C=v;C<x;++C){const E=s[C];if(E<0||E>=l[0])throw new Error(DB(C,s[C],l[0]));for(let R=0;R<c;R++)y[T*c+R]+=t[E*c+R]}if(a)for(let C=0;C<c;C++)y[T*c+C]/=x-v;if(v=x,++x,w=T+1,T=N,x>o)break}return w<d&&y.fill(i,w*c,d*c),[y,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E0e=Ka(t=>Math.sqrt(t)),$0e=Nt(Xh,t=>Math.sqrt(t)),I0e={kernelName:Xh,backendName:"cpu",kernelFunc:$0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nU=hn((t,e)=>{const n=t-e;return n*n}),A0e=En(Kh,nU),R0e={kernelName:Kh,backendName:"cpu",kernelFunc:A0e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sU=Ka((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=e;return t.replace(new RegExp(n,s?"g":""),r)}),D0e=sl(Bm,sU),O0e={kernelName:Bm,backendName:"cpu",kernelFunc:D0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rU(t,e,n,s){const r=Qe(t,e.dtype);for(let a=0;a<r.size;a++){const i=r.indexToLoc(a),o=new Array(i.length);for(let l=0;l<o.length;l++)o[l]=i[l]*n[l]+s[l];r.set(e.get(...o),...i)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _0e{constructor(e,n,s,r,a,i){this.separator=La(e),this.nGramWidths=n,this.leftPad=La(s),this.rightPad=La(r),this.padWidth=a,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,a,i){for(let o=0;o<a;++o){const l=this.getPadWidth(i),c=Math.max(0,l-o),f=Math.max(0,l-(a-(o+1))),d=i-(c+f),p=n+(c>0?0:o-l);let g=0;g+=c*this.leftPad.length;for(let T=0;T<d;++T)g+=e[p+T].length;g+=f*this.rightPad.length;const y=c+f+d-1;g+=y*this.separator.length,s[r+o]=new Uint8Array(g);const v=s[r+o];let x=0;const w=T=>T.forEach(N=>v[x++]=N);for(let T=0;T<c;++T)w(this.leftPad),w(this.separator);for(let T=0;T<d-1;++T)w(e[p+T]),w(this.separator);if(d>0){w(e[p+d-1]);for(let T=0;T<f;++T)w(this.separator),w(this.rightPad)}else{for(let T=0;T<f-1;++T)w(this.rightPad),w(this.separator);w(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let f=n[c]>=l;if(f=f&&n[c]<=s,!f)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const a=r-1,i=Zt("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=a;++c)i[c]=0;return[l,i]}i[0]=0;for(let l=1;l<=a;++l){const c=n[l]-n[l-1];let f=0;this.nGramWidths.forEach(d=>{f+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&f===0&&(f=1),i[l]=i[l-1]+f}const o=new Array(i[a]);for(let l=0;l<a;++l){const c=n[l];let f=i[l];if(this.nGramWidths.forEach(d=>{const p=n[l+1]-n[l],g=this.getNumNGrams(p,d);this.createNGrams(e,c,o,f,g,d),f+=g}),this.preserveShort&&f===i[l]){const d=n[l+1]-n[l];if(d===0)continue;const p=d+2*this.padWidth;this.createNGrams(e,c,o,f,1,p)}}return[o,i]}}function aU(t,e,n,s,r,a,i,o){return new _0e(n,s,r,a,i,o).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F0e(t,e,n,s){if(!t.length)return;if(e.length===0){for(let a=0;a<t.length;++a)s.push(t.subarray(a,a+1));return}if(e.length===1){const a=e[0];let i=t.indexOf(a);for(;i!==-1;){const o=t.subarray(0,i);(!n||o.length!==0)&&s.push(o),t=t.subarray(i+1),i=t.indexOf(a)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let a=0;a<t.length+1;a++)if(a===t.length||e.indexOf(t[a])!==-1){const i=t.subarray(r,a);(!n||i.length!==0)&&s.push(i),r=a+1}}function iU(t,e,n){const s=t.length,r=[];let a=0,i=0;const o=new Array(s);for(let p=0;p<s;++p){const g=r.length;F0e(t[p],e,n,r);const y=r.length-g;o[p]=y,a+=y,i=Math.max(i,y)}const l=Zt("int32",a*2),c=new Array(a),f=[s,i];let d=0;for(let p=0;p<s;++p)for(let g=0;g<o[p];++g)l[d*2]=p,l[d*2+1]=g,c[d]=r[d],++d;return[l,c,f]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oU(t,e){const n=Zt("int32",t.length);for(let s=0;s<t.length;++s)n[s]=bP(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lU=hn((t,e)=>t-e),L0e=pI((t,e,n,s)=>({real:t-n,imag:e-s})),xI=En(Yh,lU,L0e),M0e={kernelName:Yh,backendName:"cpu",kernelFunc:xI};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=Qe(n,t.dtype);for(let r=0;r<s.values.length;++r){const a=s.indexToLoc(r),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=a[l]%t.shape[l];const o=t.locToIndex(i);s.values[r]=t.values[o]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bd=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function cU(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const o=s-n+1,l=e-n+1,c=Math.log(o),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(o-f)/o)*Math.sign(l-o/2),p=Math.max(n,Math.floor(e-l*f/o+d)),g=Math.min(s,Math.floor(e+(o-l)*f/o+d));cU(t,e,p,g)}const r=t[e];let a=n,i=s;for(xi(t,n,e),Bd(t[s],r)>0&&xi(t,n,s);a<i;){for(xi(t,a,i),a++,i--;Bd(t[a],r)<0;)a=a+1;for(;Bd(t[i],r)>0;)i=i-1}Bd(t[n],r)===0?xi(t,n,i):(i=i+1,xi(t,i,s)),i<=e&&(n=i+1),e<=i&&(s=i-1)}}function hU(t,e,n,s,r){const a=e[e.length-1],[i,o]=[t.length/a,a],l=On(n,i*s),c=On("int32",i*s);for(let d=0;d<i;d++){const p=d*o,g=t.subarray(p,p+o);let y=new Array(g.length);g.forEach((T,N)=>y[N]={value:T,index:N}),s<y.length&&(cU(y,s),y=y.slice(0,s)),r&&y.sort(Bd);const v=d*s,x=l.subarray(v,v+s),w=c.subarray(v,v+s);for(let T=0;T<s;T++)x[T]=y[T].value,w[T]=y[T].index}const f=e.slice();return f[f.length-1]=s,[Qe(f,n,l),Qe(f,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fU(t,e,n,s){const r=nt(e,n)[0],a=[1,n[0],1];for(let y=0;y<r;y++)a[0]*=n[y];a[1]=n[r];for(let y=r+1;y<n.length;y++)a[2]*=n[y];const i=new Map,o=new Int32Array(n[r]),l=new yn(a,s,t),c=[],f=a[0]===1&&a[2]===1;for(let y=0;y<n[r];y++){let v;if(f)v=t[y].toString();else{const w=[];for(let T=0;T<a[0];T++)for(let N=0;N<a[2];N++)w.push(l.get(T,y,N));v=w.join(",")}const x=i.get(v);if(x!=null)o[y]=x;else{const w=i.size;i.set(v,w),o[y]=w,c.push(y)}}const d=a.slice();d[1]=i.size;const p=new yn(d,s);c.forEach((y,v)=>{for(let x=0;x<a[0];x++)for(let w=0;w<a[2];w++)p.set(l.get(x,y,w),x,v,w)});const g=n.slice();return g[r]=d[1],{outputValues:p.values,outputShape:g,indices:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dU=Object.freeze(Object.defineProperty({__proto__:null,addImpl:w5,bincountImpl:mI,bincountReduceImpl:S5,bitwiseAndImpl:T5,castImpl:v5,ceilImpl:C5,concatImpl:N5,equalImpl:k5,expImpl:$5,expm1Impl:A5,floorDivImpl:D5,floorImpl:R5,gatherNdImpl:O5,gatherV2Impl:_5,greaterEqualImpl:L5,greaterImpl:F5,lessEqualImpl:z5,lessImpl:M5,linSpaceImpl:P5,logImpl:B5,maxImpl:V5,maximumImpl:U5,minimumImpl:j5,multiplyImpl:gI,negImpl:W5,notEqualImpl:G5,prodImpl:H5,raggedGatherImpl:q5,raggedRangeImpl:X5,raggedTensorToTensorImpl:K5,rangeImpl:Y5,rsqrtImpl:Z5,scatterImpl:Gl,sigmoidImpl:C0e,simpleAbsImpl:x5,sliceImpl:J5,sparseFillEmptyRowsImpl:eU,sparseReshapeImpl:tU,sparseSegmentReductionImpl:bI,sqrtImpl:E0e,squaredDifferenceImpl:nU,staticRegexReplaceImpl:sU,stridedSliceImpl:rU,stringNGramsImpl:aU,stringSplitImpl:iU,stringToHashBucketFastImpl:oU,subImpl:lU,tileImpl:uU,topKImpl:hU,transposeImpl:yI,uniqueImpl:fU},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const pU="4.22.0";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */VN("cpu",()=>new Sg,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mU=Nt(xh,t=>t>=0?t:Math.exp(t)-1),z0e={kernelName:xh,backendName:"cpu",kernelFunc:mU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gU(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:a}=s;_e([r],"leakyRelu");const i=de(r.shape),o=n.data.get(r.dataId).values,l=On("float32",i);for(let c=0;c<o.length;c++)l[c]=o[c]<0?a*o[c]:o[c];return n.makeTensorInfo(r.shape,"float32",l)}const P0e={kernelName:um,backendName:"cpu",kernelFunc:gU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B0e=hn((t,e)=>t<0?e*t:t);function yU(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;_e([s,r],"prelu");const a=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,[o,l]=B0e(s.shape,r.shape,a,i,"float32");return n.makeTensorInfo(l,"float32",o)}const V0e={kernelName:$m,backendName:"cpu",kernelFunc:yU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bU=Nt(zh,t=>Math.max(0,t)),U0e={kernelName:zh,backendName:"cpu",kernelFunc:bU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xU=Nt(Ph,t=>Math.min(Math.max(0,t),6)),j0e={kernelName:Ph,backendName:"cpu",kernelFunc:xU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z1(t,e,n,s,r){if(n==="linear")return Ha({inputs:{x:e},backend:t});if(n==="relu")return bU({inputs:{x:e},backend:t});if(n==="elu")return mU({inputs:{x:e},backend:t});if(n==="relu6")return xU({inputs:{x:e},backend:t});if(n==="prelu")return yU({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return gU({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return Q5({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lt(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:a}=s,i=de(r.shape),o=DN(a,i),l=de(o);M(i===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${r.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const f=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;f.shape=o,d.shape=o}return{dataId:r.dataId,shape:o,dtype:r.dtype}}const W0e={kernelName:Am,backendName:"cpu",kernelFunc:Lt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vU(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:a}=e,{transposeA:i,transposeB:o}=s;_e([r,a],"matMul");const l=r.shape.length,c=a.shape.length,f=i?r.shape[l-2]:r.shape[l-1],d=o?a.shape[c-1]:a.shape[c-2],p=i?r.shape[l-1]:r.shape[l-2],g=o?a.shape[c-2]:a.shape[c-1],y=r.shape.slice(0,-2),v=a.shape.slice(0,-2),x=de(y),w=de(v),N=Ke(r.shape.slice(0,-2),a.shape.slice(0,-2)).concat([p,g]);M(f===d,()=>`Error in matMul: inner shapes (${f}) and (${d}) of Tensors with shapes ${r.shape} and ${a.shape} and transposeA=${i} and transposeB=${o} must match.`);const C=i?[x,f,p]:[x,p,f],E=o?[w,g,d]:[w,d,g],R=Lt({inputs:{x:r},backend:n,attrs:{shape:C}}),$=Lt({inputs:{x:a},backend:n,attrs:{shape:E}}),O=i?R.shape[1]:R.shape[2],A=i?R.shape[2]:R.shape[1],_=o?$.shape[1]:$.shape[2],D=Math.max(x,w),B=n.data.get(R.dataId).values,j=n.data.get($.dataId).values,W=Be(R.shape),X=Be($.shape),[U,Y,Q]=i?[W[0],1,W[1]]:[W[0],W[1],1],[ie,V,ee]=o?[1,X[1],X[0]]:[X[1],1,X[0]],ce=A*_,ue=Qe([D,A,_],R.dtype),he=ue.values,be=n.blockSize;for(let we=0;we<D;we++){const Ie=we%x,ke=we%w;for(let Ae=0;Ae<A;Ae+=be){const De=Math.min(Ae+be,A);for(let We=0;We<_;We+=be){const ft=Math.min(We+be,_);for(let dt=0;dt<O;dt+=be){const $t=Math.min(dt+be,O);for(let vt=Ae;vt<De;vt++)for(let pt=We;pt<ft;pt++){let It=0;for(let Tt=dt;Tt<$t;Tt++){const Zs=B[Ie*U+vt*Y+Tt*Q],Jt=j[Tt*ie+pt*V+ke*ee];It+=Zs*Jt}he[we*ce+(vt*_+pt)]+=It}}}}}return n.disposeIntermediateTensorInfo(R),n.disposeIntermediateTensorInfo($),n.makeTensorInfo(N,ue.dtype,ue.values)}const G0e={kernelName:qp,backendName:"cpu",kernelFunc:vU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H0e(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:a,bias:i,preluActivationWeights:o}=e,{transposeA:l,transposeB:c,activation:f,leakyreluAlpha:d}=s;let p,g,y;const v=[];p=vU({inputs:{a:r,b:a},attrs:{transposeA:l,transposeB:c},backend:n}),i&&(g=Qc({inputs:{a:p,b:i},backend:n}),v.push(p),p=g),f&&(y=z1(n,p,f,o,d),v.push(p),p=y);for(const w of v)n.disposeIntermediateTensorInfo(w);return p}const q0e={kernelName:hp,backendName:"cpu",kernelFunc:H0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X0e=Nt(ih,t=>Math.acos(t)),K0e={kernelName:ih,backendName:"cpu",kernelFunc:X0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y0e=Nt(oh,t=>Math.acosh(t)),Z0e={kernelName:oh,backendName:"cpu",kernelFunc:Y0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q0e(t){const{inputs:e,backend:n}=t,s=e;_e(e,"addN");const r=s.map(o=>n.data.get(o.dataId).values),a=Qe(s[0].shape,s[0].dtype),i=a.values;for(let o=0;o<s.length;o++){const l=r[o];for(let c=0;c<i.length;c++)i[c]+=l[c]}return n.makeTensorInfo(a.shape,a.dtype,a.values)}const J0e={kernelName:Up,backendName:"cpu",kernelFunc:Q0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s;_e(r,"all");const o=nt(a,r.shape);let l=o;const c=qt(l,r.shape.length);let f=r;c!=null&&(f=Fs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=un(l.length,r.shape.length)),Yn("all",l,f.shape.length);const[d,p]=Mn(f.shape,l),g=de(p),y=qn(de(d),f.dtype),v=n.data.get(f.dataId).values;for(let w=0;w<y.length;++w){const T=w*g;let N=v[T];for(let C=0;C<g;++C){const E=v[T+C];N=N&&E}y[w]=N}c!=null&&n.disposeIntermediateTensorInfo(f);const x=n.makeTensorInfo(d,f.dtype,y);if(i){const w=on(d,o),T=Lt({inputs:{x},backend:n,attrs:{shape:w}});return n.disposeIntermediateTensorInfo(x),T}return x}const tye={kernelName:ob,backendName:"cpu",kernelFunc:eye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s;_e(r,"any");const o=nt(a,r.shape);let l=o;const c=qt(l,r.shape.length);let f=r;c!=null&&(f=Fs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=un(l.length,r.shape.length)),Yn("any",l,f.shape.length);const[d,p]=Mn(f.shape,l),g=de(p),y=qn(de(d),f.dtype),v=n.data.get(f.dataId).values;for(let w=0;w<y.length;++w){const T=w*g;let N=v[T];for(let C=0;C<g;++C){const E=v[T+C];N=N||E}y[w]=N}c!=null&&n.disposeIntermediateTensorInfo(f);const x=n.makeTensorInfo(d,f.dtype,y);if(i){const w=on(d,o),T=Lt({inputs:{x},backend:n,attrs:{shape:w}});return n.disposeIntermediateTensorInfo(x),T}return x}const sye={kernelName:lb,backendName:"cpu",kernelFunc:nye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a}=s;_e(r,"argMax");let i=nt(a,r.shape);const o=qt(i,r.shape.length);let l=r;const c=[];o!=null&&(l=Fs({inputs:{x:r},backend:n,attrs:{perm:o}}),c.push(l),i=un(i.length,l.shape.length)),i=[i[0]],Yn("argMax",i,l.shape.length);const[f,d]=Mn(l.shape,i),p=de(f),g=qn(p,"int32"),y=de(d),v=n.data.get(l.dataId).values;for(let x=0;x<g.length;++x){const w=x*y;let T=v[w],N=0;for(let C=0;C<y;++C){const E=v[w+C];E>T&&(T=E,N=C)}g[x]=N}return c.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(f,"int32",g)}const aye={kernelName:jp,backendName:"cpu",kernelFunc:rye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a}=s;_e(r,"argMin");let i=nt(a,r.shape);const o=qt(i,r.shape.length);let l=r;const c=[];o!=null&&(l=Fs({inputs:{x:r},backend:n,attrs:{perm:o}}),c.push(l),i=un(i.length,l.shape.length)),i=[i[0]],Yn("argMin",i,l.shape.length);const[f,d]=Mn(l.shape,i),p=de(f),g=qn(p,"int32"),y=de(d),v=n.data.get(l.dataId).values;for(let x=0;x<g.length;++x){const w=x*y;let T=v[w],N=0;for(let C=0;C<y;++C){const E=v[w+C];E<T&&(T=E,N=C)}g[x]=N}return c.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(f,"int32",g)}const oye={kernelName:Wp,backendName:"cpu",kernelFunc:iye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lye=Nt(lh,t=>Math.asin(t)),uye={kernelName:lh,backendName:"cpu",kernelFunc:lye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cye=Nt(uh,t=>Math.asinh(t)),hye={kernelName:uh,backendName:"cpu",kernelFunc:cye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fye=Nt(ch,t=>Math.atan(t)),dye={kernelName:ch,backendName:"cpu",kernelFunc:fye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pye=hn((t,e)=>Math.atan2(t,e)),mye=En(fh,pye),gye={kernelName:fh,backendName:"cpu",kernelFunc:mye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yye=Nt(hh,t=>Math.atanh(t)),bye={kernelName:hh,backendName:"cpu",kernelFunc:yye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vI(t,e,n,s,r,a){const i=r.strideHeight,o=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=r.padInfo.top,g=r.padInfo.left,y=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=Qe(r.outShape,n),x=v.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3],T=r.outShape[2]*r.outShape[3],N=r.outShape[3];for(let C=0;C<r.batchSize;++C){const E=C*w,R=C*s[0];for(let $=0;$<r.inChannels;++$)for(let O=0;O<r.outHeight;++O){const A=O*i-p,_=Math.max(0,A),D=Math.min(r.inHeight,f+A),B=E+O*T;for(let j=0;j<r.outWidth;++j){const W=j*o-g,X=Math.max(0,W),U=Math.min(r.inWidth,d+W);let Y=y,Q=0,ie=0;for(let ee=_;ee<D;ee+=l){const ce=R+ee*s[1];for(let ue=X;ue<U;ue+=c){const he=ce+ue*s[2],be=t[he+$];a==="max"&&be>Y?Y=be:a==="avg"&&(Q+=be,ie++)}if(isNaN(Y))break}const V=B+j*N+$;x[V]=a==="avg"?Q/ie:Y}}}return v}function wU(t,e,n,s,r=!1,a=!1){const i=Qe(s.outShape,"int32"),o=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,f=s.dilationWidth,d=s.effectiveFilterHeight,p=s.effectiveFilterWidth,g=s.padInfo.top,y=s.padInfo.left,v=Qe(e,n,t);for(let x=0;x<s.batchSize;++x)for(let w=0;w<s.inChannels;++w)for(let T=0;T<s.outHeight;++T){const N=T*o-g;let C=N;for(;C<0;)C+=c;const E=Math.min(s.inHeight,d+N);for(let R=0;R<s.outWidth;++R){const $=R*l-y;let O=$;for(;O<0;)O+=f;const A=Math.min(s.inWidth,p+$);let _=Number.NEGATIVE_INFINITY,D=-1;for(let B=C;B<E;B+=c){const j=B-N;for(let W=O;W<A;W+=f){const X=W-$,U=v.get(x,B,W,w);U>_&&(_=U,r?D=a?((x*s.inHeight+B)*s.inWidth+W)*s.inChannels+w:(B*s.inWidth+W)*s.inChannels+w:D=j*p+X)}}i.set(D,x,T,R,w)}}return i}function SU(t,e,n,s,r,a){const i=r.strideDepth,o=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,f=r.dilationHeight,d=r.dilationWidth,p=r.effectiveFilterDepth,g=r.effectiveFilterHeight,y=r.effectiveFilterWidth,v=r.padInfo.front,x=r.padInfo.top,w=r.padInfo.left,T=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,N=Qe(r.outShape,n),C=N.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],R=r.outShape[2]*r.outShape[3]*r.outShape[4],$=r.outShape[3]*r.outShape[4],O=r.outShape[4];for(let A=0;A<r.batchSize;++A){const _=A*E,D=A*s[0];for(let B=0;B<r.inChannels;++B)for(let j=0;j<r.outDepth;++j){const W=j*i-v;let X=W;for(;X<0;)X+=c;const U=Math.min(r.inDepth,p+W),Y=_+j*R;for(let Q=0;Q<r.outHeight;++Q){const ie=Q*o-x;let V=ie;for(;V<0;)V+=f;const ee=Math.min(r.inHeight,g+ie),ce=Y+Q*$;for(let ue=0;ue<r.outWidth;++ue){const he=ue*l-w;let be=he;for(;be<0;)be+=d;const we=Math.min(r.inWidth,y+he),Ie=ce+ue*O;let ke=T,Ae=0,De=0;for(let ft=X;ft<U;ft+=c){const dt=D+ft*s[1];for(let $t=V;$t<ee;$t+=f){const vt=dt+$t*s[2];for(let pt=be;pt<we;pt+=d){const It=vt+pt*s[3],Tt=t[It+B];if(a==="max"&&Tt>ke?ke=Tt:a==="avg"&&(Ae+=Tt,De++),isNaN(ke))break}if(isNaN(ke))break}if(isNaN(ke))break}const We=Ie+B;C[We]=a==="avg"?Ae/Math.max(De,1):ke}}}}return N}function xye(t,e){const n=Qe(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,a=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;for(let v=0;v<e.batchSize;++v)for(let x=0;x<e.inChannels;++x)for(let w=0;w<e.outDepth;++w){const T=w*s-p;let N=T;for(;N<0;)N+=i;const C=Math.min(e.inDepth,c+T);for(let E=0;E<e.outHeight;++E){const R=E*r-g;let $=R;for(;$<0;)$+=o;const O=Math.min(e.inHeight,f+R);for(let A=0;A<e.outWidth;++A){const _=A*a-y;let D=_;for(;D<0;)D+=l;const B=Math.min(e.inWidth,d+_);let j=Number.NEGATIVE_INFINITY,W=-1;for(let X=N;X<C;X+=i){const U=X-T;for(let Y=$;Y<O;Y+=o){const Q=Y-R;for(let ie=D;ie<B;ie+=l){const V=ie-_,ee=t.get(v,X,Y,ie,x);ee>=j&&(j=ee,W=U*f*d+Q*f+V)}}}n.set(W,v,w,E,A,x)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;_e(r,"avgPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=s,c=1;M(Kn(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const f=Ur(r.shape,a,i,c,o,l);let d;if(f.filterWidth===1&&f.filterHeight===1&&at(f.inShape,f.outShape))d=Ha({inputs:{x:r},backend:n});else{const p=n.data.get(r.dataId).values,g=Be(r.shape),y=vI(p,r.shape,r.dtype,g,f,"avg");d=n.makeTensorInfo(f.outShape,r.dtype,y.values)}return d}const wye={kernelName:Gp,backendName:"cpu",kernelFunc:vye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:a,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=s;_e(r,"avgPool3d");const f=Ui(r.shape,a,i,1,o,l,c),d=n.data.get(r.dataId).values,p=SU(d,r.shape,r.dtype,Be(r.shape),f,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}const Tye={kernelName:Hp,backendName:"cpu",kernelFunc:Sye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cye(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=s;_e([r,a],"avgPool3DGrad");const f=Ui(a.shape,i,o,1,l,c),d=f.strideDepth,p=f.strideHeight,g=f.strideWidth,y=f.filterDepth,v=f.filterHeight,x=f.filterWidth,w=f.dilationDepth,T=f.dilationHeight,N=f.dilationWidth,C=f.effectiveFilterDepth,E=f.effectiveFilterHeight,R=f.effectiveFilterWidth,$=C-1-f.padInfo.front,O=R-1-f.padInfo.left,A=E-1-f.padInfo.top,_=Qe(a.shape,"float32"),D=1/(y*v*x),B=n.bufferSync(r);for(let j=0;j<f.batchSize;++j)for(let W=0;W<f.inChannels;++W)for(let X=0;X<f.inDepth;++X)for(let U=0;U<f.inHeight;++U)for(let Y=0;Y<f.inWidth;++Y){const Q=X-$,ie=U-A,V=Y-O;let ee=0;for(let ce=0;ce<C;ce+=w){const ue=(Q+ce)/d;if(!(ue<0||ue>=f.outDepth||Math.floor(ue)!==ue))for(let he=0;he<E;he+=T){const be=(ie+he)/p;if(!(be<0||be>=f.outHeight||Math.floor(be)!==be))for(let we=0;we<R;we+=N){const Ie=(V+we)/g;if(Ie<0||Ie>=f.outWidth||Math.floor(Ie)!==Ie)continue;const ke=B.get(j,ue,be,Ie,W);ee+=ke}}}_.set(ee*D,j,X,U,Y,W)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const Nye={kernelName:cb,backendName:"cpu",kernelFunc:Cye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kye(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,i=a;_e([r,a],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=s,f=Ur(i.shape,o,l,1,c),d=f.strideHeight,p=f.strideWidth,g=f.filterHeight,y=f.filterWidth,v=f.dilationHeight,x=f.dilationWidth,w=f.effectiveFilterHeight,T=f.effectiveFilterWidth,N=T-1-f.padInfo.left,C=w-1-f.padInfo.top,E=Qe(i.shape,"float32"),R=1/(g*y),$=n.data.get(r.dataId).values,O=Qe(r.shape,"float32",$);for(let A=0;A<f.batchSize;++A)for(let _=0;_<f.inChannels;++_)for(let D=0;D<f.inHeight;++D)for(let B=0;B<f.inWidth;++B){const j=D-C,W=B-N;let X=0;for(let U=0;U<w;U+=v){const Y=(j+U)/d;if(!(Y<0||Y>=f.outHeight||Math.floor(Y)!==Y))for(let Q=0;Q<T;Q+=x){const ie=(W+Q)/p;if(ie<0||ie>=f.outWidth||Math.floor(ie)!==ie)continue;const V=O.get(A,Y,ie,_);X+=V}}E.set(X*R,A,D,B,_)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const Eye={kernelName:ub,backendName:"cpu",kernelFunc:kye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:a,offset:i,mean:o,variance:l}=e;M(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),M(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),M(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),_e([r,o,l,a,i],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const f=n.data.get(r.dataId).values,d=n.data.get(o.dataId).values,p=n.data.get(l.dataId).values,g=a?n.data.get(a.dataId).values:new Float32Array([1]),y=i?n.data.get(i.dataId).values:new Float32Array([0]),v=new Float32Array(f.length),x=y.length,w=g.length,T=p.length,N=d.length;let C=0,E=0,R=0,$=0;for(let O=0;O<f.length;++O)v[O]=y[C++]+(f[O]-d[E++])*g[R++]/Math.sqrt(p[$++]+c),C>=x&&(C=0),E>=N&&(E=0),R>=w&&(R=0),$>=T&&($=0);return n.makeTensorInfo(r.shape,r.dtype,v)}const Iye={kernelName:im,backendName:"cpu",kernelFunc:$ye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:a,crops:i}=s;_e([r],"batchToSpaceND");const o=a.reduce((w,T)=>w*T),l=cg(r.shape,a,o),c=hg(l.length,a.length),f=fg(r.shape,a,o),d=yE(i,a.length),p=bE(f,i,a.length),g=Lt({inputs:{x:r},backend:n,attrs:{shape:l}}),y=Fs({inputs:{x:g},backend:n,attrs:{perm:c}}),v=Lt({inputs:{x:y},backend:n,attrs:{shape:f}}),x=gu({inputs:{x:v},backend:n,attrs:{begin:d,size:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),x}const Rye={kernelName:Xp,backendName:"cpu",kernelFunc:Aye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:a}=e,{size:i}=s,o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,c=mI(o,l,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,c)}const Oye={kernelName:hb,backendName:"cpu",kernelFunc:Dye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ye(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,a=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,o=Ke(Array.from(a),Array.from(i));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const Fye={kernelName:fb,backendName:"cpu",kernelFunc:_ye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lye=Nt(mh,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),Mye={kernelName:mh,backendName:"cpu",kernelFunc:Lye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zye=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(de(e.shape)),r=n.data.get(e.dataId),a=r.complexTensorInfos.real,i=r.complexTensorInfos.imag,o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values;for(let c=0;c<o.length;c++){const f=o[c],d=l[c];s[c]=Math.hypot(f,d)}return n.makeOutput(s,e.shape,"float32")},Pye={kernelName:Yp,backendName:"cpu",kernelFunc:zye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jc(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,a=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,a)}const Bye={kernelName:Db,backendName:"cpu",kernelFunc:Jc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eh(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,a=nt(r,e[0].shape)[0],i=e.map(v=>v.shape);pE(i,a);let o=za(e.map(v=>v.shape),a);if(de(o)===0)return n.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(v=>de(v.shape)>0);if(l.length===1)return Ha({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const v=l.map(C=>mu({inputs:{input:C},backend:n})),x=l.map(C=>Jc({inputs:{input:C},backend:n})),w=eh({inputs:v,backend:n,attrs:{axis:a}}),T=eh({inputs:x,backend:n,attrs:{axis:a}}),N=js({inputs:{real:w,imag:T},backend:n});return v.forEach(C=>n.disposeIntermediateTensorInfo(C)),x.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(T),N}const c=l.map(v=>{const w=[-1,de(v.shape.slice(a))];return Lt({inputs:{x:v},backend:n,attrs:{shape:w}})}),f=c.map(v=>({vals:n.data.get(v.dataId).values,shape:v.shape}));o=za(c.map(v=>v.shape),1);const d=c[0].shape[0]===1,p=N5(f,o,e[0].dtype,d),g=za(l.map(v=>v.shape),a),y=n.makeTensorInfo(g,e[0].dtype,p);return c.forEach(v=>n.disposeIntermediateTensorInfo(v)),y}const Vye={kernelName:Zp,backendName:"cpu",kernelFunc:eh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TU(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:i,pad:o,dataFormat:l,dilations:c,dimRoundingMode:f}=s;_e([r,a],"conv2d");const d=ji(l),p=Ln(r.shape,a.shape,i,c,o,f,!1,d),g=p.filterHeight,y=p.filterWidth,v=p.dilationHeight,x=p.dilationWidth,w=p.padInfo.left,T=p.padInfo.top,N=p.dataFormat==="channelsLast",C=new yn(p.outShape,r.dtype),E=Be(r.shape),R=Be(a.shape),$=E[0],O=N?E[1]:E[2],A=N?E[2]:1,_=N?1:E[1],D=C.strides[0],B=N?C.strides[1]:C.strides[2],j=N?C.strides[2]:1,W=N?1:C.strides[1],X=n.data.get(r.dataId).values,U=n.data.get(a.dataId).values,Y=C.values;for(let Q=0;Q<p.batchSize;++Q){const ie=Q*$,V=Q*D;for(let ee=0;ee<p.outHeight;++ee){const ce=V+ee*B,ue=ee*p.strideHeight-T;for(let he=0;he<g;++he){const be=ue+he*v;if(be<0||be>=p.inHeight)continue;const we=he*R[0],Ie=ie+be*O;for(let ke=0;ke<p.outWidth;++ke){const Ae=ce+ke*j,De=ke*p.strideWidth-w;for(let We=0;We<y;++We){const ft=De+We*x;if(ft<0||ft>=p.inWidth)continue;const dt=we+We*R[1],$t=Ie+ft*A;let vt=dt;for(let pt=0;pt<p.inChannels;++pt){const It=X[$t+pt*_];for(let Tt=0;Tt<p.outChannels;++Tt)Y[Ae+Tt*W]+=It*U[vt+Tt];vt+=p.outChannels}}}}}}return n.makeTensorInfo(C.shape,C.dtype,Y)}const Uye={kernelName:Qp,backendName:"cpu",kernelFunc:TU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:i,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:f}=s;_e([r,a],"conv2dBackpropFilter");const d=ji(l),p=Ln(r.shape,f,i,1,o,c,!1,d),{strideHeight:g,strideWidth:y,filterHeight:v,filterWidth:x}=p,w=p.dataFormat==="channelsLast",T=new yn(p.filterShape,"float32"),N=p.padInfo.left,C=p.padInfo.top,E=n.data.get(r.dataId).values,R=n.data.get(a.dataId).values,$=new yn(r.shape,r.dtype,E),O=new yn(a.shape,a.dtype,R);for(let A=0;A<v;++A){const _=Math.max(0,Math.ceil((C-A)/g)),D=Math.min(p.outHeight,(p.inHeight+C-A)/g);for(let B=0;B<x;++B){const j=Math.max(0,Math.ceil((N-B)/y)),W=Math.min(p.outWidth,(p.inWidth+N-B)/y);for(let X=0;X<p.inChannels;++X)for(let U=0;U<p.outChannels;++U){let Y=0;for(let Q=0;Q<p.batchSize;++Q)for(let ie=_;ie<D;++ie){const V=A+ie*g-C;for(let ee=j;ee<W;++ee){const ce=B+ee*y-N;w?Y+=$.get(Q,V,ce,X)*O.get(Q,ie,ee,U):Y+=$.get(Q,X,V,ce)*O.get(Q,U,ie,ee)}}T.set(Y,A,B,X,U)}}}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const Wye={kernelName:pb,backendName:"cpu",kernelFunc:jye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gye(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{inputShape:i,strides:o,pad:l,dataFormat:c,dimRoundingMode:f}=s;_e([r,a],"conv2dBackpropInput");const d=Be(a.shape),p=Be(r.shape);let g=ji(c);const y=Ln(i,a.shape,o,1,l,f,!1,g),v=new yn(y.inShape,"float32"),x=v.values,w=n.data.get(r.dataId).values,T=n.data.get(a.dataId).values,[N,C,E]=d,{batchSize:R,filterHeight:$,filterWidth:O,inChannels:A,inHeight:_,inWidth:D,outChannels:B,outHeight:j,outWidth:W,strideHeight:X,strideWidth:U}=y;g=y.dataFormat;const Y=$-1-y.padInfo.top,Q=O-1-y.padInfo.left,ie=g==="channelsLast",V=v.strides[0],ee=ie?v.strides[1]:v.strides[2],ce=ie?v.strides[2]:1,ue=ie?1:v.strides[1],he=p[0],be=ie?p[1]:p[2],we=ie?p[2]:1,Ie=ie?1:p[1];for(let ke=0;ke<R;++ke)for(let Ae=0;Ae<A;++Ae)for(let De=0;De<_;++De){const We=De-Y,ft=Math.max(0,Math.ceil(We/X)),dt=Math.min(j,($+We)/X);for(let $t=0;$t<D;++$t){const vt=$t-Q,pt=Math.max(0,Math.ceil(vt/U)),It=Math.min(W,(O+vt)/U);let Tt=0;for(let Jt=ft;Jt<dt;++Jt){const wr=Jt*X-We;for(let Ss=pt;Ss<It;++Ss){const Ya=Ss*U-vt,en=he*ke+be*Jt+we*Ss,Gr=N*($-1-wr)+C*(O-1-Ya)+E*Ae;for(let Hr=0;Hr<B;++Hr){const qr=w[en+Ie*Hr],Qs=T[Gr+Hr];Tt+=qr*Qs}}}const Zs=V*ke+ee*De+ce*$t+ue*Ae;x[Zs]=Tt}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const Hye={kernelName:Jp,backendName:"cpu",kernelFunc:Gye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:i,pad:o,dilations:l}=s;_e([r,a],"conv3d");const c=Zo(r.shape,a.shape,i,l,o),{filterDepth:f,filterHeight:d,filterWidth:p,dilationDepth:g,dilationHeight:y,dilationWidth:v,padInfo:x}=c,w=x.front,T=x.left,N=x.top,C=new yn(c.outShape,r.dtype),E=n.data.get(r.dataId).values,R=n.data.get(a.dataId).values,$=C.values,O=Be(r.shape),A=Be(a.shape);for(let _=0;_<c.batchSize;++_){const D=_*O[0],B=_*C.strides[0];for(let j=0;j<c.outDepth;++j){const W=B+j*C.strides[1],X=j*c.strideDepth-w;for(let U=0;U<f;++U){const Y=X+U*g;if(Y<0||Y>=c.inDepth)continue;const Q=U*A[0],ie=D+Y*O[1];for(let V=0;V<c.outHeight;++V){const ee=W+V*C.strides[2],ce=V*c.strideHeight-N;for(let ue=0;ue<d;++ue){const he=ce+ue*y;if(he<0||he>=c.inHeight)continue;const be=Q+ue*A[1],we=ie+he*O[2];for(let Ie=0;Ie<c.outWidth;++Ie){const ke=ee+Ie*c.outChannels,Ae=Ie*c.strideWidth-T;for(let De=0;De<p;++De){const We=Ae+De*v;if(We<0||We>=c.inWidth)continue;const ft=be+De*A[2],dt=we+We*c.inChannels;let $t=ft;for(let vt=0;vt<c.inChannels;++vt){const pt=E[dt+vt];for(let It=0;It<c.outChannels;++It)$[ke+It]+=pt*R[$t+It];$t+=c.outChannels}}}}}}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const Xye={kernelName:em,backendName:"cpu",kernelFunc:qye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:i,pad:o,filterShape:l}=s;_e([r,a],"conv3dBackpropFilterV2");const c=Be(r.shape),f=Be(a.shape),d=Zo(r.shape,l,i,1,o),p=d.strideDepth,g=d.strideHeight,y=d.strideWidth,v=d.filterDepth,x=d.filterHeight,w=d.filterWidth,T=new yn(d.filterShape,"float32"),N=T.values,[C,E,R,$]=T.strides,O=n.data.get(a.dataId).values,[A,_,D,B]=f,j=n.data.get(r.dataId).values,[W,X,U,Y]=c,Q=d.padInfo.front,ie=d.padInfo.left,V=d.padInfo.top;for(let ee=0;ee<v;++ee){const ce=Math.max(0,Math.ceil((Q-ee)/p)),ue=Math.min(d.outDepth,(d.inDepth+Q-ee)/p),he=ee*C;for(let be=0;be<x;++be){const we=Math.max(0,Math.ceil((V-be)/g)),Ie=Math.min(d.outHeight,(d.inHeight+V-be)/g),ke=be*E+he;for(let Ae=0;Ae<w;++Ae){const De=Math.max(0,Math.ceil((ie-Ae)/y)),We=Math.min(d.outWidth,(d.inWidth+ie-Ae)/y),ft=Ae*R+ke;for(let dt=0;dt<d.inChannels;++dt){const $t=dt*$+ft;for(let vt=0;vt<d.outChannels;++vt){let pt=0;for(let It=0;It<d.batchSize;++It){const Tt=It*W,Zs=It*A;for(let Jt=ce;Jt<ue;++Jt){const Ss=(ee+Jt*p-Q)*X+Tt,Ya=Jt*_+Zs;for(let en=we;en<Ie;++en){const Hr=(be+en*g-V)*U+Ss,qr=en*D+Ya;for(let Qs=De;Qs<We;++Qs){const zu=(Ae+Qs*y-ie)*Y+Hr,kf=Qs*B+qr;pt+=j[zu+dt]*O[kf+vt]}}}}N[$t+vt]=pt}}}}}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const Yye={kernelName:mb,backendName:"cpu",kernelFunc:Kye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zye(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{pad:i,strides:o,inputShape:l}=s;_e([r],"conv3dBackpropInputV2");const c=Be(r.shape),f=Be(a.shape),d=Zo(l,a.shape,o,1,i),p=new yn(d.inShape,"float32"),g=p.values,[y,v,x,w]=p.strides,T=n.data.get(r.dataId).values,[N,C,E,R]=c,$=n.data.get(a.dataId).values,[O,A,_,D]=f,{batchSize:B,filterDepth:j,filterHeight:W,filterWidth:X,inChannels:U,inDepth:Y,inHeight:Q,inWidth:ie,outChannels:V,outDepth:ee,outHeight:ce,outWidth:ue,strideDepth:he,strideHeight:be,strideWidth:we}=d,Ie=j-1-d.padInfo.front,ke=W-1-d.padInfo.top,Ae=X-1-d.padInfo.left;for(let De=0;De<B;++De)for(let We=0;We<U;++We)for(let ft=0;ft<Y;++ft){const dt=ft-Ie,$t=Math.max(0,Math.ceil(dt/he)),vt=Math.min(ee,(j+dt)/he);for(let pt=0;pt<Q;++pt){const It=pt-ke,Tt=Math.max(0,Math.ceil(It/be)),Zs=Math.min(ce,(W+It)/be);for(let Jt=0;Jt<ie;++Jt){const wr=Jt-Ae,Ss=Math.max(0,Math.ceil(wr/we)),Ya=Math.min(ue,(X+wr)/we);let en=0;for(let Gr=$t;Gr<vt;++Gr){const Hr=Gr*he-dt;for(let qr=Tt;qr<Zs;++qr){const Qs=qr*be-It;for(let al=Ss;al<Ya;++al){const zu=al*we-wr,kf=N*De+C*Gr+E*qr+R*al,Fv=O*(j-1-Hr)+A*(W-1-Qs)+_*(X-1-zu)+D*We;for(let xa=0;xa<V;++xa){const Ts=T[kf+xa],Lv=$[Fv+xa];en+=Ts*Lv}}}}g[y*De+v*ft+x*pt+w*Jt+We]=en}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const Qye={kernelName:gb,backendName:"cpu",kernelFunc:Zye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jye=Nt(gh,t=>Math.cos(t)),e1e={kernelName:gh,backendName:"cpu",kernelFunc:Jye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t1e=Nt(yh,t=>Math.cosh(t)),n1e={kernelName:yh,backendName:"cpu",kernelFunc:t1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s1e(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:a,boxInd:i}=e,{cropSize:o,method:l,extrapolationValue:c}=s,[f,d,p,g]=r.shape,y=a.shape[0],[v,x]=o,w=Qe([y,v,x,g],"float32"),T=n.data.get(a.dataId).values,N=n.data.get(i.dataId).values,C=n.data.get(r.dataId).values,E=Be(r.shape),R=Be(w.shape);for(let $=0;$<y;$++){const O=$*4,A=T[O],_=T[O+1],D=T[O+2],B=T[O+3],j=N[$];if(j>=f)continue;const W=v>1?(D-A)*(d-1)/(v-1):0,X=x>1?(B-_)*(p-1)/(x-1):0;for(let U=0;U<v;U++){const Y=v>1?A*(d-1)+U*W:.5*(A+D)*(d-1);if(Y<0||Y>d-1){for(let Q=0;Q<x;Q++)for(let ie=0;ie<g;ie++){const V=ie+Q*R[2]+U*R[1]+$*R[0];w.values[V]=c}continue}if(l==="bilinear"){const Q=Math.floor(Y),ie=Math.ceil(Y),V=Y-Q;for(let ee=0;ee<x;ee++){const ce=x>1?_*(p-1)+ee*X:.5*(_+B)*(p-1);if(ce<0||ce>p-1){for(let we=0;we<g;we++){const Ie=we+ee*R[2]+U*R[1]+$*R[0];w.values[Ie]=c}continue}const ue=Math.floor(ce),he=Math.ceil(ce),be=ce-ue;for(let we=0;we<g;we++){let Ie=we+ue*E[2]+Q*E[1]+j*E[0];const ke=C[Ie];Ie=we+he*E[2]+Q*E[1]+j*E[0];const Ae=C[Ie];Ie=we+ue*E[2]+ie*E[1]+j*E[0];const De=C[Ie];Ie=we+he*E[2]+ie*E[1]+j*E[0];const We=C[Ie],ft=ke+(Ae-ke)*be,dt=De+(We-De)*be;Ie=we+ee*R[2]+U*R[1]+$*R[0],w.values[Ie]=ft+(dt-ft)*V}}}else for(let Q=0;Q<x;++Q){const ie=x>1?_*(p-1)+Q*X:.5*(_+B)*(p-1);if(ie<0||ie>p-1){for(let ce=0;ce<g;ce++){const ue=ce+Q*R[2]+U*R[1]+$*R[0];w.values[ue]=c}continue}const V=Math.round(ie),ee=Math.round(Y);for(let ce=0;ce<g;ce++){const ue=ce+V*E[2]+ee*E[1]+j*E[0],he=ce+Q*R[2]+U*R[1]+$*R[0];w.values[he]=C[ue]}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const r1e={kernelName:bb,backendName:"cpu",kernelFunc:s1e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,exclusive:i,reverse:o}=s;_e(r,"cumprod");const l=qt([a],r.shape.length);let c=r;l!=null&&(c=Fs({inputs:{x:r},backend:n,attrs:{perm:l}}));const f=un(1,r.shape.length)[0];if(f!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${f}`);const d=As(c.dtype,"int32"),p=ib(de(c.shape),d),g=n.data.get(c.dataId).values,y=c.shape[c.shape.length-1],v=o?(w,T)=>w+y-T-1:(w,T)=>w+T;for(let w=0;w<g.length;w+=y)for(let T=0;T<y;T++){const N=v(w,T);if(T===0)p[N]=i?1:g[N];else{const C=v(w,T-1);p[N]=i?g[C]*p[C]:g[N]*p[C]}}const x=n.makeTensorInfo(c.shape,d,p);if(l!=null){const w=Qo(l),T=Fs({inputs:{x},backend:n,attrs:{perm:w}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(c),T}return x}const i1e={kernelName:yb,backendName:"cpu",kernelFunc:a1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,exclusive:i,reverse:o}=s;_e(r,"cumsum");const l=qt([a],r.shape.length);let c=r;l!=null&&(c=Fs({inputs:{x:r},backend:n,attrs:{perm:l}}));const f=un(1,r.shape.length)[0];if(f!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${f}`);const d=As(c.dtype,"int32"),p=qn(de(c.shape),d),g=n.data.get(c.dataId).values,y=c.shape[c.shape.length-1],v=o?(w,T)=>w+y-T-1:(w,T)=>w+T;for(let w=0;w<g.length;w+=y)for(let T=0;T<y;T++){const N=v(w,T);if(T===0)p[N]=i?0:g[N];else{const C=v(w,T-1);p[N]=i?g[C]+p[C]:g[N]+p[C]}}const x=n.makeTensorInfo(c.shape,d,p);if(l!=null){const w=Qo(l),T=Fs({inputs:{x},backend:n,attrs:{perm:w}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(c),T}return x}const l1e={kernelName:tm,backendName:"cpu",kernelFunc:o1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:a}=e,{size:i,binaryOutput:o}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,f=mI(l,c,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,f)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(a),f=S5(l,c,i,o);return n.makeTensorInfo(f.shape,a.dtype,f.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const c1e={kernelName:xb,backendName:"cpu",kernelFunc:u1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:a,dataFormat:i}=s;M(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const o=r.shape[0],l=r.shape[1],c=r.shape[2],f=r.shape[3],d=l*a,p=c*a,g=f/(a*a),y=n.data.get(r.dataId).values,v=new Float32Array(o*d*p*g);let x=0;for(let w=0;w<o;++w)for(let T=0;T<d;++T){const N=Math.floor(T/a),C=T%a;for(let E=0;E<p;++E){const R=Math.floor(E/a),$=E%a,O=(C*a+$)*g;for(let A=0;A<g;++A){const D=A+O+f*(R+c*(N+l*w));v[x++]=y[D]}}}return n.makeTensorInfo([o,d,p,g],r.dtype,v)}const f1e={kernelName:vb,backendName:"cpu",kernelFunc:h1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CU(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:i,pad:o,dilations:l,dimRoundingMode:c}=s;_e([r,a],"depthwiseConv2DNative");const f=Be(r.shape),d=Be(a.shape);let p=l;p==null&&(p=[1,1]),M(Kn(i,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${p}'`);const g=Ln(r.shape,a.shape,i,p,o,c,!0),{filterHeight:y,filterWidth:v,dilationHeight:x,dilationWidth:w,padInfo:T}=g,N=T.left,C=T.top,E=g.outChannels/g.inChannels,R=new yn(g.outShape,r.dtype),$=n.data.get(r.dataId).values,O=n.data.get(a.dataId).values,A=R.values;for(let _=0;_<g.batchSize;++_){const D=_*f[0],B=_*R.strides[0];for(let j=0;j<g.outHeight;++j){const W=B+j*R.strides[1],X=j*g.strideHeight-C;for(let U=0;U<y;++U){const Y=X+U*x;if(Y<0||Y>=g.inHeight)continue;const Q=U*d[0],ie=D+Y*f[1];for(let V=0;V<g.outWidth;++V){const ee=W+V*R.strides[2],ce=V*g.strideWidth-N;for(let ue=0;ue<v;++ue){const he=ce+ue*w;if(he<0||he>=g.inWidth)continue;const be=Q+ue*d[1],we=ie+he*g.inChannels;let Ie=ee,ke=be;for(let Ae=0;Ae<g.inChannels;++Ae){const De=$[we+Ae];for(let We=0;We<E;++We)A[Ie+We]+=De*O[ke+We];Ie+=E,ke+=E}}}}}}return n.makeTensorInfo(R.shape,R.dtype,R.values)}const d1e={kernelName:nm,backendName:"cpu",kernelFunc:CU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:c,filterShape:f}=s;_e([r,a],"depthwiseConv2dNativeBackpropFilter");const d=Ln(r.shape,f,i,o,l,c,!0),{strideHeight:p,strideWidth:g,filterHeight:y,filterWidth:v}=d,x=new yn(d.filterShape,"float32"),w=d.padInfo.left,T=d.padInfo.top,N=d.outChannels/d.inChannels,C=n.data.get(r.dataId).values,E=new yn(r.shape,r.dtype,C),R=n.data.get(a.dataId).values,$=new yn(a.shape,a.dtype,R);for(let O=0;O<y;++O){const A=Math.max(0,Math.ceil((T-O)/p)),_=Math.min(d.outHeight,(d.inHeight+T-O)/p);for(let D=0;D<v;++D){const B=Math.max(0,Math.ceil((w-D)/g)),j=Math.min(d.outWidth,(d.inWidth+w-D)/g);for(let W=0;W<d.outChannels;++W){const X=Math.trunc(W/N),U=W%N;let Y=0;for(let Q=0;Q<d.batchSize;++Q)for(let ie=A;ie<_;++ie){const V=O+ie*p-T;for(let ee=B;ee<j;++ee){const ce=D+ee*g-w;Y+=E.get(Q,V,ce,X)*$.get(Q,ie,ee,W)}}x.set(Y,O,D,X,U)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const m1e={kernelName:wb,backendName:"cpu",kernelFunc:p1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g1e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:c,inputShape:f}=s;_e([r,a],"depthwiseConv2DNativeBackpropInput");const d=Be(r.shape),p=Be(a.shape),g=Ln(f,a.shape,i,o,l,c,!0),y=new yn(g.inShape,"float32"),v=y.values,[x,w,T]=y.strides,N=n.data.get(r.dataId).values,[C,E,R]=d,$=n.data.get(a.dataId).values,[O,A,_]=p,{batchSize:D,filterHeight:B,filterWidth:j,inChannels:W,inHeight:X,inWidth:U,outChannels:Y,outHeight:Q,outWidth:ie,strideHeight:V,strideWidth:ee}=g,ce=B-1-g.padInfo.top,ue=j-1-g.padInfo.left,he=Y/W;for(let be=0;be<D;++be)for(let we=0;we<W;++we)for(let Ie=0;Ie<X;++Ie){const ke=Ie-ce,Ae=Math.max(0,Math.ceil(ke/V)),De=Math.min(Q,(B+ke)/V);for(let We=0;We<U;++We){const ft=We-ue,dt=Math.max(0,Math.ceil(ft/ee)),$t=Math.min(ie,(j+ft)/ee);let vt=0;for(let pt=Ae;pt<De;++pt){const It=pt*V-ke;for(let Tt=dt;Tt<$t;++Tt){const Zs=Tt*ee-ft,Jt=C*be+E*pt+R*Tt,wr=O*(B-1-It)+A*(j-1-Zs)+_*we;for(let Ss=0;Ss<he;++Ss){const Ya=we*he+Ss,en=N[Jt+Ya],Gr=$[wr+Ss];vt+=en*Gr}}}v[x*be+w*Ie+T*We+we]=vt}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const y1e={kernelName:Sb,backendName:"cpu",kernelFunc:g1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b1e(t){const{inputs:e,backend:n}=t,{x:s}=e,r=de(s.shape),a=n.data.get(s.dataId).values,i=Qe([r,r],s.dtype),o=i.values;for(let c=0;c<a.length;c++)o[c*r+c]=a[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,i.dtype,i.values)}const x1e={kernelName:Tb,backendName:"cpu",kernelFunc:b1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v1e={kernelName:sm,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:a,pad:i,dilations:o}=n,l=e,c=l.data.get(s.dataId).values,f=s.shape.length,d=l.data.get(r.dataId).values,p=r.shape.length,{batchSize:g,inHeight:y,inWidth:v,inChannels:x,outHeight:w,outWidth:T,padInfo:N,strideHeight:C,strideWidth:E,filterHeight:R,filterWidth:$,dilationHeight:O,dilationWidth:A,outShape:_}=Hm(s.shape,r.shape,a,i,"NHWC",o),D=de(_),B=_.length,j=Zt(s.dtype,D);for(let X=0;X<g;++X)for(let U=0;U<w;++U){const Y=U*C-N.top;for(let Q=0;Q<T;++Q){const ie=Q*E-N.left;for(let V=0;V<x;++V){let ee=Number.MIN_SAFE_INTEGER;for(let ue=0;ue<R;++ue){const he=Y+ue*O;if(he>=0&&he<y)for(let be=0;be<$;++be){const we=ie+be*A;if(we>=0&&we<v){const Ie=ia([X,he,we,V],f,Be(s.shape)),ke=ia([ue,be,V],p,Be(r.shape)),Ae=c[Ie]+d[ke];Ae>ee&&(ee=Ae)}}}const ce=ia([X,U,Q,V],B,Be(_));j[ce]=ee}}}return{dataId:l.write(Ko(j,s.dtype),_,s.dtype),shape:_,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w1e={kernelName:b1,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:a}=t,{strides:i,pad:o,dilations:l}=n,c=e,f=pr(s.shape,c.data.get(s.dataId).values),d=pr(r.shape,c.data.get(r.dataId).values),{batchSize:p,inHeight:g,inWidth:y,inChannels:v,outHeight:x,outWidth:w,padInfo:T,strideHeight:N,strideWidth:C,filterHeight:E,filterWidth:R,dilationHeight:$,dilationWidth:O,outShape:A}=Hm(s.shape,r.shape,i,o,"NHWC",l);M(a.rank===A.length,()=>`Error in ${b1}, dy must have the same rank as output ${A.length}, but got ${a.rank}`);const _=pr(A,c.data.get(a.dataId).values),D=_N(r.shape,r.dtype);for(let j=0;j<p;++j)for(let W=0;W<x;++W){const X=W*N-T.top;for(let U=0;U<w;++U){const Y=U*C-T.left;for(let Q=0;Q<v;++Q){let ie=Number.MIN_SAFE_INTEGER,V=0,ee=0;for(let ce=0;ce<E;++ce){const ue=X+ce*$;if(ue>=0&&ue<g)for(let he=0;he<R;++he){const be=Y+he*O;if(be>=0&&be<y){const we=f[j][ue][be][Q]+d[ce][he][Q];we>ie&&(ie=we,V=ce,ee=he)}}}D[V][ee][Q]+=_[j][W][U][Q]}}}return{dataId:c.write(Ko(D,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S1e={kernelName:y1,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:a}=t,{strides:i,pad:o,dilations:l}=n,c=e,f=pr(s.shape,c.data.get(s.dataId).values),d=pr(r.shape,c.data.get(r.dataId).values),{batchSize:p,inHeight:g,inWidth:y,inChannels:v,outHeight:x,outWidth:w,padInfo:T,strideHeight:N,strideWidth:C,filterHeight:E,filterWidth:R,dilationHeight:$,dilationWidth:O,outShape:A}=Hm(s.shape,r.shape,i,o,"NHWC",l);M(a.rank===A.length,()=>`Error in ${y1}, dy must have the same rank as output ${A.length}, but got ${a.rank}`);const _=pr(A,c.data.get(a.dataId).values),D=_N(s.shape,s.dtype);for(let j=0;j<p;++j)for(let W=0;W<x;++W){const X=W*N-T.top;for(let U=0;U<w;++U){const Y=U*C-T.left;for(let Q=0;Q<v;++Q){let ie=Number.MIN_SAFE_INTEGER,V=X<0?0:X,ee=Y<0?0:Y;for(let ce=0;ce<E;++ce){const ue=X+ce*$;if(ue>=0&&ue<g)for(let he=0;he<R;++he){const be=Y+he*O;if(be>=0&&be<y){const we=f[j][ue][be][Q]+d[ce][he][Q];we>ie&&(ie=we,V=ue,ee=be)}}}D[j][V][ee][Q]+=_[j][W][U][Q]}}}return{dataId:c.write(Ko(D,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T1e(t){const{inputs:e,backend:n,attrs:s}=t,{image:r}=e,{canvas:a,options:i}=s,{contextOptions:o,imageOptions:l}=i||{},c=(l==null?void 0:l.alpha)||1,f=(o==null?void 0:o.contextType)||"2d";if(f!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);const d=a.getContext(f,(o==null?void 0:o.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${f} type.`);const[p,g]=r.shape.slice(0,2),y=r.shape.length===2?1:r.shape[2],v=n.data.get(r.dataId).values,x=r.dtype==="float32"?255:1,w=new Uint8ClampedArray(g*p*4);for(let N=0;N<p*g;++N){const C=[0,0,0,255*c];for(let R=0;R<y;R++){const $=v[N*y+R];if(r.dtype==="float32"){if($<0||$>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${$}.`)}else if(r.dtype==="int32"&&($<0||$>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${$}.`);y===1?(C[0]=$*x,C[1]=$*x,C[2]=$*x):C[R]=$*x}const E=N*4;w[E+0]=Math.round(C[0]),w[E+1]=Math.round(C[1]),w[E+2]=Math.round(C[2]),w[E+3]=Math.round(C[3])}a.width=g,a.height=p;const T=new ImageData(w,g,p);return d.putImageData(T,0,0),r}const C1e={kernelName:Cb,backendName:"cpu",kernelFunc:T1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tg(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s;_e(r,"sum");let o;r.dtype==="bool"?o=Ho({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):o=Ha({inputs:{x:r},backend:n});const l=o.shape.length,c=nt(a,o.shape),f=qt(c,l);let d=c,p=o;f!=null&&(p=Fs({inputs:{x:o},backend:n,attrs:{perm:f}}),d=un(d.length,l)),Yn("sum",d,p.shape.length);const[g,y]=Mn(p.shape,d),v=As(p.dtype,"int32");let x=L1(n,g,v);const w=de(y),T=n.data.get(x.dataId).values,N=n.data.get(p.dataId).values;for(let C=0;C<T.length;++C){const E=C*w;let R=0;for(let $=0;$<w;++$)R+=N[E+$];T[C]=R}if(i){const C=on(x.shape,c),E=x;x=Lt({inputs:{x},backend:n,attrs:{shape:C}}),n.disposeIntermediateTensorInfo(E)}return n.disposeIntermediateTensorInfo(o),f!=null&&n.disposeIntermediateTensorInfo(p),x}const N1e={kernelName:Lm,backendName:"cpu",kernelFunc:Tg};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k1e(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,a=e,{allDims:i,summedDims:o,idDims:l}=kE(r,a.length);$E(i.length,l,a);const{path:c,steps:f}=IE(o,l),d=f.length;let p=null,g=i.length;const y=[];for(let v=0;v<d;++v){for(const x of f[v]){const{permutationIndices:w,expandDims:T}=EE(g,l[x]);let N;AE(w)?N=a[x]:(N=Fs({inputs:{x:a[x]},backend:n,attrs:{perm:w}}),y.push(N));const C=N.shape.slice();for(let E=0;E<T.length;++E)C.splice(T[E],0,1);at(N.shape,C)||(N=Lt({inputs:{x:N},backend:n,attrs:{shape:C}}),y.push(N)),p===null?p=N:(p=Cv({inputs:{a:N,b:p},backend:n}),y.push(p))}v<d-1&&(c[v]>=0&&(p=Tg({inputs:{x:p},backend:n,attrs:{axis:c[v]-(i.length-g),keepDims:!1}}),y.push(p)),g--)}for(const v of y)v!==p&&n.disposeIntermediateTensorInfo(v);return p}const E1e={kernelName:Nb,backendName:"cpu",kernelFunc:k1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $1e(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;_e([s,r],"eluGrad");const a=new Float32Array(de(r.shape)),i=n.data.get(r.dataId).values,o=n.data.get(s.dataId).values;for(let l=0;l<i.length;++l){const c=i[l];c>=0?a[l]=o[l]:a[l]=o[l]*(c+1)}return n.makeTensorInfo(r.shape,"float32",a)}const I1e={kernelName:kb,backendName:"cpu",kernelFunc:$1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A1e=xE,R1e=vE,D1e=wE,O1e=SE,_1e=TE,F1e=CE,L1e=Nt(vh,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+A1e*n);return e*(1-((((F1e*s+_1e)*s+O1e)*s+D1e)*s+R1e)*s*Math.exp(-n*n))}),M1e={kernelName:vh,backendName:"cpu",kernelFunc:L1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P1(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:a}=s,i=r.shape.length,o=r.shape.slice();let l=a;return a<0&&(M(-(i+1)<=a,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+a+1),o.splice(l,0,1),Lt({inputs:{x:r},backend:n,attrs:{shape:o}})}const z1e={kernelName:am,backendName:"cpu",kernelFunc:P1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P1e=hn((t,e)=>t/e),wI=En(bh,P1e),gC={kernelName:bh,backendName:"cpu",kernelFunc:wI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NU(t,e,n){const s=t.shape,r=s[0],a=s[1],i=n.data.get(t.dataId),o=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,c=[r,a],f=de(c),d=On("float32",f),p=On("float32",f);for(let x=0;x<r;x++){const w=gu({inputs:{x:o},backend:n,attrs:{begin:[x,0],size:[1,a]}}),T=gu({inputs:{x:l},backend:n,attrs:{begin:[x,0],size:[1,a]}}),N=js({inputs:{real:w,imag:T},backend:n}),{real:C,imag:E}=B1e(N,e,n),R=Fi(C,E);for(let $=0;$<a;$++){const O=NE(R,$);d[x*a+$]=O.real,p[x*a+$]=O.imag}n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(T),n.disposeIntermediateTensorInfo(N)}const g=n.makeTensorInfo(c,"float32",d),y=n.makeTensorInfo(c,"float32",p),v=js({inputs:{real:g,imag:y},backend:n});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),v}function B1e(t,e,n){const s=de(t.shape),r=n.data.get(t.dataId),a=n.data.get(r.complexTensorInfos.real.dataId).values,i=n.data.get(r.complexTensorInfos.imag.dataId).values;if(V1e(s)){const o=yC(a,i,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",o.real),f=n.makeTensorInfo(l,"float32",o.imag),d=n.makeTensorInfo([],"float32",Vi(s,"float32")),p=Ha({inputs:{x:d},backend:n}),g=gC.kernelFunc({inputs:{a:c,b:d},backend:n}),y=gC.kernelFunc({inputs:{a:f,b:p},backend:n}),v=n.data.get(g.dataId).values,x=n.data.get(y.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),{real:v,imag:x}}return o}else{const o=Fi(a,i),l=U1e(o,s,e);return gB(l)}}function V1e(t){return(t&t-1)===0}function yC(t,e,n,s,r){if(n===1)return{real:t,imag:e};const a=Fi(t,e),i=n/2,o=yB(a),l=o.real,c=o.imag,f=[l.length],d=r.makeTensorInfo(f,"float32",l),p=r.makeTensorInfo(f,"float32",c),g=js({inputs:{real:d,imag:p},backend:r}),y=bB(a),v=y.real,x=y.imag,w=[v.length],T=r.makeTensorInfo(w,"float32",v),N=r.makeTensorInfo(w,"float32",x),C=js({inputs:{real:T,imag:N},backend:r}),E=yC(l,c,i,s,r),R=E.real,$=E.imag,O=[R.length],A=r.makeTensorInfo(O,"float32",R),_=r.makeTensorInfo(O,"float32",$),D=js({inputs:{real:A,imag:_},backend:r}),B=yC(v,x,i,s,r),j=B.real,W=B.imag,X=[j.length],U=r.makeTensorInfo(X,"float32",j),Y=r.makeTensorInfo(X,"float32",W),Q=js({inputs:{real:U,imag:Y},backend:r}),ie=vB(n,s),V=[ie.real.length],ee=r.makeTensorInfo(V,"float32",ie.real),ce=r.makeTensorInfo(V,"float32",ie.imag),ue=js({inputs:{real:ee,imag:ce},backend:r}),he=Cv({inputs:{a:ue,b:Q},backend:r}),be=Qc({inputs:{a:D,b:he},backend:r}),we=xI({inputs:{a:D,b:he},backend:r}),Ie=mu({inputs:{input:be},backend:r}),ke=mu({inputs:{input:we},backend:r}),Ae=Jc({inputs:{input:be},backend:r}),De=Jc({inputs:{input:we},backend:r}),We=eh({inputs:[Ie,ke],backend:r,attrs:{axis:0}}),ft=eh({inputs:[Ae,De],backend:r,attrs:{axis:0}}),dt=r.data.get(We.dataId).values,$t=r.data.get(ft.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(T),r.disposeIntermediateTensorInfo(N),r.disposeIntermediateTensorInfo(C),r.disposeIntermediateTensorInfo(A),r.disposeIntermediateTensorInfo(_),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(U),r.disposeIntermediateTensorInfo(Y),r.disposeIntermediateTensorInfo(Q),r.disposeIntermediateTensorInfo(ee),r.disposeIntermediateTensorInfo(ce),r.disposeIntermediateTensorInfo(ue),r.disposeIntermediateTensorInfo(he),r.disposeIntermediateTensorInfo(be),r.disposeIntermediateTensorInfo(we),r.disposeIntermediateTensorInfo(Ie),r.disposeIntermediateTensorInfo(Ae),r.disposeIntermediateTensorInfo(ke),r.disposeIntermediateTensorInfo(De),r.disposeIntermediateTensorInfo(We),r.disposeIntermediateTensorInfo(ft),{real:dt,imag:$t}}function U1e(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let a=0,i=0;for(let o=0;o<e;o++){const l=wB(r*o,e,n),c=NE(t,o);a+=c.real*l.real-c.imag*l.imag,i+=c.real*l.imag+c.imag*l.real}n&&(a/=e,i/=e),xB(s,a,i,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j1e(t){const{inputs:e,backend:n}=t,{input:s}=e,r=de(s.shape),a=s.shape[s.shape.length-1],i=r/a,o=Lt({inputs:{x:s},backend:n,attrs:{shape:[i,a]}}),l=NU(o,!1,n),c=Lt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const W1e={kernelName:Eb,backendName:"cpu",kernelFunc:j1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SI(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:a}=n,i=a||Cu(r),o=Zt(i,de(s));return H1e(o,r,i),e.makeTensorInfo(s,i,o)}const G1e={kernelName:$b,backendName:"cpu",kernelFunc:SI};function H1e(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q1e={kernelName:Ib,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,a=On(s.dtype,de(s.shape)),[i,o,l,c]=s.shape,f=r.data.get(s.dataId).values;for(let p=0;p<i;p++){const g=p*l*o*c;for(let y=0;y<o;y++){const v=y*(l*c);for(let x=0;x<l;x++){const w=x*c;for(let T=0;T<c;T++){const N=Math.round(l-x-1),C=g+v+w+T;let E=f[C];if(N>=0&&N<l){const R=N*c,$=g+v+R+T;E=f[$]}a[C]=E}}}}return{dataId:r.write(a,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a,bias:i,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:f,dilations:d,dimRoundingMode:p,activation:g,leakyreluAlpha:y}=s;let v=TU({inputs:{x:r,filter:a},backend:n,attrs:{strides:l,pad:c,dataFormat:f,dilations:d,dimRoundingMode:p}});if(i){const x=v;if(f==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const w=Lt({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});v=Qc({inputs:{a:v,b:w},backend:n}),n.disposeIntermediateTensorInfo(w)}else v=Qc({inputs:{a:v,b:i},backend:n});n.disposeIntermediateTensorInfo(x)}if(g){const x=v;if(f==="NCHW"&&g==="prelu"&&o.shape.length===1&&o.shape[0]!==1){const w=Lt({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});v=z1(n,v,g,w,y),n.disposeIntermediateTensorInfo(w)}else v=z1(n,v,g,o,y);n.disposeIntermediateTensorInfo(x)}return v}const K1e={kernelName:fp,backendName:"cpu",kernelFunc:X1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a,bias:i,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:f,dilations:d,dimRoundingMode:p,activation:g,leakyreluAlpha:y}=s;let v=CU({inputs:{x:r,filter:a},backend:n,attrs:{strides:l,pad:c,dataFormat:f,dilations:d,dimRoundingMode:p}});if(i){const x=v;v=Qc({inputs:{a:v,b:i},backend:n}),n.disposeIntermediateTensorInfo(x)}if(g){const x=v;v=z1(n,v,g,o,y),n.disposeIntermediateTensorInfo(x)}return v}const Z1e={kernelName:dp,backendName:"cpu",kernelFunc:Y1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q1e(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,a=de(s.shape),i=r.shape,o=i[i.length-1],[l,c,f,d]=Qx(s,r);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const p=n.data.get(r.dataId).values,g=n.bufferSync(s),y=O5(p,g,s.dtype,c,o,f,d,s.shape,a);return n.makeTensorInfo(l,s.dtype,y.values)}const J1e={kernelName:Ab,backendName:"cpu",kernelFunc:Q1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ebe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:a}=e,{axis:i,batchDims:o}=s;_e([r,a],"gatherV2");const l=nt(i,r.shape)[0],c=n.data.get(a.dataId).values,f=r.shape[l];for(let C=0;C<c.length;++C){const E=c[C];M(E<=f-1&&E>=0,()=>`GatherV2: the index value ${E} is not in [0, ${f-1}]`)}let d=o;o==null&&(d=0);const p=de(a.shape),g=DE(r,a,l,d),y=Lt({inputs:{x:r},backend:n,attrs:{shape:[g.batchSize,g.outerSize,g.dimSize,g.sliceSize]}}),v=Lt({inputs:{x:a},backend:n,attrs:{shape:[g.batchSize,p/g.batchSize]}}),x=[g.batchSize,g.outerSize,p/g.batchSize,g.sliceSize],w=n.bufferSync(v),T=n.bufferSync(y),N=_5(T,w,x);return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),n.makeTensorInfo(g.outputShape,N.dtype,N.values)}const tbe={kernelName:om,backendName:"cpu",kernelFunc:ebe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nbe(t){const{inputs:e,backend:n}=t,{input:s}=e,r=de(s.shape),a=s.shape[s.shape.length-1],i=r/a,o=Lt({inputs:{x:s},backend:n,attrs:{shape:[i,a]}}),l=NU(o,!0,n),c=Lt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const sbe={kernelName:Rb,backendName:"cpu",kernelFunc:nbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rbe=Nt(Eh,t=>Number.isFinite(t)?1:0,"bool"),abe={kernelName:Eh,backendName:"cpu",kernelFunc:rbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ibe=Nt($h,t=>Math.abs(t)===1/0?1:0,"bool"),obe={kernelName:$h,backendName:"cpu",kernelFunc:ibe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lbe=Nt(Ih,t=>Number.isNaN(t)?1:0,"bool"),ube={kernelName:Ih,backendName:"cpu",kernelFunc:lbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cbe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:a}=n,i=P5(s,r,a);return e.makeTensorInfo([i.length],"float32",i)}const hbe={kernelName:Ob,backendName:"cpu",kernelFunc:cbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fbe=Nt(Rh,t=>Math.log1p(t)),dbe={kernelName:Rh,backendName:"cpu",kernelFunc:fbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pbe=hn((t,e)=>t&&e),mbe=En(fm,pbe,null,"bool"),gbe={kernelName:fm,backendName:"cpu",kernelFunc:mbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ybe=Nt(dm,t=>t?0:1,"bool"),bbe={kernelName:dm,backendName:"cpu",kernelFunc:ybe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xbe=hn((t,e)=>t||e),vbe=En(pm,xbe,null,"bool"),wbe={kernelName:pm,backendName:"cpu",kernelFunc:vbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:a,bias:i,alpha:o,beta:l}=s;_e(r,"LRN");const c=r.shape[3],f=c-1,d=n.data.get(r.dataId).values,p=de(r.shape),g=new Float32Array(p);function y(v){const x=v%c;let w=v-x+Math.max(0,x-a);const T=v-x+Math.min(x+a,f);let N=0;for(;w<=T;w++){const C=d[w];N+=C*C}return N}for(let v=0;v<p;v++){const x=y(v),w=d[v]*Math.pow(i+o*x,-l);g[v]=w}return n.makeTensorInfo(r.shape,r.dtype,g)}const Tbe={kernelName:mm,backendName:"cpu",kernelFunc:Sbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:a,dy:i}=e,{depthRadius:o,bias:l,alpha:c,beta:f}=s;_e(i,"LRNGrad");const d=de(i.shape),p=i.shape[3],g=n.data.get(i.dataId).values,y=n.data.get(r.dataId).values,v=n.data.get(a.dataId).values,x=new Float32Array(d),w=d;for(let T=0;T<w;T++){const N=T%p,C=T-N+Math.max(0,N-o),E=T-N+Math.min(p,N+o+1);let R=0;for(let $=C;$<E;$++)R+=Math.pow(y[$],2);R=c*R+l;for(let $=C;$<E;$++){let O=-2*c*f*y[$]*v[T]/R;T===$&&(O+=Math.pow(R,-f)),O*=g[T],x[$]+=O}}return n.makeTensorInfo(i.shape,r.dtype,x)}const Nbe={kernelName:_b,backendName:"cpu",kernelFunc:Cbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kU(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:a,keepDims:i}=s,o=n;let l=r.shape;const c=l.length,f=nt(a,l);let d=f;const p=qt(d,c);let g=o.data.get(r.dataId).values;if(p!=null){const C=new Array(c);for(let E=0;E<C.length;E++)C[E]=l[p[E]];g=yI(g,l,r.dtype,p,C),d=un(d.length,c),l=C}_e(r,"max"),Yn("max",d,c);const[y,v]=Mn(l,d),x=de(v),w=V5(g,x,y,r.dtype),T=o.write(w,y,r.dtype);let N=y;return i&&(N=on(y,f)),{dataId:T,shape:N,dtype:r.dtype}}const kbe={kernelName:gm,backendName:"cpu",kernelFunc:kU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ebe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;_e(r,"maxPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=s,c=1;M(Kn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const f=Ur(r.shape,a,i,c,o,l);let d;if(f.filterWidth===1&&f.filterHeight===1&&at(f.inShape,f.outShape))d=Ha({inputs:{x:r},backend:n});else{const p=n.data.get(r.dataId).values,g=Be(r.shape),y=vI(p,r.shape,r.dtype,g,f,"max");d=n.makeTensorInfo(f.outShape,r.dtype,y.values)}return d}const $be={kernelName:ym,backendName:"cpu",kernelFunc:Ebe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ibe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:a,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=s;_e(r,"maxPool3d");const f=Ui(r.shape,a,i,1,o,l,c),d=n.data.get(r.dataId).values,p=SU(d,r.shape,r.dtype,Be(r.shape),f,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}const Abe={kernelName:bm,backendName:"cpu",kernelFunc:Ibe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rbe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,{filterSize:i,strides:o,pad:l,dimRoundingMode:c}=s;_e([r,a],"maxPool3DGrad");const f=Ui(a.shape,i,o,1,l,c),d=n.bufferSync(a),p=xye(d,f),g=f.strideDepth,y=f.strideHeight,v=f.strideWidth,x=f.dilationDepth,w=f.dilationHeight,T=f.dilationWidth,N=f.effectiveFilterDepth,C=f.effectiveFilterHeight,E=f.effectiveFilterWidth,R=N-1-f.padInfo.front,$=E-1-f.padInfo.left,O=C-1-f.padInfo.top,A=Qe(a.shape,"float32"),_=n.bufferSync(r);for(let D=0;D<f.batchSize;++D)for(let B=0;B<f.inChannels;++B)for(let j=0;j<f.inDepth;++j)for(let W=0;W<f.inHeight;++W)for(let X=0;X<f.inWidth;++X){const U=j-R,Y=W-O,Q=X-$;let ie=0;for(let V=0;V<N;V+=x){const ee=(U+V)/g;if(!(ee<0||ee>=f.outDepth||Math.floor(ee)!==ee))for(let ce=0;ce<C;ce+=w){const ue=(Y+ce)/y;if(!(ue<0||ue>=f.outHeight||Math.floor(ue)!==ue))for(let he=0;he<E;he+=T){const be=(Q+he)/v;if(be<0||be>=f.outWidth||Math.floor(be)!==be)continue;const we=N*C*E-1-p.get(D,ee,ue,be,B),Ie=V*C*E+ce*E+he,ke=we===Ie?1:0;if(ke===0)continue;const Ae=_.get(D,ee,ue,be,B);ie+=Ae*ke}}}A.set(ie,D,j,W,X,B)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const Dbe={kernelName:Lb,backendName:"cpu",kernelFunc:Rbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Obe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a,output:i}=e,o=a;_e([a,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:f,dimRoundingMode:d}=s,p=Ur(o.shape,l,c,1,f,d),g=n.data.get(o.dataId).values,y=Qe(p.outShape,o.dtype,wU(g,o.shape,o.dtype,p).values),v=p.strideHeight,x=p.strideWidth,w=p.dilationHeight,T=p.dilationWidth,N=p.effectiveFilterHeight,C=p.effectiveFilterWidth,E=C-1-p.padInfo.left,R=N-1-p.padInfo.top,$=Qe(o.shape,"float32"),O=n.data.get(r.dataId).values,A=Qe(r.shape,"float32",O);for(let _=0;_<p.batchSize;++_)for(let D=0;D<p.inChannels;++D)for(let B=0;B<p.inHeight;++B)for(let j=0;j<p.inWidth;++j){const W=B-R,X=j-E;let U=0;for(let Y=0;Y<N;Y+=w){const Q=(W+Y)/v;if(!(Q<0||Q>=p.outHeight||Math.floor(Q)!==Q))for(let ie=0;ie<C;ie+=T){const V=(X+ie)/x;if(V<0||V>=p.outWidth||Math.floor(V)!==V)continue;const ee=N*C-1-y.get(_,Q,V,D),ce=Y*C+ie,ue=ee===ce?1:0;if(ue===0)continue;const he=A.get(_,Q,V,D);U+=he*ue}}$.set(U,_,B,j,D)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const _be={kernelName:Fb,backendName:"cpu",kernelFunc:Obe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fbe(t,e,n,s,r){const a=Be(e),i=vI(t,e,n,a,r,"max"),o=wU(t,e,n,r,!0,s);return[i.values,o.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lbe={kernelName:Mb,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:a,pad:i,includeBatchInIndex:o}=e,l=n;_e(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,f=Ur(s.shape,r,a,[1,1],i),[d,p]=Fbe(c,s.shape,s.dtype,o,f),g=l.write(d,f.outShape,s.dtype),y=l.write(p,f.outShape,s.dtype);return[{dataId:g,shape:f.outShape,dtype:s.dtype},{dataId:y,shape:f.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s,o=nt(a,r.shape),c=Mn(r.shape,o)[1],f=de(c),d=[],p=n.makeTensorInfo([],"float32",new Float32Array([f]));d.push(p);const g=Ho({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});d.push(g);const y=wI({inputs:{a:g,b:p},backend:n});d.push(y);const v=Tg({inputs:{x:y},backend:n,attrs:{axis:a,keepDims:i}});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),v}const zbe={kernelName:xm,backendName:"cpu",kernelFunc:Mbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s;_e(r,"min");const o=nt(a,r.shape);let l=o;const c=qt(l,r.shape.length);let f=r;c!=null&&(f=Fs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=un(l.length,r.shape.length)),Yn("min",l,f.shape.length);const[d,p]=Mn(f.shape,l),g=de(p),y=qn(de(d),f.dtype),v=n.data.get(f.dataId).values;for(let w=0;w<y.length;++w){const T=w*g;let N=v[T];for(let C=0;C<g;++C){const E=v[T+C];(Number.isNaN(E)||E<N)&&(N=E)}y[w]=N}c!=null&&n.disposeIntermediateTensorInfo(f);const x=n.makeTensorInfo(d,f.dtype,y);if(i){const w=on(d,o),T=Lt({inputs:{x},backend:n,attrs:{shape:w}});return n.disposeIntermediateTensorInfo(x),T}return x}const Bbe={kernelName:vm,backendName:"cpu",kernelFunc:Pbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:a,mode:i}=s;_e(r,"mirrorPad");const o=a.map((N,C)=>N[0]+r.shape[C]+N[1]),l=a.map(N=>N[0]),c=a.map((N,C)=>N[0]+r.shape[C]),f=i==="reflect"?0:1,d=n.data.get(r.dataId).values,p=r.shape.length,g=Be(r.shape),y=de(o),v=o.length,x=Be(o),w=On(r.dtype,y);for(let N=0;N<y;N++){let C=Nu(N,v,x);for(let R=0;R<v;R++)C[R]<l[R]?C[R]=l[R]*2-C[R]-f:C[R]>=c[R]&&(C[R]=(c[R]-1)*2-C[R]+f);C=C.map((R,$)=>R-l[$]);const E=ia(C,p,g);w[N]=d[E]}return{dataId:n.write(w,o,r.dtype),shape:o,dtype:r.dtype}}const Ube={kernelName:wm,backendName:"cpu",kernelFunc:Vbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jbe=hn((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),Wbe=En(_h,jbe),Gbe={kernelName:_h,backendName:"cpu",kernelFunc:Wbe};var Oy={exports:{}},Hbe=Oy.exports,dF;function qbe(){return dF||(dF=1,function(t){(function(e,n,s){function r(l){var c=this,f=o();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=f(" "),c.s1=f(" "),c.s2=f(" "),c.s0-=f(l),c.s0<0&&(c.s0+=1),c.s1-=f(l),c.s1<0&&(c.s1+=1),c.s2-=f(l),c.s2<0&&(c.s2+=1),f=null}function a(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function i(l,c){var f=new r(l),d=c&&c.state,p=f.next;return p.int32=function(){return f.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,d&&(typeof d=="object"&&a(d,f),p.state=function(){return a(f,{})}),p}function o(){var l=4022871197,c=function(f){f=String(f);for(var d=0;d<f.length;d++){l+=f.charCodeAt(d);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=i:this.alea=i})(Hbe,t)}(Oy)),Oy.exports}var _y={exports:{}},Xbe=_y.exports,pF;function Kbe(){return pF||(pF=1,function(t){(function(e,n,s){function r(o){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},o===(o|0)?l.x=o:c+=o;for(var f=0;f<c.length+64;f++)l.x^=c.charCodeAt(f)|0,l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xor128=i})(Xbe,t)}(_y)),_y.exports}var Fy={exports:{}},Ybe=Fy.exports,mF;function Zbe(){return mF||(mF=1,function(t){(function(e,n,s){function r(o){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:c+=o;for(var f=0;f<c.length+64;f++)l.x^=c.charCodeAt(f)|0,f==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xorwow=i})(Ybe,t)}(Fy)),Fy.exports}var Ly={exports:{}},Qbe=Ly.exports,gF;function Jbe(){return gF||(gF=1,function(t){(function(e,n,s){function r(o){var l=this;l.next=function(){var f=l.x,d=l.i,p,g;return p=f[d],p^=p>>>7,g=p^p<<24,p=f[d+1&7],g^=p^p>>>10,p=f[d+3&7],g^=p^p>>>3,p=f[d+4&7],g^=p^p<<7,p=f[d+7&7],p=p^p<<13,g^=p^p<<9,f[d]=g,l.i=d+1&7,g};function c(f,d){var p,g=[];if(d===(d|0))g[0]=d;else for(d=""+d,p=0;p<d.length;++p)g[p&7]=g[p&7]<<15^d.charCodeAt(p)+g[p+1&7]<<13;for(;g.length<8;)g.push(0);for(p=0;p<8&&g[p]===0;++p);for(p==8?g[7]=-1:g[p],f.x=g,f.i=0,p=256;p>0;--p)f.next()}c(l,o)}function a(o,l){return l.x=o.x.slice(),l.i=o.i,l}function i(o,l){o==null&&(o=+new Date);var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(f.x&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xorshift7=i})(Qbe,t)}(Ly)),Ly.exports}var My={exports:{}},exe=My.exports,yF;function txe(){return yF||(yF=1,function(t){(function(e,n,s){function r(o){var l=this;l.next=function(){var f=l.w,d=l.X,p=l.i,g,y;return l.w=f=f+1640531527|0,y=d[p+34&127],g=d[p=p+1&127],y^=y<<13,g^=g<<17,y^=y>>>15,g^=g>>>12,y=d[p]=y^g,l.i=p,y+(f^f>>>16)|0};function c(f,d){var p,g,y,v,x,w=[],T=128;for(d===(d|0)?(g=d,d=null):(d=d+"\0",g=0,T=Math.max(T,d.length)),y=0,v=-32;v<T;++v)d&&(g^=d.charCodeAt((v+32)%d.length)),v===0&&(x=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,v>=0&&(x=x+1640531527|0,p=w[v&127]^=g+x,y=p==0?y+1:0);for(y>=128&&(w[(d&&d.length||0)&127]=-1),y=127,v=4*128;v>0;--v)g=w[y+34&127],p=w[y=y+1&127],g^=g<<13,p^=p<<17,g^=g>>>15,p^=p>>>12,w[y]=g^p;f.w=x,f.X=w,f.i=y}c(l,o)}function a(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function i(o,l){o==null&&(o=+new Date);var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(f.X&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xor4096=i})(exe,t)}(My)),My.exports}var zy={exports:{}},nxe=zy.exports,bF;function sxe(){return bF||(bF=1,function(t){(function(e,n,s){function r(o){var l=this,c="";l.next=function(){var d=l.b,p=l.c,g=l.d,y=l.a;return d=d<<25^d>>>7^p,p=p-g|0,g=g<<24^g>>>8^y,y=y-d|0,l.b=d=d<<20^d>>>12^p,l.c=p=p-g|0,l.d=g<<16^p>>>16^y,l.a=y-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):c+=o;for(var f=0;f<c.length+20;f++)l.b^=c.charCodeAt(f)|0,l.next()}function a(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.tychei=i})(nxe,t)}(zy)),zy.exports}var Py={exports:{}},rxe=Py.exports,xF;function axe(){return xF||(xF=1,function(t){(function(e,n,s){var r=256,a=6,i=52,o="random",l=s.pow(r,a),c=s.pow(2,i),f=c*2,d=r-1,p;function g(C,E,R){var $=[];E=E==!0?{entropy:!0}:E||{};var O=w(x(E.entropy?[C,N(n)]:C??T(),3),$),A=new y($),_=function(){for(var D=A.g(a),B=l,j=0;D<c;)D=(D+j)*r,B*=r,j=A.g(1);for(;D>=f;)D/=2,B/=2,j>>>=1;return(D+j)/B};return _.int32=function(){return A.g(4)|0},_.quick=function(){return A.g(4)/4294967296},_.double=_,w(N(A.S),n),(E.pass||R||function(D,B,j,W){return W&&(W.S&&v(W,A),D.state=function(){return v(A,{})}),j?(s[o]=D,B):D})(_,O,"global"in E?E.global:this==s,E.state)}function y(C){var E,R=C.length,$=this,O=0,A=$.i=$.j=0,_=$.S=[];for(R||(C=[R++]);O<r;)_[O]=O++;for(O=0;O<r;O++)_[O]=_[A=d&A+C[O%R]+(E=_[O])],_[A]=E;($.g=function(D){for(var B,j=0,W=$.i,X=$.j,U=$.S;D--;)B=U[W=d&W+1],j=j*r+U[d&(U[W]=U[X=d&X+B])+(U[X]=B)];return $.i=W,$.j=X,j})(r)}function v(C,E){return E.i=C.i,E.j=C.j,E.S=C.S.slice(),E}function x(C,E){var R=[],$=typeof C,O;if(E&&$=="object")for(O in C)try{R.push(x(C[O],E-1))}catch{}return R.length?R:$=="string"?C:C+"\0"}function w(C,E){for(var R=C+"",$,O=0;O<R.length;)E[d&O]=d&($^=E[d&O]*19)+R.charCodeAt(O++);return N(E)}function T(){try{var C;return p&&(C=p.randomBytes)?C=C(r):(C=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(C)),N(C)}catch{var E=e.navigator,R=E&&E.plugins;return[+new Date,e,R,e.screen,N(n)]}}function N(C){return String.fromCharCode.apply(0,C)}if(w(s.random(),n),t.exports){t.exports=g;try{p=Ex}catch{}}else s["seed"+o]=g})(typeof self<"u"?self:rxe,[],Math)}(Py)),Py.exports}var LS,vF;function ixe(){if(vF)return LS;vF=1;var t=qbe(),e=Kbe(),n=Zbe(),s=Jbe(),r=txe(),a=sxe(),i=axe();return i.alea=t,i.xor128=e,i.xorwow=n,i.xorshift7=s,i.xor4096=r,i.tychei=a,LS=i,LS}var oxe=ixe();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EU(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:a}=s,i=r.shape.length;let o=a;if(o===-1&&(o=i-1),o!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${o}`);const l=nt([o],r.shape),c=kU({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),f=on(c.shape,l),d=Lt({inputs:{x:c},backend:n,attrs:{shape:f}}),p=xI({inputs:{a:r,b:d},backend:n}),g=I5({inputs:{x:p},backend:n}),y=Tg({inputs:{x:g},backend:n,attrs:{axis:l,keepDims:!1}}),v=Lt({inputs:{x:y},backend:n,attrs:{shape:f}}),x=wI({inputs:{a:g,b:v},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),x}const lxe={kernelName:Pm,backendName:"cpu",kernelFunc:EU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uxe(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:a,seed:i,normalized:o}=s;_e(r,"multinomial");const l=o?r:EU({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],f=l.shape[1],d=n.data.get(l.dataId).values,p=[c,a],g=qn(de(p),"int32");for(let y=0;y<c;++y){const v=y*f,x=new Float32Array(f-1);x[0]=d[v];for(let N=1;N<x.length;++N)x[N]=x[N-1]+d[v+N];const w=oxe.alea(i.toString()),T=y*a;for(let N=0;N<a;++N){const C=w();g[T+N]=x.length;for(let E=0;E<x.length;E++)if(C<x[E]){g[T+N]=E;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(p,"int32",g)}const cxe={kernelName:zb,backendName:"cpu",kernelFunc:uxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hxe=Xx;function fxe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=s;_e(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,f=n.data.get(a.dataId).values,{selectedIndices:d}=hxe(c,f,i,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const dxe={kernelName:Pb,backendName:"cpu",kernelFunc:fxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pxe=Kx;function mxe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=s;_e(r,"NonMaxSuppressionPadded");const f=n.data.get(r.dataId).values,d=n.data.get(a.dataId).values,{selectedIndices:p,validOutputs:g}=pxe(f,d,i,o,l,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([g]))]}const gxe={kernelName:Bb,backendName:"cpu",kernelFunc:mxe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yxe=Yx;function bxe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=s;_e(r,"NonMaxSuppressionWithScore");const f=n.data.get(r.dataId).values,d=n.data.get(a.dataId).values,p=i,g=o,y=l,v=c,{selectedIndices:x,selectedScores:w}=yxe(f,d,p,g,y,v);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const xxe={kernelName:Vb,backendName:"cpu",kernelFunc:bxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vxe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:a,depth:i,onValue:o,offValue:l}=s;_e(r,"oneHot");const c=de(r.shape),f=new Float32Array(c*i);f.fill(l);const d=n.data.get(r.dataId).values;for(let p=0;p<c;++p)d[p]>=0&&d[p]<i&&(f[p*i+d[p]]=o);return n.makeTensorInfo([...r.shape,i],a,f)}const wxe={kernelName:Nm,backendName:"cpu",kernelFunc:vxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B1(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=mu({inputs:{input:s},backend:n}),a=B1({inputs:{x:r},backend:n}),i=Jc({inputs:{input:s},backend:n}),o=B1({inputs:{x:i},backend:n}),l=js({inputs:{real:a,imag:o},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return SI({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const Sxe={kernelName:jm,backendName:"cpu",kernelFunc:B1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $U(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=mu({inputs:{input:s},backend:n}),a=$U({inputs:{x:r},backend:n}),i=Jc({inputs:{input:s},backend:n}),o=B1({inputs:{x:i},backend:n}),l=js({inputs:{real:a,imag:o},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return SI({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const Txe={kernelName:Cm,backendName:"cpu",kernelFunc:$U};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IU(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return P1({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const a=e[0].shape,i=e[0].dtype;e.forEach(f=>{Xn(a,f.shape,"All tensors passed to stack must have matching shapes"),M(i===f.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(f=>{const d=P1({inputs:{input:f},backend:n,attrs:{dim:r}});return o.push(d),d}),c=eh({inputs:l,backend:n,attrs:{axis:r}});return o.forEach(f=>n.disposeIntermediateTensorInfo(f)),c}const Cxe={kernelName:km,backendName:"cpu",kernelFunc:IU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:a,constantValue:i}=s;_e(r,"pad");const o=a.map((T,N)=>T[0]+r.shape[N]+T[1]),l=a.map(T=>T[0]),c=n.data.get(r.dataId).values,f=de(r.shape),d=r.shape.length,p=Be(r.shape),g=de(o),y=o.length,v=Be(o),x=On(r.dtype,g);i!==0&&x.fill(i);for(let T=0;T<f;T++){const C=Nu(T,d,p).map((R,$)=>R+l[$]),E=ia(C,y,v);x[E]=c[T]}return{dataId:n.write(x,o,r.dtype),shape:o,dtype:r.dtype}}const AU={kernelName:Em,backendName:"cpu",kernelFunc:Nxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kxe=hn((t,e)=>Math.pow(t,e)),Exe=En(Lh,kxe),$xe={kernelName:Lh,backendName:"cpu",kernelFunc:Exe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ixe(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:a,indices:i}=e,{outputRaggedRank:o}=s,l=r.map(w=>n.data.get(w.dataId).values),c=r.map(w=>w.shape),f=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,[p,g,y]=q5(l,c,f,a.shape,a.dtype,d,i.shape),v=p.map(w=>n.makeTensorInfo([w.length],"int32",w)),x=n.makeTensorInfo(y,a.dtype,g);return v.concat([x])}const Axe={kernelName:Ub,backendName:"cpu",kernelFunc:Ixe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rxe(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:a}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,[c,f]=X5(i,s.shape,s.dtype,o,r.shape,l,a.shape),d=n.makeTensorInfo([c.length],"int32",c),p=n.makeTensorInfo([f.length],s.dtype,f);return[d,p]}const Dxe={kernelName:jb,backendName:"cpu",kernelFunc:Rxe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oxe(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:a,defaultValue:i,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=s,c=n.data.get(r.dataId).values,f=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,p=o.map(x=>n.data.get(x.dataId).values),g=o.map(x=>x.shape),[y,v]=K5(c,r.shape,f,a.shape,a.dtype,d,i.shape,p,g,l);return n.makeTensorInfo(y,a.dtype,v)}const _xe={kernelName:Wb,backendName:"cpu",kernelFunc:Oxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fxe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:a,step:i}=n,o=Y5(s,r,i,a);return e.makeTensorInfo([o.length],a,o)}const Lxe={kernelName:Gb,backendName:"cpu",kernelFunc:Fxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mxe=Nt(Mh,t=>1/t),zxe={kernelName:Mh,backendName:"cpu",kernelFunc:Mxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pxe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:a,halfPixelCenters:i,size:o}=s;_e(r,"resizeBilinear");const l=Be(r.shape),[c,f]=o,[d,p,g,y]=r.shape,v=n.data.get(r.dataId).values,x=new Float32Array(de([d,c,f,y])),w=[a&&c>1?p-1:p,a&&f>1?g-1:g],T=[a&&c>1?c-1:c,a&&f>1?f-1:f];let N=0;const C=w[0]/T[0],E=w[1]/T[1];for(let R=0;R<d;R++)for(let $=0;$<c;$++){let O;i?O=C*($+.5)-.5:O=C*$;const A=Math.max(0,Math.floor(O)),_=O-A,D=Math.min(p-1,Math.ceil(O)),B=R*l[0]+A*l[1],j=R*l[0]+D*l[1];for(let W=0;W<f;W++){let X;i?X=E*(W+.5)-.5:X=E*W;const U=Math.max(0,Math.floor(X)),Y=X-U,Q=Math.min(g-1,Math.ceil(X)),ie=B+U*l[2],V=j+U*l[2],ee=B+Q*l[2],ce=j+Q*l[2];for(let ue=0;ue<y;ue++){const he=v[ie+ue],be=v[V+ue],we=v[ee+ue],Ie=v[ce+ue],ke=he+(we-he)*Y,Ae=be+(Ie-be)*Y,De=ke+(Ae-ke)*_;x[N++]=De}}}return n.makeTensorInfo([d,c,f,y],"float32",x)}const Bxe={kernelName:Dm,backendName:"cpu",kernelFunc:Pxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vxe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:a}=e,{alignCorners:i}=s;_e([a,r],"resizeBilinearGrad");const o=Be(r.shape),[l,c,f,d]=r.shape,[,p,g]=a.shape,y=new Float32Array(l*c*f*d),v=[i&&p>1?c-1:c,i&&g>1?f-1:f],x=[i&&p>1?p-1:p,i&&g>1?g-1:g],w=v[0]/x[0],T=v[1]/x[1],N=n.data.get(a.dataId).values;let C=0;for(let E=0;E<l;E++){const R=E*o[0];for(let $=0;$<p;$++){const O=$*w,A=Math.floor(O),_=Math.min(Math.ceil(O),c-1),D=R+A*o[1],B=R+_*o[1],j=O-A,W=1-j;for(let X=0;X<g;X++){const U=X*T,Y=Math.floor(U),Q=Math.min(Math.ceil(U),f-1),ie=U-Y,V=1-ie,ee=D+Y*o[2],ce=D+Q*o[2],ue=B+Y*o[2],he=B+Q*o[2],be=W*V,we=W*ie,Ie=j*V,ke=j*ie;for(let Ae=0;Ae<d;Ae++){const De=N[C++];y[ee+Ae]+=De*be,y[ce+Ae]+=De*we,y[ue+Ae]+=De*Ie,y[he+Ae]+=De*ke}}}}return n.makeTensorInfo([l,f,c,d],"float32",y)}const Uxe={kernelName:Xb,backendName:"cpu",kernelFunc:Vxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jxe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:a,halfPixelCenters:i,size:o}=s;_e(r,"resizeNearestNeighbor");const l=Be(r.shape),[c,f]=o,[d,p,g,y]=r.shape,v=n.data.get(r.dataId).values,x=new Float32Array(d*c*f*y),w=[a&&c>1?p-1:p,a&&f>1?g-1:g],T=[a&&c>1?c-1:c,a&&f>1?f-1:f],N=w[0]/T[0],C=w[1]/T[1];let E=0;for(let R=0;R<d;R++){const $=R*l[0];for(let O=0;O<c;O++){const A=i?N*(O+.5):N*O;let _=Math.min(p-1,a?Math.round(A):Math.floor(A));i&&(_=Math.max(0,_));const D=$+_*l[1];for(let B=0;B<f;B++){const j=i?C*(B+.5):C*B;let W=Math.min(g-1,a?Math.round(j):Math.floor(j));i&&(W=Math.max(0,W));const X=D+W*l[2];for(let U=0;U<y;U++){const Y=v[X+U];x[E++]=Y}}}}return n.makeTensorInfo([d,c,f,y],r.dtype,x)}const Wxe={kernelName:Rm,backendName:"cpu",kernelFunc:jxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gxe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:a}=e,{alignCorners:i}=s;_e([a,r],"resizeNearestNeighborGrad");const o=Be(r.shape),l=Be(a.shape),[c,f,d,p]=r.shape,[,g,y]=a.shape,v=new Float32Array(c*f*d*p),x=n.data.get(a.dataId).values,w=[i&&g>1?f-1:f,i&&y>1?d-1:d],T=[i&&g>1?g-1:g,i&&y>1?y-1:y],N=w[0]/T[0],C=w[1]/T[1],E=1/N,R=1/C,$=Math.ceil(E)*2+2,O=Math.ceil(R)*2+2;for(let A=0;A<c;A++){const _=A*o[0];for(let D=0;D<f;D++){const B=_+D*o[1],j=Math.floor(D*E),W=Math.floor(j-$/2);for(let X=0;X<d;X++){const U=B+X*o[2],Y=Math.floor(X*R),Q=Math.floor(Y-O/2);for(let ie=0;ie<p;ie++){let V=0;for(let ee=0;ee<$;ee++){const ce=ee+W;if(ce<0||ce>=g)continue;const ue=_+ce*l[1],he=ce*N,be=Math.min(f-1,i?Math.round(he):Math.floor(he));if(D===be)for(let we=0;we<O;we++){const Ie=we+Q;if(Ie<0||Ie>=y)continue;const ke=ue+Ie*l[2],Ae=Ie*C,De=Math.min(d-1,i?Math.round(Ae):Math.floor(Ae));X===De&&(V+=x[ke+ie])}}v[U+ie]=V}}}}return n.makeTensorInfo(r.shape,r.dtype,v)}const Hxe={kernelName:qb,backendName:"cpu",kernelFunc:Gxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:a}=s;_e(r,"reverse");const i=r.shape.length,o=nt(a,r.shape);if(i===0)return Ha({inputs:{x:r},backend:n});const l=new yn(r.shape,r.dtype),c=n.bufferSync(r);for(let f=0;f<l.size;f++){const d=l.indexToLoc(f),p=d.slice();o.forEach(g=>p[g]=r.shape[g]-1-p[g]),l.set(c.get(...p),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const Xxe={kernelName:Om,backendName:"cpu",kernelFunc:qxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kxe={kernelName:hx,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:a,center:i}=e,o=n,l=On(s.dtype,de(s.shape)),[c,f,d,p]=s.shape,[g,y]=gE(i,f,d),v=255,x=Math.sin(r),w=Math.cos(r),T=o.data.get(s.dataId).values;for(let C=0;C<c;C++){const E=C*d*f*p;for(let R=0;R<f;R++){const $=R*(d*p);for(let O=0;O<d;O++){const A=O*p;for(let _=0;_<p;_++){const D=[c,R,O,_],B=D[2],j=D[1];let W=(B-g)*w-(j-y)*x,X=(B-g)*x+(j-y)*w;W=Math.round(W+g),X=Math.round(X+y);let U=a;if(typeof a!="number"&&(_===3?U=v:U=a[_]),W>=0&&W<d&&X>=0&&X<f){const Q=X*(d*p),ie=W*p,V=E+Q+ie+_;U=T[V]}const Y=E+$+A+_;l[Y]=U}}}}return{dataId:o.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yxe=Nt(Bh,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),Zxe={kernelName:Bh,backendName:"cpu",kernelFunc:Yxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qxe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:a}=e,{shape:i}=s,{sliceRank:o,numUpdates:l,sliceSize:c,strides:f,outputSize:d}=nl(a,r,i),p=!0,g=n.bufferSync(r),y=n.bufferSync(a),v=Gl(g,y,i,d,c,l,o,f,0,p);return n.makeTensorInfo(i,v.dtype,v.values)}const Jxe={kernelName:Kb,backendName:"cpu",kernelFunc:Qxe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eve(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function tve(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function nve(t,e,n,s,r,a){const i=Zt("int32",n*r);for(let o=0;o<n;++o){const l=t.slice(o*s,(o+1)*s),c=o*r;for(let f=0;f<r;++f)i[c+f]=a==="left"?eve(l,e[f+c]):tve(l,e[f+c])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sve(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:a}=e,{side:i}=s,o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,c=nve(o,l,r.shape[0],r.shape[1],a.shape[1],i);return n.makeTensorInfo(a.shape,"int32",c)}const rve={kernelName:Zb,backendName:"cpu",kernelFunc:sve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ave(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:a}=e;_e([s,r,a],"select");const i=s.shape.length,o=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,f=As(r.dtype,a.dtype),d=qn(de(r.shape),f);let p=0;const g=i===0||i>1||r.shape.length===1?1:de(r.shape.slice(1));for(let y=0;y<o.length;y++)for(let v=0;v<g;v++)o[y]===1?d[p++]=l[y]:d[p++]=c[y];return n.makeTensorInfo(r.shape,f,d)}const ive={kernelName:_m,backendName:"cpu",kernelFunc:ave};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ove=tv,lve=nv,uve=Nt(Uh,t=>t>=0?lve*t:ove*(Math.exp(t)-1)),cve={kernelName:Uh,backendName:"cpu",kernelFunc:uve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hve=Nt(Gh,t=>t<0?-1:t>0?1:0),fve={kernelName:Gh,backendName:"cpu",kernelFunc:hve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dve=Nt(jh,t=>Math.sin(t)),pve={kernelName:jh,backendName:"cpu",kernelFunc:dve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mve=Nt(Wh,t=>Math.sinh(t)),gve={kernelName:Wh,backendName:"cpu",kernelFunc:mve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yve=11920928955078125e-23,wF=Math.log(yve)+2,bve=Nt(qh,t=>{const e=t>-wF,n=t<wF,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),xve={kernelName:qh,backendName:"cpu",kernelFunc:bve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:a,paddings:i}=s;_e([r],"spaceToBatchND");const o=de(a),l=[[0,0]];l.push(...i);for(let R=1+a.length;R<r.shape.length;++R)l.push([0,0]);const c=AU.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),f=cg(c.shape,a,o,!1),d=hg(f.length,a.length,!1),p=fg(c.shape,a,o,!1),v=Lt({inputs:{x:c},backend:n,attrs:{shape:f}}),T=Fs({inputs:{x:v},backend:n,attrs:{perm:d}}),E=Lt({inputs:{x:T},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(T),E}const wve={kernelName:Mm,backendName:"cpu",kernelFunc:vve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sve(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:a,defaultValue:i}=e;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const o=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,f=n.data.get(i.dataId).values[0],[d,p,g,y,v]=eU(o,s.shape,s.dtype,l,r.dtype,c,f);return[n.makeTensorInfo(p,s.dtype,d),n.makeTensorInfo([p[0]],r.dtype,g),n.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(x=>Number(x)))),n.makeTensorInfo([v.length],s.dtype,new Int32Array(v))]}const Tve={kernelName:Qb,backendName:"cpu",kernelFunc:Sve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cve(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:a}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const i=Array.from(n.data.get(r.dataId).values),o=n.data.get(s.dataId).values,l=Array.from(n.data.get(a.dataId).values),[c,f,d]=tU(o,s.shape,s.dtype,i,l);return[n.makeTensorInfo(f,s.dtype,c),n.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}const Nve={kernelName:Jb,backendName:"cpu",kernelFunc:Cve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kve(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,[c,f]=bI(i,s.shape,s.dtype,o,l,!0);return n.makeTensorInfo(f,s.dtype,c)}const Eve={kernelName:ex,backendName:"cpu",kernelFunc:kve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ve(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,[c,f]=bI(i,s.shape,s.dtype,o,l);return n.makeTensorInfo(f,s.dtype,c)}const Ive={kernelName:tx,backendName:"cpu",kernelFunc:$ve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ave(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:a,defaultValue:i}=e,{outputShape:o}=s,{sliceRank:l,numUpdates:c,sliceSize:f,strides:d,outputSize:p}=nl(a,r,o),g=!1,y=n.bufferSync(r);let v;switch(a.dtype){case"bool":{const x=n.bufferSync(a),w=!!n.data.get(i.dataId).values[0];v=Gl(y,x,o,p,f,c,l,d,w,g);break}case"float32":{const x=n.bufferSync(a),w=n.data.get(i.dataId).values[0];v=Gl(y,x,o,p,f,c,l,d,w,g);break}case"int32":{const x=n.bufferSync(a),w=n.data.get(i.dataId).values[0];v=Gl(y,x,o,p,f,c,l,d,w,g);break}case"string":{const x=n.bufferSync(a),w=Ri(n.data.get(i.dataId).values[0]);v=Gl(y,x,o,p,f,c,l,d,w,g);break}default:throw new Error(`Unsupported type ${a.dtype}`)}return n.makeTensorInfo(o,v.dtype,v.values)}const Rve={kernelName:nx,backendName:"cpu",kernelFunc:Ave};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:a,axis:i}=s,o=nt(i,r.shape)[0],l=RE(r,a,o),c=new Array(r.shape.length).fill(0),f=r.shape.slice();return l.map(d=>{const p=[...f];p[o]=d;const g=gu({inputs:{x:r},backend:n,attrs:{begin:c,size:p}});return c[o]+=d,g})}const Ove={kernelName:zm,backendName:"cpu",kernelFunc:Dve};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ve={kernelName:sx,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;_e(n,"square");const r=s.data.get(n.dataId).values,a=new Float32Array(r.length);for(let o=0;o<r.length;++o){const l=r[o];a[o]=l*l}return{dataId:s.write(a,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fve=Nt(ef,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),Lve={kernelName:ef,backendName:"cpu",kernelFunc:Fve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:a,end:i,strides:o,beginMask:l,endMask:c,ellipsisMask:f,newAxisMask:d,shrinkAxisMask:p}=s;_e(r,"stridedSlice");const{finalShapeSparse:g,finalShape:y,isIdentity:v,sliceDim0:x,isSimpleSlice:w,begin:T,end:N,strides:C}=fE(r.shape,a,i,o,l,c,f,d,p);let E;if(v)E=Lt({inputs:{x:r},backend:n,attrs:{shape:y}});else if(x||w){M(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const R=uE(T,N,C),$=gu({inputs:{x:r},backend:n,attrs:{begin:T,size:R}});E=Lt({inputs:{x:$},backend:n,attrs:{shape:y}}),n.disposeIntermediateTensorInfo($)}else{const R=n.bufferSync(r),$=rU(g,R,C,T);E=n.makeTensorInfo(y,$.dtype,$.values)}return E}const zve={kernelName:rx,backendName:"cpu",kernelFunc:Mve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pve(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:a,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:c}=s,{data:f,dataSplits:d}=e,p=n.data.get(f.dataId).values,g=n.data.get(d.dataId).values,[y,v]=aU(p,g,r,a,i,o,l,c);return[n.makeTensorInfo([y.length],"string",y),n.makeTensorInfo(d.shape,"int32",v)]}const Bve={kernelName:ax,backendName:"cpu",kernelFunc:Pve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vve(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:a,delimiter:i}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const o=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values[0],[c,f,d]=iU(o,l,r),p=f.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",f),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Uve={kernelName:ix,backendName:"cpu",kernelFunc:Vve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jve(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=n.data.get(a.dataId).values,o=oU(i,r);return n.makeTensorInfo(a.shape,"int32",o)}const Wve={kernelName:ox,backendName:"cpu",kernelFunc:jve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gve=Nt(Zh,t=>Math.tan(t)),Hve={kernelName:Zh,backendName:"cpu",kernelFunc:Gve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qve=Nt(Qh,t=>Math.tanh(t)),Xve={kernelName:Qh,backendName:"cpu",kernelFunc:qve};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kve(t){const{inputs:e,backend:n}=t,{tensor:s,indices:r,updates:a}=e,{sliceRank:i,numUpdates:o,sliceSize:l,strides:c,outputSize:f}=nl(a,r,s.shape),d=!1,p=n.bufferSync(r),g=n.bufferSync(a),y=n.bufferSync(s),v=Gl(p,g,s.shape,f,l,o,i,c,y,d);return n.makeTensorInfo(s.shape,v.dtype,v.values)}const Yve={kernelName:Yb,backendName:"cpu",kernelFunc:Kve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:a}=s;_e(r,"tile");const i=uU(n.bufferSync(r),a);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const Qve={kernelName:Jh,backendName:"cpu",kernelFunc:Zve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:a,sorted:i}=s;_e(r,"topk");const o=n.data.get(r.dataId).values,[l,c]=hU(o,r.shape,r.dtype,a,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const ewe={kernelName:lx,backendName:"cpu",kernelFunc:Jve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function twe(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:a}=e,{interpolation:i,fillMode:o,fillValue:l,outputShape:c}=n,[f,d,p,g]=r.shape,[y,v]=c??[d,p],x=[f,y,v,g],w=Be(r.shape),T=w[0],N=w[1],C=w[2],E=Be(x),R=E[0],$=E[1],O=E[2],A=On(r.dtype,de(x));A.fill(l);const _=s.data.get(r.dataId).values,D=s.data.get(a.dataId).values;for(let j=0;j<f;++j){const W=a.shape[0]===1?D:D.subarray(j*8,j*8+8);for(let X=0;X<y;++X)for(let U=0;U<v;++U)for(let Y=0;Y<g;++Y){let Q;const ie=W[6]*U+W[7]*X+1;if(ie===0)continue;const V=(W[0]*U+W[1]*X+W[2])/ie,ee=(W[3]*U+W[4]*X+W[5])/ie,ce=SF(V,p,o),ue=SF(ee,d,o);switch(i){case"nearest":Q=owe(_,d,p,T,N,C,j,ue,ce,Y,l);break;case"bilinear":Q=lwe(_,d,p,T,N,C,j,ue,ce,Y,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const he=j*R+X*$+U*O+Y;A[he]=Q}return s.makeTensorInfo(x,r.dtype,A)}return{dataId:s.write(A,x,r.dtype),shape:r.shape,dtype:r.dtype}}const nwe={kernelName:ux,backendName:"cpu",kernelFunc:twe};function SF(t,e,n){switch(n){case"reflect":return swe(t,e);case"wrap":return rwe(t,e);case"nearest":return iwe(t,e);case"constant":default:return awe(t)}}function swe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return Lo(0,n,e-1)}function rwe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return Lo(0,n,e-1)}function awe(t,e){return t}function iwe(t,e){return Lo(0,t,e-1)}function Vd(t,e,n,s,r,a,i,o,l,c,f){const d=i*s+o*r+l*a+c;return 0<=o&&o<e&&0<=l&&l<n?t[d]:f}function owe(t,e,n,s,r,a,i,o,l,c,f){const d=Math.round(o),p=Math.round(l);return Vd(t,e,n,s,r,a,i,d,p,c,f)}function lwe(t,e,n,s,r,a,i,o,l,c,f){const d=Math.floor(o),p=Math.floor(l),g=d+1,y=p+1,v=(y-l)*Vd(t,e,n,s,r,a,i,d,p,c,f)+(l-p)*Vd(t,e,n,s,r,a,i,d,y,c,f),x=(y-l)*Vd(t,e,n,s,r,a,i,g,p,c,f)+(l-p)*Vd(t,e,n,s,r,a,i,g,y,c,f);return(g-o)*v+(o-d)*x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uwe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:a}=e;_e(a,"unique");const i=s.data.get(a.dataId).values,{outputValues:o,outputShape:l,indices:c}=fU(i,r,a.shape,a.dtype);return[s.makeTensorInfo(l,a.dtype,o),s.makeTensorInfo([c.length],"int32",c)]}const cwe={kernelName:cx,backendName:"cpu",kernelFunc:uwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hwe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:a}=s;a<0&&(a+=r.shape.length);const i=r.shape.length,o=r.shape[a],l=new Array(i-1);let c=0;for(let g=0;g<i;g++)g!==a&&(l[c++]=r.shape[g]);const f=new Array(i).fill(0),d=r.shape.slice();d[a]=1;const p=new Array(o);for(let g=0;g<p.length;g++){f[a]=g;const y=gu({inputs:{x:r},backend:n,attrs:{begin:f,size:d}});p[g]=Lt({inputs:{x:y},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(y)}return p}const fwe={kernelName:Vm,backendName:"cpu",kernelFunc:hwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:a}=e,{numSegments:i}=s;_e(r,"unsortedSegmentSum");const o=r.shape.length,l=a.shape.length,c=[],f=[],d=o-l;let p=a;for(let y=0;y<d;++y){const v=P1({inputs:{input:p},backend:n,attrs:{dim:y+1}});p=v,f.push(v)}for(let y=0;y<i;++y){const v=Vi(y,"int32"),x=n.makeTensorInfo([],"int32",v),w=E5({inputs:{a:x,b:p},backend:n}),T=Ho({inputs:{x:w},backend:n,attrs:{dtype:"float32"}}),N=Cv({inputs:{a:T,b:r},backend:n}),C=Tg({inputs:{x:N},backend:n,attrs:{axis:0,keepDims:!1}});c.push(C),f.push(x),f.push(w),f.push(T),f.push(N),f.push(C)}const g=IU({inputs:c,backend:n,attrs:{axis:0}});return f.forEach(y=>n.disposeIntermediateTensorInfo(y)),g}const pwe={kernelName:Um,backendName:"cpu",kernelFunc:dwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mwe=[q0e,$ge,K0e,Z0e,_ge,J0e,tye,sye,aye,oye,uye,hye,dye,gye,bye,wye,Tye,Nye,Eye,G0e,Iye,Rye,Oye,Lge,Fye,Dge,zge,Mye,Ige,Pye,Vye,Uye,Wye,Hye,Xye,Yye,Qye,e1e,n1e,r1e,i1e,l1e,c1e,f1e,d1e,m1e,y1e,x1e,v1e,w1e,S1e,C1e,E1e,z0e,I1e,Pge,M1e,Bge,z1e,Uge,W1e,G1e,q1e,Wge,Hge,K1e,Z1e,J1e,tbe,Xge,Yge,Age,sbe,Bye,abe,obe,ube,P0e,Qge,e0e,hbe,n0e,dbe,gbe,bbe,wbe,Tbe,Nbe,kbe,r0e,$be,Abe,Dbe,_be,Lbe,zbe,Bbe,i0e,Ube,Gbe,cxe,l0e,c0e,dxe,gxe,xxe,f0e,wxe,Txe,Cxe,AU,$xe,V0e,m0e,Axe,Dxe,_xe,Lxe,Rge,gC,zxe,U0e,j0e,W0e,Bxe,Uxe,Wxe,Hxe,Xxe,Kxe,Zxe,T0e,Jxe,rve,ive,cve,N0e,fve,pve,gve,k0e,lxe,xve,wve,Tve,Nve,Eve,Ive,Rve,Ove,I0e,_ve,R0e,O0e,Lve,zve,Bve,Uve,Wve,M0e,N1e,Hve,Xve,Yve,Qve,ewe,nwe,d0e,cwe,fwe,pwe,Sxe];for(const t of mwe)fx(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bl={},ry={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function RU(t,e){Bl[t]=e}function da(t,e){if(!(t in Bl)||e!=null){const s=ywe(t,e);if(s!==null)Bl[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=Bl[t];return n==null||n.isContextLost()?(delete Bl[t],da(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Bl[t])}function gwe(t){if(!ae().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function ywe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??gwe(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete Bl[t]},!1),ae().getBool("SOFTWARE_WEBGL_ENABLED")&&(ry.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",ry)||n.getContext("experimental-webgl",ry):n.getContext("webgl2",ry)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Np;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Np||(Np={}));var hr;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(hr||(hr={}));var Gn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Gn||(Gn={}));function Cg(t,e){return[e,t]}function bwe(t,e){return t*e}function ay(t){const e=de(t),n=Math.ceil(e/4);return p1(n)}function mf(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function xwe(t,e){const[n,s]=mf(t,e);return n*s*4}function TI(t,e){const n=t;let s,r,a,i,o,l,c,f,d,p;return ae().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,a=n.RGBA16F,i=n.RGBA32F,o=n.RED,c=4,f=1,d=n.HALF_FLOAT,p=n.FLOAT,l=n.RGBA8):(s=t.RGBA,r=t.RGBA,a=t.RGBA,i=n.RGBA,o=t.RGBA,c=4,f=4,d=e!=null?e.HALF_FLOAT_OES:null,p=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:f,textureTypeHalfFloat:d,textureTypeFloat:p}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $e(t,e){const n=e();return ae().getBool("DEBUG")&&vwe(t),n}function vwe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+OU(t,e))}const wwe=596e-10,Swe=65504;function DU(t){return!!(ae().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||wwe<Math.abs(t)&&Math.abs(t)<Swe)}function OU(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Ud(t,e){return Xi(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function _U(t,e){const n=Xi(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if($e(t,()=>t.shaderSource(n,e)),$e(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function FU(t,e){const n=Xi(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if($e(t,()=>t.shaderSource(n,e)),$e(t,()=>t.compileShader(n)),ae().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw CI(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const Twe=/ERROR: [0-9]+:([0-9]+):/g;function CI(t,e){const n=Twe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),a=r.length.toString().length+2,i=r.map((d,p)=>Xl((p+1).toString(),a)+d);let o=0;for(let d=0;d<i.length;d++)o=Math.max(i[d].length,o);const l=i.slice(0,s-1),c=i.slice(s-1,s),f=i.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Xl(c[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join(`
`))}function LU(t){return Xi(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function MU(t,e){if($e(t,()=>t.linkProgram(e)),!ae().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function By(t,e){if($e(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function zU(t,e){const n=Xi(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return $e(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),$e(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function PU(t,e){const n=Xi(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return $e(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),$e(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Cwe(){return ae().getNumber("WEBGL_VERSION")===2?1:4}function BU(t){return Xi(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function VU(t,e){const n=ae().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function UU(t){return Xi(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function bC(t,e,n,s,r,a,i){const o=t.getAttribLocation(e,n);return o===-1?!1:($e(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),$e(t,()=>t.vertexAttribPointer(o,r,t.FLOAT,!1,a,i)),$e(t,()=>t.enableVertexAttribArray(o)),!0)}function jU(t,e,n){XU(t,n),$e(t,()=>t.activeTexture(t.TEXTURE0+n)),$e(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function Nwe(t,e){XU(t,e),$e(t,()=>t.activeTexture(t.TEXTURE0+e)),$e(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function WU(t,e,n){return Xi(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function GU(t,e,n){return t.getUniformLocation(e,n)}function HU(t,e,n,s){$e(t,()=>jU(t,e,s)),$e(t,()=>t.uniform1i(n,s))}function kwe(t){$e(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),$e(t,()=>t.viewport(0,0,t.canvas.width,t.canvas.height)),$e(t,()=>t.scissor(0,0,t.canvas.width,t.canvas.height))}function Vy(t,e,n){$e(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),$e(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function xC(t,e){$e(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),$e(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function jd(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+qU(t,e))}function qU(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Xi(t,e,n){const s=$e(t,()=>e());if(s==null)throw new Error(n);return s}function XU(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function yu(t,e=2){return de(t.slice(0,t.length-e))}function bu(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Wd(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[yu(t),...bu(t)]),e}function KU(t,e=!1){let n=ae().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=ae().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&ae().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((o,l)=>l>=t.length-2?ab(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Bi(t).newShape);let r=de(t),a=null;t.length<=1&&r<=n?a=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?a=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?a=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?a=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?a=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(a=[t[0],t[1]*t[2]*t[3]]);const i=a!=null&&Math.max(...a)>s&&Math.min(...a)<=(e?2:1)&&Math.min(...a)>0;if(a==null||i)if(e){const o=yu(t);let l=2,c=2;t.length&&([l,c]=bu(t)),r=o*(l/2)*(c/2),a=p1(r).map(f=>f*2)}else a=p1(r);return a}function iy(t){return t%2===0}function kp(t,e){if(t=t.slice(-2),e=e.slice(-2),at(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||iy(n)&&iy(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&iy(t[0])&&iy(e[0])}let Uy,jy;function YU(t){if(Uy==null){const e=da(t);Uy=e.getParameter(e.MAX_TEXTURE_SIZE)}return Uy}function Ewe(){Uy=null}function $we(){jy=null}function ZU(t){if(jy==null){const e=da(t);jy=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,jy)}function QU(t){if(t===0)return 0;let e;const n=da(t);return fr(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:fr(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function fr(t,e){return t.getExtension(e)!=null}function vC(t){try{if(da(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function JU(t){if(t===0)return!1;const e=da(t);if(t===1){if(!fr(e,"OES_texture_float"))return!1}else if(!fr(e,"EXT_color_buffer_float"))return!1;return wC(e)}function e8(t){if(t===0)return!1;const e=da(t);if(t===1){if(!fr(e,"OES_texture_float")||!fr(e,"WEBGL_color_buffer_float"))return!1}else{if(fr(e,"EXT_color_buffer_float"))return wC(e);const s="EXT_color_buffer_half_float";if(fr(e,s)){const r=e.getExtension(s);return Iwe(e,r)}return!1}return wC(e)}function wC(t){const e=TI(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const a=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,a),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(a),i}function Iwe(t,e){const n=TI(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(i),o}function t8(t){return t!==2?!1:da(t).fenceSync!=null}function gf(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&M(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}const Awe=Object.freeze(Object.defineProperty({__proto__:null,assertNotComplex:gf,bindCanvasToFramebuffer:kwe,bindColorTextureToFramebuffer:Vy,bindTextureToProgramUniformSampler:HU,bindTextureUnit:jU,bindVertexBufferToProgramAttribute:bC,callAndCheck:$e,canBeRepresented:DU,createFragmentShader:FU,createFramebuffer:UU,createProgram:LU,createStaticIndexBuffer:PU,createStaticVertexBuffer:zU,createTexture:BU,createVertexShader:_U,getBatchDim:yu,getExtensionOrThrow:Ud,getFramebufferErrorMessage:qU,getMaxTexturesInShader:ZU,getNumChannels:Cwe,getProgramUniformLocation:GU,getProgramUniformLocationOrThrow:WU,getRowsCols:bu,getShapeAs3D:Wd,getTextureShapeFromLogicalShape:KU,getWebGLDisjointQueryTimerVersion:QU,getWebGLErrorMessage:OU,getWebGLMaxTextureSize:YU,hasExtension:fr,isCapableOfRenderingToFloatTexture:JU,isDownloadFloatTextureEnabled:e8,isReshapeFree:kp,isWebGLFenceEnabled:t8,isWebGLVersionEnabled:vC,linkProgram:MU,logShaderSourceAndInfoLog:CI,resetMaxTextureSize:Ewe,resetMaxTexturesInShader:$we,unbindColorTextureFromFramebuffer:xC,unbindTextureUnit:Nwe,validateFramebuffer:jd,validateProgram:By,validateTextureSize:VU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Me=ae();Me.registerFlag("HAS_WEBGL",()=>Me.getNumber("WEBGL_VERSION")>0);Me.registerFlag("WEBGL_VERSION",()=>vC(2)?2:vC(1)?1:0);Me.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Me.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Me.get("WEBGL_VERSION")===2);Me.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Me.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Me.registerFlag("WEBGL_PACK",()=>Me.getBool("HAS_WEBGL"));Me.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_CLIP",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_REDUCE",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_LAZILY_UNPACK",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_CONV_IM2COL",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>YU(Me.getNumber("WEBGL_VERSION")));Me.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>ZU(Me.getNumber("WEBGL_VERSION")));Me.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Me.getNumber("WEBGL_VERSION");return t===0?0:QU(t)});Me.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Me.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!zN());Me.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>JU(Me.getNumber("WEBGL_VERSION")));Me.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Me.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Me.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Me.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>e8(Me.getNumber("WEBGL_VERSION")));Me.registerFlag("WEBGL_FENCE_API_ENABLED",()=>t8(Me.getNumber("WEBGL_VERSION")));Me.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Me.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Me.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Me.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>zN()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Me.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Me.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Me.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Me.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Me.registerFlag("WEBGL_EXP_CONV",()=>!1);Me.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Me.getBool("IS_TEST"));Me.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Me.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Me.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Me.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ws(){let t,e,n,s,r,a,i,o,l,c;return ae().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",a="outputColor",i="out vec4 outputColor;",o=ae().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",a="gl_FragColor",i="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:a,defineOutput:i,defineSpecialNaN:o,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _u(t,e,n="index"){const s=Be(e);return s.map((r,a)=>{const i=`int ${t[a]} = ${n} / ${r}`,o=a===s.length-1?`int ${t[a+1]} = ${n} - ${t[a]} * ${r}`:`index -= ${t[a]} * ${r}`;return`${i}; ${o};`}).join("")}function Nv(t,e,n="index"){const s=Be(e);return s.map((r,a)=>{const i=`int ${t[a]} = ${n} / outShapeStrides[${a}]`,o=a===s.length-1?`int ${t[a+1]} = ${n} - ${t[a]} * outShapeStrides[${a}]`:`index -= ${t[a]} * outShapeStrides[${a}]`;return`${i}; ${o};`}).join("")}function Rwe(t,e){const n=t.length,s=t.map(a=>`${e}[${a}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let a=n-3;a>=0;--a)r[a]=`(${r[a+1]} * ${s[a+1]})`;return r}function Dwe(t,e,n="index"){const s=t.map((a,i)=>i),r=Rwe(s,e);return r.map((a,i)=>{const o=`int ${t[i]} = ${n} / ${r[i]}`,l=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${r[i]}`:`index -= ${t[i]} * ${r[i]}`;return`${o}; ${l};`}).join("")}function NI(t){const e=Be(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function kI(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const n8=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:s8}=LB;function Owe(t,e,n){const s=[];if(t.forEach(g=>{const y=de(g.shapeInfo.logicalShape);if(g.shapeInfo.isUniform?s.push(`uniform float ${g.name}${y>1?`[${y}]`:""};`):(s.push(`uniform sampler2D ${g.name};`),s.push(`uniform int offset${g.name};`)),n.enableShapeUniforms){const{uniformShape:v}=EI(n.packedInputs,g.shapeInfo.logicalShape,g.shapeInfo.texShape);switch(v.length){case 1:s.push(`uniform int ${g.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${g.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${g.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${g.name}Shape;`);break}s.push(`uniform ivec2 ${g.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(g=>{s.push(`uniform ${g.type} ${g.name}${g.arrayIndex?`[${g.arrayIndex}]`:""};`)});const r=s.join(`
`),a=t.map(g=>_we(g,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,o=ws(),l=Mwe(o);let c,f,d=Bwe(o);return e.isPacked?(c=Fwe(e.logicalShape,i,n.enableShapeUniforms),f=Pwe(o)):(c=Lwe(e.logicalShape,i,n.enableShapeUniforms),f=zwe(o)),n.packedInputs&&(d+=Wwe),[d,l,f,r,c,a,n.userCode].join(`
`)}function yf(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return n2e(t,e);case 1:return r2e(t,e);case 2:return i2e(t,e);case 3:return l2e(t,e);case 4:return c2e(t,e);case 5:return h2e(t);case 6:return f2e(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function r8(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return t2e(t);case 1:return s2e(t,e);case 2:return a2e(t,e);case 3:return o2e(t,e);default:return u2e(t,e)}}function _we(t,e,n=!1,s){let r="";n?r+=r8(t,s):r+=yf(t,s);const a=t.shapeInfo.logicalShape,i=e.logicalShape;return a.length<=i.length&&(n?r+=d2e(t,e):r+=p2e(t,e)),r}function Fwe(t,e,n){switch(t.length){case 0:return a8();case 1:return Gwe(t,e,n);case 2:return Jwe(t,e,n);case 3:return qwe(t,e,n);default:return Kwe(t,e,n)}}function Lwe(t,e,n){switch(t.length){case 0:return a8();case 1:return Hwe(t,e,n);case 2:return e2e(t,e,n);case 3:return Xwe(t,e,n);case 4:return Ywe(t,e,n);case 5:return Zwe(t,e);case 6:return Qwe(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function Mwe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function zwe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function Pwe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function Bwe(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Vwe}
    ${Uwe}
    ${jwe}
  `}const Vwe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Uwe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,jwe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Wwe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function a8(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Gwe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function Hwe(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function qwe(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),a=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function Xwe(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Nv(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=_u(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function Kwe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),a=r*Math.ceil(t[t.length-2]/2);let i=a,o="",l="b, r, c";for(let c=2;c<t.length-1;c++)i*=t[t.length-c-1],o=`
      int b${c} = index / ${i};
      index -= b${c} * ${i};
    `+o,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${o}

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${l});
    }
  `}function Ywe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Nv(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=_u(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function Zwe(t,e){const n=_u(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Qwe(t,e){const n=_u(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Jwe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(at(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function e2e(t,e,n){return at(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Fu(t){return`offset${t}`}function t2e(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=ws();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function n2e(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,a]=t.shapeInfo.texShape;if(r===1&&a===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=Fu(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[o,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function s2e(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,a=ws();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${a.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${a.texture2D}(${n}, uv);
    }
  `}function r2e(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${bf(t)}
      }
    `;const r=t.shapeInfo.texShape,a=r[0],i=r[1];if(i===1&&a===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Fu(n);return i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${a}.0);
        return sampleTexture(${n}, uv);
      }
    `:a===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${o});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${a}, ${i}, index + ${o});
      return sampleTexture(${n}, uv);
    }
  `}function a2e(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=t.shapeInfo.texShape,i=a[0],o=a[1],l=ws();if(a!=null&&at(n,a))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${i}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],f=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${f}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function i2e(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=t.shapeInfo.texShape;if(a!=null&&at(n,a)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const p=a[0],g=a[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${g}.0, ${p}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:o}=Bi(n),l=i;if(l.length<n.length){const p=xf(t,l),g=["row","col"];return`
      ${yf(p,e)}
      float ${r}(int row, int col) {
        return ${r}(${vf(g,o)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${bf(t)}
      }
    `;const c=a[0],f=a[1],d=Fu(s);return f===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${f}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${f}, index);
    return sampleTexture(${s}, uv);
  }
`}function o2e(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=t.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(n[0]===1){const p=n.slice(1),g=[1,2],y=xf(t,p),v=["b","row","col"];return`
        ${r8(y,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${vf(v,g)});
        }
      `}const o=ws();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${s}, uv);
    }
  `;const l=i[0],c=i[1],f=Math.ceil(n[2]/2),d=f*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${f}, b, row, col);
      return ${o.texture2D}(${s}, uv);
    }
  `}function l2e(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n[1]*n[2],i=n[2],{newShape:o,keptDims:l}=Bi(n),c=o;if(c.length<n.length){const v=xf(t,c),x=["row","col","depth"];return`
        ${yf(v,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${vf(x,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${a}, ${i}, 1)));
        ${bf(t)}
      }
    `;const f=t.shapeInfo.texShape,d=f[0],p=f[1],g=t.shapeInfo.flatOffset;if(p===a&&g==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(p===i&&g==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const y=Fu(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${y};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${a} + col * ${i} + depth + ${y};
        vec2 uv = uvFromFlat(${d}, ${p}, index);
        return sampleTexture(${s}, uv);
      }
  `}function u2e(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=ws();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const a=t.shapeInfo.logicalShape,i=a.length,o=t.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=l[0],f=l[1],d=Math.ceil(a[i-1]/2);let p=d*Math.ceil(a[i-2]/2),g="int b, int row, int col",y=`b * ${p} + (row / 2) * ${d} + (col / 2)`;for(let v=2;v<i-1;v++)g=`int b${v}, `+g,p*=a[i-v-1],y=`b${v} * ${p} + `+y;return`
    vec4 ${s}(${g}) {
      int index = ${y};
      int texR = index / ${f};
      int texC = index - texR * ${f};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}, ${c});
      return ${r.texture2D}(${n}, uv);
    }
  `}function c2e(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n[3],i=n[2]*a,o=n[1]*i,{newShape:l,keptDims:c}=Bi(n);if(l.length<n.length){const T=xf(t,l),N=["row","col","depth","depth2"];return`
      ${yf(T,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${vf(N,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${i}, ${a}, 1)));
        ${bf(t)}
      }
    `;const f=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],g=d[1],y=`int stride2 = ${s}Shape[3];`,v=`int stride1 = ${s}Shape[2] * stride2;`,x=`int stride0 = ${s}Shape[1] * stride1;`;if(g===o&&f==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${y}
        ${v}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${p}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(g===a&&f==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${p}.0);
        return sampleTexture(${s}, uv);
      }
    `;const w=Fu(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${y}
      ${v}
      ${x}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${w});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${i} +
          depth * ${a} + depth2;
      vec2 uv = uvFromFlat(${p}, ${g}, index + ${w});
      return sampleTexture(${s}, uv);
    }
  `}function h2e(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],a=e[3]*r,i=e[2]*a,o=e[1]*i,{newShape:l,keptDims:c}=Bi(e);if(l.length<e.length){const v=xf(t,l),x=["row","col","depth","depth2","depth3"];return`
      ${yf(v)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${vf(x,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${i}, ${a}, ${r})) +
          depth3;
        ${bf(t)}
      }
    `;const f=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],g=d[1];if(g===o&&f==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${a}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(g===r&&f==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const y=Fu(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${i} + depth * ${a} +
          depth2 * ${r} + depth3 + ${y};
      vec2 uv = uvFromFlat(${p}, ${g}, index);
      return sampleTexture(${n}, uv);
    }
  `}function f2e(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:a}=Bi(e);if(r.length<e.length){const x=xf(t,r),w=["row","col","depth","depth2","depth3","depth4"];return`
      ${yf(x)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${vf(w,a)});
      }
    `}const i=e[5],o=e[4]*i,l=e[3]*o,c=e[2]*l,f=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${f}, ${c}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${bf(t)}
      }
    `;const d=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,g=p[0],y=p[1];if(y===f&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${o}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}.0, ${g}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(y===i&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}.0, ${g}.0);
        return sampleTexture(${n}, uv);
      }
    `;const v=Fu(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${f} + col * ${c} + depth * ${l} +
          depth2 * ${o} + depth3 * ${i} + depth4 + ${v};
      vec2 uv = uvFromFlat(${g}, ${y}, index);
      return sampleTexture(${n}, uv);
    }
  `}function bf(t){const e=t.name,n=de(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function d2e(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",a=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,o=s8(t.shapeInfo.logicalShape,e.logicalShape),l=Et(i),c=i-a;let f;const d=["x","y","z","w","u","v"];a===0?f="":i<2&&o.length>=1?f="coords = 0;":f=o.map(T=>`coords.${d[T+c]} = 0;`).join(`
`);let p="";i<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((T,N)=>`coords.${d[N+c]}`).join(", ");let g="return outputValue;";const v=de(t.shapeInfo.logicalShape)===1,w=de(e.logicalShape)===1;if(a===1&&!v&&!w)g=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(v&&!w)i===1?g=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:g=`
        return vec4(outputValue.x);
      `;else if(o.length){const T=a-2,N=a-1;o.indexOf(T)>-1&&o.indexOf(N)>-1?g="return vec4(outputValue.x);":o.indexOf(T)>-1?g="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(N)>-1&&(g="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${f}
      vec4 outputValue = get${s}(${p});
      ${g}
    }
  `}function p2e(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",a=e.texShape,i=t.shapeInfo.texShape,o=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&o===l&&t.shapeInfo.flatOffset==null&&at(i,a))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=Et(l),f=s8(t.shapeInfo.logicalShape,e.logicalShape),d=l-o;let p;const g=["x","y","z","w","u","v"];o===0?p="":l<2&&f.length>=1?p="coords = 0;":p=f.map(v=>`coords.${g[v+d]} = 0;`).join(`
`);let y="";return l<2&&o>0?y="coords":y=t.shapeInfo.logicalShape.map((v,x)=>`coords.${g[x+d]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${p}
      return get${s}(${y});
    }
  `}function Et(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function EI(t,e,n){const{newShape:s,keptDims:r}=Bi(e),a=e.length,i=t&&a===3&&e[0]===1,o=i?e.slice(1):s,l=!t&&a>1&&!at(e,n)&&s.length<a||i;return{useSqueezeShape:l,uniformShape:l?o:e,keptDims:r}}function xf(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function vf(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m2e(t,e,n,s){const r=n.map((f,d)=>{const p={logicalShape:f.shape,texShape:f.isUniform?null:f.texData.texShape,isUniform:f.isUniform,isPacked:f.isUniform?!1:f.texData.isPacked,flatOffset:null};return f.texData!=null&&f.texData.slice!=null&&f.texData.slice.flatOffset>0&&(p.flatOffset=f.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:p}}),a=r.map(f=>f.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},o=Owe(r,i,e),l=FU(t.gl,o),c=t.createProgram(l);return ae().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:a,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:e,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:a,outShapeInfo:i},i8(t,e,c)))}function i8(t,e,n){const s=[],r=[];let a,i,o,l=null,c=null;c=t.getUniformLocation(n,"NAN",!1),ae().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const f=!1;for(const d of e.variableNames){const p={name:d,uniform:t.getUniformLocation(n,d,f),offset:t.getUniformLocation(n,`offset${d}`,f)};e.enableShapeUniforms&&(p.shape=t.getUniformLocation(n,`${d}Shape`,f),p.texShape=t.getUniformLocation(n,`${d}TexShape`,f)),s.push(p)}if(e.enableShapeUniforms&&(a=t.getUniformLocation(n,"outShape",f),o=t.getUniformLocation(n,"outShapeStrides",f),i=t.getUniformLocation(n,"outTexShape",f)),e.customUniforms)for(const d of e.customUniforms)r.push(t.getUniformLocation(n,d.name,f));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:i}}function TF(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,a=e[s],i=a.shape;if(!at(r,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${i} must match`);if(n.isUniform&&a.isUniform)return;const o=n.texShape,l=a.isUniform?null:a.texData.texShape;if(!at(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function g2e(t,e,n,s,r){e.program.enableShapeUniforms||(TF(e.inShapeInfos,n),TF([e.outShapeInfo],[s]));const a=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(a.texture,i[0],i[1]):t.setOutputMatrixTexture(a.texture,i[0],i[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),ae().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:f,offset:d,shape:p,texShape:g}=e.variablesLocations[l];if(p){const{uniformShape:y}=EI(e.program.packedInputs,c.shape,c.texData.texShape);switch(y.length){case 1:t.gl.uniform1iv(p,new Int32Array(y));break;case 2:t.gl.uniform2iv(p,new Int32Array(y));break;case 3:t.gl.uniform3iv(p,new Int32Array(y));break;case 4:t.gl.uniform4iv(p,new Int32Array(y));break}}if(g&&t.gl.uniform2i(g,c.texData.texShape[0],c.texData.texShape[1]),f!=null){if(c.isUniform){if(de(c.shape)<2)t.gl.uniform1f(f,c.uniformValues[0]);else{let y=c.uniformValues;y instanceof Float32Array||(y=new Float32Array(y)),t.gl.uniform1fv(f,y)}continue}c.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,f,l)}}const o=e.outShapeLocation;if(o)switch(s.shape.length){case 1:t.gl.uniform1iv(o,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(o,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(o,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(o,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Be(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],f=e.customUniformLocations[l],d=r[l];if(c.type==="float")t.gl.uniform1fv(f,d);else if(c.type==="vec2")t.gl.uniform2fv(f,d);else if(c.type==="vec3")t.gl.uniform3fv(f,d);else if(c.type==="vec4")t.gl.uniform4fv(f,d);else if(c.type==="int")t.gl.uniform1iv(f,d);else if(c.type==="ivec2")t.gl.uniform2iv(f,d);else if(c.type==="ivec3")t.gl.uniform3iv(f,d);else if(c.type==="ivec4")t.gl.uniform4iv(f,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function y2e(t,e,n){let s="";e.concat(n).forEach(i=>{const o=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:c,uniformShape:f,keptDims:d}=EI(t.packedInputs,i.shape,l);let p="",g="",y="";if(f.length===1&&t.packedInputs){const E=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${E[0]>1}_${E[1]>1}`}else if(f.length===2&&!t.packedInputs)g=`${f[0]>1}_${f[1]>1}`;else if(f.length>2&&!t.packedInputs){const E=Be(f);y=`${E[0]===l[1]}_${E[E.length-1]===l[1]}`}const v=i.shape.length,x=f.length===2&&at(i.shape,l),w=de(i.shape)===1,T=lu(i.shape,n.shape),N=!t.packedInputs&&v===n.shape.length&&at(l,n.texData.texShape),C=t.packedInputs||f.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${v}_${N}_${c?d:""}_${f.length}_${w}_${T}_${x}_${p}_${g}_${y}_${C}_${o}`}else{const l=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${l}_${o}`}});const r=t.userCode;let a=t.constructor.name;return a+="_"+s+"_"+r+`${ae().getNumber("WEBGL_VERSION")}`,a}function as(t){return ae().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b2e{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Np.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ws();this.outputShape=e,this.enableShapeUniforms=as(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Nv(["r","c","d"],e):_u(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x2e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Np.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ws();this.outputShape=e,this.enableShapeUniforms=as(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Nv(["r","c","d"],e):_u(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v2e{constructor(e){this.variableNames=["A"],this.outTexUsage=hr.DOWNLOAD;const n=ws();this.outputShape=e,this.userCode=`
      ${n8}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w2e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=hr.DOWNLOAD;const n=ws();this.outputShape=e,this.userCode=`
      ${n8}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S2e={R:0,G:1,B:2,A:3};class CF{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=ws();this.outputShape=e,this.enableShapeUniforms=as(this.outputShape.length);let a="result";n&&(a="floor(result * 255. + 0.5)");let i="";for(let o=0;o<s.length;o++){const l=s[o];i+=`
          if(offset == ${o}) {
            result = values[${S2e[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?kI():NI(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${i}
        }
        ${r.output} = vec4(${a}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T2e{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=ws();this.outputShape=e,this.enableShapeUniforms=as(this.outputShape.length);let r="",a="result";n&&(a="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let o=0;o<=1;o++){const l=i*2+o;r+=`
          localCoords = coords;
          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${o};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?kI():NI(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${a};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o8(t){const e=ws(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return _U(t,n)}function l8(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return zU(t,e)}function u8(t){const e=new Uint16Array([0,1,2,2,1,3]);return PU(t,e)}function Ng(t,e,n,s,r,a){VU(e,n);const i=BU(t),o=t.TEXTURE_2D;return $e(t,()=>t.bindTexture(o,i)),$e(t,()=>t.texParameteri(o,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),$e(t,()=>t.texParameteri(o,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),$e(t,()=>t.texParameteri(o,t.TEXTURE_MIN_FILTER,t.NEAREST)),$e(t,()=>t.texParameteri(o,t.TEXTURE_MAG_FILTER,t.NEAREST)),ae().getNumber("WEBGL_VERSION")===1?$e(t,()=>t.texImage2D(o,0,s,e,n,0,r,a,null)):$e(t,()=>t.texStorage2D(o,1,s,e,n)),$e(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function $I(t){return t.internalFormatFloat}function c8(t,e,n,s){const[r,a]=Cg(e,n);return Ng(t,r,a,$I(s),s.textureFormatFloat,t.FLOAT)}function II(t){return t.internalFormatHalfFloat}function h8(t,e,n,s){const[r,a]=Cg(e,n);return Ng(t,r,a,II(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function AI(t){return t.downloadTextureFormat}function f8(t,e,n,s){const[r,a]=Cg(e,n);return Ng(t,r,a,AI(s),t.RGBA,t.UNSIGNED_BYTE)}function RI(t){return t.internalFormatPackedFloat}function d8(t,e,n,s){const[r,a]=mf(e,n);return Ng(t,r,a,RI(s),t.RGBA,t.FLOAT)}function DI(t){return t.internalFormatPackedHalfFloat}function p8(t,e,n,s){const[r,a]=mf(e,n);return Ng(t,r,a,DI(s),t.RGBA,s.textureTypeHalfFloat)}function m8(t,e,n){return $e(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),bC(t,e,"clipSpacePos",n,3,20,0)&&bC(t,e,"uv",n,2,20,12)}function g8(t,e,n,s,r,a){$e(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,o,l;r instanceof Uint8Array?(i=new Uint8Array(n*s*4),o=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(n*s*4),o=t.FLOAT,l=a.internalFormatPackedFloat),i.set(r),ae().getNumber("WEBGL_VERSION")===2?$e(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,o,i)):$e(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,o,i)),$e(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function y8(t,e,n){$e(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?ae().getNumber("WEBGL_VERSION")===2?$e(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):$e(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):ae().getNumber("WEBGL_VERSION")===2?$e(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):$e(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),$e(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function b8(t,e,n,s){const r=t.createBuffer();$e(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const o=4*4*e*n;return $e(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,o,t.STREAM_READ)),$e(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),$e(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function x8(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function v8(t,e,n,s){const[r,a]=Cg(e,n),i=4,o=new Uint8Array(bwe(e*n,i));return $e(t,()=>t.readPixels(0,0,r,a,s.downloadTextureFormat,t.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function w8(t,e,n,s,r,a,i,o){const l=t,c=new Float32Array(xwe(a,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function S8(t,e,n){const s=new Float32Array(e*n*4);return $e(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}const C2e=Object.freeze(Object.defineProperty({__proto__:null,bindVertexProgramAttributeStreams:m8,createBufferFromOutputTexture:b8,createFloat16MatrixTexture:h8,createFloat16PackedMatrixTexture:p8,createFloat32MatrixTexture:c8,createIndexBuffer:u8,createPackedMatrixTexture:d8,createUnsignedBytesMatrixTexture:f8,createVertexBuffer:l8,createVertexShader:o8,downloadByteEncodedFloatMatrixFromOutputTexture:v8,downloadFloat32MatrixFromBuffer:x8,downloadMatrixFromPackedOutputTexture:S8,downloadPackedMatrixFromBuffer:w8,getInternalFormatForFloat16MatrixTexture:II,getInternalFormatForFloat16PackedMatrixTexture:DI,getInternalFormatForFloat32MatrixTexture:$I,getInternalFormatForPackedMatrixTexture:RI,getInternalFormatForUnsignedBytesMatrixTexture:AI,uploadDenseMatrixToTexture:g8,uploadPixelDataToTexture:y8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wy{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=ae().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,RU(n,e)):this.gl=da(n),e=this.gl,ae().getNumber("WEBGL_VERSION")===2){const a=e;this.createVertexArray=()=>$e(a,()=>a.createVertexArray()),this.bindVertexArray=i=>$e(a,()=>a.bindVertexArray(i)),this.deleteVertexArray=i=>$e(a,()=>a.deleteVertexArray(i)),this.getVertexArray=()=>$e(a,()=>a.getParameter(a.VERTEX_ARRAY_BINDING))}else if(e!=null){const a=e.getExtension("OES_vertex_array_object");if(a==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>$e(e,()=>a.createVertexArrayOES()),this.bindVertexArray=i=>$e(e,()=>a.bindVertexArrayOES(i)),this.deleteVertexArray=i=>$e(e,()=>a.deleteVertexArrayOES(i)),this.getVertexArray=()=>$e(e,()=>e.getParameter(a.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ae().getNumber("WEBGL_VERSION")===1){const a="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Ud(this.gl,a),fr(this.gl,i))this.textureHalfFloatExtension=Ud(this.gl,i);else if(ae().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),fr(this.gl,r))this.colorBufferHalfFloatExtension=Ud(this.gl,r);else if(ae().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",fr(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(fr(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=l8(this.gl),this.indexBuffer=u8(this.gl),this.framebuffer=UU(this.gl),this.textureConfig=TI(this.gl,this.textureHalfFloatExtension)}get debug(){return ae().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;$e(e,()=>e.finish()),$e(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),$e(e,()=>e.deleteFramebuffer(this.framebuffer)),$e(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),$e(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),$e(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),c8(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),h8(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),f8(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),y8(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),g8(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),p8(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),d8(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(xC(this.gl,this.framebuffer),this.outputTexture=null),$e(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>v8(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,a,i){return w8(this.gl,e,n,s,r,a,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return x8(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=b8(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(ae().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const i=r.clientWaitSync(a,0,0);return i===r.ALREADY_SIGNALED||i===r.CONDITION_SATISFIED},n=a}else ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>S8(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=o8(n));const s=LU(n);$e(n,()=>n.attachShader(s,this.vertexShader)),$e(n,()=>n.attachShader(s,e)),MU(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&By(n,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;$e(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),m8(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&($e(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&By(this.gl,this.program),$e(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?WU(this.gl,e,n):GU(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),$e(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),HU(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,a]=mf(n,s);this.setOutputMatrixTextureDriver(e,r,a)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&By(this.gl,this.program),jd(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}$e(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),$e(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Ud(this.gl,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,a),a}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await IT(()=>this.disposed||this.isQueryAvailable(e,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=N2e(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in ae().platform&&(s=ae().platform.setTimeoutCustom.bind(ae().platform)),IT(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Vy(this.gl,e,this.framebuffer),this.debug&&jd(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Vy(this.gl,this.outputTexture,this.framebuffer),this.debug&&jd(this.gl)):xC(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;Vy(r,e,this.framebuffer),this.debug&&jd(r),this.outputTexture=e,$e(r,()=>r.viewport(0,0,n,s)),$e(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),$e(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function N2e(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:k2e,bincountImpl:T8,bincountReduceImpl:E2e,bitwiseAndImpl:$2e,castImpl:I2e,ceilImpl:A2e,concatImpl:R2e,equalImpl:D2e,expImpl:O2e,expm1Impl:_2e,floorImpl:F2e,gatherNdImpl:L2e,gatherV2Impl:M2e,greaterImpl:z2e,greaterEqualImpl:P2e,lessImpl:B2e,lessEqualImpl:V2e,linSpaceImpl:U2e,logImpl:j2e,maxImpl:W2e,maximumImpl:G2e,minimumImpl:H2e,multiplyImpl:q2e,negImpl:X2e,notEqualImpl:K2e,prodImpl:Y2e,raggedGatherImpl:Z2e,raggedRangeImpl:Q2e,raggedTensorToTensorImpl:J2e,rangeImpl:eSe,rsqrtImpl:tSe,scatterImpl:nSe,sigmoidImpl:sSe,simpleAbsImpl:C8,sliceImpl:rSe,sparseFillEmptyRowsImpl:aSe,sparseReshapeImpl:iSe,sparseSegmentReductionImpl:N8,sqrtImpl:oSe,staticRegexReplaceImpl:lSe,stridedSliceImpl:uSe,stringNGramsImpl:cSe,stringSplitImpl:hSe,stringToHashBucketFastImpl:fSe,subImpl:dSe,tileImpl:pSe,topKImpl:mSe,transposeImpl:OI,uniqueImpl:gSe}=dU;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k8(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function ds(t,e){return e===1?[t]:k8(t,e)}function ySe(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bSe{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=as(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=ds("rc",this.rank),s=Et(this.rank),r=this.getOutOfBoundsCondition(n),a=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let a=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)a=`${e[e.length-1-i]},`+a;n.push(a)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E8{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=as(this.outputShape.length);let s="";for(let r=0;r<4;r++){let a="thisRC = rc;";r%2===1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),s+=`
        ${a}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${xSe(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?kI():NI(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function xSe(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Dwe(["r","c","d"],"inputShape"):_u(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vSe{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const r=kF(n,s),a=EF(e,r,s);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const i=NF(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[a].pop();return this.usedTextures[a].push(l),l}let o;return r===Gn.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Gn.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Gn.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Gn.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Gn.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(o),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),o}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const a=kF(s,r),i=EF(n,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);const o=NF(n,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=ae().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const c=this.usedTextures[i],f=c&&c.indexOf(e);if(f==null||f<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[f]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function wSe(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function NF(t,e,n,s,r){const a=SSe(e,s);let i;if(r){const[l,c]=mf(t[0],t[1]);i=l*c}else{const[l,c]=Cg(t[0],t[1]);i=l*c}const o=wSe(n,a);return i*o}function SSe(t,e){switch(t){case Gn.PACKED_2X2_FLOAT32:return RI(e);case Gn.PACKED_2X2_FLOAT16:return DI(e);case Gn.UNPACKED_FLOAT32:return $I(e);case Gn.UNPACKED_FLOAT16:return II(e);case Gn.PACKED_4X1_UNSIGNED_BYTE:return AI(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function TSe(t){return ae().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Gn.PACKED_2X2_FLOAT32:Gn.UNPACKED_FLOAT32:t?Gn.PACKED_2X2_FLOAT16:Gn.UNPACKED_FLOAT16}function kF(t,e){if(t===hr.UPLOAD)return Gn.PACKED_2X2_FLOAT32;if(t===hr.RENDER||t==null)return TSe(e);if(t===hr.DOWNLOAD||t===hr.PIXELS)return Gn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function EF(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oa{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=as(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Wr="if (isnan(x)) return x;",CSe="return x;",$F="return abs(x);",NSe="return (x >= 0.0) ? x : (exp(x) - 1.0);",kSe=Wr+`
  return (x < 0.0) ? 0.0 : x;
`,ESe=Wr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,So="return x;",$Se="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ISe="return x;",ASe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,RSe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,DSe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,OSe="return 1.0 / (1.0 + exp(-1.0 * x));";class ko{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=as(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Se{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=as(this.outputShape.length);const n=e.length,s=ds("rc",n),r=Et(n),a=ySe(n,s),i=s.slice(-2),o=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FSe=Ux,LSe=1e-7,MSe=1e-4,oy={};function zSe(t){return t in oy||(oy[t]={}),oy[t]}const PSe=ae().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),BSe=600;function VSe(){return ae().global.screen==null?1024:ae().global.screen.height*ae().global.screen.width*window.devicePixelRatio*BSe/1024/1024}class kg extends rb{nextDataId(){return kg.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ae().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof Wy)n=e;else{const s=da(ae().getNumber("WEBGL_VERSION"),e);n=new Wy(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=da(ae().getNumber("WEBGL_VERSION"));n=new Wy(s),this.binaryCache=zSe(ae().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new vSe(this.gpgpu),this.numMBBeforeWarning=VSe(),this.texData=new AN(this,sa())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,r,a,i){const o=this.makeTensorInfo(n,s),l=this.texData.get(o.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,a]},l.texShape=[r,a];const c=Wd(n),f=new CF(c,!1,i),d=this.runWebGLProgram(f,[o],s,[[r,a]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(o),d.dataId}write(e,n,s){if((ae().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ae().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:hr.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,a){if(ae().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:hr.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:a,slice:i,shape:o,isPacked:l}=n;if(i!=null){let p;l?p=new ko(o,So):p=new Oa(o,So);const g=this.runWebGLProgram(p,[{dataId:e,shape:o,dtype:r}],r),y=this.readSync(g.dataId);return this.disposeIntermediateTensorInfo(g),y}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const c=this.activeTimers!=null;let f;c&&(f=Un());let d;if(r==="complex64"){const p=this.readSync(a.real.dataId),g=this.readSync(a.imag.dataId);d=Fi(p,g)}else d=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=Un()-f),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const y=this.pendingRead.get(e);return new Promise(v=>y.push(v))}const n=this.texData.get(e),{values:s,shape:r,slice:a,dtype:i,complexTensorInfos:o,isPacked:l}=n;if(a!=null){let y;l?y=new ko(r,So):y=new Oa(r,So);const v=this.runWebGLProgram(y,[{dataId:e,shape:r,dtype:i}],i),x=this.read(v.dataId);return this.disposeIntermediateTensorInfo(v),x}if(s!=null)return this.convertAndCacheOnCPU(e);if(ae().getBool("DEBUG")&&!ae().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ae().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,f;if(i!=="complex64"&&ae().get("WEBGL_BUFFER_SUPPORTED")){f=this.decode(e);const y=this.texData.get(f.dataId);c=this.gpgpu.createBufferFromTexture(y.texture.texture,...ay(r))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(i==="complex64"){const y=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),v=y[0],x=y[1];d=Fi(v,x)}else if(c==null)d=this.getValuesFromTexture(e);else{const y=de(r);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,y)}if(f!=null&&this.disposeIntermediateTensorInfo(f),c!=null){const y=this.gpgpu.gl;$e(y,()=>y.deleteBuffer(c))}const p=this.convertAndCacheOnCPU(e,d),g=this.pendingRead.get(e);return this.pendingRead.delete(e),g.forEach(y=>y(p)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&sa().removeDataId(e,this),this.pendingDeletes--),p}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:a,slice:i,dtype:o,isPacked:l,texture:c}=s;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let g;l?g=new ko(a,So):g=new Oa(a,So);const y=this.runWebGLProgram(g,[{dataId:e,shape:a,dtype:o}],o),v=this.readToGPU(y,n);return this.disposeIntermediateTensorInfo(y),v}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const f=this.decode(e,n.customTexShape),d=sa().makeTensorFromTensorInfo(f),p=this.texData.get(f.dataId);return Object.assign({tensorRef:d},p.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>Ri(r));return Qe(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Qe(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!DU(s))throw ae().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),a=de(n);if(ae().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const p=this.decode(e),g=this.texData.get(p.dataId),y=this.gpgpu.downloadMatrixFromPackedTexture(g.texture.texture,...ay(n)).subarray(0,a);return this.disposeIntermediateTensorInfo(p),y}const i=ae().getBool("WEBGL_PACK")&&r===!0,o=i?Wd(n):n,l=i?new w2e(o):new v2e(o),c=this.runWebGLProgram(l,[{shape:o,dtype:s,dataId:e}],"float32"),f=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(f.texture.texture,f.texShape[0],f.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const a=Ua(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=Ua(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(a);o.kernelMs=eP(l),o.getExtraProfileInfo=()=>l.map((c,f)=>({name:i[f],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Un(),endMs:null}}endTimer(e){return ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Un(),e)}async getQueryTime(e){if(ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:a,isPacked:i,slice:o}=this.texData.get(e),l=o&&o.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,a,i)));const f=this.texData.get(e);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=PSe){return ae().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&de(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){lr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return FSe(e.shape,n)}packedUnaryOp(e,n,s){const r=new ko(e.shape,n),a=this.compileAndRun(r,[e],s);return sa().makeTensorFromTensorInfo(a)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=C8(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(ae().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,$F,e.dtype);const n=new Oa(e.shape,$F),s=this.compileAndRun(n,[e]);return sa().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&Da(s[0])){const a=s.map(i=>La(i));r=this.write(a,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return sa().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new _Se(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new bSe(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const s=[yu(e.shape),...bu(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},a=[yu(n),...bu(n)],i=new E8(a,s),o=!0,l=[s],c=this.runWebGLProgram(i,[r],e.dtype,l,o);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:a,dtype:i}=s;if(n!=null){const p=de(a),g=n[0]*n[1]*4;M(p<=g,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=Wd(a);let l;r?l=new x2e(o):l=new b2e(o);const c=!0,f=[n??ay(o)],d=this.runWebGLProgram(l,[{shape:o,dtype:i,dataId:e}],i,f,c,n);return{dtype:i,shape:a,dataId:d.dataId}}runWebGLProgram(e,n,s,r,a=!1,i){const o=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(o.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Np.DENSE){const w=i??ay(e.outputShape);l.texShape=w.map(T=>T*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),de(o.shape)===0)return l.values=On(o.dtype,0),o;const c=[],f=n.map(w=>{if(w.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let T=this.texData.get(w.dataId);if(T.texture==null){if(!e.packedInputs&&de(w.shape)<=ae().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:w.shape,texData:null,isUniform:!0,uniformValues:T.values};e.packedInputs&&(T.isPacked=!0,T.shape=w.shape)}if(this.uploadToGPU(w.dataId),!!T.isPacked!=!!e.packedInputs)w=T.isPacked?this.unpackTensor(w):this.packTensor(w),c.push(w),T=this.texData.get(w.dataId);else if(T.isPacked&&!kp(T.shape,w.shape)){const N=w,C=w.shape;w.shape=T.shape,w=this.packedReshape(w,C),c.push(w),T=this.texData.get(w.dataId),N.shape=C}return{shape:w.shape,texData:T,isUniform:!1}});this.uploadToGPU(o.dataId);const d={shape:o.shape,texData:l,isUniform:!1},p=y2e(e,f,d),g=this.getAndSaveBinary(p,()=>m2e(this.gpgpu,e,f,d)),y=this.activeTimers!=null;let v;y&&(v=this.startTimer()),ae().get("ENGINE_COMPILE_ONLY")||g2e(this.gpgpu,g,f,d,r),c.forEach(w=>this.disposeIntermediateTensorInfo(w)),y&&(v=this.endTimer(v),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(v)}));const x=ae().getNumber("WEBGL_FLUSH_THRESHOLD");if(x>0){const w=Un();w-this.lastGlFlushTime>x&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=w)}if(!ae().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){const w=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),w}return o}compileAndRun(e,n,s,r,a=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,a)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ae().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=re(()=>{if(!ae().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=ae().getBool("DEBUG");ae().set("DEBUG",!1);const n=this.abs(Pe(1e-8)).dataSync()[0];if(ae().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?LSe:MSe}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:a,texture:i,usage:o,isPacked:l}=n;if(i!=null)return;const c=this.activeTimers!=null;let f;c&&(f=Un());let d=n.texShape;if(d==null&&(d=KU(s,l),n.texShape=d),a!=null){const p=Wd(s);let g,y=d[1],v=d[0];const x=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(l||!x)&&([y,v]=mf(d[0],d[1])),l?g=new T2e(p,x):g=new CF(p,x);const w=x?[v,y]:d,T=this.makeTensorInfo(w,r),N=this.texData.get(T.dataId);x?N.usage=hr.PIXELS:N.usage=hr.UPLOAD,N.texShape=w,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(T.dataId),y,v,a);const C=[[v,y]],R=this.runWebGLProgram(g,[T],r,C,!0),$=this.texData.get(R.dataId);n.texShape=$.texShape,n.isPacked=$.isPacked,n.usage=$.usage,ae().get("ENGINE_COMPILE_ONLY")?this.disposeData(R.dataId):(n.texture=$.texture,n.values=null,this.texData.delete(R.dataId)),this.disposeIntermediateTensorInfo(T),c&&(this.uploadWaitMs+=Un()-f)}else{const p=this.acquireTexture(d,o,r,l);n.texture=p}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return n!=null&&(s.values=USe(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*cp(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(a){throw a}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await dE(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(CI(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:a,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:l}=i8(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=a,e.outShapeLocation=i,e.outShapeStridesLocation=o,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:r,height:a,width:i,channels:o}=e,l=sa().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,n,s,a,i,o);return sa().makeTensorFromDataId(c,n,s,l)}}kg.nextDataId=0;function USe(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/** @license See the LICENSE file. */const $8="4.22.0";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I8(){ae().set("WEBGL_FORCE_F16_TEXTURES",!0)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */PN()&&VN("webgl",()=>new kg,2);const jSe={forceHalfFloat:I8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _I=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class xu{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=Ke(n,s),this.enableShapeUniforms=as(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lu=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class wf{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ke(n,s);const a=this.outputShape.length;this.enableShapeUniforms=as(a);let i="";if(r)if(a===0||de(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${Et(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=ds("coords",a);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${l[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${l[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ks(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const WSe={kernelName:kh,backendName:"webgl",kernelFunc:Ks};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rl(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,a=n.makeTensorInfo(s.shape,"complex64"),i=n.texData.get(a.dataId),o=Ks({inputs:{x:s},backend:n}),l=Ks({inputs:{x:r},backend:n});return i.complexTensorInfos={real:o,imag:l},a}const GSe={kernelName:db,backendName:"webgl",kernelFunc:rl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A8="return (a < 0.) ? b * a : a;",R8=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function HSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:a}=s,i=n.makeTensorInfo([],"float32",Vi(a,"float32")),o=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new wf(R8,r.shape,i.shape):new xu(A8,r.shape,i.shape),l=n.runWebGLProgram(o,[r,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const qSe={kernelName:um,backendName:"webgl",kernelFunc:HSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D8="return (a < 0.) ? b * a : a;",O8=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function XSe(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,a=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new wf(O8,s.shape,r.shape):new xu(D8,s.shape,r.shape);return n.runWebGLProgram(a,[s,r],"float32")}const KSe={kernelName:$m,backendName:"webgl",kernelFunc:XSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sf="if (isnan(x)) return x;";function yt({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:a})=>{const{x:i}=r,o=a,l=s||i.dtype;if(o.shouldExecuteOnCPU([i])&&n!=null){const d=o.texData.get(i.dataId),p=n(d.values,l);return o.makeTensorInfo(i.shape,l,p)}const c=ae().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let f;return c?f=new ko(i.shape,e):f=new Oa(i.shape,t),o.runWebGLProgram(f,[i],l)}}function Qn({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:a}){return({inputs:i,backend:o})=>{const{a:l,b:c}=i,f=o;if(s&&l.dtype==="complex64"){const y=f.texData.get(l.dataId),v=f.texData.get(c.dataId),[x,w]=[[y.complexTensorInfos.real,v.complexTensorInfos.real],[y.complexTensorInfos.imag,v.complexTensorInfos.imag]].map(N=>{const[C,E]=N,R={dataId:C.dataId,dtype:C.dtype,shape:l.shape},$={dataId:E.dataId,dtype:E.dtype,shape:c.shape},O=new xu(t,l.shape,c.shape);return f.runWebGLProgram(O,[R,$],As(C.dtype,E.dtype))}),T=rl({inputs:{real:x,imag:w},backend:f});return f.disposeIntermediateTensorInfo(x),f.disposeIntermediateTensorInfo(w),T}const d=a||As(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||f.shouldExecuteOnCPU([l,c]))&&r!=null){const y=f.texData.get(l.dataId).values,v=f.texData.get(c.dataId).values,x=l.dtype==="string"?Li(y):y,w=l.dtype==="string"?Li(v):v,[T,N]=r(l.shape,c.shape,x,w,d),C=f.makeTensorInfo(N,d),E=f.texData.get(C.dataId);return E.values=T,C}const p=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let g;return p?g=new wf(e,l.shape,c.shape,n):g=new xu(t,l.shape,c.shape),f.runWebGLProgram(g,[l,c],d)}}function Ep(t,e=!1){if(t==="linear")return e?ISe:CSe;if(t==="relu")return e?RSe:kSe;if(t==="elu")return e?ASe:NSe;if(t==="relu6")return e?DSe:ESe;if(t==="prelu")return e?O8:D8;if(t==="leakyrelu")return e?R8:A8;if(t==="sigmoid")return e?OSe:$Se;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _8{constructor(e,n,s,r=!1,a=!1,i=!1,o=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=as(this.outputShape.length);const f=r?e[1]:e[2],d=Math.ceil(f/2),p=r?"i * 2, rc.y":"rc.y, i * 2",g=a?"rc.z, i * 2":"i * 2, rc.z",y=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],v=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let x="",w="";o&&(l?x=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:c?x=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:x=`vec4 activation(vec4 x) {
          ${o}
        }`,w="result = activation(result);");const T=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let N="rc.x",C="rc.x";e[0]<n[0]?N=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(C=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${x}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${N};
        int batchB = ${C};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${g});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${y[0]} * ${v[0]});
          result += (${y[1]} * ${v[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${T}

        ${w}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IF={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class AF{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ke(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RF="return a * b;";function FI(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,a=As(s.dtype,r.dtype);if(s.dtype==="complex64"){const o=n.texData.get(s.dataId),l=n.texData.get(r.dataId),c=new AF(IF.REAL,s.shape,r.shape),f=new AF(IF.IMAG,s.shape,r.shape),d=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:s.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],p=n.runWebGLProgram(c,d,"float32"),g=n.runWebGLProgram(f,d,"float32"),y=rl({inputs:{real:p,imag:g},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),y}if(n.shouldExecuteOnCPU([s,r])){const o=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[c,f]=q2e(s.shape,r.shape,o.values,l.values,a),d=n.makeTensorInfo(f,a),p=n.texData.get(d.dataId);return p.values=c,d}let i;return ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new wf(RF,s.shape,r.shape):i=new xu(RF,s.shape,r.shape),n.runWebGLProgram(i,[s,r],a)}const YSe={kernelName:Fh,backendName:"webgl",kernelFunc:FI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZSe(t,e,n){const s=[yu(t.shape),...bu(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},a=[yu(e),...bu(e)],i=new E8(a,s),o=!0,l=[s],c=n.runWebGLProgram(i,[r],t.dtype,l,o);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:a}=s,i=n,o=de(r.shape),l=DN(a,o),c=de(l);M(o===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);const f=i.texData.get(r.dataId);return f.isPacked&&!kp(r.shape,l)&&!(f.texture!==null&&kp(f.shape,l))?ZSe(r,l,i):(i.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const QSe={kernelName:Am,backendName:"webgl",kernelFunc:Ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DF{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];const o=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const d=1/n;c=`sumValue += dot(values * ${nu(d)?d.toPrecision(2):d}, ones);`}let f="";a%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${o};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JSe{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];let o="0.0",l="";n==="prod"?o="1.0":n==="min"?(o="1.0 / 1e-20",l="min"):n==="max"&&(o="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const f=Math.floor(s/4)*4,d=s%4;let p=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,g="vec4";n==="all"?(o="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,g="bvec4"):n==="any"&&(o="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,g="bvec4");let y="";a%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${y}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${f}; i += 4) {
          int inIdx = inOffset + i;
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${f};
        if (${d===1}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===2}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===3}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eTe(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=ev(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function Mu(t,e,n,s){const r=eTe(t.shape);let a=t;for(let i=0;i<r.length;i++){const{inSize:o,windowSize:l,outSize:c}=r[i];let f,d;n==="mean"?f=i===0?new DF({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:c},o):new DF({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:c}):f=new JSe({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:c},n),d=a,a=s.runWebGLProgram(f,[a],e),d.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(d)}return a}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tTe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[n[i]];this.outputShape=s,this.rank=s.length;const r=Et(this.rank),a=nTe(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}}function nTe(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sTe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let f=0;f<s.length;f++)s[f]=e[n[f]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=Et(this.rank),a=k8("rc",this.rank),i=new Array(this.rank);for(let f=0;f<n.length;f++)i[n[f]]=a[f];const o=`vec2(${i.slice(-2).join()})`,l=`++${a[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${i.join()}), ${o})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kv(t,e,n){const s=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sTe(t.shape,e):new tTe(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rTe(t,e,n,s){const r=e,a=t.shape.length,i=nt(r,t.shape);let o=i;const l=qt(o,a),c=l!=null;let f=t;c&&(f=kv(t,l,s),o=un(o.length,a)),Yn("sum",o,a);const[d,p]=Mn(f.shape,o);let g=d;n&&(g=on(d,i));const y=de(p),x=de(t.shape)/y,w=Ee({inputs:{x:f},attrs:{shape:[x,y]},backend:s}),T=dx(t.dtype),N=Mu(w,T,"sum",s),C=Ee({inputs:{x:N},attrs:{shape:g},backend:s});return s.disposeIntermediateTensorInfo(w),s.disposeIntermediateTensorInfo(N),c&&s.disposeIntermediateTensorInfo(f),C}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ev(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s;return rTe(r,a,i,n)}const aTe={kernelName:Lm,backendName:"webgl",kernelFunc:Ev};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bs(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:a}=s,i=n,o=r.shape.length,l=new Array(o);for(let f=0;f<l.length;f++)l[f]=r.shape[a[f]];let c;if(i.shouldExecuteOnCPU([r])){const d=i.texData.get(r.dataId).values,p=OI(d,r.shape,r.dtype,a,l);c=i.makeTensorInfo(l,r.dtype);const g=i.texData.get(c.dataId);g.values=p}else c=kv(r,a,i);return c}const iTe={kernelName:Kl,backendName:"webgl",kernelFunc:bs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F8=1e3;function V1({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:l=null}){const c=t.shape.length,f=e.shape.length,d=n?t.shape[c-2]:t.shape[c-1],p=s?e.shape[f-1]:e.shape[f-2],g=n?t.shape[c-1]:t.shape[c-2],y=s?e.shape[f-2]:e.shape[f-1],v=t.shape.slice(0,-2),x=e.shape.slice(0,-2),w=de(v),T=de(x),C=Ke(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([g,y]);M(d===p,()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const E=n?[w,d,g]:[w,g,d],R=s?[T,y,p]:[T,p,y],$=Ee({inputs:{x:t},backend:r,attrs:{shape:E}}),O=Ee({inputs:{x:e},backend:r,attrs:{shape:R}}),A=[$,O],_=Math.max(w,T),D=n?$.shape[1]:$.shape[2],B=a!=null,j=i!=null,W=l==="leakyrelu",X=l!=null?Ep(l,!0):null,U=B||j||W||X!=null;let Y;if((g===1||y===1)&&D>F8&&U===!1){let ie=$,V=O;n&&(ie=bs({inputs:{x:$},backend:r,attrs:{perm:[0,2,1]}}),A.push(ie)),s&&(V=bs({inputs:{x:O},backend:r,attrs:{perm:[0,2,1]}}),A.push(V));const ee=y!==1,ce=y===1;let ue=ie;ee&&(ue=Ee({inputs:{x:ie},backend:r,attrs:{shape:[_,D,1]}}),A.push(ue));const he=y===1?2:1;let be=V;ce&&(be=Ee({inputs:{x:V},backend:r,attrs:{shape:[_,1,D]}}),A.push(be));const we=FI({inputs:{a:ue,b:be},backend:r});Y=Ev({inputs:{x:we},backend:r,attrs:{axis:he,keepDims:!0}}),A.push(we)}else{const ie=As(t.dtype,e.dtype),V=new _8(E,R,[_,g,y],n,s,B,X,j,W),ee=[$,O];if(a!=null&&ee.push(a),j&&ee.push(i),W){const ce=r.makeTensorInfo([],"float32",Vi(o,"float32"));ee.push(ce),A.push(ce)}Y=r.runWebGLProgram(V,ee,ie)}const Q=Ee({inputs:{x:Y},backend:r,attrs:{shape:C}});A.push(Y);for(const ie of A)r.disposeIntermediateTensorInfo(ie);return Q}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oTe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:a,bias:i,preluActivationWeights:o}=e,{transposeA:l,transposeB:c,activation:f,leakyreluAlpha:d}=s;return V1({a:r,b:a,transposeA:l,transposeB:c,backend:n,bias:i,preluActivationWeights:o,leakyreluAlpha:d,activation:f})}const lTe={kernelName:hp,backendName:"webgl",kernelFunc:oTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OF="return abs(x);";function uTe(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const a=n.texData.get(s.dataId),i=C8(a.values);return n.makeTensorInfo(s.shape,s.dtype,i)}let r;return ae().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new ko(s.shape,OF):r=new Oa(s.shape,OF),n.runWebGLProgram(r,[s],s.dtype)}const cTe={kernelName:Vp,backendName:"webgl",kernelFunc:uTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hTe=Wr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,fTe=yt({opSnippet:hTe}),dTe={kernelName:ih,backendName:"webgl",kernelFunc:fTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pTe=Wr+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,mTe=yt({opSnippet:pTe}),gTe={kernelName:oh,backendName:"webgl",kernelFunc:mTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _F="return a + b;",yTe=Qn({opSnippet:_F,packedOpSnippet:_F,supportsComplex:!0,cpuKernelImpl:k2e}),bTe={kernelName:ku,backendName:"webgl",kernelFunc:yTe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xTe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((a,i)=>`T${i}`);const s=[];this.variableNames.forEach(a=>{s.push(`float v${a} = get${a}AtOutCoords();`)});const r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vTe{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((a,i)=>`T${i}`);const s=[];this.variableNames.forEach(a=>{s.push(`vec4 v${a} = get${a}AtOutCoords();`)});const r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gy(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return Ks({inputs:{x:s[0]},backend:n});if(s.length>ae().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=Gy({inputs:s.slice(0,l),backend:n}),f=Gy({inputs:s.slice(l),backend:n});return Gy({inputs:[c,f],backend:n})}const r=s.map(l=>l.dtype).reduce((l,c)=>As(l,c)),a=s.map(l=>l.shape),o=ae().getBool("WEBGL_PACK")?new vTe(s[0].shape,a):new xTe(s[0].shape,a);return n.runWebGLProgram(o,s,r)}const wTe={kernelName:Up,backendName:"webgl",kernelFunc:Gy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function STe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s,o=r.shape.length,l=nt(a,r.shape);let c=l;const f=qt(c,o);let d=r;f!=null&&(d=bs({inputs:{x:r},backend:n,attrs:{perm:f}}),c=un(c.length,o)),Yn("all",c,o);const[p,g]=Mn(d.shape,c),y=de(g),v=Ee({inputs:{x:d},backend:n,attrs:{shape:[-1,y]}}),x=Mu(v,v.dtype,"all",n);let w;if(i){const T=on(p,l);w=Ee({inputs:{x},backend:n,attrs:{shape:T}})}else w=Ee({inputs:{x},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(x),f!=null&&n.disposeIntermediateTensorInfo(d),w}const TTe={kernelName:ob,backendName:"webgl",kernelFunc:STe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s,o=r.shape.length,l=nt(a,r.shape);let c=l;const f=qt(c,o);let d=r;f!=null&&(d=bs({inputs:{x:r},backend:n,attrs:{perm:f}}),c=un(c.length,o)),Yn("any",c,o);const[p,g]=Mn(d.shape,c),y=de(g),v=Ee({inputs:{x:d},backend:n,attrs:{shape:[-1,y]}}),x=Mu(v,v.dtype,"any",n);let w;if(i){const T=on(p,l);w=Ee({inputs:{x},backend:n,attrs:{shape:T}})}else w=Ee({inputs:{x},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(x),f!=null&&n.disposeIntermediateTensorInfo(d),w}const NTe={kernelName:lb,backendName:"webgl",kernelFunc:CTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kTe{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:a,outSize:i}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i];const o=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${o} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ETe{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,M(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const a=e[e.length-1],i=Math.ceil(a/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const o=this.outputShape,l=o.length,c=Et(l),f=ds("coords",l);let d,p;if(i===1){p=l+1;const O=Et(p);d=`
        ${O} sourceLocR = ${O}(${f.join()}, 0);
        ++${f[l-1]};
        ${O} sourceLocG = ${O}(${f.join()}, 0);
        ++${f[l-2]};
        ${O} sourceLocA = ${O}(${f.join()}, 0);
        --${f[l-1]};
        ${O} sourceLocB = ${O}(${f.join()}, 0);
        --${f[l-2]};`}else p=l,d=`
        ${c} sourceLocR = coords;
        ++${f[l-1]};
        ${c} sourceLocG = coords;
        ++${f[l-2]};
        ${c} sourceLocA = coords;
        --${f[l-1]};
        ${c} sourceLocB = coords;
        --${f[l-2]};`;const g=["x","y","z","w","u","v"].slice(0,p),y="."+g[p-1],v=g.map(O=>"int "+O),x=ds("sourceLocR",p-1).concat("inIdx.r"),w=ds("sourceLocG",p-1).concat("inIdx.g"),T=ds("sourceLocB",p-1).concat("inIdx.b"),N=ds("sourceLocA",p-1).concat("inIdx.a"),C=s==="max"?"greaterThan":"lessThan",E=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${w.join()}),
                             getBestIndicesAChannel(${T.join()}),
                             getBestIndicesAChannel(${N.join()})));`,R=`vec4(
            getAChannel(${x.join()}),
            hasNextCol ? getAChannel(${w.join()}) : 0.,
            hasNextRow ? getAChannel(${T.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${N.join()}) : 0.)`,$=r?"":`
      float getBestIndicesAChannel(${v.join()}) {
        return getChannel(getBestIndicesA(${g.join()}),
                                          vec2(${g.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${v.join()}) {
        return getChannel(getA(${g.join()}),
                               vec2(${g.slice(-2).join()}));
      }
      ${$}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${f[l-1]} < ${o[l-1]-1};
        bool hasNextRow = ${f[l-2]} < ${o[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${y}, sourceLocG${y},
          sourceLocB${y}, sourceLocA${y}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${R};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${E}
          vec4 candidate = ${R};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${C}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L8(t,e,n,s=null){let r=e.shape[0],a=e.shape[1];s!=null&&(r=s.shape[0],a=s.shape[1]);const i=ev(a),o={windowSize:i,inSize:a,batchSize:r,outSize:Math.ceil(a/i)},l=new kTe(o,n,s==null),c=[e];s!=null&&c.push(s);const f=t.runWebGLProgram(l,c,"int32");if(f.shape[1]===1)return f;const d=L8(t,e,n,f);return t.disposeIntermediateTensorInfo(f),d}function M8(t,e,n,s=null){const r=s!=null?s.shape:e.shape,a=r[r.length-1],i=ev(a),o=new ETe(r,i,n,s==null),l=s==null?[e]:[e,s],c=t.runWebGLProgram(o,l,"int32");if(c.shape.length===e.shape.length){const f=M8(t,e,n,c);return t.disposeIntermediateTensorInfo(c),f}return c}function z8(t,e,n,s){const r=[n];if(Yn("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!ae().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const a=[],i=t.texData.get(e.dataId),o=i!==null&&i.isPacked;let l=e;o&&(l=t.unpackTensor(e),a.push(l));const[c,f]=Mn(l.shape,r),d=de(f),p=Ee({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});a.push(p);const g=L8(t,p,s);a.push(g);const y=Ee({inputs:{x:g},backend:t,attrs:{shape:c}});return a.forEach(v=>t.disposeIntermediateTensorInfo(v)),y}return M8(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Te(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a}=s;let i=nt(a,r.shape);const o=qt(i,r.shape.length);let l=r;const c=[];o!=null&&(l=bs({inputs:{x:r},backend:n,attrs:{perm:o}}),c.push(l),i=un(i.length,l.shape.length)),Yn("argMax",[i[0]],l.shape.length);const f=z8(n,l,i[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),f}const ITe={kernelName:jp,backendName:"webgl",kernelFunc:$Te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ATe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a}=s;let i=nt(a,r.shape);const o=qt(i,r.shape.length);let l=r;const c=[];o!=null&&(l=bs({inputs:{x:r},backend:n,attrs:{perm:o}}),c.push(l),i=un(i.length,l.shape.length)),Yn("argMin",[i[0]],l.shape.length);const f=z8(n,l,i[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),f}const RTe={kernelName:Wp,backendName:"webgl",kernelFunc:ATe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DTe=Wr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,OTe=yt({opSnippet:DTe}),_Te={kernelName:lh,backendName:"webgl",kernelFunc:OTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FTe=Wr+"return log(x + sqrt(x * x + 1.0));",LTe=yt({opSnippet:FTe}),MTe={kernelName:uh,backendName:"webgl",kernelFunc:LTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zTe=Wr+`
  return atan(x);
`,PTe=yt({opSnippet:zTe}),BTe={kernelName:ch,backendName:"webgl",kernelFunc:PTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VTe=_I+`
  return atan(a, b);
`,UTe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Lu+`
  return result;
`,jTe=Qn({opSnippet:VTe,packedOpSnippet:UTe}),WTe={kernelName:fh,backendName:"webgl",kernelFunc:jTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GTe=Wr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,HTe=yt({opSnippet:GTe}),qTe={kernelName:hh,backendName:"webgl",kernelFunc:HTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $p{constructor(e,n,s,r=!1,a=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,o=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const v=n==="avg",x=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,w=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let T="0.0";if(v||(T="-1.0 / 1e-20"),s){const O=">=";this.userCode=`
        const ivec2 strides = ivec2(${o}, ${l});
        const ivec2 pads = ivec2(${g}, ${y});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${f}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${O} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?a?x:w:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const N="max";let C=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(C="avgValue / max(count, 1.0)");const E=Math.floor(i/4)*4,R=i%4,$=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${N}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${g}, ${y});
      const float initializationValue = ${T};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${T});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${E}; wC += 4) {
            int xC = xCCorner + wC * ${f};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${f}, d),
              getValue(batch, xR, xC + 2 * ${f}, d),
              getValue(batch, xR, xC + 3 * ${f}, d)
            );

            ${$}
          }

          int xC = xCCorner + ${E};
          if (${R===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${R===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${f}, d),
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${R===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${f}, d),
              getValue(batch, xR, xC + 2 * ${f}, d),
              initializationValue
            );

            ${$}
          }
        }
        setOutput(${C});
      }
    `}}class LI{constructor(e,n,s,r=!1,a=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,o=e.strideDepth,l=e.strideHeight,c=e.strideWidth,f=e.dilationDepth,d=e.dilationHeight,p=e.dilationWidth,g=e.effectiveFilterDepth,y=e.effectiveFilterHeight,v=e.effectiveFilterWidth,x=e.padInfo.front,w=e.padInfo.top,T=e.padInfo.left;this.outputShape=e.outShape;const N=n==="avg";let C="0.0";if(N||(C="-1.0 / 1e-20"),s){const _=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${l}, ${c});
        const ivec3 pads = ivec3(${x}, ${w}, ${T});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${g};
              wD += ${f}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${y};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${v};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${_} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?a?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${y} * ${v} +
                      wR * ${v} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const E="max";let R=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(R="avgValue / max(count, 1.0)");const $=Math.floor(i/4)*4,O=i%4,A=`
      if (${N}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${E}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${l}, ${c});
      const ivec3 pads = ivec3(${x}, ${w}, ${T});
      const float initializationValue = ${C};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${C});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${g};
            wD += ${f}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${y};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${$}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${A}
            }

            int xC = xCCorner + ${$};
            if (${O===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${A}
            } else if (${O===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${A}
            } else if (${O===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${A}
            }
          }
        }
        setOutput(${R});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;gf(r,"avgPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=s,c=1;M(Kn(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const f=Ur(r.shape,a,i,c,o,l);if(f.filterWidth===1&&f.filterHeight===1&&at(f.inShape,f.outShape))return Ks({inputs:{x:r},backend:n});const d=new $p(f,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const KTe={kernelName:Gp,backendName:"webgl",kernelFunc:XTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:a,strides:i,pad:o,dimRoundingMode:l,dataFormat:c}=s,f=[1,1,1],d=Ui(r.shape,a,i,f,o,l,c),p=new LI(d,"avg",!1);return n.runWebGLProgram(p,[r],"float32")}const ZTe={kernelName:Hp,backendName:"webgl",kernelFunc:YTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QTe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,f=l-1-e.padInfo.top,d=c-1-e.padInfo.left,p=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${f}, ${d});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class JTe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,f=e.dilationWidth,d=e.effectiveFilterDepth,p=e.effectiveFilterHeight,g=e.effectiveFilterWidth,y=d-1-e.padInfo.front,v=p-1-e.padInfo.top,x=g-1-e.padInfo.left,w=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${y}, ${v}, ${x});
      const float avgMultiplier = float(${w});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${g};
                wC += ${f}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eCe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,i=a,{filterSize:o,strides:l,pad:c,dimRoundingMode:f}=s,d=[1,1,1],p=Ui(i.shape,o,l,d,c,f),g=new JTe(p);return n.runWebGLProgram(g,[r],i.dtype)}const tCe={kernelName:cb,backendName:"webgl",kernelFunc:eCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nCe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,i=a;gf([r,a],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=s,f=Ur(i.shape,o,l,1,c),d=new QTe(f);return n.runWebGLProgram(d,[r],i.dtype)}const sCe={kernelName:ub,backendName:"webgl",kernelFunc:nCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rCe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:a}=e,{transposeA:i,transposeB:o}=s;return V1({a:r,b:a,transposeA:i,transposeB:o,backend:n})}const aCe={kernelName:qp,backendName:"webgl",kernelFunc:rCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iCe{constructor(e,n,s,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Ke(e,n),Ke(e,s);let o="0.0";r!=null&&(Ke(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="1.0";a!=null&&(Ke(e,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oCe{constructor(e,n,s,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ke(e,n),Ke(e,s);let o="vec4(0.0)";r!=null&&(Ke(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="vec4(1.0)";a!=null&&(Ke(e,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lCe=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:a,offset:i,scale:o}=t;M(r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),M(i==null||r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),M(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,r,a];let f=null;i!=null&&(f=i.shape,c.push(i));let d=null;o!=null&&(d=o.shape,c.push(o));const p=ae().getBool("WEBGL_PACK_NORMALIZATION")?new oCe(s.shape,r.shape,a.shape,f,d,l):new iCe(s.shape,r.shape,a.shape,f,d,l);return e.runWebGLProgram(p,c,c[0].dtype)},uCe={kernelName:im,backendName:"webgl",kernelFunc:lCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cCe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=Et(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=hCe(this.rank);let r;const a=e.map((i,o)=>`sourceLoc.${SC[o]} = start[${o}] + coords.${SC[o]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const SC=["x","y","z","w","u","v"];function hCe(t){if(t===1)return"sourceLoc";if(t<=6)return SC.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fCe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=Et(this.rank),s=ds("coords",this.rank),r=ds("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${a})`,o=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${i};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${i};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((f,d)=>`start[${d}]`).join()});`:e.map((f,d)=>`${r[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${o}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dCe(t,e,n,s){const r=s.texData.get(t.dataId),a=s.makeTensorInfo(n,t.dtype),i=s.texData.get(a.dataId);Object.assign(i,r),i.refCount=1,i.shape=n,i.dtype=t.dtype;let o=hE(e,Be(t.shape));r.slice&&(o+=r.slice.flatOffset),i.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||t.dataId};const l=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,l+1),a}function Tf(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:a,size:i}=s,[o,l]=Jx(r,a,i);if(lE(r,o,l),de(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const d=n.texData.get(r.dataId),p=rSe(d.values,o,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,p)}const{isPacked:c}=n.texData.get(r.dataId),f=cE(r.shape,o,l);if(c||!f){const d=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new fCe(l):new cCe(l),p=[o];return n.runWebGLProgram(d,[r],r.dtype,p)}return n.uploadToGPU(r.dataId),dCe(r,o,l,n)}const pCe={kernelName:Fm,backendName:"webgl",kernelFunc:Tf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mCe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:a,crops:i}=s;M(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=a.reduce((T,N)=>T*N),l=cg(r.shape,a,o),c=hg(l.length,a.length),f=fg(r.shape,a,o),d=yE(i,a.length),p=bE(f,i,a.length),g=[],y=Ee({inputs:{x:r},backend:n,attrs:{shape:l}}),v=bs({inputs:{x:y},backend:n,attrs:{perm:c}}),x=Ee({inputs:{x:v},backend:n,attrs:{shape:f}}),w=Tf({inputs:{x},backend:n,attrs:{begin:d,size:p}});return g.push(y),g.push(v),g.push(x),g.forEach(T=>n.disposeIntermediateTensorInfo(T)),w},gCe={kernelName:Xp,backendName:"webgl",kernelFunc:mCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:a}=e,{size:i}=s,o=n.readSync(r.dataId),l=n.readSync(a.dataId),c=T8(o,l,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,c)}const bCe={kernelName:hb,backendName:"webgl",kernelFunc:yCe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xCe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,vCe=`
  return float(int(a.r) & int(b.r));
`;function wCe(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,a=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=ae().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||i===1){const l=n.texData.get(s.dataId).values,c=n.texData.get(r.dataId).values,[f,d]=$2e(s.shape,r.shape,l,c,s.dtype),p=n.makeTensorInfo(d,s.dtype),g=n.texData.get(p.dataId);return g.values=f,p}let o;return a?o=new wf(xCe,s.shape,r.shape,!1):o=new xu(vCe,s.shape,r.shape),n.runWebGLProgram(o,[s,r],s.dtype)}const SCe={kernelName:Kp,backendName:"webgl",kernelFunc:wCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TCe(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,a=n.readSync(s.dataId),i=n.readSync(r.dataId),o=Ke(Array.from(a),Array.from(i));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const CCe={kernelName:fb,backendName:"webgl",kernelFunc:TCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NCe="return float(a != b);",P8=Qn({opSnippet:NCe,cpuKernelImpl:K2e,dtype:"bool"}),kCe={kernelName:Tm,backendName:"webgl",kernelFunc:P8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eg(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return Ks({inputs:{x:r.complexTensorInfos.real},backend:n})}const ECe={kernelName:Hb,backendName:"webgl",kernelFunc:Eg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ce="return float(int(x));";function ICe(t,e){const n=new Oa(t.shape,$Ce),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TC(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return Ks({inputs:{x:r},backend:n});const i=mn(r.shape),o=TC({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=rl({inputs:{real:o,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(o),l}if(r.dtype==="complex64"){const i=Eg({inputs:{input:r},backend:n}),o=TC({inputs:{x:i},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(i),o}if(!ON(r.dtype,a)){const i=Ks({inputs:{x:r},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:a}}if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId).values,[o,l,c]=I2e(i,r.shape,r.dtype,a);return n.makeTensorInfo(o,l,c)}if(a==="int32")return ICe(r,n);if(a==="bool"){const i=n.makeTensorInfo([],"bool",On("bool",1)),l=P8({inputs:{a:r,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${a}`)}const ACe={kernelName:dh,backendName:"webgl",kernelFunc:TC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FF="return ceil(x);",RCe=yt({opSnippet:FF,packedOpSnippet:FF,cpuKernelImpl:A2e}),DCe={kernelName:ph,backendName:"webgl",kernelFunc:RCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OCe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Ce{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:a,clipValueMax:i}=s;let o;ae().getBool("WEBGL_PACK_CLIP")?o=new _Ce(r.shape):o=new OCe(r.shape);const l=[[a],[i]];return n.runWebGLProgram(o,[r],r.dtype,l)}const LCe={kernelName:mh,backendName:"webgl",kernelFunc:FCe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MCe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LF(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function zCe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),a=new MCe(s.shape),i=[LF(s,r.complexTensorInfos.real),LF(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(a,i,i[0].dtype)}const PCe={kernelName:Yp,backendName:"webgl",kernelFunc:zCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BCe{constructor(e){this.outputShape=[],this.outputShape=za(e,1),this.variableNames=e.map((i,o)=>`T${o}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const o=n[i-1];s.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${o}));`)}const r=n.length,a=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VCe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=za(e,n);const s=this.outputShape,r=s.length,a=Et(r),i=ds("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((v,x)=>`T${x}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let v=1;v<l.length;v++)l[v]=l[v-1]+e[v][n];const c=o[n],f=o.slice(-2),d=o.join();let p=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${f.join()}));
        }`;for(let v=1;v<l.length;v++){const x=l[v-1];p+=`
        if (${c} < ${l[v]}  && ${c} >= ${l[v-1]}) {
          return getChannel(
            getT${v}(${ly(o,c,x)}),
            vec2(${ly(f,c,x)}));
        }`}const g=l.length,y=l[l.length-1];p+=`
        return getChannel(
          getT${g}(${ly(o,c,y)}),
          vec2(${ly(f,c,y)}));`,this.userCode=`
      float getValue(${o.map(v=>"int "+v)}) {
        ${p}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[r-1]} = ${i[r-1]} + 1;
        if (${i[r-1]} < ${s[r-1]}) {
          result.g = getValue(${i});
        }

        ${i[r-2]} = ${i[r-2]} + 1;
        if (${i[r-2]} < ${s[r-2]}) {
          result.a = getValue(${i});
        }

        ${i[r-1]} = ${i[r-1]} - 1;
        if (${i[r-2]} < ${s[r-2]} &&
            ${i[r-1]} < ${s[r-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function ly(t,e,n){const s=t.indexOf(e);return t.map((a,i)=>i===s?`${a} - ${n}`:a).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $v(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return Ks({inputs:{x:r.complexTensorInfos.imag},backend:n})}const UCe={kernelName:Db,backendName:"webgl",kernelFunc:$v};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gd(t,e,n){const s=t[0].dtype;if(s==="complex64"){const g=t.map(T=>Eg({inputs:{input:T},backend:n})),y=t.map(T=>$v({inputs:{input:T},backend:n})),v=Gd(g,e,n),x=Gd(y,e,n),w=rl({inputs:{real:v,imag:x},backend:n});return g.forEach(T=>n.disposeIntermediateTensorInfo(T)),y.forEach(T=>n.disposeIntermediateTensorInfo(T)),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(x),w}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const g=t.map(C=>{const R=[-1,de(C.shape.slice(e))];return Ee({inputs:{x:C},backend:n,attrs:{shape:R}})}),y=g.map(C=>({vals:n.readSync(C.dataId),shape:C.shape})),v=za(g.map(C=>C.shape),1),x=g[0].shape[0]===1,w=R2e(y,v,s,x),T=za(t.map(C=>C.shape),e),N=n.makeTensorInfo(T,s,w);return g.forEach(C=>n.disposeIntermediateTensorInfo(C)),N}const a=t.filter(g=>de(g.shape)>0),i=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&a[0].shape.length>1;if(a.length===1){const g=i?new Oa(t[0].shape,So):new ko(t[0].shape,So);return n.runWebGLProgram(g,t,s)}const o=ae().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(a.length>o){const g=[];for(let v=0;v<a.length;v+=o){const x=a.slice(v,v+o);g.push(Gd(x,e,n))}const y=Gd(g,e,n);for(const v of g)n.disposeIntermediateTensorInfo(v);return y}if(i){const g=new VCe(a.map(y=>y.shape),e);return n.runWebGLProgram(g,a,s)}const{tensors2D:l,outShape:c}=jCe(a,e,n),f=new BCe(l.map(g=>g.shape)),d=n.runWebGLProgram(f,l,s);l.forEach(g=>n.disposeIntermediateTensorInfo(g));const p=Ee({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),p}function jCe(t,e,n){const s=za(t.map(a=>a.shape),e);return{tensors2D:t.map(a=>Ee({inputs:{x:a},attrs:{shape:[-1,de(a.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B8(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,a=nt(r,e[0].shape)[0],i=e.map(c=>c.shape);pE(i,a);const o=za(e.map(c=>c.shape),a);if(de(o)===0)return n.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(c=>de(c.shape)>0);return l.length===1?Ks({inputs:{x:l[0]},backend:n}):Gd(l,a,n)}const WCe={kernelName:Zp,backendName:"webgl",kernelFunc:B8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V8{constructor(e,n=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,o=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,f=e.dilationHeight,d=e.dilationWidth,p=e.filterHeight,g=e.filterWidth,y=Math.floor(e.inChannels/4)*4,v=e.inChannels%4,x=e.dataFormat==="channelsLast",w=x?1:2,T=x?2:3,N=x?3:1;let C="",E="";s&&(r?C=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?C=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:C=`
          float activation(float x) {
            ${s}
          }
        `,E="result = activation(result);");const R=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${C}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${N}];

        ivec2 xRCCorner =
            ivec2(coords[${w}], coords[${T}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${f};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${g}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${y}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${x}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${v===1}) {

              if (${x}) {
                dotProd +=
                    getX(batch, xR, xC, ${y}) *
                    getW(wR, wC, ${y}, d2);
              } else {
                dotProd +=
                    getX(batch, ${y}, xR, xC) *
                    getW(wR, wC, ${y}, d2);
              }

            } else if (${v===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${y}, d2),
                getW(wR, wC, ${y} + 1, d2)
              );

              if (${x}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${y}),
                  getX(batch, xR, xC, ${y} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${y}, xR, xC),
                  getX(batch, ${y} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${v===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${y}, d2),
                getW(wR, wC, ${y} + 1, d2),
                getW(wR, wC, ${y} + 2, d2)
              );

              if (${x}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${y}),
                  getX(batch, xR, xC, ${y} + 1),
                  getX(batch, xR, xC, ${y} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${y}, xR, xC),
                  getX(batch, ${y} + 1, xR, xC),
                  getX(batch, ${y} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${R}
        ${E}
        setOutput(result);
      }
    `}}class GCe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterDepth,p=e.filterHeight,g=e.filterWidth,y=Math.floor(e.inChannels/4)*4,v=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${i}, ${o});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${g}; wC++) {
              int xC = xCCorner + wC * ${f};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${y}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${v===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${y}) *
                  getW(wF, wR, wC, ${y}, d2);
              } else if (${v===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${y}),
                  getX(batch, xF, xR, xC, ${y} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${y}, d2),
                  getW(wF, wR, wC, ${y} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${v===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${y}),
                  getX(batch, xF, xR, xC, ${y} + 1),
                  getX(batch, xF, xR, xC, ${y} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${y}, d2),
                  getW(wF, wR, wC, ${y} + 1, d2),
                  getW(wF, wR, wC, ${y} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U8{constructor(e,n=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=as(this.outputShape.length);const i=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,f=e.filterWidth,d=f;let p=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<f;x++)p+=`
           vec4 xTexelC${x*2};
           int xTexelC${x*2}Ready;
           vec4 xTexelC${x*2+1};
           int xTexelC${x*2+1}Ready;
           vec4 xC${x};`;p+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let x=0;x<f;x++)p+=`
           xTexelC${x*2} = vec4(0.0);
           xTexelC${x*2}Ready = 0;
           xTexelC${x*2+1} = vec4(0.0);
           xTexelC${x*2+1}Ready = 0;
           xC${x} = vec4(0.0);`;p+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let x=0;x<(d+1)/2;x++){const w=x*2;if(p+=`
           xC = xCCorner + ${w*l};
           `,o===1){if(w<f&&(i%2===1?(p+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }
               `,l===1&&w>0?p+=`
                 xC${w} = vec4(xTexelC${w-2}.zw, xTexelC${w}.xy);
                 `:p+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${w} = vec4(previous.zw, xTexelC${w}.xy);
                   } else {
                     xC${w} = vec4(0.0, 0.0, xTexelC${w}.xy);
                   }
                   `):p+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xC${w} = xTexelC${w};
                 `,w+1<f)){const T=i%2===0?ab(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(p+=`
                   xCOffset = xC + imod(pads[1], 2) + ${T};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                     xTexelC${w+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${w+1}.zw = vec2(0.0);
                     }
                     xTexelC${w+1}Ready = 1;
                   }
                   `,l>1?p+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${w+1} = vec4(previous.zw, xTexelC${w+1}.xy);
                     } else {
                      xC${w+1} = vec4(0.0, 0.0, xTexelC${w+1}.xy);
                     }
                     `:p+=`
                     xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.xy);
                     `):T===1?p+=`
                     xC${w+1} = xTexelC${w};
                     `:p+=`
                     xCOffset = xC + ${T};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                       xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${w+1}.zw = vec2(0.0);
                       }
                       xTexelC${w+1}Ready = 1;
                     }

                     xC${w+1} = xTexelC${w+1};
                     `}}else w<f&&(i%2===1?(p+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.0);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
               `,w+1<f&&(p+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${w+1} = vec4(xTexelC${w+1}.xy, final.xy);
                 `)):(p+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(
                   xTexelC${w}.xy, xTexelC${w+1}.xy);
               `,w+1<f&&(p+=`
                   xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
                 `)));w<f&&(p+=`
             wTexel = getW(r, ${w}, d1, d2);
             dotProd += xC${w}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${w}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,w+1<f&&(p+=`
               wTexel = getW(r, ${w+1}, d1, d2);
               dotProd += xC${w+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${w+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}p+=`
     }
   `,p+=`
     }
   `,p+=`
     }
   `;let g="",y="";s&&(r?g=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:a?g=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:g=`vec4 activation(vec4 x) {
           ${s}
         }`,y="result = activation(result);");const v=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${g}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${p}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${v}
         ${y}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HCe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=as(this.outputShape.length);const{dataFormat:s}=n,r=ws(),a=s==="channelsLast",i=a?1:2,o=a?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let f=0;f<=1;f++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${f};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${f*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${f*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U1(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function j8({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:o=null}){const l=t.shape,c=s.texData.get(t.dataId),f=n.inChannels,d=l[0]*l[1]*l[2],p=n.outChannels,g=n.dataFormat==="channelsLast",y=!1,v=!1;let x;const w=[];if(a!=null){const C=U1(a.shape,g);C!=null&&(a=Ee({inputs:{x:a},backend:s,attrs:{shape:C}}),w.push(a))}if(r!=null){const C=U1(r.shape,g);C!=null&&(r=Ee({inputs:{x:r},backend:s,attrs:{shape:C}}),w.push(r))}if(!((d===1||p===1)&&f>F8)&&c.isPacked&&g&&c.texture!=null&&l[2]%2!==0&&at(c.shape.slice(-3),l.slice(-3))){const C=l[0]*l[1]*(l[2]+1),E={dataId:t.dataId,shape:[1,C,n.inChannels],dtype:t.dtype},R=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,M(kp(c.shape,E.shape),()=>`packed reshape ${c.shape} to ${E.shape} isn't free`);const $=Ee({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});w.push($);const O=V1({a:E,b:$,backend:s,transposeA:y,transposeB:v,bias:r,activation:o,preluActivationWeights:a,leakyreluAlpha:i}),A=s.texData.get(O.dataId);M(A.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=R,A.shape=n.outShape,x=Ks({inputs:{x:O},backend:s}),x.shape=n.outShape,w.push(O)}else{const C=n.outHeight*n.outWidth,E=Ee({inputs:{x:t},backend:s,attrs:{shape:g?[n.batchSize,C,n.inChannels]:[n.batchSize,n.inChannels,C]}}),R=Ee({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),$=V1({a:g?E:R,b:g?R:E,transposeA:!g,transposeB:v,backend:s,bias:r,activation:o,preluActivationWeights:a,leakyreluAlpha:i});x=Ee({inputs:{x:$},backend:s,attrs:{shape:n.outShape}}),w.push(E),w.push(R),w.push($)}for(const C of w)s.disposeIntermediateTensorInfo(C);return x}function W8({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:o=null}){const{filterWidth:l,filterHeight:c,inChannels:f,outWidth:d,outHeight:p,dataFormat:g}=n,y=g==="channelsLast",v=l*c*f,x=p*d,w=[n.batchSize,v,x],T=!0,N=!1,C=[];if(a!=null){const Q=U1(a.shape,y);Q!=null&&(a=Ee({inputs:{x:a},backend:s,attrs:{shape:Q}}),C.push(a))}if(r!=null){const Q=U1(r.shape,y);Q!=null&&(r=Ee({inputs:{x:r},backend:s,attrs:{shape:Q}}),C.push(r))}const E=Ee({inputs:{x:e},backend:s,attrs:{shape:[1,v,de(e.shape)/v]}});C.push(E);const R=new HCe(w,n),$=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],O=s.runWebGLProgram(R,[t],"float32",$),A=Ee({inputs:{x:O},backend:s,attrs:{shape:w}});C.push(O),C.push(A);const _=r!=null,D=a!=null,B=o==="leakyrelu",j=o?Ep(o,!0):null,W=new _8(y?A.shape:E.shape,y?E.shape:A.shape,y?[n.batchSize,x,n.outChannels]:[n.batchSize,n.outChannels,x],T,N,_,j,D,B),X=y?[A,E]:[E,A];if(r&&X.push(r),D&&X.push(a),B){const Q=s.makeTensorInfo([],"float32",Vi(i,"float32"));X.push(Q),C.push(Q)}const U=s.runWebGLProgram(W,X,"float32"),Y=Ee({inputs:{x:U},backend:s,attrs:{shape:n.outShape}});C.push(U);for(const Q of C)s.disposeIntermediateTensorInfo(Q);return Y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:i,pad:o,dataFormat:l,dilations:c,dimRoundingMode:f}=s,d=ji(l),p=Ln(r.shape,a.shape,i,c,o,f,!1,d);let g;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))g=j8({x:r,filter:a,convInfo:p,backend:n});else if(p.strideWidth<=2&&d==="channelsLast"&&ae().getBool("WEBGL_EXP_CONV")){const v=new U8(p),x=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];g=n.runWebGLProgram(v,[r,a],"float32",x)}else if(ae().getBool("WEBGL_CONV_IM2COL"))g=W8({x:r,filter:a,convInfo:p,backend:n});else{const v=new V8(p);g=n.runWebGLProgram(v,[r,a],"float32")}const y=Ee({inputs:{x:g},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(g),y}const XCe={kernelName:Qp,backendName:"webgl",kernelFunc:qCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KCe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class YCe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dataFormat==="channelsLast",o=n-1-e.padInfo.top,l=s-1-e.padInfo.left,c=i?1:2,f=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${f}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ZCe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${a};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${o};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class QCe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=n-1-e.padInfo.front,c=s-1-e.padInfo.top,f=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:i,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:f}=s,d=ji(l),p=Ln(r.shape,f,i,1,o,c,!1,d),g=new KCe(p);return n.runWebGLProgram(g,[r,a],"float32")}const eNe={kernelName:pb,backendName:"webgl",kernelFunc:JCe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tNe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=as(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,r=n-1-e.padInfo.top,a=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nNe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{inputShape:i,strides:o,pad:l,dataFormat:c,dimRoundingMode:f}=s,d=ji(c),p=Ln(i,a.shape,o,1,l,f,!1,d);if(ae().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const g=[[p.strideHeight,p.strideWidth]],y=new tNe(p);return n.runWebGLProgram(y,[r,a],"float32",g)}else{const g=new YCe(p);return n.runWebGLProgram(g,[r,a],"float32")}}const sNe={kernelName:Jp,backendName:"webgl",kernelFunc:nNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:i,pad:o,dilations:l}=s,c=Zo(r.shape,a.shape,i,l,o),f=new GCe(c);return n.runWebGLProgram(f,[r,a],"float32")}const aNe={kernelName:em,backendName:"webgl",kernelFunc:rNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:i,pad:o,filterShape:l}=s,c=Zo(r.shape,l,i,1,o),f=new ZCe(c);return n.runWebGLProgram(f,[r,a],"float32")}const oNe={kernelName:mb,backendName:"webgl",kernelFunc:iNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lNe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{pad:i,strides:o,inputShape:l}=s,c=Zo(l,a.shape,o,1,i),f=new QCe(c);return n.runWebGLProgram(f,[r,a],"float32")}const uNe={kernelName:gb,backendName:"webgl",kernelFunc:lNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cNe=Sf+`
  return cos(x);
`,hNe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Lu}
  return result;
`,fNe=yt({opSnippet:cNe,packedOpSnippet:hNe}),dNe={kernelName:gh,backendName:"webgl",kernelFunc:fNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pNe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,mNe=yt({opSnippet:pNe}),gNe={kernelName:yh,backendName:"webgl",kernelFunc:mNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yNe{constructor(e,n,s,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,o,l,c]=e,[f]=n,[d,p]=s;this.outputShape=[f,d,p,c];const g=r==="bilinear"?1:0,[y,v]=[`${o-1}.0`,`${l-1}.0`],[x,w,T]=d>1?[`${(o-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${y} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${y}`],[N,C,E]=p>1?[`${(l-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${v} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${v}`];this.userCode=`
      const float height_ratio = float(${x});
      const float width_ratio = float(${N});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${w};
        float width_scale = ${C};

        float in_y = ${T};
        if( in_y < 0.0 || in_y > ${y} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${E};
        if( in_x < 0.0 || in_x > ${v} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${g} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bNe=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:a,boxInd:i}=e,{cropSize:o,method:l,extrapolationValue:c}=s,f=new yNe(r.shape,a.shape,o,l,c);return n.runWebGLProgram(f,[r,a,i],"float32")},xNe={kernelName:bb,backendName:"webgl",kernelFunc:bNe};var Ip;(function(t){t.Prod="*",t.Sum="+"})(Ip||(Ip={}));class MF{constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,i=this.op===Ip.Prod?"1.0":"0.0",o=s?i:`getX(${zF(a,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",f="";s?(c=r?`end != ${l-1}`:"end != 0",f=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",f=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Et(a)} coords = getOutputCoords();
        int end = ${PF(a,"coords",this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${f};
          ${PF(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${zF(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function zF(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function PF(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G8(t,e,n,s,r,a){const i=e.shape.length,o=qt([s],i);let l=e;o!=null&&(l=bs({inputs:{x:e},backend:n,attrs:{perm:o}}));const c=un(1,i)[0];if(c!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const f=l.shape[c];let d=Ks({inputs:{x:l},backend:n});for(let p=0;p<=Math.ceil(Math.log2(f))-1;p++){const g=new MF(t,l.shape,!1,a),y=[[p]],v=d;d=n.runWebGLProgram(g,[d],d.dtype,y),n.disposeIntermediateTensorInfo(v)}if(r){const p=new MF(t,l.shape,r,a),g=d;d=n.runWebGLProgram(p,[d],d.dtype),n.disposeIntermediateTensorInfo(g)}if(o!=null){const p=Qo(o),g=bs({inputs:{x:d},backend:n,attrs:{perm:p}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),g}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,exclusive:i,reverse:o}=s;return G8(Ip.Prod,r,n,a,i,o)}const wNe={kernelName:yb,backendName:"webgl",kernelFunc:vNe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,exclusive:i,reverse:o}=s;return G8(Ip.Sum,r,n,a,i,o)}const TNe={kernelName:tm,backendName:"webgl",kernelFunc:SNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:a}=e,{size:i,binaryOutput:o}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),c=n.readSync(a.dataId),f=T8(l,c,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,f)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(a),f=E2e(l,c,i,o);return n.makeTensorInfo(f.shape,a.dtype,f.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const NNe={kernelName:xb,backendName:"webgl",kernelFunc:CNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kNe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ENe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:a,dataFormat:i}=s,o=r.shape[0],l=i==="NHWC"?r.shape[1]:r.shape[2],c=i==="NHWC"?r.shape[2]:r.shape[3],f=i==="NHWC"?r.shape[3]:r.shape[1],d=l*a,p=c*a,g=f/(a*a),y=i==="NHWC"?[o,d,p,g]:[o,g,d,p],v=new kNe(y,a,i);return n.runWebGLProgram(v,[r],r.dtype)}const $Ne={kernelName:vb,backendName:"webgl",kernelFunc:ENe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H8{constructor(e,n=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=as(this.outputShape.length);const i=e.filterHeight,o=e.filterWidth,l=e.outChannels/e.inChannels;let c="",f="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,f="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q8{constructor(e,n=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=as(this.outputShape.length);const i=e.outChannels/e.inChannels,o=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,f=e.filterHeight,d=e.filterWidth,p=d;let g=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let w=0;w<d;w++)g+=`
          vec4 xTexelC${w*2};
          int xTexelC${w*2}Ready;
          vec4 xTexelC${w*2+1};
          int xTexelC${w*2+1}Ready;
          vec4 xC${w};`;g+=`
    for (int r = 0; r < ${f}; r++) {
      `;for(let w=0;w<d;w++)g+=`
          xTexelC${w*2} = vec4(0.0);
          xTexelC${w*2}Ready = 0;
          xTexelC${w*2+1} = vec4(0.0);
          xTexelC${w*2+1}Ready = 0;
          xC${w} = vec4(0.0);`;g+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let w=0;w<(p+1)/2;w++){const T=w*2;if(g+=`
          xC = xCCorner + ${T*c};
          `,l===1){if(T<d&&(o%2===1?(g+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T}Ready == 0) {
                  xTexelC${T} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${T}.zw = vec2(0.0);
                  }
                  xTexelC${T}Ready = 1;
                }
              `,c===1&&T>0?g+=`
                xC${T} = vec4(xTexelC${T-2}.zw, xTexelC${T}.xy);
                `:g+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${T} = vec4(previous.zw, xTexelC${T}.xy);
                  } else {
                    xC${T} = vec4(0.0, 0.0, xTexelC${T}.xy);
                  }
                  `):g+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${T}Ready == 0) {
                  xTexelC${T} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${T}.zw = vec2(0.0);
                  }
                  xTexelC${T}Ready = 1;
                }

                xC${T} = xTexelC${T};
                `,T+1<d)){const N=o%2===0?ab(c):c;c%2===0&&o%2===1||c%2!==0&&o%2!==1?(g+=`
                  xCOffset = xC + imod(pads[1], 2) + ${N};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                    xTexelC${T+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${T+1}.zw = vec2(0.0);
                    }
                    xTexelC${T+1}Ready = 1;
                  }
                  `,c>1?g+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${T+1} = vec4(previous.zw, xTexelC${T+1}.xy);
                    } else {
                     xC${T+1} = vec4(0.0, 0.0, xTexelC${T+1}.xy);
                    }
                    `:g+=`
                    xC${T+1} = vec4(xTexelC${T}.zw, xTexelC${T+1}.xy);
                    `):N===1?g+=`
                    xC${T+1} = xTexelC${T};
                    `:g+=`
                    xCOffset = xC + ${N};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                      xTexelC${T+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${T+1}.zw = vec2(0.0);
                      }
                      xTexelC${T+1}Ready = 1;
                    }

                    xC${T+1} = xTexelC${T+1};
                    `}}else T<d&&(o%2===1?(g+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T}Ready == 0) {
                  xTexelC${T} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${T}.zw = vec2(0.0);
                  }
                  xTexelC${T}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${T+1}Ready == 0) {
                  xTexelC${T+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${T+1}.zw = vec2(0.0);
                  }
                  xTexelC${T+1}Ready = 1;
                }

                xC${T} = vec4(xTexelC${T}.zw, xTexelC${T+1}.zw);
              `,T+1<d&&(g+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${T+1} = vec4(xTexelC${T+1}.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${T}Ready == 0) {
                  xTexelC${T} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${T}.zw = vec2(0.0);
                  }
                  xTexelC${T}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                  xTexelC${T+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${T+1}.zw = vec2(0.);
                  }
                  xTexelC${T+1}Ready = 1;
                }

                xC${T} = vec4(
                  xTexelC${T}.xy, xTexelC${T+1}.xy);
              `,T+1<d&&(g+=`
                  xC${T+1} = vec4(xTexelC${T}.zw, xTexelC${T+1}.zw);
                `)));T<d&&(g+=`
            wTexel = getW(r, ${T}, d1, q);
            dotProd += xC${T} * vec4(wTexel.xz, wTexel.xz);
          `,T+1<d&&(g+=`
              wTexel = getW(r, ${T+1}, d1, q);
              dotProd += xC${T+1} * vec4(wTexel.xz, wTexel.xz);
            `))}g+=`
    }
  `,g+=`
      }
    `;let y="",v="";s&&(r?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:y=`vec4 activation(vec4 x) {
          ${s}
        }`,v="result = activation(result);");const x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${y}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${g}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${x}
        ${v}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function INe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:i,pad:o,dilations:l,dimRoundingMode:c}=s;let f=l;f==null&&(f=[1,1]),M(Kn(i,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${f}'`);const d=Ln(r.shape,a.shape,i,f,o,c,!0);let p;ae().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?p=new q8(d):p=new H8(d);const g=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(p,[r,a],"float32",g)}const ANe={kernelName:nm,backendName:"webgl",kernelFunc:INe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RNe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class DNe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=n-1-e.padInfo.top,o=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ONe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:c,filterShape:f}=s,d=Ln(r.shape,f,i,o,l,c,!0),p=new RNe(d);return n.runWebGLProgram(p,[r,a],"float32")}const _Ne={kernelName:wb,backendName:"webgl",kernelFunc:ONe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FNe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:c,inputShape:f}=s,d=Ln(f,a.shape,i,o,l,c,!0),p=new DNe(d);return n.runWebGLProgram(p,[r,a],"float32")}const LNe={kernelName:Sb,backendName:"webgl",kernelFunc:FNe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MNe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zNe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],a=de(s.shape),i=Ee({inputs:{x:s},backend:n,attrs:{shape:[a]}}),o=new MNe(a),l=n.runWebGLProgram(o,[i],i.dtype),c=Ee({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),c}const PNe={kernelName:Tb,backendName:"webgl",kernelFunc:zNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BNe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:a,strideWidth:i,filterHeight:o,filterWidth:l,dilationHeight:c,dilationWidth:f}=e,{top:d,left:p}=r;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${i});
      const ivec2 pads = ivec2(${d}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${f};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:i,pad:o,dilations:l}=s,c=Hm(r.shape,a.shape,i,o,"NHWC",l);let f;const d=new BNe(c);f=n.runWebGLProgram(d,[r,a],"float32");const p=Ee({inputs:{x:f},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(f),p}const UNe={kernelName:sm,backendName:"webgl",kernelFunc:VNe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jNe(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,a=e,{allDims:i,summedDims:o,idDims:l}=kE(r,a.length);$E(i.length,l,a);const{path:c,steps:f}=IE(o,l),d=f.length;let p=null,g=i.length;const y=[];for(let v=0;v<d;++v){for(const x of f[v]){const{permutationIndices:w,expandDims:T}=EE(g,l[x]);let N;AE(w)?N=a[x]:(N=bs({inputs:{x:a[x]},backend:n,attrs:{perm:w}}),y.push(N));const C=N.shape.slice();for(let E=0;E<T.length;++E)C.splice(T[E],0,1);at(N.shape,C)||(N=Ee({inputs:{x:N},backend:n,attrs:{shape:C}}),y.push(N)),p===null?p=N:(p=FI({inputs:{a:N,b:p},backend:n}),y.push(p))}v<d-1&&(c[v]>=0&&(p=Ev({inputs:{x:p},backend:n,attrs:{axis:c[v]-(i.length-g),keepDims:!1}}),y.push(p)),g--)}for(const v of y)v!==p&&n.disposeIntermediateTensorInfo(v);return p}const WNe={kernelName:Nb,backendName:"webgl",kernelFunc:jNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GNe="return (x >= 0.0) ? x : (exp(x) - 1.0);",HNe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,qNe=yt({opSnippet:GNe,packedOpSnippet:HNe}),XNe={kernelName:xh,backendName:"webgl",kernelFunc:qNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KNe="return (b >= 0.0) ? a : a * (b + 1.0);",YNe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,ZNe=t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,a=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new wf(YNe,s.shape,r.shape):new xu(KNe,s.shape,r.shape);return n.runWebGLProgram(a,[s,r],s.dtype)},QNe={kernelName:kb,backendName:"webgl",kernelFunc:ZNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JNe=`
  return vec4(equal(a, b));
`,eke="return float(a == b);",tke=Qn({opSnippet:eke,packedOpSnippet:JNe,dtype:"bool",cpuKernelImpl:D2e}),nke={kernelName:rm,backendName:"webgl",kernelFunc:tke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ske=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${xE};
  float a1 = ${vE};
  float a2 = ${wE};
  float a3 = ${SE};
  float a4 = ${TE};
  float a5 = ${CE};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,rke=yt({opSnippet:ske}),ake={kernelName:vh,backendName:"webgl",kernelFunc:rke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ike=Sf+`
  return exp(x);
`,oke=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,X8=yt({opSnippet:ike,packedOpSnippet:oke,cpuKernelImpl:O2e,dtype:"float32"}),lke={kernelName:wh,backendName:"webgl",kernelFunc:X8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CC(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:a}=e,i=a.shape.length,o=a.shape.slice();let l=r;return r<0&&(M(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+r+1),o.splice(l,0,1),Ee({inputs:{x:a},backend:s,attrs:{shape:o}})}const uke={kernelName:am,backendName:"webgl",kernelFunc:CC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BF="return exp(x) - 1.0;",cke=yt({opSnippet:BF,packedOpSnippet:BF,cpuKernelImpl:_2e}),hke={kernelName:Sh,backendName:"webgl",kernelFunc:cke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VF{constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const a=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${r}.0`:"1.0";let o;if(e==="real")o="return real * expR - imag * expI;";else if(e==="imag")o="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K8(t,e,n){const s=n.texData.get(t.dataId),r=de(t.shape),a=t.shape[t.shape.length-1],i=r/a,o=Ee({inputs:{x:t},backend:n,attrs:{shape:[i,a]}}),l=o.shape,c=new VF("real",l,e),f=new VF("imag",l,e),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],p=n.runWebGLProgram(c,d,"float32"),g=n.runWebGLProgram(f,d,"float32"),y=rl({inputs:{real:p,imag:g},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g);const v=Ee({inputs:{x:y},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(y),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fke(t){const{inputs:e,backend:n}=t,{input:s}=e;return K8(s,!1,n)}const dke={kernelName:Eb,backendName:"webgl",kernelFunc:fke};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pke{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $g(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:a}=n;if(a=a||Cu(r),a==="string"){const i=Zt(a,de(s));return i.fill(r),e.makeTensorInfo(s,a,i)}else{const i=new pke(s,r),o=[[r]];return e.runWebGLProgram(i,[],a,o)}}const mke={kernelName:$b,backendName:"webgl",kernelFunc:$g};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gke{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yke={kernelName:Ib,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new gke(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UF="return floor(x);",bke=yt({opSnippet:UF,packedOpSnippet:UF,cpuKernelImpl:F2e}),xke={kernelName:Th,backendName:"webgl",kernelFunc:bke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vke=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,wke=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,Ske=Qn({opSnippet:vke,packedOpSnippet:wke,dtype:"int32"}),Tke={kernelName:Ch,backendName:"webgl",kernelFunc:Ske};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cke{constructor(e){this.variableNames=["A"];const n=ws(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nke{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=ws(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kke={kernelName:x1,backendName:"webgl",kernelFunc:Eke};let wc,MS=ae().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Eke(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:a}=s,i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=i?[r.videoWidth,r.videoHeight]:[r.width,r.height],f=[c,l],d=[c,l,a];if(o||i){const v=ae().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(wc==null||v!==MS)&&(MS=v,wc=document.createElement("canvas").getContext("2d",{willReadFrequently:MS})),wc.canvas.width=l,wc.canvas.height=c,wc.drawImage(r,0,0,l,c),r=wc.canvas}const p=n.makeTensorInfo(f,"int32");n.texData.get(p.dataId).usage=hr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),r);const g=ae().getBool("WEBGL_PACK")?new Nke(d):new Cke(d),y=n.runWebGLProgram(g,[p],"int32");return n.disposeData(p.dataId),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a,bias:i,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:f,dilations:d,dimRoundingMode:p,activation:g,leakyreluAlpha:y}=s,v=ji(f),x=Ln(r.shape,a.shape,l,d,c,p,!1,v);let w;const T=[],N=i!=null,C=o!=null,E=g==="leakyrelu",R=()=>{const O=[r,a],A=(_,D)=>{if(D==="NCHW"&&_.shape.length===1&&_.shape[0]!==1){const B=Ee({inputs:{x:_},backend:n,attrs:{shape:[_.shape[0],1,1]}});return T.push(B),B}return _};if(N&&O.push(A(i,f)),C&&O.push(A(o,f)),E){const _=n.makeTensorInfo([],"float32",Vi(y,"float32"));O.push(_),T.push(_)}return O};if(x.filterHeight===1&&x.filterWidth===1&&x.dilationHeight===1&&x.dilationWidth===1&&x.strideHeight===1&&x.strideWidth===1&&(x.padInfo.type==="SAME"||x.padInfo.type==="VALID"))w=j8({x:r,filter:a,convInfo:x,backend:n,bias:i,activation:g,preluActivationWeights:o,leakyreluAlpha:y});else if(x.strideWidth<=2&&v==="channelsLast"&&ae().getBool("WEBGL_EXP_CONV")){const O=g?Ep(g,!0):null,A=new U8(x,N,O,C,E),_=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],D=R();w=n.runWebGLProgram(A,D,"float32",_)}else if(ae().getBool("WEBGL_CONV_IM2COL"))w=W8({x:r,filter:a,convInfo:x,backend:n,bias:i,activation:g,preluActivationWeights:o,leakyreluAlpha:y});else{const O=g?Ep(g,!1):null,A=new V8(x,N,O,C,E),_=R();w=n.runWebGLProgram(A,_,"float32")}const $=Ee({inputs:{x:w},backend:n,attrs:{shape:x.outShape}});return T.push(w),T.forEach(O=>n.disposeIntermediateTensorInfo(O)),$}const Ike={kernelName:fp,backendName:"webgl",kernelFunc:$ke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ake(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a,bias:i,preluActivationWeights:o}=e,{strides:l,pad:c,dilations:f,dimRoundingMode:d,activation:p,leakyreluAlpha:g}=s,y=[];let v=f;v==null&&(v=[1,1]),M(Kn(l,v),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${v}'`);const x=Ln(r.shape,a.shape,l,v,c,d,!0),w=ae().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,T=p?Ep(p,w):null,N=[r,a],C=i!=null,E=o!=null,R=p==="leakyrelu";if(C&&N.push(i),E&&N.push(o),R){const _=n.makeTensorInfo([],"float32",Vi(g,"float32"));N.push(_),y.push(_)}let $;w?$=new q8(x,C,T,E,R):$=new H8(x,C,T,E,R);const O=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],A=n.runWebGLProgram($,N,"float32",O);return y.forEach(_=>n.disposeIntermediateTensorInfo(_)),A}const Rke={kernelName:dp,backendName:"webgl",kernelFunc:Ake};class Dke{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const a=Et(s.length);let i=`
    int index;`;for(let o=0;o<this.sliceDim;o++)i+=`
          index = round(getIndices(coords[0], ${o}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};
          flattenIndex += index * ${this.strides[o]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oke(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,a=r.shape,i=a[a.length-1],o=de(s.shape),[l,c,f,d]=Qx(s,r),p=Ee({inputs:{x:r},backend:n,attrs:{shape:[c,i]}}),g=Ee({inputs:{x:s},backend:n,attrs:{shape:[de(s.shape)/f,f]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const w=n.readSync(r.dataId),T=n.bufferSync(s),N=L2e(w,T,s.dtype,c,i,f,d,s.shape,o);return n.makeTensorInfo(l,s.dtype,N.values)}const y=new Dke(i,d,[c,f],s.shape),v=n.runWebGLProgram(y,[g,p],g.dtype),x=Ee({inputs:{x:v},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),x}const _ke={kernelName:Ab,backendName:"webgl",kernelFunc:Oke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fke{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=Et(this.rank),r=Lke(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function Lke(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y8(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:a}=e,{axis:i,batchDims:o}=s,l=nt(i,r.shape)[0];if(ae().get("DEBUG")){const T=n.readSync(a.dataId),N=r.shape[l];for(let C=0;C<T.length;++C){const E=T[C];M(E<=N-1&&E>=0,()=>`GatherV2: the index value ${E} is not in [0, ${N-1}]`)}}const c=DE(r,a,l,o),f=de(a.shape),d=[],p=Ee({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),g=Ee({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,f/c.batchSize]}});d.push(p),d.push(g);const y=[c.batchSize,c.outerSize,f/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,a])||r.dtype==="string"){const T=n.bufferSync(g),N=n.bufferSync(p),C=M2e(N,T,y);return d.forEach(E=>n.disposeIntermediateTensorInfo(E)),n.makeTensorInfo(c.outputShape,C.dtype,C.values)}const v=new Fke(p.shape,y),x=n.runWebGLProgram(v,[p,g],p.dtype);d.push(x);const w=Ee({inputs:{x},backend:n,attrs:{shape:c.outputShape}});return d.forEach(T=>n.disposeIntermediateTensorInfo(T)),w}const Mke={kernelName:om,backendName:"webgl",kernelFunc:Y8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zke="return float(a > b);",Pke=`
  return vec4(greaterThan(a, b));
`,Bke=Qn({opSnippet:zke,packedOpSnippet:Pke,cpuKernelImpl:z2e,dtype:"bool"}),Vke={kernelName:lm,backendName:"webgl",kernelFunc:Bke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uke="return float(a >= b);",jke=`
  return vec4(greaterThanEqual(a, b));
`,Wke=Qn({opSnippet:Uke,packedOpSnippet:jke,dtype:"bool",cpuKernelImpl:P2e}),Gke={kernelName:Nh,backendName:"webgl",kernelFunc:Wke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hke(t){const{inputs:e,backend:n}=t,{input:s}=e;return K8(s,!0,n)}const qke={kernelName:Rb,backendName:"webgl",kernelFunc:Hke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xke="return float(!isnan(x) && !isinf(x));",Kke=yt({opSnippet:Xke,dtype:"bool"}),Yke={kernelName:Eh,backendName:"webgl",kernelFunc:Kke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zke="return float(isinf(x));",Qke=yt({opSnippet:Zke,dtype:"bool"}),Jke={kernelName:$h,backendName:"webgl",kernelFunc:Qke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eEe="return float(isnan(x));",tEe=yt({opSnippet:eEe,dtype:"bool"}),nEe={kernelName:Ih,backendName:"webgl",kernelFunc:tEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sEe="return float(a < b);",rEe=`
  return vec4(lessThan(a, b));
`,aEe=Qn({opSnippet:sEe,packedOpSnippet:rEe,cpuKernelImpl:B2e,dtype:"bool"}),iEe={kernelName:cm,backendName:"webgl",kernelFunc:aEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oEe="return float(a <= b);",lEe=`
  return vec4(lessThanEqual(a, b));
`,uEe=Qn({opSnippet:oEe,packedOpSnippet:lEe,cpuKernelImpl:V2e,dtype:"bool"}),cEe={kernelName:hm,backendName:"webgl",kernelFunc:uEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hEe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:a}=n,i=U2e(s,r,a);return e.makeTensorInfo([i.length],"float32",i)}const fEe={kernelName:Ob,backendName:"webgl",kernelFunc:hEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dEe=Sf+`
  return x < 0.0 ? 0./0. : log(x);
`,pEe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,mEe=yt({opSnippet:dEe,packedOpSnippet:pEe,cpuKernelImpl:j2e}),gEe={kernelName:Ah,backendName:"webgl",kernelFunc:mEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yEe=Sf+`
  return log(1.0 + x);
`,bEe=yt({opSnippet:yEe}),xEe={kernelName:Rh,backendName:"webgl",kernelFunc:bEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vEe="return float(a >= 1.0 && b >= 1.0);",wEe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,SEe=Qn({opSnippet:vEe,packedOpSnippet:wEe,dtype:"bool"}),TEe={kernelName:fm,backendName:"webgl",kernelFunc:SEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CEe="return float(!(x >= 1.0));",NEe=yt({opSnippet:CEe}),kEe={kernelName:dm,backendName:"webgl",kernelFunc:NEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EEe="return float(a >= 1.0 || b >= 1.0);",$Ee=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,IEe=Qn({opSnippet:EEe,packedOpSnippet:$Ee,dtype:"bool"}),AEe={kernelName:pm,backendName:"webgl",kernelFunc:IEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class REe{constructor(e,n,s,r,a){this.variableNames=["x"],this.outputShape=[];const i=n,o=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;a===.5?l=`inversesqrt(${c})`:a===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DEe{constructor(e,n,s,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,o=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;a===.5?l=`inversesqrt(${c})`:a===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OEe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:a,bias:i,alpha:o,beta:l}=s,c=ae().getBool("WEBGL_PACK_NORMALIZATION")?new DEe(r.shape,a,i,o,l):new REe(r.shape,a,i,o,l);return n.runWebGLProgram(c,[r],r.dtype)},_Ee={kernelName:mm,backendName:"webgl",kernelFunc:OEe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FEe{constructor(e,n,s,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${a})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LEe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:a,dy:i}=e,{depthRadius:o,bias:l,alpha:c,beta:f}=s,d=new FEe(r.shape,o,l,c,f);return n.runWebGLProgram(d,[r,a,i],r.dtype)},MEe={kernelName:_b,backendName:"webgl",kernelFunc:LEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zEe(t,e,n,s){const r=de(e),i=de(t.shape)/r,o=Ee({inputs:{x:t},attrs:{shape:[i,r]},backend:s}),l=Mu(o,t.dtype,"max",s),c=Ee({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(o),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z8(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:a,keepDims:i}=s,o=r.shape.length,l=nt(a,r.shape);let c=l;const f=qt(c,o),d=f!=null,p=n.shouldExecuteOnCPU([r]);let g=r;if(d){if(p){const N=n.texData.get(g.dataId).values,C=new Array(o);for(let $=0;$<C.length;$++)C[$]=r.shape[f[$]];const E=OI(N,r.shape,r.dtype,f,C);g=n.makeTensorInfo(C,r.dtype);const R=n.texData.get(g.dataId);R.values=E}else g=kv(r,f,n);c=un(c.length,o)}Yn("max",c,o);const[y,v]=Mn(g.shape,c);let x=y;i&&(x=on(y,l));let w;if(p){const N=n.texData.get(g.dataId).values,C=W2e(N,de(v),x,r.dtype);w=n.makeTensorInfo(x,r.dtype);const E=n.texData.get(w.dataId);E.values=C}else w=zEe(g,v,x,n);return d&&n.disposeIntermediateTensorInfo(g),w}const PEe={kernelName:gm,backendName:"webgl",kernelFunc:Z8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BEe=_I+`
  return max(a, b);
`,VEe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Lu+`
  return result;
`,UEe=Qn({opSnippet:BEe,packedOpSnippet:VEe,cpuKernelImpl:G2e}),jEe={kernelName:Dh,backendName:"webgl",kernelFunc:UEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;gf(r,"maxPool");const{filterSize:a,strides:i,pad:o,dimRoundingMode:l}=s,c=1;M(Kn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const f=Ur(r.shape,a,i,c,o,l);if(f.filterWidth===1&&f.filterHeight===1&&at(f.inShape,f.outShape))return Ks({inputs:{x:r},backend:n});const d=new $p(f,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const GEe={kernelName:ym,backendName:"webgl",kernelFunc:WEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:a,strides:i,pad:o,dataFormat:l,dimRoundingMode:c}=s,f=[1,1,1],d=Ui(r.shape,a,i,f,o,c,l),p=new LI(d,"max",!1);return n.runWebGLProgram(p,[r],r.dtype)}const qEe={kernelName:bm,backendName:"webgl",kernelFunc:HEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XEe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,o=a-1-e.padInfo.top,l=i-1-e.padInfo.left,c=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class KEe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,f=e.effectiveFilterWidth,d=l-1-e.padInfo.front,p=c-1-e.padInfo.top,g=f-1-e.padInfo.left,y=l*c*f-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${p}, ${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${y} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${f} +
                  wR * ${f} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YEe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,i=a,{filterSize:o,strides:l,pad:c,dimRoundingMode:f}=s,d=[1,1,1],p=Ui(i.shape,o,l,d,c,f),g=new LI(p,"max",!0),y=n.runWebGLProgram(g,[i],i.dtype),v=new KEe(p),x=n.runWebGLProgram(v,[r,y],i.dtype);return n.disposeIntermediateTensorInfo(y),x}const ZEe={kernelName:Lb,backendName:"webgl",kernelFunc:YEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QEe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a,output:i}=e,o=a;gf([a,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:f,dimRoundingMode:d}=s,p=Ur(o.shape,l,c,1,f,d),g=!0,y=new $p(p,"max",g),v=n.runWebGLProgram(y,[o],o.dtype),x=new XEe(p),w=n.runWebGLProgram(x,[r,v],o.dtype);return n.disposeIntermediateTensorInfo(v),w}const JEe={kernelName:Fb,backendName:"webgl",kernelFunc:QEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e$e(t,e,n,s){let r=new $p(n,"max",!1);const a=s.runWebGLProgram(r,[t],"float32");r=new $p(n,"max",!0,!0,e);const i=s.runWebGLProgram(r,[t],"float32");return[a,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t$e={kernelName:Mb,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:a,pad:i,includeBatchInIndex:o}=e,l=n;M(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];M(Kn(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const f=Ur(s.shape,r,a,c,i),[d,p]=e$e(s,o,f,l);return[d,p]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n$e(t,e,n,s){const r=de(e),i=de(t.shape)/r,o=Ee({inputs:{x:t},attrs:{shape:[i,r]},backend:s}),l=Mu(o,"float32","mean",s),c=Ee({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(o),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s$e={kernelName:xm,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:a}=e,i=n,o=s.shape.length,l=nt(a,s.shape);let c=l;const f=qt(c,o),d=f!=null,p=i.shouldExecuteOnCPU([s]),g=[];let y=s;if(d){if(p){const C=i.texData.get(y.dataId).values,E=new Array(o);for(let O=0;O<E.length;O++)E[O]=s.shape[f[O]];const R=OI(C,s.shape,s.dtype,f,E);y=i.makeTensorInfo(E,s.dtype);const $=i.texData.get(y.dataId);$.values=R}else y=kv(s,f,i);g.push(y),c=un(c.length,o)}Yn("sum",c,o);const[v,x]=Mn(y.shape,c);let w=v;r&&(w=on(v,l));const T=n$e(y,x,w,i);for(const N of g)i.disposeIntermediateTensorInfo(N);return T}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s,o=r.shape.length,l=nt(a,r.shape);let c=l;const f=qt(c,o);let d=r;f!=null&&(d=bs({inputs:{x:r},backend:n,attrs:{perm:f}}),c=un(c.length,r.shape.length)),Yn("min",c,o);const[p,g]=Mn(d.shape,c),y=de(g),v=Ee({inputs:{x:d},backend:n,attrs:{shape:[-1,y]}}),x=Mu(v,v.dtype,"min",n);let w;if(i){const T=on(p,l);w=Ee({inputs:{x},backend:n,attrs:{shape:T}})}else w=Ee({inputs:{x},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(x),f!=null&&n.disposeIntermediateTensorInfo(d),w}const a$e={kernelName:vm,backendName:"webgl",kernelFunc:r$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i$e=_I+`
  return min(a, b);
`,o$e=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Lu+`
  return result;
`,l$e=Qn({opSnippet:i$e,packedOpSnippet:o$e,cpuKernelImpl:H2e}),u$e={kernelName:Oh,backendName:"webgl",kernelFunc:l$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c$e{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((f,d)=>f[0]+e[d]+f[1]);const r=e.length,a=Et(r),i=n.map(f=>f[0]).join(","),o=n.map((f,d)=>f[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${i};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${o});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h$e{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((y,v)=>y[0]+e[v]+y[1]);const r=e.length,a=Et(r),i=n.map(y=>y[0]).join(","),o=n.map((y,v)=>y[0]+e[v]).join(","),l=ds("rc",r),c=ds("source",r),f=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,p=s==="reflect"?0:1;let g="";if(r===1){const y=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;g=`
        ${a} rc = outputLoc;
        ${y}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${f}) {
          ${y}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const y=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;g=`
        ${a} rc = outputLoc;
        ${y}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${f}) {
          ${y}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${y}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[r-1]} += 1;
          if(${f}) {
            ${y}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${o});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f$e=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:a}=n,i=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new h$e(s.shape,r,a):new c$e(s.shape,r,a);return e.runWebGLProgram(i,[s],s.dtype)},d$e={kernelName:wm,backendName:"webgl",kernelFunc:f$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p$e=`if (b == 0.0) return NAN;
  return mod(a, b);`,m$e=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Lu+`
  return result;
`,g$e=Qn({opSnippet:p$e,packedOpSnippet:m$e}),y$e={kernelName:_h,backendName:"webgl",kernelFunc:g$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b$e{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x$e=`
if (a == b) {
  return 1.0;
};
return a / b;`,v$e=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,Q8=Qn({opSnippet:x$e,packedOpSnippet:v$e,checkOutOfBounds:!0}),w$e={kernelName:bh,backendName:"webgl",kernelFunc:Q8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jF="return a - b;",J8=Qn({opSnippet:jF,packedOpSnippet:jF,supportsComplex:!0,cpuKernelImpl:dSe}),S$e={kernelName:Yh,backendName:"webgl",kernelFunc:J8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ej(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:a}=s,i=nt([a],r.shape),o=Z8({inputs:{x:r},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=on(o.shape,i),c=Ee({inputs:{x:o},backend:n,attrs:{shape:l}}),f=J8({inputs:{a:r,b:c},backend:n}),d=X8({inputs:{x:f},backend:n}),p=Ev({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),g=Ee({inputs:{x:p},backend:n,attrs:{shape:l}}),y=Q8({inputs:{a:d,b:g},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),y}const T$e={kernelName:Pm,backendName:"webgl",kernelFunc:ej};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C$e(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:a,seed:i,normalized:o}=s,l=o?r:ej({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=l.shape[0],f=l.shape[1],d=new b$e(c,f,a),p=[[i]],g=n.runWebGLProgram(d,[l],"int32",p);return o||n.disposeIntermediateTensorInfo(l),g}const N$e={kernelName:zb,backendName:"webgl",kernelFunc:C$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k$e=Wr+`
  return -x;
`,E$e=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function $$e(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const a=n.texData.get(s.dataId),[i,o]=X2e(a.values,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,i)}let r;return ae().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new ko(s.shape,E$e):r=new Oa(s.shape,k$e),n.runWebGLProgram(r,[s],s.dtype)}const I$e={kernelName:Sm,backendName:"webgl",kernelFunc:$$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A$e=Xx;function R$e(t){lr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=s,c=n.readSync(r.dataId),f=n.readSync(a.dataId),{selectedIndices:d}=A$e(c,f,i,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const D$e={kernelName:Pb,backendName:"webgl",kernelFunc:R$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O$e=Kx;function _$e(t){lr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=s,f=n.readSync(r.dataId),d=n.readSync(a.dataId),{selectedIndices:p,validOutputs:g}=O$e(f,d,i,o,l,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([g]))]}const F$e={kernelName:Bb,backendName:"webgl",kernelFunc:_$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L$e=Yx;function M$e(t){lr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=s,f=n.readSync(r.dataId),d=n.readSync(a.dataId),p=i,g=o,y=l,v=c,{selectedIndices:x,selectedScores:w}=L$e(f,d,p,g,y,v);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const z$e={kernelName:Vb,backendName:"webgl",kernelFunc:M$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P$e{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B$e=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:a,depth:i,onValue:o,offValue:l}=s,c=de(r.shape),f=new P$e(c,i,o,l),d=Ee({inputs:{x:r},backend:n,attrs:{shape:[c]}}),p=n.runWebGLProgram(f,[d],a);n.disposeIntermediateTensorInfo(d);const g=[...r.shape,i],y=Ee({inputs:{x:p},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(p),y},V$e={kernelName:Nm,backendName:"webgl",kernelFunc:B$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j1(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=Eg({inputs:{input:s},backend:n}),a=j1({inputs:{x:r},backend:n}),i=$v({inputs:{input:s},backend:n}),o=j1({inputs:{x:i},backend:n}),l=rl({inputs:{real:a,imag:o},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return $g({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const U$e={kernelName:jm,backendName:"webgl",kernelFunc:j1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tj(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=Eg({inputs:{input:s},backend:n}),a=tj({inputs:{x:r},backend:n}),i=$v({inputs:{input:s},backend:n}),o=j1({inputs:{x:i},backend:n}),l=rl({inputs:{real:a,imag:o},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return $g({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const j$e={kernelName:Cm,backendName:"webgl",kernelFunc:tj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W$e(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return CC({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const a=e[0].shape,i=e[0].dtype;e.forEach(f=>{Xn(a,f.shape,"All tensors passed to stack must have matching shapes"),M(i===f.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(f=>{const d=CC({inputs:{input:f},backend:n,attrs:{dim:r}});return o.push(d),d}),c=B8({inputs:l,backend:n,attrs:{axis:r}});return o.forEach(f=>n.disposeIntermediateTensorInfo(f)),c}const G$e={kernelName:km,backendName:"webgl",kernelFunc:W$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H$e{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,f)=>c[0]+e[f]+c[1]);const r=e.length,a=Et(r),i=n.map(c=>c[0]).join(","),o=n.map((c,f)=>c[0]+e[f]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${i};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${o});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q$e{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((v,x)=>v[0]+e[x]+v[1]);const r=e.length,a=Et(r),i=n.map(v=>v[0]).join(","),o=n.map((v,x)=>v[0]+e[x]).join(","),l=ds("rc",r),c=ds("source",r),f=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,p=[`${a} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${f}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${f}) {`],g=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let y="";for(let v=0,x=r===1?2:4;v<x;v++)y+=`
        ${p[v]}
        if (${g}) {
          result[${v}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${v}] = getChannel(getX(${c.join()}), ${d});
        }
      `;y+=r===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${o});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${y}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nj=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:a,constantValue:i}=s;if(de(r.shape)===0){const c=a.map((f,d)=>f[0]+r.shape[d]+f[1]);return $g({backend:n,attrs:{shape:c,value:i,dtype:r.dtype}})}const o=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new q$e(r.shape,a,i):new H$e(r.shape,a,i),l=[[i]];return n.runWebGLProgram(o,[r],r.dtype,l)},X$e={kernelName:Em,backendName:"webgl",kernelFunc:nj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K$e=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,Y$e=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Lu+`
  return result;
`,Z$e=Qn({opSnippet:K$e,packedOpSnippet:Y$e}),Q$e={kernelName:Lh,backendName:"webgl",kernelFunc:Z$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s,o=r.shape.length,l=[],c=nt(a,r.shape);let f=c;const d=qt(f,o);let p=r;d!=null&&(p=bs({inputs:{x:r},backend:n,attrs:{perm:d}}),f=un(f.length,o),l.push(p)),Yn("prod",f,o);let g;if(n.shouldExecuteOnCPU([p])){const y=n.texData.get(p.dataId).values,{outVals:v,outShape:x,outDtype:w}=Y2e(p.shape,p.dtype,y,f);g=n.makeTensorInfo(x,w,v)}else{const[y,v]=Mn(p.shape,f),x=de(v),w=Ee({inputs:{x:p},backend:n,attrs:{shape:[-1,x]}}),T=dx(r.dtype),N=Mu(w,T,"prod",n);g=Ee({inputs:{x:N},backend:n,attrs:{shape:y}}),l.push(w),l.push(N)}if(i){l.push(g);const y=on(g.shape,c);g=Ee({inputs:{x:g},backend:n,attrs:{shape:y}})}return l.forEach(y=>n.disposeIntermediateTensorInfo(y)),g}const eIe={kernelName:Im,backendName:"webgl",kernelFunc:J$e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tIe(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:a,indices:i}=e,{outputRaggedRank:o}=s,l=r.map(w=>n.readSync(w.dataId)),c=r.map(w=>w.shape),f=n.readSync(a.dataId),d=n.readSync(i.dataId),[p,g,y]=Z2e(l,c,f,a.shape,a.dtype,d,i.shape,o),v=p.map(w=>n.makeTensorInfo([w.length],"int32",w)),x=n.makeTensorInfo(y,a.dtype,g);return v.concat([x])}const nIe={kernelName:Ub,backendName:"webgl",kernelFunc:tIe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sIe(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:a}=e,i=n.readSync(s.dataId),o=n.readSync(r.dataId),l=n.readSync(a.dataId),[c,f]=Q2e(i,s.shape,s.dtype,o,r.shape,l,a.shape),d=n.makeTensorInfo([c.length],"int32",c),p=n.makeTensorInfo([f.length],s.dtype,f);return[d,p]}const rIe={kernelName:jb,backendName:"webgl",kernelFunc:sIe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aIe(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:a,defaultValue:i,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=s,c=n.readSync(r.dataId),f=n.readSync(a.dataId),d=n.readSync(i.dataId),p=o.map(x=>n.readSync(x.dataId)),g=o.map(x=>x.shape),[y,v]=J2e(c,r.shape,f,a.shape,a.dtype,d,i.shape,p,g,l);return n.makeTensorInfo(y,a.dtype,v)}const iIe={kernelName:Wb,backendName:"webgl",kernelFunc:aIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sj=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:a,dtype:i}=n,o=eSe(s,r,a,i);return e.makeTensorInfo([o.length],i,o)},oIe={kernelName:Gb,backendName:"webgl",kernelFunc:sj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lIe="return 1.0 / x;",uIe=yt({opSnippet:lIe}),cIe={kernelName:Mh,backendName:"webgl",kernelFunc:uIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hIe=Wr+`
  return (x < 0.0) ? 0.0 : x;
`,fIe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,dIe=yt({opSnippet:hIe,packedOpSnippet:fIe}),pIe={kernelName:zh,backendName:"webgl",kernelFunc:dIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mIe=Wr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,gIe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,yIe=yt({opSnippet:mIe,packedOpSnippet:gIe}),bIe={kernelName:Ph,backendName:"webgl",kernelFunc:yIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xIe{constructor(e,n,s,r,a){this.variableNames=["A"],this.outputShape=[];const[i,o,l,c]=e;this.outputShape=[i,n,s,c];const f=[r&&n>1?o-1:o,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let p;a?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${f[0]/d[0]},
          ${f[1]/d[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vIe{constructor(e,n,s,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,l,c]=e;this.outputShape=[i,n,s,c];const f=[r&&n>1?o-1:o,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let p;a?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${f[0]/d[0]},
          ${f[1]/d[1]},
          ${f[1]/d[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wIe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:a,halfPixelCenters:i,size:o}=s,[l,c]=o,f=ae().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new vIe(r.shape,l,c,a,i):new xIe(r.shape,l,c,a,i);return n.runWebGLProgram(f,[r],"float32")}const SIe={kernelName:Dm,backendName:"webgl",kernelFunc:wIe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TIe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,a]=n,[,i,o]=e,l=[s&&i>1?r-1:r,s&&o>1?a-1:a],c=[s&&i>1?i-1:i,s&&o>1?o-1:o],f=l[0]/c[0],d=l[1]/c[1],p=1/f,g=1/d,y=Math.ceil(p)*2+2,v=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${f});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${g});

        const int winHeight = int(${y});
        const int winWidth = int(${v});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CIe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:a}=e,{alignCorners:i}=s,o=new TIe(a.shape,r.shape,i);return n.runWebGLProgram(o,[a],a.dtype)}const NIe={kernelName:Xb,backendName:"webgl",kernelFunc:CIe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kIe{constructor(e,n,s,r,a){this.variableNames=["A"],this.outputShape=[];const[i,o,l,c]=e;this.outputShape=[i,n,s,c];const f=[r&&n>1?o-1:o,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],p=r?"0.5":"0.0";let g;a?g="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":g="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${f[0]/d[0]},
          ${f[1]/d[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EIe{constructor(e,n,s,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,l,c]=e;this.outputShape=[i,n,s,c];const f=[r&&n>1?o-1:o,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],p=r?"0.5":"0.0";let g;a?g="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":g="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${f[0]/d[0]},
          ${f[1]/d[1]},
          ${f[1]/d[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ie(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:a,halfPixelCenters:i,size:o}=s,[l,c]=o,f=ae().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new EIe(r.shape,l,c,a,i):new kIe(r.shape,l,c,a,i);return n.runWebGLProgram(f,[r],r.dtype)}const IIe={kernelName:Rm,backendName:"webgl",kernelFunc:$Ie};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AIe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,a]=n,[,i,o]=e,l=[s&&i>1?r-1:r,s&&o>1?a-1:a],c=[s&&i>1?i-1:i,s&&o>1?o-1:o],f=l[0]/c[0],d=l[1]/c[1],p=1/f,g=1/d,y=Math.ceil(p)*2+2,v=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${f});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${g});

        const int winHeight = int(${y});
        const int winWidth = int(${v});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RIe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:a}=e,{alignCorners:i}=s,o=new AIe(a.shape,r.shape,i);return n.runWebGLProgram(o,[a],a.dtype)}const DIe={kernelName:qb,backendName:"webgl",kernelFunc:RIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OIe{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=o=>n.indexOf(o)!==-1&&e[o]!==1?`${e[o]} - coords[${o}] - 1`:`coords[${o}]`,a=e.map((o,l)=>r(l)).join(","),i=Et(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Ie{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=ds("rc",s),a=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,o=Et(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${a}){
            result.g = ${c(r.slice())};
          }
          if(${i}) {
            result.b = ${f(r.slice())};
            if(${a}) {
              result.a = ${d(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(y){return p(y)}function c(y){return y[s-1]="("+y[s-1]+" + 1)",p(y)}function f(y){return y[s-2]="("+y[s-2]+" + 1)",p(y)}function d(y){return y[s-1]="("+y[s-1]+" + 1)",y[s-2]="("+y[s-2]+" + 1)",p(y)}function p(y){const v=e.map((T,N)=>g(N,y)),x=v.join(","),w=v.slice(-2).join(",");return`getChannel(getX(${x}), vec2(${w}))`}function g(y,v){return n.indexOf(y)!==-1&&e[y]!==1?`${e[y]} - ${v[y]} - 1`:`${v[y]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:a}=s,i=r.shape.length,o=nt(a,r.shape);if(i===0)return Ks({inputs:{x:r},backend:n});const l=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new _Ie(r.shape,o):new OIe(r.shape,o);return n.runWebGLProgram(l,[r],r.dtype)}const LIe={kernelName:Om,backendName:"webgl",kernelFunc:FIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MIe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let a="";typeof n=="number"?a=`float outputValue = ${n.toFixed(2)};`:a=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zIe={kernelName:hx,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:a,center:i}=e,o=n,l=new MIe(s.shape,a),[c,f]=gE(i,s.shape[1],s.shape[2]),d=[[c,f,Math.sin(r),Math.cos(r)]];return o.runWebGLProgram(l,[s],s.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PIe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,BIe=yt({opSnippet:PIe}),VIe={kernelName:Bh,backendName:"webgl",kernelFunc:BIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UIe="return inversesqrt(x);",jIe=yt({opSnippet:UIe,cpuKernelImpl:tSe}),WIe={kernelName:Vh,backendName:"webgl",kernelFunc:jIe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MI{constructor(e,n,s,r,a,i,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const c=Et(a.length),f=Et(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const p=`getIndices(${d})`;let g="";r===1?g="i":r===2&&(g="i, coords[1]");const y=`getUpdates(${g})`;let v="";l&&(v="coords[0], coords[1]");const x=`getDefaultValue(${v})`,w=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${a});

        void main() {
          ${f} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${p});
              flattenedIndex += index * ${w};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${y};
              found = true;
            }
          }
          setOutput(mix(${x}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GIe{constructor(e,n,s,r,a,i,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const c=Et(a.length),f=Et(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const p=`getIndices(${d})`;let g="";r===1?g="i":r===2&&(g="i, coords[1]");const y=`getUpdates(${g})`;let v="";l&&(v="coords[0], coords[1]");const x=`getDefaultValue(${v})`,w=n>1?"strides[j]":"strides",T=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${a});

        void main() {
          ${f} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${p});
              flattenedIndex += index.xz * ${w};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${T};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${y};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${x}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HIe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:a}=e,{shape:i}=s,{sliceRank:o,numUpdates:l,sliceSize:c,strides:f,outputSize:d}=nl(a,r,i),p=[d/c,c];if(d===0)return n.makeTensorInfo(i,r.dtype);const g=Ee({inputs:{x:r},backend:n,attrs:{shape:[l,o]}}),y=Ee({inputs:{x:a},backend:n,attrs:{shape:[l,c]}}),v=n.makeTensorInfo([],"float32",new Float32Array([0]));let x;ae().getBool("WEBGL_PACK")?x=new GIe(l,o,g.shape.length,y.shape.length,f,p):x=new MI(l,o,g.shape.length,y.shape.length,f,p);const w=n.runWebGLProgram(x,[y,g,v],y.dtype),T=Ee({inputs:{x:w},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(v),T}const qIe={kernelName:Kb,backendName:"webgl",kernelFunc:HIe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XIe{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const a="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,o=ae().getNumber("WEBGL_VERSION")===2?a:i,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${o}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KIe(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:a}=e,{side:i}=s,o=new XIe(r.shape[0],r.shape[1],a.shape[1],i),l=[[r.shape[1]]];return n.runWebGLProgram(o,[r,a],"int32",l)}const YIe={kernelName:Zb,backendName:"webgl",kernelFunc:KIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZIe{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,a;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)a="resRC",r="resRC";else{const o=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let f=0;f<n.length;f++)c.push(`${o[f]}`),f<e&&l.push(`${o[f]}`);r=l.join(),a=c.join()}const i=Et(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QIe(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:a}=e,i=new ZIe(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(i,[s,r,a],As(r.dtype,a.dtype))}const JIe={kernelName:_m,backendName:"webgl",kernelFunc:QIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eAe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${tv};
  float scale = ${nv};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,tAe=yt({opSnippet:eAe}),nAe={kernelName:Uh,backendName:"webgl",kernelFunc:tAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sAe=Sf+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,rAe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,aAe=yt({opSnippet:sAe,packedOpSnippet:rAe,cpuKernelImpl:sSe}),iAe={kernelName:Hh,backendName:"webgl",kernelFunc:aAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oAe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,lAe=yt({opSnippet:oAe}),uAe={kernelName:Gh,backendName:"webgl",kernelFunc:lAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cAe=Sf+`
  return sin(x);
`,hAe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Lu}
  return result;
`,fAe=yt({opSnippet:cAe,packedOpSnippet:hAe}),dAe={kernelName:jh,backendName:"webgl",kernelFunc:fAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pAe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,mAe=yt({opSnippet:pAe}),gAe={kernelName:Wh,backendName:"webgl",kernelFunc:mAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yAe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,bAe=yt({opSnippet:yAe}),xAe={kernelName:qh,backendName:"webgl",kernelFunc:bAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vAe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:a,paddings:i}=s;M(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=a.reduce((w,T)=>w*T),l=[[0,0]];l.push(...i);for(let w=1+a.length;w<r.shape.length;++w)l.push([0,0]);const c=[],f=nj({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),d=cg(f.shape,a,o,!1),p=hg(d.length,a.length,!1),g=fg(f.shape,a,o,!1),y=Ee({inputs:{x:f},backend:n,attrs:{shape:d}}),v=bs({inputs:{x:y},backend:n,attrs:{perm:p}}),x=Ee({inputs:{x:v},backend:n,attrs:{shape:g}});return c.push(f),c.push(y),c.push(v),c.forEach(w=>n.disposeIntermediateTensorInfo(w)),x},wAe={kernelName:Mm,backendName:"webgl",kernelFunc:vAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SAe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:a,defaultValue:i}=e;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const o=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(a.dataId),f=n.readSync(i.dataId)[0],[d,p,g,y,v]=aSe(o,s.shape,s.dtype,l,r.dtype,c,f);return[n.makeTensorInfo(p,s.dtype,d),n.makeTensorInfo([p[0]],r.dtype,g),n.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(x=>Number(x)))),n.makeTensorInfo([v.length],s.dtype,new Int32Array(v))]}const TAe={kernelName:Qb,backendName:"webgl",kernelFunc:SAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CAe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:a}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const i=Array.from(n.readSync(r.dataId)),o=n.readSync(s.dataId),l=Array.from(n.readSync(a.dataId)),[c,f,d]=iSe(o,s.shape,s.dtype,i,l);return[n.makeTensorInfo(f,s.dtype,c),n.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}const NAe={kernelName:Jb,backendName:"webgl",kernelFunc:CAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kAe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${a.shape}`);const i=n.readSync(s.dataId),o=n.readSync(r.dataId),l=n.readSync(a.dataId),[c,f]=N8(i,s.shape,s.dtype,o,l,!0);return n.makeTensorInfo(f,s.dtype,c)}const EAe={kernelName:ex,backendName:"webgl",kernelFunc:kAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ae(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${a.shape}`);const i=n.readSync(s.dataId),o=n.readSync(r.dataId),l=n.readSync(a.dataId),[c,f]=N8(i,s.shape,s.dtype,o,l);return n.makeTensorInfo(f,s.dtype,c)}const IAe={kernelName:tx,backendName:"webgl",kernelFunc:$Ae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AAe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:a,defaultValue:i}=e,{outputShape:o}=s,{sliceRank:l,numUpdates:c,sliceSize:f,strides:d,outputSize:p}=nl(a,r,o),g=!1;if(a.dtype==="string"){const w=n.bufferSync(r),T=n.bufferSync(a),N=Ri(n.readSync(i.dataId)[0]),C=nSe(w,T,o,p,f,c,l,d,N,g);return n.makeTensorInfo(o,C.dtype,C.values)}const y=new MI(c,l,r.shape.length,a.shape.length,d,[p,1],g),v=n.runWebGLProgram(y,[a,r,i],a.dtype),x=Ee({inputs:{x:v},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(v),x}const RAe={kernelName:nx,backendName:"webgl",kernelFunc:AAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DAe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:a,axis:i}=s,o=nt(i,r.shape)[0],l=RE(r,a,o),c=r.shape.length,f=new Array(c).fill(0),d=r.shape.slice();return l.map(p=>{const g=[...d];g[o]=p;const y=Tf({inputs:{x:r},backend:n,attrs:{begin:f,size:g}});return f[o]+=p,y})}const OAe={kernelName:zm,backendName:"webgl",kernelFunc:DAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WF="return sqrt(x);",_Ae=yt({opSnippet:WF,packedOpSnippet:WF,cpuKernelImpl:oSe}),FAe={kernelName:Xh,backendName:"webgl",kernelFunc:_Ae};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LAe="return x * x;",MAe=yt({opSnippet:LAe}),zAe={kernelName:sx,backendName:"webgl",kernelFunc:MAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GF="return (a - b) * (a - b);",PAe=Qn({opSnippet:GF,packedOpSnippet:GF}),BAe={kernelName:Kh,backendName:"webgl",kernelFunc:PAe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VAe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const a=n.readSync(r.dataId),i=Li(a),o=lSe(i,"string",s);return n.makeTensorInfo(r.shape,"string",o)}const UAe={kernelName:Bm,backendName:"webgl",kernelFunc:VAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jAe({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=Wr+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,a=new Oa(s.shape,r);return n.runWebGLProgram(a,[s],s.dtype)}const WAe={kernelName:ef,backendName:"webgl",kernelFunc:jAe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GAe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,a=Et(s.length),i=Et(s.length);let o="";if(r===1)o="coords * strides + begin";else{let l=0;o=s.map((c,f)=>(l++,s.length===1?`coords * strides[${f}] + begin[${f}]`:`coords[${l-1}] * strides[${f}] + begin[${f}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${e});
      ${a} strides = ${a}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HAe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:a,end:i,strides:o,beginMask:l,endMask:c,ellipsisMask:f,newAxisMask:d,shrinkAxisMask:p}=s,{finalShapeSparse:g,finalShape:y,isIdentity:v,sliceDim0:x,isSimpleSlice:w,begin:T,end:N,strides:C}=fE(r.shape,a,i,o,l,c,f,d,p);let E;if(v)E=Ee({inputs:{x:r},backend:n,attrs:{shape:y}});else if(x||w){M(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const $=uE(T,N,C),O=Tf({inputs:{x:r},backend:n,attrs:{begin:T,size:$}});E=Ee({inputs:{x:O},backend:n,attrs:{shape:y}}),n.disposeIntermediateTensorInfo(O)}else if(n.shouldExecuteOnCPU([r])){const O=n.readSync(r.dataId),A=Qe(r.shape,r.dtype,O),_=uSe(g,A,C,T);E=n.makeTensorInfo(y,r.dtype,_.values)}else{const O=new GAe(T,C,g);E=n.runWebGLProgram(O,[r],r.dtype)}const R=Ee({inputs:{x:E},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(E),R}const qAe={kernelName:rx,backendName:"webgl",kernelFunc:HAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XAe(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:a,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:c}=s,{data:f,dataSplits:d}=e,p=n.readSync(f.dataId),g=n.readSync(d.dataId),[y,v]=cSe(p,g,r,a,i,o,l,c);return[n.makeTensorInfo([y.length],"string",y),n.makeTensorInfo(d.shape,"int32",v)]}const KAe={kernelName:ax,backendName:"webgl",kernelFunc:XAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YAe(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:a,delimiter:i}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const o=n.readSync(a.dataId),l=n.readSync(i.dataId)[0],[c,f,d]=hSe(o,l,r),p=f.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",f),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const ZAe={kernelName:ix,backendName:"webgl",kernelFunc:YAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QAe(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(a.dataId),o=fSe(i,r);return n.makeTensorInfo(a.shape,"int32",o)}const JAe={kernelName:ox,backendName:"webgl",kernelFunc:QAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eRe="return tan(x);",tRe=yt({opSnippet:eRe}),nRe={kernelName:Zh,backendName:"webgl",kernelFunc:tRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sRe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,rRe=yt({opSnippet:sRe}),aRe={kernelName:Qh,backendName:"webgl",kernelFunc:rRe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iRe(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:r,indices:a,updates:i}=e,{sliceRank:o,numUpdates:l,sliceSize:c,strides:f,outputSize:d}=nl(i,a,r.shape),p=[d/c,c];if(d===0)return n.makeTensorInfo(r.shape,a.dtype);const g=Ee({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),y=Ee({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),v=Ee({inputs:{x:r},backend:n,attrs:{shape:p}}),x=new MI(l,o,g.shape.length,y.shape.length,f,p,!1,!0),w=n.runWebGLProgram(x,[y,g,v],v.dtype),T=Ee({inputs:{x:w},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(w),T}const oRe={kernelName:Yb,backendName:"webgl",kernelFunc:iRe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lRe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[i]*n[i];this.outputShape=s,this.rank=s.length;const r=Et(this.rank),a=uRe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}}function uRe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rj(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:a}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),c=r.dtype==="string"?l.map(p=>Ri(p)):l,f=Qe(r.shape,r.dtype,c),d=pSe(f,a);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new lRe(r.shape,a);return n.runWebGLProgram(i,[r],r.dtype)}const cRe={kernelName:Jh,backendName:"webgl",kernelFunc:rj};class hRe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class fRe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rl(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function HF(t){let e=1;for(;e<t;)e*=2;return e}function dRe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:a,sorted:i}=s,o=ae().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=ae().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,f=c[c.length-1];if(n.shouldExecuteOnCPU([r])||f<o||a>l){const _=n.readSync(r.dataId),[D,B]=mSe(_,c,r.dtype,a,i);return[n.makeTensorInfo(D.shape,D.dtype,D.values),n.makeTensorInfo(B.shape,B.dtype,B.values)]}if(a===0)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(f===1)return[r,$g({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(r.dataId),p=d!==null&&d.isPacked,g=p?n.unpackTensor(r):r,v=de(c)/f,x=Ee({inputs:{x:g},attrs:{shape:[v,f]},backend:n});p&&Rl(n,g);const w=HF(a),T=HF(f);let N=null;const C=()=>N===null?[x,x]:[x,N],E=(_,D,B)=>{const j=C(),W=new hRe(B),U=[[f],[N===null?1:0],[Number.NEGATIVE_INFINITY],[_],[D]],Y=N;N=n.runWebGLProgram(W,j,"int32",U),Rl(n,Y)};for(let _=1;_<w;_*=2){const D=_*2;for(let B=_;B>=1;B/=2)E(D,B,[v,T])}for(let _=T;_>w;_/=2){const D=C(),B=new fRe([v,_/2]),W=[[f],[N===null?1:0],[w]],X=N;N=n.runWebGLProgram(B,D,"int32",W),Rl(n,X);const U=w/2,Y=U*2;for(let Q=U;Q>=1;Q/=2)E(Y,Q,N.shape)}let R=N;N=Tf({inputs:{x:N},backend:n,attrs:{begin:0,size:[v,a]}}),Rl(n,R);let $=Y8({inputs:{x,indices:N},backend:n,attrs:{axis:1,batchDims:1}});Rl(n,x);const O=c.slice(0,-1);O.push(a),R=N,N=Ee({inputs:{x:N},attrs:{shape:O},backend:n}),Rl(n,R);const A=$;return $=Ee({inputs:{x:$},attrs:{shape:O},backend:n}),Rl(n,A),[$,N]}const pRe={kernelName:lx,backendName:"webgl",kernelFunc:dRe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mRe{constructor(e,n,s,r,a,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const o=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gRe(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:a}=e,{interpolation:i,fillMode:o,fillValue:l,outputShape:c}=s,[f,d,p,g]=r.shape,[y,v]=c??[d,p],x=[f,y,v,g],w=new mRe(d,p,i,o,l,x);return n.runWebGLProgram(w,[r,a],"float32")}const yRe={kernelName:ux,backendName:"webgl",kernelFunc:gRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bRe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:a}=e;gf(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(a.dataId),{outputValues:o,outputShape:l,indices:c}=gSe(i,r,a.shape,a.dtype);return[s.makeTensorInfo(l,a.dtype,o),s.makeTensorInfo([c.length],"int32",c)]}const xRe={kernelName:cx,backendName:"webgl",kernelFunc:bRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vRe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:a}=s;a<0&&(a+=r.shape.length);const i=r,o=i.shape.length,l=r.shape[a],c=new Array(o-1);let f=0;for(let v=0;v<o;v++)v!==a&&(c[f++]=i.shape[v]);const d=[],p=new Array(o).fill(0),g=i.shape.slice();g[a]=1;const y=new Array(l);for(let v=0;v<y.length;v++){p[a]=v;const x=Tf({inputs:{x:i},backend:n,attrs:{begin:p,size:g}}),w=Ee({inputs:{x},backend:n,attrs:{shape:c}});y[v]=w,d.push(x)}return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),y}const wRe={kernelName:Vm,backendName:"webgl",kernelFunc:vRe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SRe{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,a=e.inSize,i=e.numSegments,o=i*Math.ceil(a/s);this.outputShape=[r,o];const l="0.0",c="sumValue",f=Math.floor(s/4)*4,d=s%4,p=`
        sumValue += dot(values, segFilter);
    `;let g="";a%s>0&&(g=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let y="";a%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${g}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${y}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${f}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${f};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TRe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:a}=e,{numSegments:i}=s,o=r.shape.length,l=[];let c=0;const f=qt([c],o);let d=r;f!=null&&(d=bs({inputs:{x:r},backend:n,attrs:{perm:f}}),l.push(d),c=un(1,o)[0]);const p=_B(d.shape,c,i),g=de([d.shape[c]]),y=Ee({inputs:{x:d},backend:n,attrs:{shape:[-1,g]}});l.push(y);const v=dx(r.dtype),x=(C,E,R,$,O)=>{const A=C.shape[0],_=C.shape[1],D=OB(_,O),B={windowSize:D,inSize:_,batchSize:A,numSegments:O},j=new SRe(B,E),W=n.compileAndRun(j,[C,R],$);if(l.push(W),W.shape[1]===O)return W;const X=sj({backend:n,attrs:{start:0,stop:O,step:1,dtype:"float32"}}),U=rj({inputs:{x:X},backend:n,attrs:{reps:[_/D]}});return l.push(X),l.push(U),x(W,E,U,$,O)},w=x(y,"unsortedSegmentSum",a,v,i),T=Ee({inputs:{x:w},backend:n,attrs:{shape:p}});let N=T;if(f!=null){l.push(T);const C=Qo(f);N=bs({inputs:{x:N},backend:n,attrs:{perm:C}})}return l.forEach(C=>n.disposeIntermediateTensorInfo(C)),N}const CRe={kernelName:Um,backendName:"webgl",kernelFunc:TRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NRe=[lTe,cTe,dTe,gTe,bTe,wTe,TTe,NTe,ITe,RTe,_Te,MTe,BTe,WTe,qTe,KTe,ZTe,tCe,sCe,aCe,uCe,gCe,bCe,SCe,CCe,ACe,DCe,LCe,GSe,PCe,WCe,XCe,eNe,sNe,aNe,oNe,uNe,dNe,gNe,xNe,wNe,TNe,NNe,$Ne,ANe,_Ne,LNe,PNe,UNe,WNe,XNe,QNe,nke,ake,lke,uke,hke,dke,mke,yke,xke,Tke,kke,Ike,Rke,_ke,Mke,Vke,Gke,WSe,qke,UCe,Yke,Jke,nEe,qSe,iEe,cEe,fEe,gEe,xEe,TEe,kEe,AEe,_Ee,MEe,PEe,jEe,GEe,qEe,ZEe,JEe,t$e,s$e,a$e,u$e,d$e,y$e,N$e,YSe,I$e,D$e,F$e,z$e,kCe,V$e,j$e,G$e,X$e,Q$e,KSe,eIe,nIe,rIe,iIe,oIe,ECe,w$e,cIe,pIe,bIe,QSe,SIe,NIe,IIe,DIe,LIe,zIe,VIe,WIe,qIe,YIe,JIe,nAe,iAe,uAe,dAe,gAe,pCe,T$e,xAe,wAe,TAe,NAe,EAe,IAe,RAe,OAe,FAe,zAe,BAe,UAe,WAe,qAe,KAe,ZAe,JAe,S$e,aTe,nRe,aRe,oRe,cRe,pRe,yRe,iTe,xRe,wRe,CRe,U$e];for(const t of NRe)fx(t);/** @license See the LICENSE file. */const kRe="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ERe={"tfjs-core":cB,"tfjs-backend-cpu":pU,"tfjs-backend-webgl":$8,"tfjs-data":b5,"tfjs-layers":mv,"tfjs-converter":t5,tfjs:kRe},$Re=Object.freeze(Object.defineProperty({__proto__:null,Abs:Vp,Acos:ih,Acosh:oh,AdadeltaOptimizer:Jk,AdagradOptimizer:eE,AdamOptimizer:tE,AdamaxOptimizer:nE,Add:ku,AddN:Up,All:ob,Any:lb,ArgMax:jp,ArgMin:Wp,Asin:lh,Asinh:uh,Atan:ch,Atan2:fh,Atanh:hh,AvgPool:Gp,AvgPool3D:Hp,AvgPool3DGrad:cb,AvgPoolGrad:ub,BatchMatMul:qp,BatchToSpaceND:Xp,Bincount:hb,BitwiseAnd:Kp,BroadcastArgs:fb,BroadcastTo:cP,Callback:YV,CallbackList:JB,Cast:dh,Ceil:ph,ClipByValue:mh,Complex:db,ComplexAbs:Yp,Concat:Zp,Conv2D:Qp,Conv2DBackpropFilter:pb,Conv2DBackpropInput:Jp,Conv3D:em,Conv3DBackpropFilterV2:mb,Conv3DBackpropInputV2:gb,Cos:gh,Cosh:yh,CropAndResize:bb,Cumprod:yb,Cumsum:tm,CustomCallback:tV,DataStorage:AN,DenseBincount:xb,DepthToSpace:vb,DepthwiseConv2dNative:nm,DepthwiseConv2dNativeBackpropFilter:wb,DepthwiseConv2dNativeBackpropInput:Sb,Diag:Tb,Dilation2D:sm,Dilation2DBackpropFilter:b1,Dilation2DBackpropInput:y1,Draw:Cb,get ENV(){return FN},EarlyStopping:ZV,Einsum:Nb,Elu:xh,EluGrad:kb,Environment:lP,Equal:rm,Erf:vh,Exp:wh,ExpandDims:am,Expm1:Sh,FFT:Eb,Fill:$b,FlipLeftRight:Ib,Floor:Th,FloorDiv:Ch,FromPixels:x1,FusedBatchNorm:im,FusedConv2D:fp,FusedDepthwiseConv2D:dp,GPGPUContext:Wy,GatherNd:Ab,GatherV2:om,GraphModel:uI,Greater:lm,GreaterEqual:Nh,History:eV,IFFT:Rb,Identity:kh,Imag:Db,InputSpec:gn,IsFinite:Eh,IsInf:$h,IsNan:Ih,KernelBackend:rb,LRN:mm,LRNGrad:_b,LayerVariable:KB,LayersModel:Ni,LeakyRelu:um,Less:cm,LessEqual:hm,LinSpace:Ob,Log:Ah,Log1p:Rh,LogSoftmax:hP,LogicalAnd:fm,LogicalNot:dm,LogicalOr:pm,LogicalXor:LJ,LowerBound:MJ,MathBackendCPU:Sg,MathBackendWebGL:kg,MatrixBandPart:zJ,Max:gm,MaxPool:ym,MaxPool3D:bm,MaxPool3DGrad:Lb,MaxPoolGrad:Fb,MaxPoolWithArgmax:Mb,Maximum:Dh,Mean:xm,Min:vm,Minimum:Oh,MirrorPad:wm,Mod:_h,MomentumOptimizer:sE,Multinomial:zb,Multiply:Fh,Neg:Sm,NonMaxSuppressionV3:Pb,NonMaxSuppressionV4:Bb,NonMaxSuppressionV5:Vb,NotEqual:Tm,OP_SCOPE_SUFFIX:BN,OneHot:Nm,OnesLike:Cm,Optimizer:qi,OptimizerConstructors:hB,Pack:km,PadV2:Em,Pool:PJ,Pow:Lh,Prelu:$m,Prod:Im,RMSPropOptimizer:rE,RNN:ya,RaggedGather:Ub,RaggedRange:jb,RaggedTensorToTensor:Wb,Range:Gb,get Rank(){return DT},Real:Hb,RealDiv:bh,Reciprocal:Mh,get Reduction(){return fs},Relu:zh,Relu6:Ph,Reshape:Am,ResizeBilinear:Dm,ResizeBilinearGrad:Xb,ResizeNearestNeighbor:Rm,ResizeNearestNeighborGrad:qb,Reverse:Om,RotateWithOffset:hx,Round:Bh,Rsqrt:Vh,SGDOptimizer:Zx,ScatterNd:Kb,SearchSorted:Zb,Select:_m,Selu:Uh,Sequential:du,Sigmoid:Hh,Sign:Gh,Sin:jh,Sinh:Wh,Slice:Fm,Softmax:Pm,Softplus:qh,SpaceToBatchND:Mm,SparseFillEmptyRows:Qb,SparseReshape:Jb,SparseSegmentMean:ex,SparseSegmentSum:tx,SparseToDense:nx,SplitV:zm,Sqrt:Xh,Square:sx,SquaredDifference:Kh,StaticRegexReplace:Bm,Step:ef,StridedSlice:rx,StringNGrams:ax,StringSplit:ix,StringToHashBucketFast:ox,Sub:Yh,Sum:Lm,SymbolicTensor:fa,Tan:Zh,Tanh:Qh,Tensor:gt,TensorBuffer:yn,TensorScatterUpdate:Yb,Tile:Jh,TopK:lx,Transform:ux,Transpose:Kl,Unique:cx,Unpack:Vm,UnsortedSegmentSum:Um,UpperBound:BJ,Variable:gp,ZerosLike:jm,_FusedMatMul:hp,abs:pn,acos:XN,acosh:KN,add:ve,addN:VP,all:gx,any:bp,argMax:iu,argMin:YN,asin:ZN,asinh:QN,atan:JN,atan2:ek,atanh:tk,avgPool:qm,avgPool3d:sk,backend:UN,backend_util:LB,basicLSTMCell:UP,batchNorm:tf,batchNorm2d:rk,batchNorm3d:ak,batchNorm4d:ik,batchToSpaceND:Xm,bincount:ok,bitwiseAnd:jP,booleanMaskAsync:E6,broadcastArgs:WP,broadcastTo:Yl,broadcast_util:yne,browser:_oe,buffer:Qe,callbacks:Zde,cast:Ne,ceil:lk,clipByValue:Ds,clone:Ma,complex:Oi,concat:an,concat1d:uk,concat2d:ck,concat3d:hk,concat4d:fk,constraints:Lce,conv1d:yx,conv2d:_i,conv2dTranspose:bx,conv3d:pk,conv3dTranspose:mk,copyRegisteredKernels:WJ,cos:Km,cosh:xx,cosineWindow:jx,cumprod:wp,cumsum:vx,customGrad:Ga,data:Nge,denseBincount:S1,deprecationWarn:wee,depthToSpace:gk,depthwiseConv2d:nf,deregisterOp:epe,device_util:mee,diag:HP,dilation2d:yk,disableDeprecationWarnings:vee,dispose:Xe,disposeVariables:See,div:Le,divNoNan:bk,dot:xk,dropout:Xk,einsum:Ml,elu:sf,enableDebugMode:xee,enableProdMode:bee,enclosingPowerOfTwo:Kk,engine:sa,ensureShape:qP,env:ae,equal:Hs,erf:wx,euclideanNorm:wk,exp:Os,expandDims:jn,expm1:Sk,eye:Sx,fft:lg,fill:Eu,findBackend:$ee,findBackendFactory:Iee,floor:af,floorDiv:mx,forceHalfFloat:I8,fused:L6,gather:of,gatherND:R6,gather_util:Foe,getBackend:EP,getGradient:AT,getKernel:mp,getKernelsForBackend:v1,gpgpu_util:C2e,grad:ese,grads:tse,greater:vs,greaterEqual:Wi,ifft:Xc,imag:Ym,image:Pr,inTopKAsync:D6,initializers:Qce,input:mV,io:oE,irfft:Mx,isFinite:Tk,isInf:Ck,isNaN:Nk,keep:Tn,kernel_impls:Woe,layers:Ede,leakyRelu:Zm,less:Wc,lessEqual:Jo,linalg:Qk,linspace:YP,loadGraphModel:Nme,loadGraphModelSync:kme,loadLayersModel:Uhe,localResponseNormalization:kk,log:qs,log1p:Qm,logSigmoid:Ek,logSoftmax:Cx,logSumExp:Jm,logicalAnd:Vr,logicalNot:eg,logicalOr:Nx,logicalXor:$k,losses:j6,lowerBound:QP,matMul:tt,math:Noe,max:mr,maxPool:tg,maxPool3d:Ik,maxPoolWithArgmax:JP,maximum:Xa,mean:Wt,memory:zT,meshgrid:e6,metrics:Wde,min:jc,minimum:Vo,mirrorPad:Ak,mod:Rk,model:Ghe,models:Gde,moments:ng,movingAverage:$6,mul:Z,multiRNNCell:t6,multinomial:n6,neg:Ft,nextFrame:dE,norm:rf,notEqual:uu,oneHot:Gc,ones:$s,onesLike:Xs,op:q,outerProduct:s6,pad:Gi,pad1d:r6,pad2d:a6,pad3d:i6,pad4d:o6,pool:Dk,pow:Wa,prelu:rg,print:qN,prod:Ok,profile:Tee,raggedGather:l6,raggedRange:u6,raggedTensorToTensor:c6,rand:h6,randomGamma:p6,randomNormal:$x,randomStandardNormal:m6,randomUniform:el,randomUniformInt:g6,range:cu,ready:kee,real:Hc,reciprocal:zk,registerBackend:VN,registerCallbackConstructor:qhe,registerGradient:fP,registerKernel:fx,registerOp:Jde,regularizers:Kde,relu:ma,relu6:Ix,removeBackend:Eee,reshape:J,reverse:yr,reverse1d:y6,reverse2d:b6,reverse3d:x6,reverse4d:v6,rfft:ug,round:Ax,rsqrt:Rx,scalar:Pe,scatterND:I6,scatter_util:rae,searchSorted:kx,selu:Dx,separableConv2d:Ox,sequential:Hhe,serialization:aoe,setBackend:Nee,setPlatform:Aee,setWebGLContext:RU,setdiff1dAsync:w6,shared:dU,sigmoid:oa,sign:Pk,signal:U6,sin:_x,sinh:Fx,slice:ct,slice1d:ag,slice2d:Lx,slice3d:ig,slice4d:qc,slice_util:uB,softmax:og,softplus:$u,spaceToBatchND:sg,sparse:W6,sparseToDense:A6,spectral:V6,split:Is,sqrt:_n,square:kt,squaredDifference:zx,squeeze:tl,stack:ys,step:Iu,stridedSlice:Bk,string:G6,sub:Re,sum:Oe,sumOutType:dx,tan:Vk,tanh:Bo,tensor:Ws,tensor1d:Hn,tensor2d:$o,tensor3d:Uk,tensor4d:S6,tensor5d:T6,tensor6d:C6,tensorScatterUpdate:N6,tensor_util:cee,test_util:yre,tidy:re,tile:cr,time:Cee,topk:Wk,train:Fl,transpose:ot,truncatedNormal:Bx,unique:Gk,unregisterGradient:jJ,unregisterKernel:UJ,unsortedSegmentSum:Vx,unstack:br,upcastType:As,upperBound:k6,util:QJ,valueAndGrad:nse,valueAndGrads:sse,variable:Hk,variableGrads:ZP,version:ERe,version_converter:t5,version_core:cB,version_cpu:pU,version_layers:mv,version_webgl:$8,webgl:jSe,webgl_util:Awe,where:Dn,whereAsync:qk,zeros:mn,zerosLike:ht},Symbol.toStringTag,{value:"Module"})),Ap=DC($Re);var Dl={},qF;function aj(){if(qF)return Dl;qF=1;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Dl,"__esModule",{value:!0}),Dl.cropTensor=Dl.capture=void 0;var t=Ap;function e(s,r){return t.tidy(function(){var a=t.browser.fromPixels(s),i=n(a,r),o=i.expandDims(0);return o.toFloat().div(t.scalar(127)).sub(t.scalar(1))})}Dl.capture=e;function n(s,r,a){var i=Math.min(s.shape[0],s.shape[1]),o=s.shape[0]/2,l=o-i/2,c=s.shape[1]/2,f=c-i/2;if(r&&!a){var d=s.slice([l,f,0],[i,i,3]);d=d.reshape([i*i,1,3]);var p=[.2989,.587,.114];return d=t.mul(d,p),d=d.reshape([i,i,3]),d=t.sum(d,-1),d=t.expandDims(d,-1),d}return s.slice([l,f,0],[i,i,3])}return Dl.cropTensor=n,Dl}var Jr={},XF;function ij(){if(XF)return Jr;XF=1;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.cropTo=Jr.resizeMinTo=Jr.resizeMaxTo=Jr.resize=void 0;var t=function(){return document.createElement("canvas")};function e(a,i,o){o===void 0&&(o=t()),o.width=a.width*i,o.height=a.height*i;var l=o.getContext("2d");return l.drawImage(a,0,0,o.width,o.height),o}Jr.resize=e;function n(a,i,o){o===void 0&&(o=t());var l=Math.max(a.width,a.height);return e(a,i/l,o)}Jr.resizeMaxTo=n;function s(a,i,o){o===void 0&&(o=t());var l=Math.min(a.width,a.height);return e(a,i/l,o)}Jr.resizeMinTo=s;function r(a,i,o,l){o===void 0&&(o=!1),l===void 0&&(l=t());var c=a.width,f=a.height;a instanceof HTMLVideoElement&&(c=a.videoWidth,f=a.videoHeight);var d=Math.min(c,f),p=i/d,g=Math.ceil(c*p),y=Math.ceil(f*p),v=g-i,x=y-i;l.width=l.height=i;var w=l.getContext("2d");return w.drawImage(a,~~(v/2)*-1,~~(x/2)*-1,g,y),o&&(w.scale(-1,1),w.drawImage(l,i*-1,0)),l}return Jr.cropTo=r,Jr}var Dd={},KF;function oj(){if(KF)return Dd;KF=1;/** @license See the LICENSE file. */Object.defineProperty(Dd,"__esModule",{value:!0}),Dd.version=void 0;var t="0.8.4-alpha2";return Dd.version=t,Dd}var YF;function lj(){return YF||(YF=1,function(t){/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var e=Il&&Il.__awaiter||function($,O,A,_){function D(B){return B instanceof A?B:new A(function(j){j(B)})}return new(A||(A=Promise))(function(B,j){function W(Y){try{U(_.next(Y))}catch(Q){j(Q)}}function X(Y){try{U(_.throw(Y))}catch(Q){j(Q)}}function U(Y){Y.done?B(Y.value):D(Y.value).then(W,X)}U((_=_.apply($,O||[])).next())})},n=Il&&Il.__generator||function($,O){var A={label:0,sent:function(){if(B[0]&1)throw B[1];return B[1]},trys:[],ops:[]},_,D,B,j;return j={next:W(0),throw:W(1),return:W(2)},typeof Symbol=="function"&&(j[Symbol.iterator]=function(){return this}),j;function W(U){return function(Y){return X([U,Y])}}function X(U){if(_)throw new TypeError("Generator is already executing.");for(;A;)try{if(_=1,D&&(B=U[0]&2?D.return:U[0]?D.throw||((B=D.return)&&B.call(D),0):D.next)&&!(B=B.call(D,U[1])).done)return B;switch(D=0,B&&(U=[U[0]&2,B.value]),U[0]){case 0:case 1:B=U;break;case 4:return A.label++,{value:U[1],done:!1};case 5:A.label++,D=U[1],U=[0];continue;case 7:U=A.ops.pop(),A.trys.pop();continue;default:if(B=A.trys,!(B=B.length>0&&B[B.length-1])&&(U[0]===6||U[0]===2)){A=0;continue}if(U[0]===3&&(!B||U[1]>B[0]&&U[1]<B[3])){A.label=U[1];break}if(U[0]===6&&A.label<B[1]){A.label=B[1],B=U;break}if(B&&A.label<B[2]){A.label=B[2],A.ops.push(U);break}B[2]&&A.ops.pop(),A.trys.pop();continue}U=O.call($,A)}catch(Y){U=[6,Y],D=0}finally{_=B=0}if(U[0]&5)throw U[1];return{value:U[0]?U[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.loadFromFiles=t.load=t.loadTruncatedMobileNet=t.CustomMobileNet=t.getTopKClasses=t.IMAGE_SIZE=void 0;var s=Ap,r=Ap,a=aj(),i=ij(),o=oj(),l=1,c="conv_pw_13_relu",f="out_relu",d=.25,p=.35;t.IMAGE_SIZE=224;var g=function($){return $.packageVersion=$.packageVersion||o.version,$.packageName=$.packageName||"@teachablemachine/image",$.timeStamp=$.timeStamp||new Date().toISOString(),$.userMetadata=$.userMetadata||{},$.modelName=$.modelName||"untitled",$.labels=$.labels||[],$.imageSize=$.imageSize||t.IMAGE_SIZE,$},y=function($){return!!$&&Array.isArray($.labels)},v=function($,O){if($===1){if(O!==.25&&O!==.5&&O!==.75&&O!==1)return console.warn("Invalid alpha. Options are: 0.25, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",d.toFixed(2)),d}else if(O!==.35&&O!==.5&&O!==.75&&O!==1)return console.warn("Invalid alpha. Options are: 0.35, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",p.toFixed(2)),p;return O},x=function($){if($=$||{},$.checkpointUrl&&$.trainingLayer)return($.alpha||$.version)&&console.warn("Checkpoint URL passed to modelOptions, alpha options are ignored"),[$.checkpointUrl,$.trainingLayer];if($.version=$.version||l,$.version===1){$.alpha=$.alpha||d,$.alpha=v($.version,$.alpha),console.log("Loading mobilenet "+$.version+" and alpha "+$.alpha);var O=$.alpha.toFixed(2);return O==="1.00"&&(O="1.0"),["https://storage.googleapis.com/tfjs-models/tfjs/mobilenet_v1_"+O+"_"+t.IMAGE_SIZE+"/model.json",c]}else{if($.version===2)return $.alpha=$.alpha||p,$.alpha=v($.version,$.alpha),console.log("Loading mobilenet "+$.version+" and alpha "+$.alpha),["https://storage.googleapis.com/teachable-machine-models/mobilenet_v2_weights_tf_dim_ordering_tf_kernels_"+$.alpha.toFixed(2)+"_"+t.IMAGE_SIZE+"_no_top/model.json",f];throw new Error("MobileNet V"+$.version+" doesn't exist")}},w=function($){return e(void 0,void 0,void 0,function(){var O,A;return n(this,function(_){switch(_.label){case 0:return typeof $!="string"?[3,3]:[4,fetch($)];case 1:return A=_.sent(),[4,A.json()];case 2:return O=_.sent(),[3,4];case 3:if(y($))O=$;else throw new Error("Invalid Metadata provided");_.label=4;case 4:return[2,g(O)]}})})};function T($,O,A){return A===void 0&&(A=3),e(this,void 0,void 0,function(){var _;return n(this,function(D){switch(D.label){case 0:return[4,O.data()];case 1:return _=D.sent(),[2,s.tidy(function(){A=Math.min(A,_.length);for(var B=[],j=0;j<_.length;j++)B.push({value:_[j],index:j});B.sort(function(Y,Q){return Q.value-Y.value});for(var W=new Float32Array(A),X=new Int32Array(A),j=0;j<A;j++)W[j]=B[j].value,X[j]=B[j].index;for(var U=[],j=0;j<X.length;j++)U.push({className:$[X[j]],probability:W[j]});return U})]}})})}t.getTopKClasses=T;var N=function(){function $(O,A){this.model=O,this._metadata=g(A)}return Object.defineProperty($,"EXPECTED_IMAGE_SIZE",{get:function(){return t.IMAGE_SIZE},enumerable:!1,configurable:!0}),$.prototype.getMetadata=function(){return this._metadata},$.prototype.getTotalClasses=function(){var O=this.model.output,A=O.shape[1];return A},$.prototype.getClassLabels=function(){return this._metadata.labels},$.prototype.predictTopK=function(O,A,_){return A===void 0&&(A=10),_===void 0&&(_=!1),e(this,void 0,void 0,function(){var D,B,j,W=this;return n(this,function(X){switch(X.label){case 0:return D=i.cropTo(O,this._metadata.imageSize,_),B=s.tidy(function(){var U=a.capture(D,W._metadata.grayscale);return W.model.predict(U)}),[4,T(this._metadata.labels,B,A)];case 1:return j=X.sent(),r.dispose(B),[2,j]}})})},$.prototype.predict=function(O,A){return A===void 0&&(A=!1),e(this,void 0,void 0,function(){var _,D,B,j,W,X=this;return n(this,function(U){switch(U.label){case 0:return _=i.cropTo(O,this._metadata.imageSize,A),D=s.tidy(function(){var Y=a.capture(_,X._metadata.grayscale);return X.model.predict(Y)}),[4,D.data()];case 1:for(B=U.sent(),j=[],W=0;W<B.length;W++)j.push({className:this._metadata.labels[W],probability:B[W]});return r.dispose(D),[2,j]}})})},$.prototype.dispose=function(){this.truncatedModel.dispose()},$}();t.CustomMobileNet=N;function C($){return e(this,void 0,void 0,function(){var O,A,_,D,B,j,W,B,j,W;return n(this,function(X){switch(X.label){case 0:return O=x($),A=O[0],_=O[1],[4,s.loadLayersModel(A)];case 1:return D=X.sent(),$&&$.version===1?(B=D.getLayer(_),j=s.model({inputs:D.inputs,outputs:B.output}),W=s.sequential(),W.add(j),W.add(s.layers.flatten()),[2,W]):(B=D.getLayer(_),j=s.model({inputs:D.inputs,outputs:B.output}),W=s.sequential(),W.add(j),W.add(s.layers.globalAveragePooling2d({})),[2,W])}})})}t.loadTruncatedMobileNet=C;function E($,O){return e(this,void 0,void 0,function(){var A,_,D;return n(this,function(B){switch(B.label){case 0:return[4,s.loadLayersModel($)];case 1:return A=B.sent(),O?[4,w(O)]:[3,3];case 2:return D=B.sent(),[3,4];case 3:D=null,B.label=4;case 4:return _=D,[2,new N(A,_)]}})})}t.load=E;function R($,O,A){return e(this,void 0,void 0,function(){var _,D,B,j;return n(this,function(W){switch(W.label){case 0:return[4,s.loadLayersModel(s.io.browserFiles([$,O]))];case 1:return _=W.sent(),[4,new Response(A).json()];case 2:return D=W.sent(),A?[4,w(D)]:[3,4];case 3:return j=W.sent(),[3,5];case 4:j=null,W.label=5;case 5:return B=j,[2,new N(_,B)]}})})}t.loadFromFiles=R}(Il)),Il}var ir={},Hy={exports:{}},IRe=Hy.exports,ZF;function ARe(){return ZF||(ZF=1,function(t){(function(e,n,s){function r(l){var c=this,f=o();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=f(" "),c.s1=f(" "),c.s2=f(" "),c.s0-=f(l),c.s0<0&&(c.s0+=1),c.s1-=f(l),c.s1<0&&(c.s1+=1),c.s2-=f(l),c.s2<0&&(c.s2+=1),f=null}function a(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function i(l,c){var f=new r(l),d=c&&c.state,p=f.next;return p.int32=function(){return f.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,d&&(typeof d=="object"&&a(d,f),p.state=function(){return a(f,{})}),p}function o(){var l=4022871197,c=function(f){f=f.toString();for(var d=0;d<f.length;d++){l+=f.charCodeAt(d);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=i:this.alea=i})(IRe,t)}(Hy)),Hy.exports}var qy={exports:{}},RRe=qy.exports,QF;function DRe(){return QF||(QF=1,function(t){(function(e,n,s){function r(o){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},o===(o|0)?l.x=o:c+=o;for(var f=0;f<c.length+64;f++)l.x^=c.charCodeAt(f)|0,l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xor128=i})(RRe,t)}(qy)),qy.exports}var Xy={exports:{}},ORe=Xy.exports,JF;function _Re(){return JF||(JF=1,function(t){(function(e,n,s){function r(o){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:c+=o;for(var f=0;f<c.length+64;f++)l.x^=c.charCodeAt(f)|0,f==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xorwow=i})(ORe,t)}(Xy)),Xy.exports}var Ky={exports:{}},FRe=Ky.exports,eL;function LRe(){return eL||(eL=1,function(t){(function(e,n,s){function r(o){var l=this;l.next=function(){var f=l.x,d=l.i,p,g;return p=f[d],p^=p>>>7,g=p^p<<24,p=f[d+1&7],g^=p^p>>>10,p=f[d+3&7],g^=p^p>>>3,p=f[d+4&7],g^=p^p<<7,p=f[d+7&7],p=p^p<<13,g^=p^p<<9,f[d]=g,l.i=d+1&7,g};function c(f,d){var p,g=[];if(d===(d|0))g[0]=d;else for(d=""+d,p=0;p<d.length;++p)g[p&7]=g[p&7]<<15^d.charCodeAt(p)+g[p+1&7]<<13;for(;g.length<8;)g.push(0);for(p=0;p<8&&g[p]===0;++p);for(p==8?g[7]=-1:g[p],f.x=g,f.i=0,p=256;p>0;--p)f.next()}c(l,o)}function a(o,l){return l.x=o.x.slice(),l.i=o.i,l}function i(o,l){o==null&&(o=+new Date);var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(f.x&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xorshift7=i})(FRe,t)}(Ky)),Ky.exports}var Yy={exports:{}},MRe=Yy.exports,tL;function zRe(){return tL||(tL=1,function(t){(function(e,n,s){function r(o){var l=this;l.next=function(){var f=l.w,d=l.X,p=l.i,g,y;return l.w=f=f+1640531527|0,y=d[p+34&127],g=d[p=p+1&127],y^=y<<13,g^=g<<17,y^=y>>>15,g^=g>>>12,y=d[p]=y^g,l.i=p,y+(f^f>>>16)|0};function c(f,d){var p,g,y,v,x,w=[],T=128;for(d===(d|0)?(g=d,d=null):(d=d+"\0",g=0,T=Math.max(T,d.length)),y=0,v=-32;v<T;++v)d&&(g^=d.charCodeAt((v+32)%d.length)),v===0&&(x=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,v>=0&&(x=x+1640531527|0,p=w[v&127]^=g+x,y=p==0?y+1:0);for(y>=128&&(w[(d&&d.length||0)&127]=-1),y=127,v=4*128;v>0;--v)g=w[y+34&127],p=w[y=y+1&127],g^=g<<13,p^=p<<17,g^=g>>>15,p^=p>>>12,w[y]=g^p;f.w=x,f.X=w,f.i=y}c(l,o)}function a(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function i(o,l){o==null&&(o=+new Date);var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(f.X&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.xor4096=i})(MRe,t)}(Yy)),Yy.exports}var Zy={exports:{}},PRe=Zy.exports,nL;function BRe(){return nL||(nL=1,function(t){(function(e,n,s){function r(o){var l=this,c="";l.next=function(){var d=l.b,p=l.c,g=l.d,y=l.a;return d=d<<25^d>>>7^p,p=p-g|0,g=g<<24^g>>>8^y,y=y-d|0,l.b=d=d<<20^d>>>12^p,l.c=p=p-g|0,l.d=g<<16^p>>>16^y,l.a=y-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):c+=o;for(var f=0;f<c.length+20;f++)l.b^=c.charCodeAt(f)|0,l.next()}function a(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function i(o,l){var c=new r(o),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}n&&n.exports?n.exports=i:this.tychei=i})(PRe,t)}(Zy)),Zy.exports}var zS={exports:{}},sL;function VRe(){return sL||(sL=1,function(t){(function(e,n){var s=(0,eval)("this"),r=256,a=6,i=52,o="random",l=n.pow(r,a),c=n.pow(2,i),f=c*2,d=r-1,p;function g(C,E,R){var $=[];E=E==!0?{entropy:!0}:E||{};var O=w(x(E.entropy?[C,N(e)]:C??T(),3),$),A=new y($),_=function(){for(var D=A.g(a),B=l,j=0;D<c;)D=(D+j)*r,B*=r,j=A.g(1);for(;D>=f;)D/=2,B/=2,j>>>=1;return(D+j)/B};return _.int32=function(){return A.g(4)|0},_.quick=function(){return A.g(4)/4294967296},_.double=_,w(N(A.S),e),(E.pass||R||function(D,B,j,W){return W&&(W.S&&v(W,A),D.state=function(){return v(A,{})}),j?(n[o]=D,B):D})(_,O,"global"in E?E.global:this==n,E.state)}n["seed"+o]=g;function y(C){var E,R=C.length,$=this,O=0,A=$.i=$.j=0,_=$.S=[];for(R||(C=[R++]);O<r;)_[O]=O++;for(O=0;O<r;O++)_[O]=_[A=d&A+C[O%R]+(E=_[O])],_[A]=E;($.g=function(D){for(var B,j=0,W=$.i,X=$.j,U=$.S;D--;)B=U[W=d&W+1],j=j*r+U[d&(U[W]=U[X=d&X+B])+(U[X]=B)];return $.i=W,$.j=X,j})(r)}function v(C,E){return E.i=C.i,E.j=C.j,E.S=C.S.slice(),E}function x(C,E){var R=[],$=typeof C,O;if(E&&$=="object")for(O in C)try{R.push(x(C[O],E-1))}catch{}return R.length?R:$=="string"?C:C+"\0"}function w(C,E){for(var R=C+"",$,O=0;O<R.length;)E[d&O]=d&($^=E[d&O]*19)+R.charCodeAt(O++);return N(E)}function T(){try{var C;return p&&(C=p.randomBytes)?C=C(r):(C=new Uint8Array(r),(s.crypto||s.msCrypto).getRandomValues(C)),N(C)}catch{var E=s.navigator,R=E&&E.plugins;return[+new Date,s,R,s.screen,N(e)]}}function N(C){return String.fromCharCode.apply(0,C)}if(w(n.random(),e),t.exports){t.exports=g;try{p=Ex}catch{}}})([],Math)}(zS)),zS.exports}var PS,rL;function URe(){if(rL)return PS;rL=1;var t=ARe(),e=DRe(),n=_Re(),s=LRe(),r=zRe(),a=BRe(),i=VRe();return i.alea=t,i.xor128=e,i.xorwow=n,i.xorshift7=s,i.xor4096=r,i.tychei=a,PS=i,PS}var aL;function jRe(){if(aL)return ir;aL=1;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=ir&&ir.__extends||function(){var y=function(v,x){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,T){w.__proto__=T}||function(w,T){for(var N in T)T.hasOwnProperty(N)&&(w[N]=T[N])},y(v,x)};return function(v,x){y(v,x);function w(){this.constructor=v}v.prototype=x===null?Object.create(x):(w.prototype=x.prototype,new w)}}(),e=ir&&ir.__awaiter||function(y,v,x,w){function T(N){return N instanceof x?N:new x(function(C){C(N)})}return new(x||(x=Promise))(function(N,C){function E(O){try{$(w.next(O))}catch(A){C(A)}}function R(O){try{$(w.throw(O))}catch(A){C(A)}}function $(O){O.done?N(O.value):T(O.value).then(E,R)}$((w=w.apply(y,v||[])).next())})},n=ir&&ir.__generator||function(y,v){var x={label:0,sent:function(){if(N[0]&1)throw N[1];return N[1]},trys:[],ops:[]},w,T,N,C;return C={next:E(0),throw:E(1),return:E(2)},typeof Symbol=="function"&&(C[Symbol.iterator]=function(){return this}),C;function E($){return function(O){return R([$,O])}}function R($){if(w)throw new TypeError("Generator is already executing.");for(;x;)try{if(w=1,T&&(N=$[0]&2?T.return:$[0]?T.throw||((N=T.return)&&N.call(T),0):T.next)&&!(N=N.call(T,$[1])).done)return N;switch(T=0,N&&($=[$[0]&2,N.value]),$[0]){case 0:case 1:N=$;break;case 4:return x.label++,{value:$[1],done:!1};case 5:x.label++,T=$[1],$=[0];continue;case 7:$=x.ops.pop(),x.trys.pop();continue;default:if(N=x.trys,!(N=N.length>0&&N[N.length-1])&&($[0]===6||$[0]===2)){x=0;continue}if($[0]===3&&(!N||$[1]>N[0]&&$[1]<N[3])){x.label=$[1];break}if($[0]===6&&x.label<N[1]){x.label=N[1],N=$;break}if(N&&x.label<N[2]){x.label=N[2],x.ops.push($);break}N[2]&&x.ops.pop(),x.trys.pop();continue}$=v.call(y,x)}catch(O){$=[6,O],T=0}finally{w=N=0}if($[0]&5)throw $[1];return{value:$[0]?$[1]:void 0,done:!0}}};Object.defineProperty(ir,"__esModule",{value:!0}),ir.createTeachable=ir.TeachableMobileNet=void 0;var s=Ap,r=Ap,a=aj(),i=lj(),o=URe(),l=.15,c=function(y){return typeof y.dataId=="object"&&typeof y.shape=="object"};function f(y,v){var x=new Array(v).fill(0);return x[y]=1,x}function d(y,v){for(var x,w=y.length,T=y.slice(),N=w-1;N>0;N-=1){var C=void 0;v?C=Math.floor(v()*(N+1)):C=Math.floor(Math.random()*(N+1)),x=[T[C],T[N]],T[N]=x[0],T[C]=x[1]}return T}var p=function(y){t(v,y);function v(x,w){var T=y.call(this,s.sequential(),w)||this;return T.totalSamples=0,T.examples=[],T.truncatedModel=x,T}return Object.defineProperty(v.prototype,"asSequentialModel",{get:function(){return this.model},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"isTrained",{get:function(){return!!this.model&&this.model.layers&&this.model.layers.length>2},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"isPrepared",{get:function(){return!!this.trainDataset},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"numClasses",{get:function(){return this._metadata.labels.length},enumerable:!1,configurable:!0}),v.prototype.addExample=function(x,w){return e(this,void 0,void 0,function(){var T,N,C;return n(this,function(E){return T=c(w)?w:a.capture(w,this._metadata.grayscale),N=this.truncatedModel.predict(T),C=N.dataSync(),T.dispose(),N.dispose(),this.examples[x].push(C),this.totalSamples++,[2]})})},v.prototype.predict=function(x,w){return w===void 0&&(w=!1),e(this,void 0,void 0,function(){return n(this,function(T){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,y.prototype.predict.call(this,x,w)]})})},v.prototype.predictTopK=function(x,w,T){return w===void 0&&(w=10),T===void 0&&(T=!1),e(this,void 0,void 0,function(){return n(this,function(N){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,y.prototype.predictTopK.call(this,x,w,T)]})})},v.prototype.prepare=function(){for(var x in this.examples)if(x.length===0)throw new Error("Add some examples before training");var w=this.convertToTfDataset();this.trainDataset=w.trainDataset,this.validationDataset=w.validationDataset},v.prototype.convertToTfDataset=function(){for(var x=0;x<this.examples.length;x++)this.examples[x]=d(this.examples[x],this.seed);for(var w=[],T=[],N=function(A){var _=f(A,C.numClasses),D=C.examples[A].length,B=Math.ceil(l*D),j=D-B,W=C.examples[A].slice(0,j).map(function(U){return{data:U,label:_}}),X=C.examples[A].slice(j).map(function(U){return{data:U,label:_}});w=w.concat(W),T=T.concat(X)},C=this,x=0;x<this.examples.length;x++)N(x);w=d(w,this.seed),T=d(T,this.seed);var E=s.data.array(w.map(function(A){return A.data})),R=s.data.array(T.map(function(A){return A.data})),$=s.data.array(w.map(function(A){return A.label})),O=s.data.array(T.map(function(A){return A.label}));return{trainDataset:s.data.zip({xs:E,ys:$}),validationDataset:s.data.zip({xs:R,ys:O})}},v.prototype.save=function(x,w){return e(this,void 0,void 0,function(){return n(this,function(T){return[2,this.model.save(x,w)]})})},v.prototype.train=function(x,w){return w===void 0&&(w={}),e(this,void 0,void 0,function(){var T,N,C,E,R,$,O,A,_,D=this;return n(this,function(B){switch(B.label){case 0:if(T=w.onTrainEnd||function(){},w.onTrainEnd=function(j){D.__stopTrainingResolve&&(D.__stopTrainingResolve(),D.__stopTrainingResolve=null),T(j)},this.isPrepared||this.prepare(),N=this.getLabels().length,r.util.assert(N===this.numClasses,function(){return"Can not train, has "+N+" labels and "+D.numClasses+" classes"}),C=this.truncatedModel.outputs[0].shape.slice(1),E=s.util.sizeFromShape(C),this.seed?R=s.initializers.varianceScaling({seed:3.14}):R=s.initializers.varianceScaling({}),this.trainingModel=s.sequential({layers:[s.layers.dense({inputShape:[E],units:x.denseUnits,activation:"relu",kernelInitializer:R,useBias:!0}),s.layers.dense({kernelInitializer:R,useBias:!1,activation:"softmax",units:this.numClasses})]}),$=s.train.adam(x.learningRate),this.trainingModel.compile({optimizer:$,loss:"categoricalCrossentropy",metrics:["accuracy"]}),!(x.batchSize>0))throw new Error("Batch size is 0 or NaN. Please choose a non-zero fraction");return O=this.trainDataset.batch(x.batchSize),A=this.validationDataset.batch(x.batchSize),[4,this.trainingModel.fitDataset(O,{epochs:x.epochs,validationData:A,callbacks:w})];case 1:return B.sent(),_=s.sequential(),_.add(this.truncatedModel),_.add(this.trainingModel),this.model=_,$.dispose(),[2,this.model]}})})},v.prototype.prepareDataset=function(){for(var x=0;x<this.numClasses;x++)this.examples[x]=[]},v.prototype.setLabel=function(x,w){this._metadata.labels[x]=w},v.prototype.setLabels=function(x){this._metadata.labels=x,this.prepareDataset()},v.prototype.getLabel=function(x){return this._metadata.labels[x]},v.prototype.getLabels=function(){return this._metadata.labels},v.prototype.setName=function(x){this._metadata.modelName=x},v.prototype.getName=function(){return this._metadata.modelName},v.prototype.stopTraining=function(){var x=this,w=new Promise(function(T,N){x.trainingModel.stopTraining=!0,x.__stopTrainingResolve=T});return w},v.prototype.dispose=function(){this.trainingModel.dispose(),y.prototype.dispose.call(this)},v.prototype.calculateAccuracyPerClass=function(){return e(this,void 0,void 0,function(){var x,w,T,N,C,E,R,$,O,A,Y,_,D,B,j,W,X,U,Y,Q=this;return n(this,function(ie){switch(ie.label){case 0:return x=this.validationDataset.mapAsync(function(V){return e(Q,void 0,void 0,function(){return n(this,function(ee){return[2,V.xs]})})}),w=this.validationDataset.mapAsync(function(V){return e(Q,void 0,void 0,function(){return n(this,function(ee){return[2,V.ys]})})}),T=Math.min(w.size,32),N=Math.ceil(w.size/T),C=x.batch(T),E=w.batch(T),[4,C.iterator()];case 1:return R=ie.sent(),[4,E.iterator()];case 2:$=ie.sent(),O=[],A=[],Y=0,ie.label=3;case 3:return Y<N?[4,R.next()]:[3,7];case 4:return _=ie.sent(),D=this.trainingModel.predict(_.value),B=D.argMax(1),O.push(B),[4,$.next()];case 5:j=ie.sent(),W=j.value.argMax(1),A.push(W),_.value.dispose(),D.dispose(),j.value.dispose(),ie.label=6;case 6:return Y++,[3,3];case 7:if(X=s.concat(A),U=s.concat(O),N!==1)for(Y=0;Y<O.length;Y++)O[Y].dispose(),A[Y].dispose();return[2,{reference:X,predictions:U}]}})})},v.prototype.setSeed=function(x){this.seed=o(x)},v}(i.CustomMobileNet);ir.TeachableMobileNet=p;function g(y,v){return e(this,void 0,void 0,function(){var x;return n(this,function(w){switch(w.label){case 0:return[4,i.loadTruncatedMobileNet(v)];case 1:return x=w.sent(),[2,new p(x,y)]}})})}return ir.createTeachable=g,ir}var ea={};function Qy(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Qy=function(n){return typeof n}:Qy=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Qy(t)}function zI(t,e,n){var s=n.value;if(typeof s!="function")throw new TypeError("@boundMethod decorator can only be applied to methods not: ".concat(Qy(s)));var r=!1;return{configurable:!0,get:function(){if(r||this===t.prototype||this.hasOwnProperty(e)||typeof s!="function")return s;var i=s.bind(this);return r=!0,Object.defineProperty(this,e,{configurable:!0,get:function(){return i},set:function(l){s=l,delete this[e]}}),r=!1,i},set:function(i){s=i}}}function uj(t){var e;return typeof Reflect<"u"&&typeof Reflect.ownKeys=="function"?e=Reflect.ownKeys(t.prototype):(e=Object.getOwnPropertyNames(t.prototype),typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(t.prototype)))),e.forEach(function(n){if(n!=="constructor"){var s=Object.getOwnPropertyDescriptor(t.prototype,n);typeof s.value=="function"&&Object.defineProperty(t.prototype,n,zI(t,n,s))}}),t}function WRe(){return arguments.length===1?uj.apply(void 0,arguments):zI.apply(void 0,arguments)}const GRe=Object.freeze(Object.defineProperty({__proto__:null,boundClass:uj,boundMethod:zI,default:WRe},Symbol.toStringTag,{value:"Module"})),HRe=DC(GRe);var iL;function qRe(){if(iL)return ea;iL=1;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=ea&&ea.__decorate||function(l,c,f,d){var p=arguments.length,g=p<3?c:d===null?d=Object.getOwnPropertyDescriptor(c,f):d,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(l,c,f,d);else for(var v=l.length-1;v>=0;v--)(y=l[v])&&(g=(p<3?y(g):p>3?y(c,f,g):y(c,f))||g);return p>3&&g&&Object.defineProperty(c,f,g),g},e=ea&&ea.__awaiter||function(l,c,f,d){function p(g){return g instanceof f?g:new f(function(y){y(g)})}return new(f||(f=Promise))(function(g,y){function v(T){try{w(d.next(T))}catch(N){y(N)}}function x(T){try{w(d.throw(T))}catch(N){y(N)}}function w(T){T.done?g(T.value):p(T.value).then(v,x)}w((d=d.apply(l,c||[])).next())})},n=ea&&ea.__generator||function(l,c){var f={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},d,p,g,y;return y={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function v(w){return function(T){return x([w,T])}}function x(w){if(d)throw new TypeError("Generator is already executing.");for(;f;)try{if(d=1,p&&(g=w[0]&2?p.return:w[0]?p.throw||((g=p.return)&&g.call(p),0):p.next)&&!(g=g.call(p,w[1])).done)return g;switch(p=0,g&&(w=[w[0]&2,g.value]),w[0]){case 0:case 1:g=w;break;case 4:return f.label++,{value:w[1],done:!1};case 5:f.label++,p=w[1],w=[0];continue;case 7:w=f.ops.pop(),f.trys.pop();continue;default:if(g=f.trys,!(g=g.length>0&&g[g.length-1])&&(w[0]===6||w[0]===2)){f=0;continue}if(w[0]===3&&(!g||w[1]>g[0]&&w[1]<g[3])){f.label=w[1];break}if(w[0]===6&&f.label<g[1]){f.label=g[1],g=w;break}if(g&&f.label<g[2]){f.label=g[2],f.ops.push(w);break}g[2]&&f.ops.pop(),f.trys.pop();continue}w=c.call(l,f)}catch(T){w=[6,T],p=0}finally{d=g=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}};Object.defineProperty(ea,"__esModule",{value:!0}),ea.Webcam=void 0;var s=HRe,r=ij(),a={facingMode:"user",frameRate:24},i=function(l){return l.facingMode=l.facingMode||a.facingMode,l.frameRate=l.frameRate||a.frameRate,l.aspectRatio=l.aspectRatio||a.aspectRatio,l},o=function(){function l(c,f,d){c===void 0&&(c=400),f===void 0&&(f=400),d===void 0&&(d=!1),this.width=c,this.height=f,this.flip=d}return l.prototype.getWebcam=function(c){if(c===void 0&&(c={}),!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)return Promise.reject("Your browser does not support WebRTC. Please try another one.");c.width=640;var f=i(c),d=document.createElement("video");return window.navigator.mediaDevices.getUserMedia({video:f}).then(function(p){return d.srcObject=p,d.addEventListener("loadedmetadata",function(g){var y=d.videoWidth,v=d.videoHeight;d.width=y,d.height=v}),d},function(){return Promise.reject("Could not open your camera. You may have denied access.")})},l.prototype.setup=function(c){return c===void 0&&(c={}),e(this,void 0,void 0,function(){var f;return n(this,function(d){switch(d.label){case 0:return this.webcam?[3,2]:(f=this,[4,this.getWebcam(c)]);case 1:f.webcam=d.sent(),this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height),d.label=2;case 2:return[2]}})})},l.prototype.play=function(){var c=this.webcam.play();return c},l.prototype.pause=function(){this.webcam.pause()},l.prototype.stop=function(){this.stopStreamedVideo(this.webcam)},l.prototype.update=function(){this.renderCameraToCanvas()},l.prototype.stopStreamedVideo=function(c){var f=c.srcObject,d=f.getTracks();d.forEach(function(p){p.stop()}),c.srcObject=null},l.prototype.renderCameraToCanvas=function(){if(this.canvas&&this.webcam){var c=this.canvas.getContext("2d");if(this.webcam.videoWidth!==0){var f=r.cropTo(this.webcam,this.width,this.flip);c.drawImage(f,0,0)}}},t([s.default],l.prototype,"getWebcam",null),t([s.default],l.prototype,"setup",null),t([s.default],l.prototype,"play",null),t([s.default],l.prototype,"pause",null),t([s.default],l.prototype,"stop",null),t([s.default],l.prototype,"update",null),t([s.default],l.prototype,"stopStreamedVideo",null),t([s.default],l.prototype,"renderCameraToCanvas",null),l}();return ea.Webcam=o,ea}var oL;function XRe(){return oL||(oL=1,function(t){/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(t,"__esModule",{value:!0});var e=lj();Object.defineProperty(t,"IMAGE_SIZE",{enumerable:!0,get:function(){return e.IMAGE_SIZE}}),Object.defineProperty(t,"CustomMobileNet",{enumerable:!0,get:function(){return e.CustomMobileNet}}),Object.defineProperty(t,"load",{enumerable:!0,get:function(){return e.load}}),Object.defineProperty(t,"loadFromFiles",{enumerable:!0,get:function(){return e.loadFromFiles}}),Object.defineProperty(t,"loadTruncatedMobileNet",{enumerable:!0,get:function(){return e.loadTruncatedMobileNet}});var n=jRe();Object.defineProperty(t,"TeachableMobileNet",{enumerable:!0,get:function(){return n.TeachableMobileNet}}),Object.defineProperty(t,"createTeachable",{enumerable:!0,get:function(){return n.createTeachable}});var s=qRe();Object.defineProperty(t,"Webcam",{enumerable:!0,get:function(){return s.Webcam}});var r=oj();Object.defineProperty(t,"version",{enumerable:!0,get:function(){return r.version}})}(bS)),bS}var KRe=XRe();const YRe=async t=>{try{const e=await fetch("https://ai-based-crop-disease.onrender.com",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({disease:t})});if(!e.ok){const n=await e.json().catch(()=>({}));throw new Error(`Server error: ${e.status} - ${n.error||"Unknown error"} ${n.details||""}`)}return await e.json()}catch(e){throw console.error("Fetch error details:",e),new Error(`not onnect to backend: ${e.message}`)}},ZRe="/assets/my_model/model.json",QRe="/assets/my_model/metadata.json";function JRe(){const[t,e]=K.useState(null),[n,s]=K.useState(null),[r,a]=K.useState(null),[i,o]=K.useState(!1),[l,c]=K.useState(null),[f,d]=K.useState(null),[p,g]=K.useState(!1);let y;async function v(){y=await KRe.load(ZRe,QRe)}const x=N=>{const C=N.target.files[0];if(!C||!C.type.startsWith("image/")){c("Only image files (JPG, PNG) are allowed.");return}e(C),s(URL.createObjectURL(C)),c(null),a(null)},w=async()=>{if(!t){c("Please upload an image first.");return}o(!0),c(null);const N=document.createElement("img");N.src=URL.createObjectURL(t),N.onload=async()=>{await v(),setTimeout(async()=>{const E=(await y.predict(N)).reduce((R,$)=>$.probability>R.probability?$:R);a({disease:E.className,confidence:(E.probability*100).toFixed(2)+"%",remedies:"Suggested remedies will be based on the detected disease."}),o(!1)},2e3)}},T=async()=>{if(r)try{o(!0);const N=await YRe(r.disease);d(N),g(!0)}catch(N){console.error("Error fetching disease info:",N),c(N.message)}finally{o(!1)}};return L.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-green-100 py-12 px-4 sm:px-6 lg:px-8",children:[L.jsxs(je.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-3xl mx-auto",children:[L.jsxs("div",{className:"text-center mb-10",children:[L.jsx("div",{className:"inline-flex items-center justify-center bg-green-100 text-green-800 rounded-full p-3 mb-4",children:L.jsx(Qd,{className:"text-xl"})}),L.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-3",children:"AI-Powered Crop Health Scanner"}),L.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Upload an image to detect plant diseases and get treatment recommendations"})]}),L.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[L.jsxs("div",{className:"p-6 sm:p-8",children:[L.jsxs("label",{className:"group cursor-pointer",children:[L.jsx("div",{className:`border-2 border-dashed rounded-xl p-8 text-center transition-all duration-300 ${l?"border-red-300 bg-red-50":"border-green-300 hover:border-green-400 hover:bg-green-50"}`,children:L.jsxs("div",{className:"flex flex-col items-center justify-center space-y-3",children:[L.jsx("div",{className:"p-4 bg-green-100 rounded-full text-green-600 group-hover:bg-green-200 transition",children:L.jsx(vJ,{className:"text-2xl"})}),L.jsxs("div",{children:[L.jsx("p",{className:"font-medium text-gray-700",children:n?"Image ready for analysis":"Click to upload plant image"}),L.jsx("p",{className:"text-sm text-gray-500 mt-1",children:n?t.name:"JPEG, PNG (Max 5MB)"})]})]})}),L.jsx("input",{type:"file",onChange:x,accept:"image/*",className:"hidden"})]}),l&&L.jsxs(je.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-4 p-3 bg-red-50 text-red-700 rounded-lg flex items-start",children:[L.jsx(U_,{className:"flex-shrink-0 mt-0.5 mr-2"}),L.jsx("span",{children:l})]}),n&&L.jsxs(je.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"mt-6 flex flex-col items-center",children:[L.jsxs("div",{className:"relative w-full max-w-md",children:[L.jsx("img",{src:n,alt:"Plant preview",className:"w-full h-auto rounded-lg shadow-md border border-gray-200"}),i&&L.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30 rounded-lg flex items-center justify-center",children:L.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-500"})})]}),L.jsxs(je.button,{whileHover:{scale:1.03},whileTap:{scale:.98},onClick:w,disabled:i,className:`mt-6 inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white focus:outline-none focus:ring-2 focus:ring-offset-2 ${i?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 focus:ring-green-500"}`,children:[L.jsx(Jz,{className:"mr-2"}),i?"Analyzing...":"Detect Disease"]})]})]}),r&&L.jsxs(je.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gray-50 border-t border-gray-200 p-6 sm:p-8",children:[L.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center",children:[L.jsx(Qd,{className:"text-green-500 mr-2"}),"Detection Results"]}),L.jsxs("div",{className:"space-y-4",children:[L.jsxs("div",{className:"flex justify-between items-center p-4 bg-white rounded-lg shadow-sm",children:[L.jsx("span",{className:"font-medium text-gray-700",children:"Disease Identified"}),L.jsx("span",{className:"font-semibold text-gray-900",children:r.disease})]}),L.jsxs("div",{className:"flex justify-between items-center p-4 bg-white rounded-lg shadow-sm",children:[L.jsx("span",{className:"font-medium text-gray-700",children:"Confidence Level"}),L.jsx("span",{className:"font-bold text-green-600",children:r.confidence})]}),L.jsxs(je.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:T,disabled:i,className:`w-full inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white focus:outline-none focus:ring-2 focus:ring-offset-2 ${i?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}`,children:[L.jsx(yJ,{className:"mr-2"}),i?"Loading Details...":"View Detailed Information"]})]})]})]})]}),L.jsx(wu,{children:p&&f&&L.jsx(je.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:()=>g(!1),children:L.jsx(je.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:N=>N.stopPropagation(),children:L.jsxs("div",{className:"p-6 sm:p-8",children:[L.jsxs("div",{className:"flex justify-between items-start mb-6",children:[L.jsxs("div",{children:[L.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[L.jsx(Qd,{className:"text-green-500 mr-2"}),r.disease]}),L.jsx("div",{className:"mt-1 flex items-center",children:L.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800",children:["Confidence: ",r.confidence]})})]}),L.jsx("button",{onClick:()=>g(!1),className:"p-1 rounded-full hover:bg-gray-100",children:L.jsx(U_,{className:"text-gray-500"})})]}),L.jsxs("div",{className:"space-y-6",children:[L.jsxs("div",{children:[L.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Description"}),L.jsx("p",{className:"text-gray-700",children:f.description})]}),L.jsxs("div",{children:[L.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Symptoms"}),L.jsx("ul",{className:"list-disc pl-5 space-y-1 text-gray-700",children:f.symptoms.split(";").map((N,C)=>L.jsx("li",{children:N.trim()},C))})]}),L.jsxs("div",{children:[L.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Treatment Options"}),L.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:L.jsx("ul",{className:"space-y-3",children:f.treatment.split(";").map((N,C)=>L.jsxs("li",{className:"flex items-start",children:[L.jsx("span",{className:"flex-shrink-0 bg-green-100 text-green-800 rounded-full p-1 mr-3",children:L.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),L.jsx("span",{className:"text-gray-700",children:N.trim()})]},C))})})]}),L.jsx("button",{onClick:()=>g(!1),className:"w-full mt-6 inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Close Details"})]})]})})})})]})}function cj(t,e){return function(){return t.apply(e,arguments)}}const{toString:eDe}=Object.prototype,{getPrototypeOf:PI}=Object,Iv=(t=>e=>{const n=eDe.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ba=t=>(t=t.toLowerCase(),e=>Iv(e)===t),Av=t=>e=>typeof e===t,{isArray:Cf}=Array,Rp=Av("undefined");function tDe(t){return t!==null&&!Rp(t)&&t.constructor!==null&&!Rp(t.constructor)&&gr(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const hj=ba("ArrayBuffer");function nDe(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&hj(t.buffer),e}const sDe=Av("string"),gr=Av("function"),fj=Av("number"),Rv=t=>t!==null&&typeof t=="object",rDe=t=>t===!0||t===!1,Jy=t=>{if(Iv(t)!=="object")return!1;const e=PI(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},aDe=ba("Date"),iDe=ba("File"),oDe=ba("Blob"),lDe=ba("FileList"),uDe=t=>Rv(t)&&gr(t.pipe),cDe=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||gr(t.append)&&((e=Iv(t))==="formdata"||e==="object"&&gr(t.toString)&&t.toString()==="[object FormData]"))},hDe=ba("URLSearchParams"),[fDe,dDe,pDe,mDe]=["ReadableStream","Request","Response","Headers"].map(ba),gDe=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ig(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let s,r;if(typeof t!="object"&&(t=[t]),Cf(t))for(s=0,r=t.length;s<r;s++)e.call(null,t[s],s,t);else{const a=n?Object.getOwnPropertyNames(t):Object.keys(t),i=a.length;let o;for(s=0;s<i;s++)o=a[s],e.call(null,t[o],o,t)}}function dj(t,e){e=e.toLowerCase();const n=Object.keys(t);let s=n.length,r;for(;s-- >0;)if(r=n[s],e===r.toLowerCase())return r;return null}const Hl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,pj=t=>!Rp(t)&&t!==Hl;function NC(){const{caseless:t}=pj(this)&&this||{},e={},n=(s,r)=>{const a=t&&dj(e,r)||r;Jy(e[a])&&Jy(s)?e[a]=NC(e[a],s):Jy(s)?e[a]=NC({},s):Cf(s)?e[a]=s.slice():e[a]=s};for(let s=0,r=arguments.length;s<r;s++)arguments[s]&&Ig(arguments[s],n);return e}const yDe=(t,e,n,{allOwnKeys:s}={})=>(Ig(e,(r,a)=>{n&&gr(r)?t[a]=cj(r,n):t[a]=r},{allOwnKeys:s}),t),bDe=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),xDe=(t,e,n,s)=>{t.prototype=Object.create(e.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},vDe=(t,e,n,s)=>{let r,a,i;const o={};if(e=e||{},t==null)return e;do{for(r=Object.getOwnPropertyNames(t),a=r.length;a-- >0;)i=r[a],(!s||s(i,t,e))&&!o[i]&&(e[i]=t[i],o[i]=!0);t=n!==!1&&PI(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},wDe=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const s=t.indexOf(e,n);return s!==-1&&s===n},SDe=t=>{if(!t)return null;if(Cf(t))return t;let e=t.length;if(!fj(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},TDe=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&PI(Uint8Array)),CDe=(t,e)=>{const s=(t&&t[Symbol.iterator]).call(t);let r;for(;(r=s.next())&&!r.done;){const a=r.value;e.call(t,a[0],a[1])}},NDe=(t,e)=>{let n;const s=[];for(;(n=t.exec(e))!==null;)s.push(n);return s},kDe=ba("HTMLFormElement"),EDe=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,r){return s.toUpperCase()+r}),lL=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),$De=ba("RegExp"),mj=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),s={};Ig(n,(r,a)=>{let i;(i=e(r,a,t))!==!1&&(s[a]=i||r)}),Object.defineProperties(t,s)},IDe=t=>{mj(t,(e,n)=>{if(gr(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=t[n];if(gr(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},ADe=(t,e)=>{const n={},s=r=>{r.forEach(a=>{n[a]=!0})};return Cf(t)?s(t):s(String(t).split(e)),n},RDe=()=>{},DDe=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function ODe(t){return!!(t&&gr(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const _De=t=>{const e=new Array(10),n=(s,r)=>{if(Rv(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[r]=s;const a=Cf(s)?[]:{};return Ig(s,(i,o)=>{const l=n(i,r+1);!Rp(l)&&(a[o]=l)}),e[r]=void 0,a}}return s};return n(t,0)},FDe=ba("AsyncFunction"),LDe=t=>t&&(Rv(t)||gr(t))&&gr(t.then)&&gr(t.catch),gj=((t,e)=>t?setImmediate:e?((n,s)=>(Hl.addEventListener("message",({source:r,data:a})=>{r===Hl&&a===n&&s.length&&s.shift()()},!1),r=>{s.push(r),Hl.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",gr(Hl.postMessage)),MDe=typeof queueMicrotask<"u"?queueMicrotask.bind(Hl):typeof process<"u"&&process.nextTick||gj,me={isArray:Cf,isArrayBuffer:hj,isBuffer:tDe,isFormData:cDe,isArrayBufferView:nDe,isString:sDe,isNumber:fj,isBoolean:rDe,isObject:Rv,isPlainObject:Jy,isReadableStream:fDe,isRequest:dDe,isResponse:pDe,isHeaders:mDe,isUndefined:Rp,isDate:aDe,isFile:iDe,isBlob:oDe,isRegExp:$De,isFunction:gr,isStream:uDe,isURLSearchParams:hDe,isTypedArray:TDe,isFileList:lDe,forEach:Ig,merge:NC,extend:yDe,trim:gDe,stripBOM:bDe,inherits:xDe,toFlatObject:vDe,kindOf:Iv,kindOfTest:ba,endsWith:wDe,toArray:SDe,forEachEntry:CDe,matchAll:NDe,isHTMLForm:kDe,hasOwnProperty:lL,hasOwnProp:lL,reduceDescriptors:mj,freezeMethods:IDe,toObjectSet:ADe,toCamelCase:EDe,noop:RDe,toFiniteNumber:DDe,findKey:dj,global:Hl,isContextDefined:pj,isSpecCompliantForm:ODe,toJSONObject:_De,isAsyncFn:FDe,isThenable:LDe,setImmediate:gj,asap:MDe};function Je(t,e,n,s,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),s&&(this.request=s),r&&(this.response=r,this.status=r.status?r.status:null)}me.inherits(Je,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:me.toJSONObject(this.config),code:this.code,status:this.status}}});const yj=Je.prototype,bj={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{bj[t]={value:t}});Object.defineProperties(Je,bj);Object.defineProperty(yj,"isAxiosError",{value:!0});Je.from=(t,e,n,s,r,a)=>{const i=Object.create(yj);return me.toFlatObject(t,i,function(l){return l!==Error.prototype},o=>o!=="isAxiosError"),Je.call(i,t.message,e,n,s,r),i.cause=t,i.name=t.name,a&&Object.assign(i,a),i};const zDe=null;function kC(t){return me.isPlainObject(t)||me.isArray(t)}function xj(t){return me.endsWith(t,"[]")?t.slice(0,-2):t}function uL(t,e,n){return t?t.concat(e).map(function(r,a){return r=xj(r),!n&&a?"["+r+"]":r}).join(n?".":""):e}function PDe(t){return me.isArray(t)&&!t.some(kC)}const BDe=me.toFlatObject(me,{},null,function(e){return/^is[A-Z]/.test(e)});function Dv(t,e,n){if(!me.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=me.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,x){return!me.isUndefined(x[v])});const s=n.metaTokens,r=n.visitor||f,a=n.dots,i=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&me.isSpecCompliantForm(e);if(!me.isFunction(r))throw new TypeError("visitor must be a function");function c(y){if(y===null)return"";if(me.isDate(y))return y.toISOString();if(!l&&me.isBlob(y))throw new Je("Blob is not supported. Use a Buffer instead.");return me.isArrayBuffer(y)||me.isTypedArray(y)?l&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function f(y,v,x){let w=y;if(y&&!x&&typeof y=="object"){if(me.endsWith(v,"{}"))v=s?v:v.slice(0,-2),y=JSON.stringify(y);else if(me.isArray(y)&&PDe(y)||(me.isFileList(y)||me.endsWith(v,"[]"))&&(w=me.toArray(y)))return v=xj(v),w.forEach(function(N,C){!(me.isUndefined(N)||N===null)&&e.append(i===!0?uL([v],C,a):i===null?v:v+"[]",c(N))}),!1}return kC(y)?!0:(e.append(uL(x,v,a),c(y)),!1)}const d=[],p=Object.assign(BDe,{defaultVisitor:f,convertValue:c,isVisitable:kC});function g(y,v){if(!me.isUndefined(y)){if(d.indexOf(y)!==-1)throw Error("Circular reference detected in "+v.join("."));d.push(y),me.forEach(y,function(w,T){(!(me.isUndefined(w)||w===null)&&r.call(e,w,me.isString(T)?T.trim():T,v,p))===!0&&g(w,v?v.concat(T):[T])}),d.pop()}}if(!me.isObject(t))throw new TypeError("data must be an object");return g(t),e}function cL(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function BI(t,e){this._pairs=[],t&&Dv(t,this,e)}const vj=BI.prototype;vj.append=function(e,n){this._pairs.push([e,n])};vj.toString=function(e){const n=e?function(s){return e.call(this,s,cL)}:cL;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function VDe(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function wj(t,e,n){if(!e)return t;const s=n&&n.encode||VDe;me.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let a;if(r?a=r(e,n):a=me.isURLSearchParams(e)?e.toString():new BI(e,n).toString(s),a){const i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class hL{constructor(){this.handlers=[]}use(e,n,s){return this.handlers.push({fulfilled:e,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){me.forEach(this.handlers,function(s){s!==null&&e(s)})}}const Sj={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},UDe=typeof URLSearchParams<"u"?URLSearchParams:BI,jDe=typeof FormData<"u"?FormData:null,WDe=typeof Blob<"u"?Blob:null,GDe={isBrowser:!0,classes:{URLSearchParams:UDe,FormData:jDe,Blob:WDe},protocols:["http","https","file","blob","url","data"]},VI=typeof window<"u"&&typeof document<"u",EC=typeof navigator=="object"&&navigator||void 0,HDe=VI&&(!EC||["ReactNative","NativeScript","NS"].indexOf(EC.product)<0),qDe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",XDe=VI&&window.location.href||"http://localhost",KDe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:VI,hasStandardBrowserEnv:HDe,hasStandardBrowserWebWorkerEnv:qDe,navigator:EC,origin:XDe},Symbol.toStringTag,{value:"Module"})),ps={...KDe,...GDe};function YDe(t,e){return Dv(t,new ps.classes.URLSearchParams,Object.assign({visitor:function(n,s,r,a){return ps.isNode&&me.isBuffer(n)?(this.append(s,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},e))}function ZDe(t){return me.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function QDe(t){const e={},n=Object.keys(t);let s;const r=n.length;let a;for(s=0;s<r;s++)a=n[s],e[a]=t[a];return e}function Tj(t){function e(n,s,r,a){let i=n[a++];if(i==="__proto__")return!0;const o=Number.isFinite(+i),l=a>=n.length;return i=!i&&me.isArray(r)?r.length:i,l?(me.hasOwnProp(r,i)?r[i]=[r[i],s]:r[i]=s,!o):((!r[i]||!me.isObject(r[i]))&&(r[i]=[]),e(n,s,r[i],a)&&me.isArray(r[i])&&(r[i]=QDe(r[i])),!o)}if(me.isFormData(t)&&me.isFunction(t.entries)){const n={};return me.forEachEntry(t,(s,r)=>{e(ZDe(s),r,n,0)}),n}return null}function JDe(t,e,n){if(me.isString(t))try{return(e||JSON.parse)(t),me.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(t)}const Ag={transitional:Sj,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const s=n.getContentType()||"",r=s.indexOf("application/json")>-1,a=me.isObject(e);if(a&&me.isHTMLForm(e)&&(e=new FormData(e)),me.isFormData(e))return r?JSON.stringify(Tj(e)):e;if(me.isArrayBuffer(e)||me.isBuffer(e)||me.isStream(e)||me.isFile(e)||me.isBlob(e)||me.isReadableStream(e))return e;if(me.isArrayBufferView(e))return e.buffer;if(me.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(a){if(s.indexOf("application/x-www-form-urlencoded")>-1)return YDe(e,this.formSerializer).toString();if((o=me.isFileList(e))||s.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Dv(o?{"files[]":e}:e,l&&new l,this.formSerializer)}}return a||r?(n.setContentType("application/json",!1),JDe(e)):e}],transformResponse:[function(e){const n=this.transitional||Ag.transitional,s=n&&n.forcedJSONParsing,r=this.responseType==="json";if(me.isResponse(e)||me.isReadableStream(e))return e;if(e&&me.isString(e)&&(s&&!this.responseType||r)){const i=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(o){if(i)throw o.name==="SyntaxError"?Je.from(o,Je.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ps.classes.FormData,Blob:ps.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};me.forEach(["delete","get","head","post","put","patch"],t=>{Ag.headers[t]={}});const e3e=me.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),t3e=t=>{const e={};let n,s,r;return t&&t.split(`
`).forEach(function(i){r=i.indexOf(":"),n=i.substring(0,r).trim().toLowerCase(),s=i.substring(r+1).trim(),!(!n||e[n]&&e3e[n])&&(n==="set-cookie"?e[n]?e[n].push(s):e[n]=[s]:e[n]=e[n]?e[n]+", "+s:s)}),e},fL=Symbol("internals");function Od(t){return t&&String(t).trim().toLowerCase()}function e1(t){return t===!1||t==null?t:me.isArray(t)?t.map(e1):String(t)}function n3e(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(t);)e[s[1]]=s[2];return e}const s3e=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function BS(t,e,n,s,r){if(me.isFunction(s))return s.call(this,e,n);if(r&&(e=n),!!me.isString(e)){if(me.isString(s))return e.indexOf(s)!==-1;if(me.isRegExp(s))return s.test(e)}}function r3e(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,s)=>n.toUpperCase()+s)}function a3e(t,e){const n=me.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+n,{value:function(r,a,i){return this[s].call(this,e,r,a,i)},configurable:!0})})}let Gs=class{constructor(e){e&&this.set(e)}set(e,n,s){const r=this;function a(o,l,c){const f=Od(l);if(!f)throw new Error("header name must be a non-empty string");const d=me.findKey(r,f);(!d||r[d]===void 0||c===!0||c===void 0&&r[d]!==!1)&&(r[d||l]=e1(o))}const i=(o,l)=>me.forEach(o,(c,f)=>a(c,f,l));if(me.isPlainObject(e)||e instanceof this.constructor)i(e,n);else if(me.isString(e)&&(e=e.trim())&&!s3e(e))i(t3e(e),n);else if(me.isHeaders(e))for(const[o,l]of e.entries())a(l,o,s);else e!=null&&a(n,e,s);return this}get(e,n){if(e=Od(e),e){const s=me.findKey(this,e);if(s){const r=this[s];if(!n)return r;if(n===!0)return n3e(r);if(me.isFunction(n))return n.call(this,r,s);if(me.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Od(e),e){const s=me.findKey(this,e);return!!(s&&this[s]!==void 0&&(!n||BS(this,this[s],s,n)))}return!1}delete(e,n){const s=this;let r=!1;function a(i){if(i=Od(i),i){const o=me.findKey(s,i);o&&(!n||BS(s,s[o],o,n))&&(delete s[o],r=!0)}}return me.isArray(e)?e.forEach(a):a(e),r}clear(e){const n=Object.keys(this);let s=n.length,r=!1;for(;s--;){const a=n[s];(!e||BS(this,this[a],a,e,!0))&&(delete this[a],r=!0)}return r}normalize(e){const n=this,s={};return me.forEach(this,(r,a)=>{const i=me.findKey(s,a);if(i){n[i]=e1(r),delete n[a];return}const o=e?r3e(a):String(a).trim();o!==a&&delete n[a],n[o]=e1(r),s[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return me.forEach(this,(s,r)=>{s!=null&&s!==!1&&(n[r]=e&&me.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const s=new this(e);return n.forEach(r=>s.set(r)),s}static accessor(e){const s=(this[fL]=this[fL]={accessors:{}}).accessors,r=this.prototype;function a(i){const o=Od(i);s[o]||(a3e(r,i),s[o]=!0)}return me.isArray(e)?e.forEach(a):a(e),this}};Gs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);me.reduceDescriptors(Gs.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(s){this[n]=s}}});me.freezeMethods(Gs);function VS(t,e){const n=this||Ag,s=e||n,r=Gs.from(s.headers);let a=s.data;return me.forEach(t,function(o){a=o.call(n,a,r.normalize(),e?e.status:void 0)}),r.normalize(),a}function Cj(t){return!!(t&&t.__CANCEL__)}function Nf(t,e,n){Je.call(this,t??"canceled",Je.ERR_CANCELED,e,n),this.name="CanceledError"}me.inherits(Nf,Je,{__CANCEL__:!0});function Nj(t,e,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?t(n):e(new Je("Request failed with status code "+n.status,[Je.ERR_BAD_REQUEST,Je.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function i3e(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function o3e(t,e){t=t||10;const n=new Array(t),s=new Array(t);let r=0,a=0,i;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),f=s[a];i||(i=c),n[r]=l,s[r]=c;let d=a,p=0;for(;d!==r;)p+=n[d++],d=d%t;if(r=(r+1)%t,r===a&&(a=(a+1)%t),c-i<e)return;const g=f&&c-f;return g?Math.round(p*1e3/g):void 0}}function l3e(t,e){let n=0,s=1e3/e,r,a;const i=(c,f=Date.now())=>{n=f,r=null,a&&(clearTimeout(a),a=null),t.apply(null,c)};return[(...c)=>{const f=Date.now(),d=f-n;d>=s?i(c,f):(r=c,a||(a=setTimeout(()=>{a=null,i(r)},s-d)))},()=>r&&i(r)]}const W1=(t,e,n=3)=>{let s=0;const r=o3e(50,250);return l3e(a=>{const i=a.loaded,o=a.lengthComputable?a.total:void 0,l=i-s,c=r(l),f=i<=o;s=i;const d={loaded:i,total:o,progress:o?i/o:void 0,bytes:l,rate:c||void 0,estimated:c&&o&&f?(o-i)/c:void 0,event:a,lengthComputable:o!=null,[e?"download":"upload"]:!0};t(d)},n)},dL=(t,e)=>{const n=t!=null;return[s=>e[0]({lengthComputable:n,total:t,loaded:s}),e[1]]},pL=t=>(...e)=>me.asap(()=>t(...e)),u3e=ps.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,ps.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(ps.origin),ps.navigator&&/(msie|trident)/i.test(ps.navigator.userAgent)):()=>!0,c3e=ps.hasStandardBrowserEnv?{write(t,e,n,s,r,a){const i=[t+"="+encodeURIComponent(e)];me.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),me.isString(s)&&i.push("path="+s),me.isString(r)&&i.push("domain="+r),a===!0&&i.push("secure"),document.cookie=i.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function h3e(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function f3e(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function kj(t,e,n){let s=!h3e(e);return t&&(s||n==!1)?f3e(t,e):e}const mL=t=>t instanceof Gs?{...t}:t;function vu(t,e){e=e||{};const n={};function s(c,f,d,p){return me.isPlainObject(c)&&me.isPlainObject(f)?me.merge.call({caseless:p},c,f):me.isPlainObject(f)?me.merge({},f):me.isArray(f)?f.slice():f}function r(c,f,d,p){if(me.isUndefined(f)){if(!me.isUndefined(c))return s(void 0,c,d,p)}else return s(c,f,d,p)}function a(c,f){if(!me.isUndefined(f))return s(void 0,f)}function i(c,f){if(me.isUndefined(f)){if(!me.isUndefined(c))return s(void 0,c)}else return s(void 0,f)}function o(c,f,d){if(d in e)return s(c,f);if(d in t)return s(void 0,c)}const l={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(c,f,d)=>r(mL(c),mL(f),d,!0)};return me.forEach(Object.keys(Object.assign({},t,e)),function(f){const d=l[f]||r,p=d(t[f],e[f],f);me.isUndefined(p)&&d!==o||(n[f]=p)}),n}const Ej=t=>{const e=vu({},t);let{data:n,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:a,headers:i,auth:o}=e;e.headers=i=Gs.from(i),e.url=wj(kj(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let l;if(me.isFormData(n)){if(ps.hasStandardBrowserEnv||ps.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((l=i.getContentType())!==!1){const[c,...f]=l?l.split(";").map(d=>d.trim()).filter(Boolean):[];i.setContentType([c||"multipart/form-data",...f].join("; "))}}if(ps.hasStandardBrowserEnv&&(s&&me.isFunction(s)&&(s=s(e)),s||s!==!1&&u3e(e.url))){const c=r&&a&&c3e.read(a);c&&i.set(r,c)}return e},d3e=typeof XMLHttpRequest<"u",p3e=d3e&&function(t){return new Promise(function(n,s){const r=Ej(t);let a=r.data;const i=Gs.from(r.headers).normalize();let{responseType:o,onUploadProgress:l,onDownloadProgress:c}=r,f,d,p,g,y;function v(){g&&g(),y&&y(),r.cancelToken&&r.cancelToken.unsubscribe(f),r.signal&&r.signal.removeEventListener("abort",f)}let x=new XMLHttpRequest;x.open(r.method.toUpperCase(),r.url,!0),x.timeout=r.timeout;function w(){if(!x)return;const N=Gs.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),E={data:!o||o==="text"||o==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:N,config:t,request:x};Nj(function($){n($),v()},function($){s($),v()},E),x=null}"onloadend"in x?x.onloadend=w:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(w)},x.onabort=function(){x&&(s(new Je("Request aborted",Je.ECONNABORTED,t,x)),x=null)},x.onerror=function(){s(new Je("Network Error",Je.ERR_NETWORK,t,x)),x=null},x.ontimeout=function(){let C=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const E=r.transitional||Sj;r.timeoutErrorMessage&&(C=r.timeoutErrorMessage),s(new Je(C,E.clarifyTimeoutError?Je.ETIMEDOUT:Je.ECONNABORTED,t,x)),x=null},a===void 0&&i.setContentType(null),"setRequestHeader"in x&&me.forEach(i.toJSON(),function(C,E){x.setRequestHeader(E,C)}),me.isUndefined(r.withCredentials)||(x.withCredentials=!!r.withCredentials),o&&o!=="json"&&(x.responseType=r.responseType),c&&([p,y]=W1(c,!0),x.addEventListener("progress",p)),l&&x.upload&&([d,g]=W1(l),x.upload.addEventListener("progress",d),x.upload.addEventListener("loadend",g)),(r.cancelToken||r.signal)&&(f=N=>{x&&(s(!N||N.type?new Nf(null,t,x):N),x.abort(),x=null)},r.cancelToken&&r.cancelToken.subscribe(f),r.signal&&(r.signal.aborted?f():r.signal.addEventListener("abort",f)));const T=i3e(r.url);if(T&&ps.protocols.indexOf(T)===-1){s(new Je("Unsupported protocol "+T+":",Je.ERR_BAD_REQUEST,t));return}x.send(a||null)})},m3e=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let s=new AbortController,r;const a=function(c){if(!r){r=!0,o();const f=c instanceof Error?c:this.reason;s.abort(f instanceof Je?f:new Nf(f instanceof Error?f.message:f))}};let i=e&&setTimeout(()=>{i=null,a(new Je(`timeout ${e} of ms exceeded`,Je.ETIMEDOUT))},e);const o=()=>{t&&(i&&clearTimeout(i),i=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(a):c.removeEventListener("abort",a)}),t=null)};t.forEach(c=>c.addEventListener("abort",a));const{signal:l}=s;return l.unsubscribe=()=>me.asap(o),l}},g3e=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let s=0,r;for(;s<n;)r=s+e,yield t.slice(s,r),s=r},y3e=async function*(t,e){for await(const n of b3e(t))yield*g3e(n,e)},b3e=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:s}=await e.read();if(n)break;yield s}}finally{await e.cancel()}},gL=(t,e,n,s)=>{const r=y3e(t,e);let a=0,i,o=l=>{i||(i=!0,s&&s(l))};return new ReadableStream({async pull(l){try{const{done:c,value:f}=await r.next();if(c){o(),l.close();return}let d=f.byteLength;if(n){let p=a+=d;n(p)}l.enqueue(new Uint8Array(f))}catch(c){throw o(c),c}},cancel(l){return o(l),r.return()}},{highWaterMark:2})},Ov=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",$j=Ov&&typeof ReadableStream=="function",x3e=Ov&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Ij=(t,...e)=>{try{return!!t(...e)}catch{return!1}},v3e=$j&&Ij(()=>{let t=!1;const e=new Request(ps.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),yL=64*1024,$C=$j&&Ij(()=>me.isReadableStream(new Response("").body)),G1={stream:$C&&(t=>t.body)};Ov&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!G1[e]&&(G1[e]=me.isFunction(t[e])?n=>n[e]():(n,s)=>{throw new Je(`Response type '${e}' is not supported`,Je.ERR_NOT_SUPPORT,s)})})})(new Response);const w3e=async t=>{if(t==null)return 0;if(me.isBlob(t))return t.size;if(me.isSpecCompliantForm(t))return(await new Request(ps.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(me.isArrayBufferView(t)||me.isArrayBuffer(t))return t.byteLength;if(me.isURLSearchParams(t)&&(t=t+""),me.isString(t))return(await x3e(t)).byteLength},S3e=async(t,e)=>{const n=me.toFiniteNumber(t.getContentLength());return n??w3e(e)},T3e=Ov&&(async t=>{let{url:e,method:n,data:s,signal:r,cancelToken:a,timeout:i,onDownloadProgress:o,onUploadProgress:l,responseType:c,headers:f,withCredentials:d="same-origin",fetchOptions:p}=Ej(t);c=c?(c+"").toLowerCase():"text";let g=m3e([r,a&&a.toAbortSignal()],i),y;const v=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let x;try{if(l&&v3e&&n!=="get"&&n!=="head"&&(x=await S3e(f,s))!==0){let E=new Request(e,{method:"POST",body:s,duplex:"half"}),R;if(me.isFormData(s)&&(R=E.headers.get("content-type"))&&f.setContentType(R),E.body){const[$,O]=dL(x,W1(pL(l)));s=gL(E.body,yL,$,O)}}me.isString(d)||(d=d?"include":"omit");const w="credentials"in Request.prototype;y=new Request(e,{...p,signal:g,method:n.toUpperCase(),headers:f.normalize().toJSON(),body:s,duplex:"half",credentials:w?d:void 0});let T=await fetch(y);const N=$C&&(c==="stream"||c==="response");if($C&&(o||N&&v)){const E={};["status","statusText","headers"].forEach(A=>{E[A]=T[A]});const R=me.toFiniteNumber(T.headers.get("content-length")),[$,O]=o&&dL(R,W1(pL(o),!0))||[];T=new Response(gL(T.body,yL,$,()=>{O&&O(),v&&v()}),E)}c=c||"text";let C=await G1[me.findKey(G1,c)||"text"](T,t);return!N&&v&&v(),await new Promise((E,R)=>{Nj(E,R,{data:C,headers:Gs.from(T.headers),status:T.status,statusText:T.statusText,config:t,request:y})})}catch(w){throw v&&v(),w&&w.name==="TypeError"&&/fetch/i.test(w.message)?Object.assign(new Je("Network Error",Je.ERR_NETWORK,t,y),{cause:w.cause||w}):Je.from(w,w&&w.code,t,y)}}),IC={http:zDe,xhr:p3e,fetch:T3e};me.forEach(IC,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const bL=t=>`- ${t}`,C3e=t=>me.isFunction(t)||t===null||t===!1,Aj={getAdapter:t=>{t=me.isArray(t)?t:[t];const{length:e}=t;let n,s;const r={};for(let a=0;a<e;a++){n=t[a];let i;if(s=n,!C3e(n)&&(s=IC[(i=String(n)).toLowerCase()],s===void 0))throw new Je(`Unknown adapter '${i}'`);if(s)break;r[i||"#"+a]=s}if(!s){const a=Object.entries(r).map(([o,l])=>`adapter ${o} `+(l===!1?"is not supported by the environment":"is not available in the build"));let i=e?a.length>1?`since :
`+a.map(bL).join(`
`):" "+bL(a[0]):"as no adapter specified";throw new Je("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return s},adapters:IC};function US(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Nf(null,t)}function xL(t){return US(t),t.headers=Gs.from(t.headers),t.data=VS.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Aj.getAdapter(t.adapter||Ag.adapter)(t).then(function(s){return US(t),s.data=VS.call(t,t.transformResponse,s),s.headers=Gs.from(s.headers),s},function(s){return Cj(s)||(US(t),s&&s.response&&(s.response.data=VS.call(t,t.transformResponse,s.response),s.response.headers=Gs.from(s.response.headers))),Promise.reject(s)})}const Rj="1.8.4",_v={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{_v[t]=function(s){return typeof s===t||"a"+(e<1?"n ":" ")+t}});const vL={};_v.transitional=function(e,n,s){function r(a,i){return"[Axios v"+Rj+"] Transitional option '"+a+"'"+i+(s?". "+s:"")}return(a,i,o)=>{if(e===!1)throw new Je(r(i," has been removed"+(n?" in "+n:"")),Je.ERR_DEPRECATED);return n&&!vL[i]&&(vL[i]=!0,console.warn(r(i," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(a,i,o):!0}};_v.spelling=function(e){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function N3e(t,e,n){if(typeof t!="object")throw new Je("options must be an object",Je.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let r=s.length;for(;r-- >0;){const a=s[r],i=e[a];if(i){const o=t[a],l=o===void 0||i(o,a,t);if(l!==!0)throw new Je("option "+a+" must be "+l,Je.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Je("Unknown option "+a,Je.ERR_BAD_OPTION)}}const t1={assertOptions:N3e,validators:_v},Na=t1.validators;let Jl=class{constructor(e){this.defaults=e,this.interceptors={request:new hL,response:new hL}}async request(e,n){try{return await this._request(e,n)}catch(s){if(s instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const a=r.stack?r.stack.replace(/^.+\n/,""):"";try{s.stack?a&&!String(s.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+a):s.stack=a}catch{}}throw s}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=vu(this.defaults,n);const{transitional:s,paramsSerializer:r,headers:a}=n;s!==void 0&&t1.assertOptions(s,{silentJSONParsing:Na.transitional(Na.boolean),forcedJSONParsing:Na.transitional(Na.boolean),clarifyTimeoutError:Na.transitional(Na.boolean)},!1),r!=null&&(me.isFunction(r)?n.paramsSerializer={serialize:r}:t1.assertOptions(r,{encode:Na.function,serialize:Na.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),t1.assertOptions(n,{baseUrl:Na.spelling("baseURL"),withXsrfToken:Na.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let i=a&&me.merge(a.common,a[n.method]);a&&me.forEach(["delete","get","head","post","put","patch","common"],y=>{delete a[y]}),n.headers=Gs.concat(i,a);const o=[];let l=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(n)===!1||(l=l&&v.synchronous,o.unshift(v.fulfilled,v.rejected))});const c=[];this.interceptors.response.forEach(function(v){c.push(v.fulfilled,v.rejected)});let f,d=0,p;if(!l){const y=[xL.bind(this),void 0];for(y.unshift.apply(y,o),y.push.apply(y,c),p=y.length,f=Promise.resolve(n);d<p;)f=f.then(y[d++],y[d++]);return f}p=o.length;let g=n;for(d=0;d<p;){const y=o[d++],v=o[d++];try{g=y(g)}catch(x){v.call(this,x);break}}try{f=xL.call(this,g)}catch(y){return Promise.reject(y)}for(d=0,p=c.length;d<p;)f=f.then(c[d++],c[d++]);return f}getUri(e){e=vu(this.defaults,e);const n=kj(e.baseURL,e.url,e.allowAbsoluteUrls);return wj(n,e.params,e.paramsSerializer)}};me.forEach(["delete","get","head","options"],function(e){Jl.prototype[e]=function(n,s){return this.request(vu(s||{},{method:e,url:n,data:(s||{}).data}))}});me.forEach(["post","put","patch"],function(e){function n(s){return function(a,i,o){return this.request(vu(o||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}Jl.prototype[e]=n(),Jl.prototype[e+"Form"]=n(!0)});let k3e=class Dj{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const s=this;this.promise.then(r=>{if(!s._listeners)return;let a=s._listeners.length;for(;a-- >0;)s._listeners[a](r);s._listeners=null}),this.promise.then=r=>{let a;const i=new Promise(o=>{s.subscribe(o),a=o}).then(r);return i.cancel=function(){s.unsubscribe(a)},i},e(function(a,i,o){s.reason||(s.reason=new Nf(a,i,o),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=s=>{e.abort(s)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new Dj(function(r){e=r}),cancel:e}}};function E3e(t){return function(n){return t.apply(null,n)}}function $3e(t){return me.isObject(t)&&t.isAxiosError===!0}const AC={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(AC).forEach(([t,e])=>{AC[e]=t});function Oj(t){const e=new Jl(t),n=cj(Jl.prototype.request,e);return me.extend(n,Jl.prototype,e,{allOwnKeys:!0}),me.extend(n,e,null,{allOwnKeys:!0}),n.create=function(r){return Oj(vu(t,r))},n}const ln=Oj(Ag);ln.Axios=Jl;ln.CanceledError=Nf;ln.CancelToken=k3e;ln.isCancel=Cj;ln.VERSION=Rj;ln.toFormData=Dv;ln.AxiosError=Je;ln.Cancel=ln.CanceledError;ln.all=function(e){return Promise.all(e)};ln.spread=E3e;ln.isAxiosError=$3e;ln.mergeConfig=vu;ln.AxiosHeaders=Gs;ln.formToJSON=t=>Tj(me.isHTMLForm(t)?new FormData(t):t);ln.getAdapter=Aj.getAdapter;ln.HttpStatusCode=AC;ln.default=ln;const{Axios:Q3e,AxiosError:J3e,CanceledError:eOe,isCancel:tOe,CancelToken:nOe,VERSION:sOe,all:rOe,Cancel:aOe,isAxiosError:iOe,spread:oOe,toFormData:lOe,AxiosHeaders:uOe,HttpStatusCode:cOe,formToJSON:hOe,getAdapter:fOe,mergeConfig:dOe}=ln,wL="http://localhost:5000",pi={default:"https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",rice:"https://images.unsplash.com/photo-1601342630318-5f4a6f4b6e0b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",wheat:"https://images.unsplash.com/photo-1558211246-bb8a7dfb2f9a?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",corn:"https://images.unsplash.com/photo-1601593768793-1e0d2290a1d1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",tomato:"https://images.unsplash.com/photo-1594282418426-62d45b5e50c3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",potato:"https://images.unsplash.com/photo-1518977676601-b53f82aba655?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",blight:"https://images.unsplash.com/photo-1586771107445-d3ca888129ce?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",rust:"https://images.unsplash.com/photo-1605000797499-95a51c5269ae?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80"},I3e=()=>{const[t,e]=K.useState([]),[n,s]=K.useState([]),[r,a]=K.useState(!0),[i,o]=K.useState(null),[l,c]=K.useState(""),[f,d]=K.useState(1),[p,g]=K.useState(pi.default),y=9;K.useEffect(()=>{v()},[]),K.useEffect(()=>{const R=l.toLowerCase();let $=pi.default;R.includes("rice")?$=pi.rice:R.includes("wheat")?$=pi.wheat:R.includes("corn")?$=pi.corn:R.includes("tomato")?$=pi.tomato:R.includes("potato")?$=pi.potato:R.includes("blight")?$=pi.blight:R.includes("rust")&&($=pi.rust),g($)},[l]);const v=async()=>{var R,$;a(!0),o(null);try{const O=await ln.get(`${wL}/api/diseases`);Array.isArray(O.data)?(e(O.data),s(O.data),d(1)):o("Unexpected API response. Check the backend.")}catch(O){o((($=(R=O.response)==null?void 0:R.data)==null?void 0:$.message)||"Failed to load disease information.")}finally{a(!1)}},x=async()=>{var R,$;if(!l){v();return}a(!0),o(null);try{const O=await ln.get(`${wL}/api/diseases/search?query=${encodeURIComponent(l)}`);Array.isArray(O.data)?(s(O.data),d(1)):o("No diseases found for this search.")}catch(O){o((($=(R=O.response)==null?void 0:R.data)==null?void 0:$.message)||"Failed to search diseases.")}finally{a(!1)}},w=f*y,T=w-y,N=n.slice(T,w),C=Math.ceil(n.length/y),E=R=>{d(R),window.scrollTo({top:0,behavior:"smooth"})};return L.jsxs("div",{className:"min-h-screen  from-green-50 to-green-100 bg-gradient-to-b",children:[L.jsx("div",{className:"h-64 w-full bg-cover bg-center flex items-center justify-center",style:{backgroundImage:`linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url(${p})`},children:L.jsxs("div",{className:"text-center px-4",children:[L.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:"Crop Disease Encyclopedia"}),L.jsxs("div",{className:"max-w-2xl mx-auto relative",children:[L.jsx("input",{type:"text",placeholder:"Search diseases, crops, symptoms...",className:"w-full bg-gray-300  rounded-full focus:outline-none focus:ring-2 focus:ring-green-500 px-6 py-4",value:l,onChange:R=>c(R.target.value),onKeyPress:R=>R.key==="Enter"&&x()}),L.jsx("button",{onClick:x,className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-green-600 hover:bg-green-700 text-white p-2 rounded-full",children:L.jsx(Jz,{className:"text-xl"})})]})]})}),L.jsxs("div",{className:"py-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto",children:[r&&L.jsx("div",{className:"flex justify-center my-12",children:L.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-500"})}),i&&L.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-8 rounded",children:L.jsxs("div",{className:"flex",children:[L.jsx("div",{className:"flex-shrink-0",children:L.jsx("svg",{className:"h-5 w-5 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:L.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),L.jsx("div",{className:"ml-3",children:L.jsx("p",{className:"text-sm text-red-700",children:i})})]})}),L.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.map(R=>{var $;return L.jsxs(je.div,{whileHover:{y:-5},className:"bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-all",children:[L.jsxs("div",{className:"relative h-48 overflow-hidden",children:[L.jsx("img",{src:R.imageUrl||"https://placehold.co/600x400?text=Plant+Disease",alt:R.name,className:"w-full h-full object-cover",loading:"lazy",onError:O=>{O.target.src="https://placehold.co/600x400?text=Plant+Disease"}}),L.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),L.jsx("h3",{className:"absolute bottom-0 left-0 right-0 text-white font-bold text-xl p-4",children:R.name})]}),L.jsxs("div",{className:"p-6",children:[L.jsxs("div",{className:"mb-4",children:[L.jsx("h4",{className:"text-sm font-semibold text-green-600 uppercase tracking-wider",children:"Affected Crops"}),L.jsx("p",{className:"mt-1 text-gray-600",children:(($=R.affectedCrops)==null?void 0:$.join(", "))||"Various crops"})]}),L.jsxs("div",{className:"mb-4",children:[L.jsx("h4",{className:"text-sm font-semibold text-green-600 uppercase tracking-wider",children:"Symptoms"}),L.jsx("p",{className:"mt-1 text-gray-600 line-clamp-3",children:R.symptoms})]}),L.jsxs("button",{className:"text-green-600 hover:text-green-800 font-medium text-sm flex items-center",children:["View full details",L.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})]})]})]},R.id)})}),!r&&N.length===0&&L.jsxs("div",{className:"bg-white rounded-xl shadow-md p-8 text-center",children:[L.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100",children:L.jsx(Qd,{className:"h-6 w-6 text-green-600"})}),L.jsx("h3",{className:"mt-3 text-lg font-medium text-gray-900",children:"No diseases found"}),L.jsx("p",{className:"mt-2 text-sm text-gray-500",children:l?"Try adjusting your search query":"There are currently no diseases in our database"})]}),C>1&&L.jsxs("div",{className:"flex items-center justify-between mt-8 bg-white rounded-lg shadow-sm p-4",children:[L.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[L.jsx("button",{onClick:()=>E(f-1),disabled:f===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),L.jsx("button",{onClick:()=>E(f+1),disabled:f===C,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Next"})]}),L.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[L.jsx("div",{children:L.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",L.jsx("span",{className:"font-medium",children:T+1})," to"," ",L.jsx("span",{className:"font-medium",children:Math.min(w,n.length)})," ","of ",L.jsx("span",{className:"font-medium",children:n.length})," results"]})}),L.jsx("div",{children:L.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[L.jsxs("button",{onClick:()=>E(f-1),disabled:f===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:[L.jsx("span",{className:"sr-only",children:"Previous"}),L.jsx(fJ,{className:"h-5 w-5"})]}),Array.from({length:C},(R,$)=>$+1).map(R=>L.jsx("button",{onClick:()=>E(R),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${f===R?"z-10 bg-green-50 border-green-500 text-green-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:R},R)),L.jsxs("button",{onClick:()=>E(f+1),disabled:f===C,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:[L.jsx("span",{className:"sr-only",children:"Next"}),L.jsx(dJ,{className:"h-5 w-5"})]})]})})]})]})]})]})};function A3e(){const[t,e]=K.useState([]),[n,s]=K.useState(""),[r,a]=K.useState(""),[i,o]=K.useState(null),[l,c]=K.useState(null);K.useEffect(()=>{f()},[]);const f=async()=>{try{const v=await(await fetch("http://localhost:5000/api/posts")).json();e(v)}catch(y){c("Failed to fetch posts"),console.error(y)}},d=async y=>{if(y.preventDefault(),!n||!r){c("Title and Description are required!");return}const v=new FormData;v.append("title",n),v.append("description",r),i&&v.append("file",i);try{const x=await fetch("http://localhost:5000/api/posts",{method:"POST",body:v});if(!x.ok)throw new Error("Failed to create post");const w=await x.json();e([w,...t]),s(""),a(""),o(null),c(null)}catch(x){c("Failed to create post"),console.error(x)}},p=async y=>{try{if(!(await fetch(`http://localhost:5000/api/posts/${y}`,{method:"DELETE"})).ok)throw new Error("Failed to delete post");e(t.filter(x=>x._id!==y))}catch(v){c("Failed to delete post"),console.error(v)}},g=async y=>{try{const v=await fetch(`http://localhost:5000/api/posts/${y}/like`,{method:"PUT"});if(!v.ok)throw new Error("Failed to like post");const x=await v.json();e(t.map(w=>w._id===y?x:w))}catch(v){console.error(v)}};return L.jsx("div",{className:"min-h-screen bg-gradient-to-b from-green-50 to-green-100 py-8 px-4 sm:px-6 lg:px-8",children:L.jsxs(je.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-7xl mx-auto",children:[L.jsxs("div",{className:"text-center mb-12",children:[L.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-3",children:"Farmer Community Forum"}),L.jsx("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:"Connect with fellow farmers, share knowledge and get advice"})]}),l&&L.jsx(je.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-red-50 border-l-4 border-red-500 p-4 mb-8 rounded",children:L.jsxs("div",{className:"flex items-center",children:[L.jsx("div",{className:"flex-shrink-0",children:L.jsx("svg",{className:"h-5 w-5 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:L.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),L.jsx("div",{className:"ml-3",children:L.jsx("p",{className:"text-sm text-red-700",children:l})})]})}),L.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[L.jsx("div",{className:"w-full lg:w-1/3",children:L.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 sticky top-6",children:[L.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center",children:[L.jsx(n_,{className:"mr-2 text-green-600"}),"Create a Post"]}),L.jsxs("form",{onSubmit:d,className:"space-y-4",children:[L.jsxs("div",{children:[L.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),L.jsx("input",{type:"text",value:n,onChange:y=>s(y.target.value),placeholder:"What's your question?",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),L.jsxs("div",{children:[L.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),L.jsx("textarea",{value:r,onChange:y=>a(y.target.value),placeholder:"Share details about your farming issue...",rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),L.jsxs("div",{children:[L.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add Image (Optional)"}),L.jsxs("label",{className:"flex flex-col items-center justify-center w-full p-4 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[L.jsxs("div",{className:"flex flex-col items-center justify-center",children:[L.jsx(gY,{className:"w-8 h-8 text-gray-500 mb-2"}),L.jsx("p",{className:"text-sm text-gray-500",children:i?i.name:"Click to upload image"})]}),L.jsx("input",{type:"file",onChange:y=>o(y.target.files[0]),className:"hidden",accept:"image/*"})]})]}),L.jsx("button",{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-4 rounded-lg shadow-md transition-colors",children:"Share Post"})]})]})}),L.jsx("div",{className:"w-full lg:w-2/3",children:t.length>0?L.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.map(y=>L.jsx(je.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-all",children:L.jsxs("div",{className:"p-6",children:[L.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:y.title}),L.jsx("p",{className:"text-gray-600 mb-4",children:y.description}),y.imageUrl&&L.jsx("div",{className:"mb-4 rounded-lg overflow-hidden",children:L.jsx("img",{src:`http://localhost:5000${y.imageUrl}`,alt:"Post",className:"w-full h-48 object-cover"})}),L.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-100",children:[L.jsxs("button",{onClick:()=>g(y._id),className:`flex items-center space-x-1 ${y.likes>0?"text-red-500":"text-gray-500"} hover:text-red-600 transition-colors`,children:[L.jsx(pY,{className:"w-5 h-5",fill:y.likes>0?"currentColor":"none"}),L.jsxs("span",{children:[y.likes," Likes"]})]}),L.jsxs("button",{onClick:()=>p(y._id),className:"text-red-500 hover:text-red-700 flex items-center",children:[L.jsx(wY,{className:"w-5 h-5 mr-1"}),"Delete"]})]})]})},y._id))}):L.jsxs("div",{className:"bg-white rounded-xl shadow-md p-8 text-center",children:[L.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100",children:L.jsx(n_,{className:"h-6 w-6 text-green-600"})}),L.jsx("h3",{className:"mt-3 text-lg font-medium text-gray-900",children:"No posts yet"}),L.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Be the first to share your farming questions or experiences!"})]})})]})]})})}/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const R3e={prefix:"fab",iconName:"linkedin",icon:[448,512,[],"f08c","M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"]},D3e={prefix:"fab",iconName:"instagram",icon:[448,512,[],"f16d","M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"]},O3e={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256C0 376 82.7 476.8 194.2 504.5V334.2H141.4V256h52.8V222.3c0-87.1 39.4-127.5 125-127.5c16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1c-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287V510.1C413.8 494.8 512 386.9 512 256h0z"]},_3e={prefix:"fab",iconName:"youtube",icon:[576,512,[61802],"f167","M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"]},F3e={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]},L3e=()=>{const[t,e]=K.useState(""),[n,s]=K.useState(!1),r=o=>{o.preventDefault(),t&&(s(!0),setTimeout(()=>s(!1),3e3),e(""))},a=[{name:"Home",path:"/"},{name:"Disease Detection",path:"/detect"},{name:"Solutions",path:"/solutions"},{name:"About Us",path:"/about"},{name:"Contact",path:"/contact"},{name:"Privacy Policy",path:"/privacy"}],i=[{icon:O3e,url:"https://facebook.com",name:"Facebook"},{icon:F3e,url:"https://twitter.com",name:"Twitter"},{icon:D3e,url:"https://instagram.com",name:"Instagram"},{icon:R3e,url:"https://linkedin.com",name:"LinkedIn"},{icon:_3e,url:"https://youtube.com",name:"YouTube"}];return L.jsx("footer",{className:" from-green-800 bg-gradient-to-b  text-white to-green-900",children:L.jsxs("div",{className:"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8 ",children:[L.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-10",children:[L.jsxs(je.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},viewport:{once:!0},className:"space-y-4",children:[L.jsx("h3",{className:"text-xl  tracking-wider font-bold",children:"CROP AI"}),L.jsx("p",{className:"text-green-100 text-sm leading-relaxed",children:"Empowering farmers with AI-driven crop disease detection."}),L.jsx("div",{className:"flex space-x-4 pt-2",children:i.slice(0,4).map((o,l)=>L.jsx(je.a,{href:o.url,target:"_blank",rel:"noopener noreferrer","aria-label":o.name,whileHover:{y:-2},className:"bg-green-700  text-white p-2 rounded-full hover:bg-green-600 transition-colors duration-300",children:L.jsx(mi,{icon:o.icon,className:"h-4 w-4"})},l))})]}),L.jsxs(je.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.1},viewport:{once:!0},className:"space-y-4",children:[L.jsx("h3",{className:" font-semibold text-lg tracking-wider",children:"Quick Links"}),L.jsx("ul",{className:"space-y-2",children:a.map((o,l)=>L.jsx("li",{children:L.jsxs(je.a,{href:o.path,whileHover:{x:5},className:"text-green-100  text-sm flex  transition-colors items-center duration-200 hover:text-yellow-300",children:[L.jsx("span",{className:"w-2 h-2  rounded-full mr-2 bg-yellow-400"}),o.name]})},l))})]}),L.jsxs(je.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.2},viewport:{once:!0},className:"space-y-4",children:[L.jsx("h3",{className:"text-lg  tracking-wider font-semibold",children:"Contact Us"}),L.jsxs("address",{className:"not-italic  text-sm space-y-3",children:[L.jsxs("div",{className:" items-start flex ",children:[L.jsx(mi,{icon:JQ,className:"mt-1  text-yellow-400 mr-3"}),L.jsxs("p",{className:"text-green-100",children:["Farma It.pvt Lted",L.jsx("br",{}),"Agricultural Zone Varanasi",L.jsx("br",{}),"India 221307"]})]}),L.jsxs("div",{className:" items-center flex ",children:[L.jsx(mi,{icon:KQ,className:" text-yellow-400 mr-3 "}),L.jsx("a",{href:"mailto:support@cropai.com",className:" hover:text-yellow-300 text-green-100 transition-colors",children:"support@cropai.com"})]}),L.jsxs("div",{className:"flex items-center",children:[L.jsx(mi,{icon:XQ,className:"mr-3 text-yellow-400"}),L.jsx("a",{href:"tel:+916393168549",className:"text-green-100 hover:text-yellow-300 transition-colors",children:"+91 6393168549"})]})]})]}),L.jsxs(je.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:.3},viewport:{once:!0},className:"space-y-4",children:[L.jsx("h3",{className:"text-lg  tracking-wider font-semibold",children:"Updated"}),L.jsx("p",{className:"text-sm text-green-100 ",children:"Subscribe to our newsletter for the latest updates on crop health solutions."}),L.jsxs("form",{onSubmit:r,className:"space-y-3",children:[L.jsxs("div",{className:"relative",children:[L.jsx("input",{type:"email",placeholder:"Your email address",className:"w-full px-4 py-3 rounded-lg bg-green-700 border border-green-600  focus:ring-1 focus:ring-yellow-300 text-white placeholder-green-300 outline-none transition-all focus:border-yellow-400 z-0",value:t,onChange:o=>e(o.target.value),required:!0}),L.jsx("button",{type:"submit",className:" duration-200 absolute right-2 top-1/2 transform -translate-y-1/2 bg-yellow-400 hover:bg-yellow-500 text-green-900 p-2 rounded-lg transition-colors ","aria-label":"Subscribe",children:L.jsx(mi,{icon:tJ})})]}),n&&L.jsx(je.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},className:"text-xs text-yellow-400 ",children:"Thank you for subscribing"})]})]})]}),L.jsxs(je.div,{initial:{opacity:0},whileInView:{opacity:1},transition:{duration:.5,delay:.4},viewport:{once:!0},className:"border-t  mt-12 pt-8 flex  md:flex-row justify-between flex-col items-center border-green-700",children:[L.jsx("p",{className:"text-green-300  md:text-left mb-4 md:mb-0 text-sm text-center",children:" 2025 AI-Powered Crop Disease Detection. All rights reserved."}),L.jsx("div",{className:"flex space-x-6",children:i.map((o,l)=>L.jsx(je.a,{href:o.url,target:"_blank",rel:"noopener noreferrer","aria-label":o.name,whileHover:{y:-3},className:"text-green-300 duration-200  transition-colors  hover:text-yellow-400",children:L.jsx(mi,{icon:o.icon,className:"h-5 w-5"})},l))})]})]})})};function M3e(t){return ss({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M20.998 3V5C20.998 8.86599 17.864 12 13.998 12H12.998V13H17.998V20C17.998 21.1046 17.1026 22 15.998 22H7.99805C6.89348 22 5.99805 21.1046 5.99805 20V13H10.998V10C10.998 6.13401 14.1321 3 17.998 3H20.998ZM5.49805 2C8.02667 2 10.263 3.25136 11.6216 5.1686C10.6026 6.51084 9.99805 8.18482 9.99805 10V11H9.49805C5.35591 11 1.99805 7.64214 1.99805 3.5V2H5.49805Z"},child:[]}]})(t)}const z3e=()=>{const[t,e]=K.useState(!1),[n,s]=K.useState(!1),r=zi();K.useEffect(()=>{e(!1)},[r]),K.useEffect(()=>{const i=()=>{s(window.scrollY>10)};return window.addEventListener("scroll",i),()=>window.removeEventListener("scroll",i)},[]);const a=[{path:"/home",name:"Home",icon:gJ},{path:"/upload",name:"Upload",icon:pJ},{path:"/diseases",name:"Diseases",icon:Qd},{path:"/forum",name:"Forum",icon:mJ}];return L.jsxs(L.Fragment,{children:[L.jsxs(je.header,{initial:{y:-100},animate:{y:0},transition:{duration:.5},className:` w-full z-50 transition-all duration-300 fixed top-0 left-0 ${n?"bg-green-800 shadow-lg":"bg-green-700"}`,children:[L.jsx("div",{className:"container mx-auto px-4 sm:px-6",children:L.jsxs("div",{className:"flex justify-between items-center h-16 sm:h-20",children:[L.jsxs(Dc,{to:"/home",className:"flex items-center",children:[L.jsx(je.div,{whileHover:{rotate:15},className:"text-2xl text-white mr-2",children:L.jsx(M3e,{})}),L.jsxs("h1",{className:"text-xl font-bold text-white hidden sm:block",children:[L.jsx("span",{className:"font-extrabold",children:"AI"})," Crop Disease Detection"]})]}),L.jsx("nav",{className:"hidden md:flex items-center space-x-1",children:a.map(i=>L.jsxs(Dc,{to:i.path,className:`flex items-center px-4 py-2 rounded-lg transition-all ${r.pathname===i.path?"bg-green-600 text-white":"text-green-100 hover:bg-green-600/50 hover:text-white"}`,children:[L.jsx(i.icon,{className:"mr-2"}),i.name]},i.path))}),L.jsx("button",{className:"md:hidden text-2xl text-white p-2 rounded-lg hover:bg-green-600 transition-colors",onClick:()=>e(!t),"aria-label":"Toggle menu",children:t?L.jsx(xJ,{}):L.jsx(hJ,{})})]})}),L.jsx(wu,{children:t&&L.jsx(je.div,{initial:{opacity:0,x:"-100%"},animate:{opacity:1,x:0},exit:{opacity:0,x:"-100%"},transition:{type:"spring",damping:25},className:"fixed inset-0 bg-green-800 z-40 pt-16 md:hidden",children:L.jsx("div",{className:"container mx-auto  px-4 py-6 ",children:L.jsx("nav",{className:"flex  space-y-2 flex-col",children:a.map(i=>L.jsxs(Dc,{to:i.path,className:`flex items-center px-4  rounded-lg text-lg transition-all py-3${r.pathname===i.path?"bg-green-700 text-white":"text-green-100 hover:bg-green-700/50"}`,onClick:()=>e(!1),children:[L.jsx(i.icon,{className:"mr-3 text-xl"}),i.name]},i.path))})})})})]}),L.jsx("div",{className:"h-16 sm:h-20"})]})},P3e="/assets/leaf-pU6i8_rY.png",B3e=()=>L.jsxs("div",{className:"h-screen flex flex-col justify-center items-center bg-cover bg-center relative overflow-hidden text-white",style:{backgroundImage:"url(https://images.unsplash.com/photo-1495107334309-fcf20504a5ab?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D)"},children:[L.jsx(je.div,{className:"absolute w-72 h-72 bg-green-400 opacity-10 rounded-full top-10 left-10 blur-[120px]",animate:{x:[0,30,-30,0],y:[0,20,-20,0],rotate:[0,15,-15,0]},transition:{duration:8,repeat:1/0,ease:"easeInOut"}}),L.jsx(je.div,{className:"absolute w-60 h-60 bg-blue-400 opacity-30 rounded-full bottom-10 right-10 blur-[100px]",animate:{x:[0,-25,25,0],y:[0,-25,25,0],rotate:[0,-10,10,0]},transition:{duration:6,repeat:1/0,ease:"easeInOut"}}),L.jsx(je.img,{src:P3e,alt:"AI Crop Logo",className:"w-24 md:w-28 lg:w-32 drop-shadow-lg",initial:{opacity:0,scale:.5,rotate:-10},animate:{opacity:1,scale:1,rotate:0},transition:{duration:1.5,ease:"easeOut"}}),L.jsxs(je.div,{className:"rounded-3xl  p-8 md:p-14 text-center w-11/12 max-w-lg",initial:{opacity:0,y:60},animate:{opacity:1,y:0},transition:{duration:1.2,ease:"easeOut"},children:[L.jsx("h2",{className:"text-4xl md:text-5xl font-extrabold text-[#f1f1f1] drop-shadow-lg",children:"AI Crop Disease Detection"}),L.jsx("p",{className:"text-red-600 mt-4 text-lg md:text-xl leading-relaxed font-sans",children:"Protect your crops with AI-powered disease detection. Smart farming starts here"}),L.jsx(je.div,{whileHover:{scale:1.08},whileTap:{scale:.95},children:L.jsx(Dc,{to:"/home",className:"mt-6 inline-block w-full bg-gradient-to-r bg-green-600 text-white font-semibold py-3 text-lg rounded-lg transition hover:opacity-90",children:"Get Started"})})]})]}),V3e=({children:t})=>{const n=zi().pathname==="/";return L.jsxs("div",{className:"bg-gray-100 font-roboto min-h-screen",children:[!n&&L.jsx(z3e,{}),t,!n&&L.jsx(L3e,{})]})},U3e=()=>L.jsx(x9,{children:L.jsx(V3e,{children:L.jsxs(YG,{children:[L.jsx(Sc,{path:"/",element:L.jsx(B3e,{})}),L.jsx(Sc,{path:"/home",element:L.jsx(SJ,{})}),L.jsx(Sc,{path:"/upload",element:L.jsx(JRe,{})}),L.jsx(Sc,{path:"/diseases",element:L.jsx(I3e,{})}),L.jsx(Sc,{path:"/forum",element:L.jsx(A3e,{})})]})})});aG.createRoot(document.getElementById("root")).render(L.jsx(K.StrictMode,{children:L.jsx(U3e,{})}));
